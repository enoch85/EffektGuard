s6-rc: info: service s6rc-oneshot-runner: starting
s6-rc: info: service s6rc-oneshot-runner successfully started
s6-rc: info: service fix-attrs: starting
s6-rc: info: service fix-attrs successfully started
s6-rc: info: service legacy-cont-init: starting
s6-rc: info: service legacy-cont-init successfully started
s6-rc: info: service legacy-services: starting
services-up: info: copying legacy longrun home-assistant (no readiness notification)
s6-rc: info: service legacy-services successfully started
[33m2025-10-27 15:22:10.995 WARNING (SyncWorker_0) [homeassistant.loader] We found a custom integration sunspec which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant[0m
[33m2025-10-27 15:22:10.997 WARNING (SyncWorker_0) [homeassistant.loader] We found a custom integration home_connect_alt which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant[0m
[33m2025-10-27 15:22:10.997 WARNING (SyncWorker_0) [homeassistant.loader] We found a custom integration ovms which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant[0m
[33m2025-10-27 15:22:10.998 WARNING (SyncWorker_0) [homeassistant.loader] We found a custom integration sonoff which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant[0m
[33m2025-10-27 15:22:10.999 WARNING (SyncWorker_0) [homeassistant.loader] We found a custom integration nodered which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant[0m
[33m2025-10-27 15:22:10.999 WARNING (SyncWorker_0) [homeassistant.loader] We found a custom integration ge_spot which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant[0m
[33m2025-10-27 15:22:11.000 WARNING (SyncWorker_0) [homeassistant.loader] We found a custom integration spook_inverse which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant[0m
[33m2025-10-27 15:22:11.000 WARNING (SyncWorker_0) [homeassistant.loader] We found a custom integration ev_smart_charging which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant[0m
[33m2025-10-27 15:22:11.000 WARNING (SyncWorker_0) [homeassistant.loader] We found a custom integration hacs which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant[0m
[33m2025-10-27 15:22:11.001 WARNING (SyncWorker_0) [homeassistant.loader] We found a custom integration tesla_custom which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant[0m
[33m2025-10-27 15:22:11.001 WARNING (SyncWorker_0) [homeassistant.loader] We found a custom integration effektguard which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant[0m
[33m2025-10-27 15:22:11.002 WARNING (SyncWorker_0) [homeassistant.loader] We found a custom integration greenely which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant[0m
[33m2025-10-27 15:22:11.002 WARNING (SyncWorker_0) [homeassistant.loader] We found a custom integration watchman which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant[0m
[33m2025-10-27 15:22:11.002 WARNING (SyncWorker_0) [homeassistant.loader] We found a custom integration easee which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant[0m
[33m2025-10-27 15:22:11.002 WARNING (SyncWorker_0) [homeassistant.loader] We found a custom integration spook which has not been tested by Home Assistant. This component might cause stability problems, be sure to disable it if you experience issues with Home Assistant[0m
[32m2025-10-27 15:22:25.316 INFO (MainThread) [custom_components.effektguard] Setting up EffektGuard integration[0m
[36m2025-10-27 15:22:25.317 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] Latitude 55.60 matches zone 'moderate_cold' (54.5-56.0)[0m
[32m2025-10-27 15:22:25.317 INFO (MainThread) [custom_components.effektguard.optimization.climate_zones] Climate zone detected: Moderate Cold (Moderate winter heating demands) at latitude 55.60Â°N - Winter avg: -1.0Â°C, DM normal range: -300 to -500[0m
[32m2025-10-27 15:22:25.317 INFO (MainThread) [custom_components.effektguard.optimization.weather_compensation] AdaptiveClimateSystem initialized: latitude=55.60Â° -> Moderate Cold zone (winter avg low: -1.0Â°C, base safety margin: 0.5Â°C)[0m
[36m2025-10-27 15:22:25.317 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] Latitude 55.60 matches zone 'moderate_cold' (54.5-56.0)[0m
[32m2025-10-27 15:22:25.317 INFO (MainThread) [custom_components.effektguard.optimization.climate_zones] Climate zone detected: Moderate Cold (Moderate winter heating demands) at latitude 55.60Â°N - Winter avg: -1.0Â°C, DM normal range: -300 to -500[0m
[32m2025-10-27 15:22:25.317 INFO (MainThread) [custom_components.effektguard.optimization.decision_engine] Climate zone: Moderate Cold (moderate_cold) - DM thresholds adapted for Moderate winter heating demands[0m
[36m2025-10-27 15:22:25.317 DEBUG (MainThread) [custom_components.effektguard.optimization.weather_compensation] WeatherCompensationCalculator initialized: HC=180.0 W/Â°C, radiator_output=None W, type=radiator[0m
[32m2025-10-27 15:22:25.317 INFO (MainThread) [custom_components.effektguard.optimization.decision_engine] Weather compensation initialized: HC=180.0 W/Â°C, radiator=not configured W, type=radiator[0m
[32m2025-10-27 15:22:25.318 INFO (MainThread) [custom_components.effektguard.optimization.effect_manager] Loaded 3 monthly peaks[0m
[32m2025-10-27 15:22:25.323 INFO (MainThread) [custom_components.effektguard.coordinator] Loaded heat pump model: F750 (F-series ASHP)[0m
[32m2025-10-27 15:22:25.323 INFO (MainThread) [custom_components.effektguard.coordinator] Detected climate region: Southern Sweden (MalmÃ¶/Gothenburg) (latitude: 55.60Â°N)[0m
[36m2025-10-27 15:22:25.323 DEBUG (MainThread) [custom_components.effektguard.utils.compressor_monitor] CompressorHealthMonitor initialized (max 24 hours, 1440 samples)[0m
[32m2025-10-27 15:22:25.327 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimizer initialized with climate-aware thresholds: Moderate Cold zone[0m
[32m2025-10-27 15:22:25.327 INFO (MainThread) [custom_components.effektguard.coordinator] DHW demand periods configured: ['07:00 (50.0Â°C)'][0m
[36m2025-10-27 15:22:25.327 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW periods configured: ['7:00'] (types: ['int'])[0m
[32m2025-10-27 15:22:25.327 INFO (MainThread) [custom_components.effektguard.coordinator] Restored monthly peak: 11.32 kW (3 peaks loaded)[0m
[36m2025-10-27 15:22:25.327 DEBUG (MainThread) [custom_components.effektguard.coordinator] Initializing learning modules...[0m
[32m2025-10-27 15:22:25.329 INFO (MainThread) [custom_components.effektguard.coordinator] Loaded learned data from storage (version 1, updated 2025-10-27T14:16:37.095894+00:00)[0m
[32m2025-10-27 15:22:25.329 INFO (MainThread) [custom_components.effektguard.coordinator] Restored last offset: 0.1Â°C from 2025-10-27T13:06:37.097273+00:00[0m
[32m2025-10-27 15:22:25.329 INFO (MainThread) [custom_components.effektguard.coordinator] Restored thermal model: mass=2.00, UFH=unknown[0m
[32m2025-10-27 15:22:25.329 INFO (MainThread) [custom_components.effektguard.coordinator] Restored thermal predictor with 96 historical snapshots[0m
[32m2025-10-27 15:22:25.330 INFO (MainThread) [custom_components.effektguard.coordinator] Restored weather patterns: 0 weeks of data[0m
[32m2025-10-27 15:22:25.330 INFO (MainThread) [custom_components.effektguard.coordinator] Restored last Legionella boost: 2025-10-20 00:35:42.242714+00:00[0m
[36m2025-10-27 15:22:25.333 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Found NIBE entity offset: number.f750_cu_3x400v_heating_offset_climate_system_1[0m
[36m2025-10-27 15:22:25.333 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Found NIBE entity outdoor_temp: sensor.f750_cu_3x400v_current_outd_temp_bt1[0m
[36m2025-10-27 15:22:25.333 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Found NIBE entity supply_temp: sensor.f750_cu_3x400v_heating_medium_supply_bt63[0m
[36m2025-10-27 15:22:25.333 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Found NIBE entity dhw_charging_temp: sensor.f750_cu_3x400v_heating_medium_supply_bt63[0m
[36m2025-10-27 15:22:25.333 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Found NIBE entity return_temp: sensor.f750_cu_3x400v_return_line_bt3[0m
[36m2025-10-27 15:22:25.333 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Found NIBE entity hot_water_status: sensor.f750_cu_3x400v_hot_water_top_bt7[0m
[36m2025-10-27 15:22:25.333 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Found NIBE entity dhw_top_temp: sensor.f750_cu_3x400v_hot_water_top_bt7[0m
[36m2025-10-27 15:22:25.333 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Found NIBE entity indoor_temp: sensor.f750_cu_3x400v_room_temperature_bt50[0m
[36m2025-10-27 15:22:25.333 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Found NIBE entity phase3_current: sensor.f750_cu_3x400v_current_be3[0m
[36m2025-10-27 15:22:25.333 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Found NIBE entity phase2_current: sensor.f750_cu_3x400v_current_be2[0m
[36m2025-10-27 15:22:25.334 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Found NIBE entity phase1_current: sensor.f750_cu_3x400v_current_be1[0m
[36m2025-10-27 15:22:25.334 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Found NIBE entity degree_minutes: sensor.f750_cu_3x400v_degree_minutes[0m
[36m2025-10-27 15:22:25.334 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Found NIBE entity compressor_status: sensor.f750_cu_3x400v_current_compressor_frequency[0m
[36m2025-10-27 15:22:25.334 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Found NIBE entity compressor_hz: sensor.f750_cu_3x400v_current_compressor_frequency[0m
[32m2025-10-27 15:22:25.336 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE Entity Discovery: Found 14 entities[0m
[32m2025-10-27 15:22:25.336 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter]   offset: number.f750_cu_3x400v_heating_offset_climate_system_1 = 1.0 [0m
[32m2025-10-27 15:22:25.336 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter]   outdoor_temp: sensor.f750_cu_3x400v_current_outd_temp_bt1 = 8.7 Â°C[0m
[32m2025-10-27 15:22:25.336 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter]   supply_temp: sensor.f750_cu_3x400v_heating_medium_supply_bt63 = 30.6 Â°C[0m
[32m2025-10-27 15:22:25.336 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter]   dhw_charging_temp: sensor.f750_cu_3x400v_heating_medium_supply_bt63 = 30.6 Â°C[0m
[32m2025-10-27 15:22:25.336 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter]   return_temp: sensor.f750_cu_3x400v_return_line_bt3 = 30.4 Â°C[0m
[32m2025-10-27 15:22:25.336 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter]   hot_water_status: sensor.f750_cu_3x400v_hot_water_top_bt7 = 44.1 Â°C[0m
[32m2025-10-27 15:22:25.336 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter]   dhw_top_temp: sensor.f750_cu_3x400v_hot_water_top_bt7 = 44.1 Â°C[0m
[32m2025-10-27 15:22:25.336 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter]   indoor_temp: sensor.f750_cu_3x400v_room_temperature_bt50 = 24.6 Â°C[0m
[32m2025-10-27 15:22:25.336 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter]   phase3_current: sensor.f750_cu_3x400v_current_be3 = 0.6 A[0m
[32m2025-10-27 15:22:25.336 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter]   phase2_current: sensor.f750_cu_3x400v_current_be2 = 0.9 A[0m
[32m2025-10-27 15:22:25.336 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter]   phase1_current: sensor.f750_cu_3x400v_current_be1 = 4.2 A[0m
[32m2025-10-27 15:22:25.336 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter]   degree_minutes: sensor.f750_cu_3x400v_degree_minutes = -168.0 [0m
[32m2025-10-27 15:22:25.336 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter]   compressor_status: sensor.f750_cu_3x400v_current_compressor_frequency = 1.0 Hz[0m
[32m2025-10-27 15:22:25.336 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter]   compressor_hz: sensor.f750_cu_3x400v_current_compressor_frequency = 1.0 Hz[0m
[36m2025-10-27 15:22:25.336 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] Loading BT7 temperature history from 2025-10-13 14:22:25.336784+00:00 to 2025-10-27 14:22:25.336784+00:00 (14 days)[0m
[32m2025-10-27 15:22:25.379 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] Loaded 837 BT7 temperature readings from past 14 days (max: 56.1Â°C at 2025-10-20 00:35:42.242714+00:00)[0m
[32m2025-10-27 15:22:25.379 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] Detected previous Legionella boost from history: 56.1Â°C at 2025-10-20 00:35:42.242714+00:00 (181.8 hours ago)[0m
[32m2025-10-27 15:22:25.379 INFO (MainThread) [custom_components.effektguard.coordinator] Learning modules initialized successfully[0m
[36m2025-10-27 15:22:25.379 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[36m2025-10-27 15:22:25.379 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -168.0[0m
[36m2025-10-27 15:22:25.379 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 44.1Â°C[0m
[36m2025-10-27 15:22:25.380 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.6Â°C[0m
[36m2025-10-27 15:22:25.380 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.2A, L2=0.9A, L3=0.6A[0m
[36m2025-10-27 15:22:25.380 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 24.6Â°C, outdoor 8.7Â°C, flow 30.6Â°C, DM -168[0m
[32m2025-10-27 15:22:25.380 INFO (MainThread) [custom_components.effektguard.coordinator] EffektGuard fully initialized - NIBE entities available[0m
[36m2025-10-27 15:22:25.380 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 1 Hz (1h avg: 1, 6h avg: 1, mode: space) - OK: Normal operation (1 Hz, 6h avg: 1 Hz)[0m
[36m2025-10-27 15:22:25.380 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 15:22:25.380 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 15:22:25.380 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 15:22:25.380 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 15:22:25.380 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 15:22:25.380 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 15:22:25.380 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 15:22:25.380 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'active_source': 'nordpool'}[0m
[36m2025-10-27 15:22:25.380 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 15:22:25.380 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 15:22:25.380 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 130}[0m
[36m2025-10-27 15:22:25.380 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 15:22:25.380 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 15:22:25.380 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 15:22:25.381 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 15:22:25.381 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 15:22:25.381 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 15:22:25.381 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 15:22:25.381 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 15:22:25.381 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q61 = 80.64 Ã¶re/kWh[0m
[36m2025-10-27 15:22:25.381 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 15:22:25.381 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 15:22:25.382 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 15:22:25.382 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 15:22:25.383 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 15:22:25.383 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 15:22:25.383 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 15:22:25.396 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 15:22:25.397 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 15:22:25.397 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 15:22:25.397 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 15:22:25.397 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.7Â°C: normal -106 to -306, warning -306[0m
[36m2025-10-27 15:22:25.397 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 15:22:25.397 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -306 (base: -306), critical -1500[0m
[36m2025-10-27 15:22:25.397 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.7Â°C, indoor_target=21.0Â°C, temp_diff=12.3Â°C, HC=0.180 kW/K -> flow=25.7Â°C[0m
[36m2025-10-27 15:22:25.398 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 15:22:25.398 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 15:22:25.398 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.2Â°C, current=30.6Â°C, error=-4.4Â°C, sensitivity=1.5 -> offset=-2.9[0m
[36m2025-10-27 15:22:25.398 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 15:22:25.398 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 30.6Â°C â†’ offset: -2.9Â°C; Weight: 0.23; Deferred: Light debt (DM -168)[0m
[36m2025-10-27 15:22:25.398 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Price classification Q61 (15:22): 80.64 â†’ NORMAL[0m
[32m2025-10-27 15:22:25.398 INFO (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Decision: offset -5.00Â°C - SAFETY: Too hot (24.6Â°C > 24.0Â°C)[0m
[32m2025-10-27 15:22:25.399 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -5.00Â°C, reasoning: SAFETY: Too hot (24.6Â°C > 24.0Â°C)[0m
[36m2025-10-27 15:22:25.399 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=-5.00Â°C, integer=-5Â°C, fractional=0.00Â°C, accumulator_before=0.00Â°C[0m
[36m2025-10-27 15:22:25.399 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Integer offset -5.00Â°C â†’ applying -5Â°C (no accumulation needed)[0m
[32m2025-10-27 15:22:25.400 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to -5Â°C[0m
[36m2025-10-27 15:22:25.400 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=-5Â°C, original=-5.00Â°C, accumulator=0.00Â°C[0m
[32m2025-10-27 15:22:25.400 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset -5.00Â°C to NIBE via MyUplink[0m
[36m2025-10-27 15:22:25.400 DEBUG (MainThread) [custom_components.effektguard.coordinator] External power sensor sensor.gen24_elnat_import_effekt not yet available (state: unknown) - skipping peak tracking (listener active: False)[0m
[36m2025-10-27 15:22:25.400 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=24.6Â°C, outdoor=8.7Â°C, offset=-5.0Â°C, change=0.00Â°C, Î”t=0.00h[0m
[36m2025-10-27 15:22:25.400 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=24.6Â°C, outdoor=8.7Â°C, offset=-5.0Â°C, flow=30.6Â°C, DM=-168[0m
[36m2025-10-27 15:22:25.406 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 1.5Â°C/h trend[0m
[36m2025-10-27 15:22:25.407 DEBUG (MainThread) [custom_components.effektguard.optimization.weather_learning] Recorded weather pattern 10-4: avg=7.8Â°C, range=3.9Â°C, volatility=1.3[0m
[36m2025-10-27 15:22:25.407 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded weather pattern for 2025-10-27[0m
[36m2025-10-27 15:22:25.408 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 15:22:25.411 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved learned data to storage[0m
[36m2025-10-27 15:22:25.411 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 15:22:25.411 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 15:22:25.411 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=44.1[0m
[36m2025-10-27 15:22:25.411 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 15:22:25.423 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 15:22:25.423 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 15:22:25.423 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 15:22:25.424 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 60 quarters available, need 3 quarters (45 min), lookahead 15.0h[0m
[36m2025-10-27 15:22:25.424 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 58 windows evaluated[0m
[36m2025-10-27 15:22:25.424 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (12.4h away) â† SELECTED[0m
[36m2025-10-27 15:22:25.424 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (12.1h away)[0m
[36m2025-10-27 15:22:25.424 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (12.6h away)[0m
[36m2025-10-27 15:22:25.424 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (11.9h away)[0m
[36m2025-10-27 15:22:25.424 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (11.6h away)[0m
[32m2025-10-27 15:22:25.424 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 12.4h away[0m
[36m2025-10-27 15:22:25.425 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 15:22:25.425 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 15:22:25.425 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 15:22:25.426 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 60 quarters available, need 3 quarters (45 min), lookahead 15.0h[0m
[36m2025-10-27 15:22:25.426 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 58 windows evaluated[0m
[36m2025-10-27 15:22:25.426 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (12.4h away) â† SELECTED[0m
[36m2025-10-27 15:22:25.426 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (12.1h away)[0m
[36m2025-10-27 15:22:25.426 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (12.6h away)[0m
[36m2025-10-27 15:22:25.426 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (11.9h away)[0m
[36m2025-10-27 15:22:25.426 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (11.6h away)[0m
[32m2025-10-27 15:22:25.426 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 12.4h away[0m
[36m2025-10-27 15:22:25.426 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-27 15:22:25.426 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.047 seconds (success: True)[0m
[36m2025-10-27 15:22:25.426 DEBUG (MainThread) [custom_components.effektguard.coordinator] Listening for external power sensor sensor.gen24_elnat_import_effekt availability (current state: unknown)[0m
[36m2025-10-27 15:22:25.436 DEBUG (MainThread) [custom_components.effektguard.climate] Restored HVAC mode: heat from previous state[0m
[36m2025-10-27 15:22:25.438 DEBUG (MainThread) [custom_components.effektguard.sensor] Restored peak_today: 10.92[0m
[36m2025-10-27 15:22:25.439 DEBUG (MainThread) [custom_components.effektguard.sensor] Restored peak_this_month: 11.32[0m
[36m2025-10-27 15:22:25.439 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.2 + 0.9 + 0.6)A Ã— 0.95 = 1.30 kW[0m
[36m2025-10-27 15:22:25.439 DEBUG (MainThread) [custom_components.effektguard.sensor] Could not restore compressor_health, will use coordinator value[0m
[36m2025-10-27 15:22:25.441 DEBUG (MainThread) [custom_components.effektguard.sensor] Restored savings_estimate: 100.00[0m
[36m2025-10-27 15:22:25.443 DEBUG (MainThread) [custom_components.effektguard] Registered service: force_offset[0m
[36m2025-10-27 15:22:25.443 DEBUG (MainThread) [custom_components.effektguard] Registered service: reset_peak_tracking[0m
[36m2025-10-27 15:22:25.443 DEBUG (MainThread) [custom_components.effektguard] Registered service: boost_heating[0m
[36m2025-10-27 15:22:25.443 DEBUG (MainThread) [custom_components.effektguard] Registered service: boost_dhw[0m
[36m2025-10-27 15:22:25.443 DEBUG (MainThread) [custom_components.effektguard] Registered service: calculate_optimal_schedule[0m
[32m2025-10-27 15:22:25.443 INFO (MainThread) [custom_components.effektguard] EffektGuard services registered successfully[0m
[32m2025-10-27 15:22:25.443 INFO (MainThread) [custom_components.effektguard] EffektGuard setup complete[0m
[32m2025-10-27 15:22:44.030 INFO (MainThread) [custom_components.effektguard.coordinator] External power sensor sensor.gen24_elnat_import_effekt is now available (state: 0)[0m
[36m2025-10-27 15:22:44.030 DEBUG (MainThread) [custom_components.effektguard.coordinator] Power sensor availability listener unsubscribed[0m
[36m2025-10-27 15:22:44.030 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 15:22:44.030 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.4Â°C (median of 3 sensors: 24.6Â°C, 22.1Â°C, 23.4Â°C)[0m
[36m2025-10-27 15:22:44.030 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -168.0[0m
[36m2025-10-27 15:22:44.030 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 44.1Â°C[0m
[36m2025-10-27 15:22:44.031 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.6Â°C[0m
[36m2025-10-27 15:22:44.031 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.2A, L2=0.9A, L3=0.6A[0m
[36m2025-10-27 15:22:44.031 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.4Â°C, outdoor 8.7Â°C, flow 30.6Â°C, DM -168[0m
[36m2025-10-27 15:22:44.031 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 1 Hz (1h avg: 1, 6h avg: 1, mode: space) - OK: Normal operation (1 Hz, 6h avg: 1 Hz)[0m
[36m2025-10-27 15:22:44.031 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 15:22:44.031 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 15:22:44.031 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 15:22:44.031 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 15:22:44.031 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 15:22:44.031 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 15:22:44.031 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 15:22:44.031 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'active_source': 'nordpool'}[0m
[36m2025-10-27 15:22:44.031 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 15:22:44.031 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 15:22:44.031 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 130}[0m
[36m2025-10-27 15:22:44.031 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 15:22:44.031 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 15:22:44.031 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 15:22:44.031 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 15:22:44.031 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 15:22:44.031 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 15:22:44.031 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 15:22:44.033 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 15:22:44.033 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q61 = 80.64 Ã¶re/kWh[0m
[36m2025-10-27 15:22:44.033 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 15:22:44.033 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 15:22:44.034 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 15:22:44.034 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 15:22:44.034 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 15:22:44.034 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 15:22:44.038 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 15:22:44.044 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 15:22:44.044 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 15:22:44.044 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 15:22:44.044 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 15:22:44.045 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.7Â°C: normal -106 to -306, warning -306[0m
[36m2025-10-27 15:22:44.045 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 15:22:44.045 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -306 (base: -306), critical -1500[0m
[36m2025-10-27 15:22:44.045 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.7Â°C, indoor_target=21.0Â°C, temp_diff=12.3Â°C, HC=0.180 kW/K -> flow=25.7Â°C[0m
[36m2025-10-27 15:22:44.045 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 15:22:44.045 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 15:22:44.045 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.2Â°C, current=30.6Â°C, error=-4.4Â°C, sensitivity=1.5 -> offset=-2.9[0m
[36m2025-10-27 15:22:44.045 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 15:22:44.045 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 30.6Â°C â†’ offset: -2.9Â°C; Weight: 0.23; Deferred: Light debt (DM -168)[0m
[36m2025-10-27 15:22:44.045 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Price classification Q61 (15:22): 80.64 â†’ NORMAL[0m
[32m2025-10-27 15:22:44.046 INFO (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.11Â°C - Learned pre-heat: Pre-heating: predicted drop 0.6Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 30.6Â°C â†’ offset: -2.9Â°C; Weight: 0.23; Deferred: Light debt (DM -168) | GE-Spot Q61: NORMAL (day) | Too warm: 2.4Â°C over (damped 25%: warming 1.52Â°C/h)[0m
[32m2025-10-27 15:22:44.047 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.11Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 0.6Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 30.6Â°C â†’ offset: -2.9Â°C; Weight: 0.23; Deferred: Light debt (DM -168) | GE-Spot Q61: NORMAL (day) | Too warm: 2.4Â°C over (damped 25%: warming 1.52Â°C/h)[0m
[36m2025-10-27 15:22:44.047 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Skipping offset write, too soon since last write[0m
[36m2025-10-27 15:22:44.047 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset -0.11Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 15:22:44.047 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.000 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 15:22:44.047 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-27 15:22:44.047 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.4Â°C, outdoor=8.7Â°C, offset=-0.1Â°C, change=-1.16Â°C, Î”t=0.01h[0m
[36m2025-10-27 15:22:44.048 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.4Â°C, outdoor=8.7Â°C, offset=-0.1Â°C, flow=30.6Â°C, DM=-168[0m
[36m2025-10-27 15:22:44.048 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (19s since last save)[0m
[36m2025-10-27 15:22:44.048 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 15:22:44.055 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 15:22:44.055 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 15:22:44.055 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=44.1[0m
[36m2025-10-27 15:22:44.056 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 15:22:44.059 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 15:22:44.059 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 15:22:44.060 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 15:22:44.060 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 60 quarters available, need 3 quarters (45 min), lookahead 15.0h[0m
[36m2025-10-27 15:22:44.060 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 58 windows evaluated[0m
[36m2025-10-27 15:22:44.060 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (12.4h away) â† SELECTED[0m
[36m2025-10-27 15:22:44.060 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (12.1h away)[0m
[36m2025-10-27 15:22:44.060 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (12.6h away)[0m
[36m2025-10-27 15:22:44.060 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (11.9h away)[0m
[36m2025-10-27 15:22:44.060 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (11.6h away)[0m
[32m2025-10-27 15:22:44.060 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 12.4h away[0m
[36m2025-10-27 15:22:44.062 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 15:22:44.062 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 15:22:44.063 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 15:22:44.063 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 60 quarters available, need 3 quarters (45 min), lookahead 15.0h[0m
[36m2025-10-27 15:22:44.063 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 58 windows evaluated[0m
[36m2025-10-27 15:22:44.063 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (12.4h away) â† SELECTED[0m
[36m2025-10-27 15:22:44.063 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (12.1h away)[0m
[36m2025-10-27 15:22:44.063 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (12.6h away)[0m
[36m2025-10-27 15:22:44.063 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (11.9h away)[0m
[36m2025-10-27 15:22:44.063 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (11.6h away)[0m
[32m2025-10-27 15:22:44.063 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 12.4h away[0m
[36m2025-10-27 15:22:44.063 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-27 15:22:44.064 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.033 seconds (success: True)[0m
[36m2025-10-27 15:22:44.064 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.2 + 0.9 + 0.6)A Ã— 0.95 = 1.30 kW[0m
[36m2025-10-27 15:22:44.065 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 15:27:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 15:27:44.223 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.7Â°C (median of 9 sensors: 24.6Â°C, 22.1Â°C, 22.6Â°C, 23.4Â°C, 25.8Â°C, 23.7Â°C, 24.1Â°C, 23.4Â°C, 25.0Â°C)[0m
[36m2025-10-27 15:27:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -168.0[0m
[36m2025-10-27 15:27:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 44.1Â°C[0m
[36m2025-10-27 15:27:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.6Â°C[0m
[36m2025-10-27 15:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.2A, L2=0.9A, L3=0.6A[0m
[36m2025-10-27 15:27:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.7Â°C, outdoor 8.7Â°C, flow 30.6Â°C, DM -168[0m
[36m2025-10-27 15:27:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 1 Hz (1h avg: 1, 6h avg: 1, mode: space) - OK: Normal operation (1 Hz, 6h avg: 1 Hz)[0m
[36m2025-10-27 15:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 15:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 15:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 15:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 15:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 15:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 15:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 15:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 15:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 15:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 15:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 130}[0m
[36m2025-10-27 15:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 15:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 15:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 15:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 15:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 15:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 15:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 15:27:44.224 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 15:27:44.225 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q61 = 80.64 Ã¶re/kWh[0m
[36m2025-10-27 15:27:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 15:27:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 15:27:44.226 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 15:27:44.226 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 15:27:44.226 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 15:27:44.226 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 15:27:44.226 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 15:27:44.228 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 15:27:44.228 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 15:27:44.228 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 15:27:44.228 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 15:27:44.228 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.7Â°C: normal -106 to -306, warning -306[0m
[36m2025-10-27 15:27:44.228 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 15:27:44.229 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -306 (base: -306), critical -1500[0m
[36m2025-10-27 15:27:44.229 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.7Â°C, indoor_target=21.0Â°C, temp_diff=12.3Â°C, HC=0.180 kW/K -> flow=25.7Â°C[0m
[36m2025-10-27 15:27:44.229 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 15:27:44.229 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 15:27:44.229 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.2Â°C, current=30.6Â°C, error=-4.4Â°C, sensitivity=1.5 -> offset=-2.9[0m
[36m2025-10-27 15:27:44.229 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 15:27:44.229 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 30.6Â°C â†’ offset: -2.9Â°C; Weight: 0.23; Deferred: Light debt (DM -168)[0m
[36m2025-10-27 15:27:44.229 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Price classification Q61 (15:27): 80.64 â†’ NORMAL[0m
[32m2025-10-27 15:27:44.229 INFO (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.08Â°C - Peak: PREDICTIVE avoidance (predicted 1.6 kW, cooling rapidly, Q61) | Learned pre-heat: Pre-heating: predicted drop 1.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 30.6Â°C â†’ offset: -2.9Â°C; Weight: 0.23; Deferred: Light debt (DM -168) | Weather pre-heat: Indoor cooling -0.52Â°C/h (reactive confirmation) â†’ +0.8Â°C @ weight 0.99 (base 0.85 Ã— thermal_mass 2.0) | GE-Spot Q61: NORMAL (day) | Too warm: 2.7Â°C over (boosted 15%: cooling -0.52Â°C/h)[0m
[32m2025-10-27 15:27:44.231 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.08Â°C, reasoning: Peak: PREDICTIVE avoidance (predicted 1.6 kW, cooling rapidly, Q61) | Learned pre-heat: Pre-heating: predicted drop 1.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 30.6Â°C â†’ offset: -2.9Â°C; Weight: 0.23; Deferred: Light debt (DM -168) | Weather pre-heat: Indoor cooling -0.52Â°C/h (reactive confirmation) â†’ +0.8Â°C @ weight 0.99 (base 0.85 Ã— thermal_mass 2.0) | GE-Spot Q61: NORMAL (day) | Too warm: 2.7Â°C over (boosted 15%: cooling -0.52Â°C/h)[0m
[36m2025-10-27 15:27:44.231 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.08Â°C, integer=0Â°C, fractional=0.08Â°C, accumulator_before=0.00Â°C[0m
[36m2025-10-27 15:27:44.231 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: 0.08Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-27 15:27:44.231 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.08Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 15:27:44.231 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.000 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 15:27:44.231 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-27 15:27:44.231 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.7Â°C, outdoor=8.7Â°C, offset=0.1Â°C, change=0.25Â°C, Î”t=0.08h[0m
[36m2025-10-27 15:27:44.231 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.7Â°C, outdoor=8.7Â°C, offset=0.1Â°C, flow=30.6Â°C, DM=-168[0m
[36m2025-10-27 15:27:44.238 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.1Â°C/h trend[0m
[36m2025-10-27 15:27:44.238 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 15:27:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 15:27:44.241 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 15:27:44.241 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=44.1[0m
[36m2025-10-27 15:27:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 15:27:44.244 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 15:27:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 15:27:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 15:27:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 60 quarters available, need 3 quarters (45 min), lookahead 15.0h[0m
[36m2025-10-27 15:27:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 58 windows evaluated[0m
[36m2025-10-27 15:27:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (12.3h away) â† SELECTED[0m
[36m2025-10-27 15:27:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (12.0h away)[0m
[36m2025-10-27 15:27:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (12.5h away)[0m
[36m2025-10-27 15:27:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (11.8h away)[0m
[36m2025-10-27 15:27:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (11.5h away)[0m
[32m2025-10-27 15:27:44.245 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 12.3h away[0m
[36m2025-10-27 15:27:44.249 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 15:27:44.249 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 15:27:44.249 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 15:27:44.249 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 60 quarters available, need 3 quarters (45 min), lookahead 15.0h[0m
[36m2025-10-27 15:27:44.249 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 58 windows evaluated[0m
[36m2025-10-27 15:27:44.249 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (12.3h away) â† SELECTED[0m
[36m2025-10-27 15:27:44.249 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (12.0h away)[0m
[36m2025-10-27 15:27:44.250 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (12.5h away)[0m
[36m2025-10-27 15:27:44.250 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (11.8h away)[0m
[36m2025-10-27 15:27:44.250 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (11.5h away)[0m
[32m2025-10-27 15:27:44.250 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 12.3h away[0m
[36m2025-10-27 15:27:44.250 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-27 15:27:44.250 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.027 seconds (success: True)[0m
[36m2025-10-27 15:27:44.251 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.2 + 0.9 + 0.6)A Ã— 0.95 = 1.30 kW[0m
[36m2025-10-27 15:27:44.251 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 15:32:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 15:32:44.224 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.7Â°C (median of 9 sensors: 24.6Â°C, 22.1Â°C, 22.6Â°C, 23.5Â°C, 25.7Â°C, 23.7Â°C, 23.9Â°C, 23.4Â°C, 25.0Â°C)[0m
[36m2025-10-27 15:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -136.0[0m
[36m2025-10-27 15:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 44.1Â°C[0m
[36m2025-10-27 15:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.6Â°C[0m
[36m2025-10-27 15:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.2A, L2=0.9A, L3=0.6A[0m
[36m2025-10-27 15:32:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.7Â°C, outdoor 8.7Â°C, flow 30.6Â°C, DM -136[0m
[36m2025-10-27 15:32:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 1 Hz (1h avg: 1, 6h avg: 1, mode: space) - OK: Normal operation (1 Hz, 6h avg: 1 Hz)[0m
[36m2025-10-27 15:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 15:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 15:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 15:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 15:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 15:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 15:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 15:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 15:32:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 15:32:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 15:32:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 129}[0m
[36m2025-10-27 15:32:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 15:32:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 15:32:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 15:32:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 15:32:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 15:32:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 15:32:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 15:32:44.225 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 15:32:44.225 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q62 = 95.18 Ã¶re/kWh[0m
[36m2025-10-27 15:32:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 15:32:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 15:32:44.226 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 15:32:44.226 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 15:32:44.226 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 15:32:44.226 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 15:32:44.227 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 15:32:44.227 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 15:32:44.229 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 15:32:44.229 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 15:32:44.229 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 15:32:44.229 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.7Â°C: normal -106 to -306, warning -306[0m
[36m2025-10-27 15:32:44.229 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 15:32:44.229 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -306 (base: -306), critical -1500[0m
[36m2025-10-27 15:32:44.229 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.7Â°C, indoor_target=21.0Â°C, temp_diff=12.3Â°C, HC=0.180 kW/K -> flow=25.7Â°C[0m
[36m2025-10-27 15:32:44.229 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 15:32:44.230 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 15:32:44.230 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.2Â°C, current=30.6Â°C, error=-4.4Â°C, sensitivity=1.5 -> offset=-2.9[0m
[36m2025-10-27 15:32:44.230 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 15:32:44.230 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 30.6Â°C â†’ offset: -2.9Â°C; Weight: 0.24[0m
[36m2025-10-27 15:32:44.230 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Price classification Q62 (15:32): 95.18 â†’ NORMAL[0m
[32m2025-10-27 15:32:44.230 INFO (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.17Â°C - Learned pre-heat: Pre-heating: predicted drop 1.3Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 30.6Â°C â†’ offset: -2.9Â°C; Weight: 0.24 | GE-Spot Q62: NORMAL (day) | Too warm: 2.7Â°C over[0m
[32m2025-10-27 15:32:44.231 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.17Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.3Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 30.6Â°C â†’ offset: -2.9Â°C; Weight: 0.24 | GE-Spot Q62: NORMAL (day) | Too warm: 2.7Â°C over[0m
[36m2025-10-27 15:32:44.231 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.17Â°C, integer=0Â°C, fractional=0.17Â°C, accumulator_before=0.08Â°C[0m
[36m2025-10-27 15:32:44.231 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: 0.25Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-27 15:32:44.231 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.17Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 15:32:44.231 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.014 kW from sensor.gen24_elnat_import_effekt[0m
[32m2025-10-27 15:32:44.231 INFO (MainThread) [custom_components.effektguard.coordinator] New daily peak: 0.01 kW at 15:32:44 (quarter 62, source: nibe_currents)[0m
[36m2025-10-27 15:32:44.232 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.01 kW below 0.5 kW threshold[0m
[36m2025-10-27 15:32:44.232 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.7Â°C, outdoor=8.7Â°C, offset=0.2Â°C, change=-0.01Â°C, Î”t=0.08h[0m
[36m2025-10-27 15:32:44.232 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.7Â°C, outdoor=8.7Â°C, offset=0.2Â°C, flow=30.6Â°C, DM=-136[0m
[36m2025-10-27 15:32:44.234 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.0Â°C/h trend[0m
[36m2025-10-27 15:32:44.234 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 15:32:44.236 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 15:32:44.236 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 15:32:44.236 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=44.1[0m
[36m2025-10-27 15:32:44.236 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 15:32:44.239 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 15:32:44.239 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 15:32:44.239 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 15:32:44.239 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 60 quarters available, need 3 quarters (45 min), lookahead 15.0h[0m
[36m2025-10-27 15:32:44.239 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 58 windows evaluated[0m
[36m2025-10-27 15:32:44.239 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (12.2h away) â† SELECTED[0m
[36m2025-10-27 15:32:44.239 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (12.0h away)[0m
[36m2025-10-27 15:32:44.239 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (12.5h away)[0m
[36m2025-10-27 15:32:44.239 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (11.7h away)[0m
[36m2025-10-27 15:32:44.239 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (11.5h away)[0m
[32m2025-10-27 15:32:44.239 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 12.2h away[0m
[36m2025-10-27 15:32:44.241 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 15:32:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 15:32:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 15:32:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 60 quarters available, need 3 quarters (45 min), lookahead 15.0h[0m
[36m2025-10-27 15:32:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 58 windows evaluated[0m
[36m2025-10-27 15:32:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (12.2h away) â† SELECTED[0m
[36m2025-10-27 15:32:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (12.0h away)[0m
[36m2025-10-27 15:32:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (12.5h away)[0m
[36m2025-10-27 15:32:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (11.7h away)[0m
[36m2025-10-27 15:32:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (11.5h away)[0m
[32m2025-10-27 15:32:44.242 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 12.2h away[0m
[36m2025-10-27 15:32:44.242 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-27 15:32:44.243 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.019 seconds (success: True)[0m
[36m2025-10-27 15:32:44.244 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.2 + 0.9 + 0.6)A Ã— 0.95 = 1.30 kW[0m
[33m2025-10-27 15:35:38.067 WARNING (MainThread) [homeassistant.components.automation.led_tak_groventre] LED TAK GROVENTRE: Already running[0m
[36m2025-10-27 15:37:44.222 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 15:37:44.223 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.7Â°C (median of 9 sensors: 24.6Â°C, 22.1Â°C, 22.6Â°C, 23.3Â°C, 25.7Â°C, 23.7Â°C, 23.9Â°C, 23.4Â°C, 25.0Â°C)[0m
[36m2025-10-27 15:37:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -104.0[0m
[36m2025-10-27 15:37:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 44.1Â°C[0m
[36m2025-10-27 15:37:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.1Â°C[0m
[36m2025-10-27 15:37:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.2A, L2=0.9A, L3=0.6A[0m
[36m2025-10-27 15:37:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.7Â°C, outdoor 8.7Â°C, flow 30.1Â°C, DM -104[0m
[36m2025-10-27 15:37:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 1 Hz (1h avg: 1, 6h avg: 1, mode: space) - OK: Normal operation (1 Hz, 6h avg: 1 Hz)[0m
[36m2025-10-27 15:37:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 15:37:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 15:37:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 15:37:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 15:37:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 15:37:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 15:37:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 15:37:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 15:37:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 15:37:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 15:37:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 129}[0m
[36m2025-10-27 15:37:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 15:37:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 15:37:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 15:37:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 15:37:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 15:37:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 15:37:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 15:37:44.224 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 15:37:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q62 = 95.18 Ã¶re/kWh[0m
[36m2025-10-27 15:37:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 15:37:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 15:37:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 15:37:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 15:37:44.225 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 15:37:44.225 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 15:37:44.225 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 15:37:44.227 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 15:37:44.229 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 15:37:44.229 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 15:37:44.229 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 15:37:44.229 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.7Â°C: normal -106 to -306, warning -306[0m
[36m2025-10-27 15:37:44.229 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 15:37:44.229 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -306 (base: -306), critical -1500[0m
[36m2025-10-27 15:37:44.229 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.7Â°C, indoor_target=21.0Â°C, temp_diff=12.3Â°C, HC=0.180 kW/K -> flow=25.7Â°C[0m
[36m2025-10-27 15:37:44.230 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 15:37:44.230 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 15:37:44.230 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.2Â°C, current=30.1Â°C, error=-3.9Â°C, sensitivity=1.5 -> offset=-2.6[0m
[36m2025-10-27 15:37:44.230 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 15:37:44.230 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 30.1Â°C â†’ offset: -2.6Â°C; Weight: 0.24[0m
[36m2025-10-27 15:37:44.230 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Price classification Q62 (15:37): 95.18 â†’ NORMAL[0m
[32m2025-10-27 15:37:44.230 INFO (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.21Â°C - Learned pre-heat: Pre-heating: predicted drop 1.3Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 30.1Â°C â†’ offset: -2.6Â°C; Weight: 0.24 | GE-Spot Q62: NORMAL (day) | Too warm: 2.7Â°C over[0m
[32m2025-10-27 15:37:44.231 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.21Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.3Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 30.1Â°C â†’ offset: -2.6Â°C; Weight: 0.24 | GE-Spot Q62: NORMAL (day) | Too warm: 2.7Â°C over[0m
[36m2025-10-27 15:37:44.231 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.21Â°C, integer=0Â°C, fractional=0.21Â°C, accumulator_before=0.25Â°C[0m
[36m2025-10-27 15:37:44.231 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: 0.46Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-27 15:37:44.231 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.21Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 15:37:44.231 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.000 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 15:37:44.231 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-27 15:37:44.231 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.7Â°C, outdoor=8.7Â°C, offset=0.2Â°C, change=0.01Â°C, Î”t=0.08h[0m
[36m2025-10-27 15:37:44.232 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.7Â°C, outdoor=8.7Â°C, offset=0.2Â°C, flow=30.1Â°C, DM=-104[0m
[36m2025-10-27 15:37:44.232 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-27 15:37:44.232 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 15:37:44.233 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 15:37:44.233 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 15:37:44.233 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=44.1[0m
[36m2025-10-27 15:37:44.233 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 15:37:44.241 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 15:37:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 15:37:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 15:37:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 60 quarters available, need 3 quarters (45 min), lookahead 15.0h[0m
[36m2025-10-27 15:37:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 58 windows evaluated[0m
[36m2025-10-27 15:37:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (12.1h away) â† SELECTED[0m
[36m2025-10-27 15:37:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (11.9h away)[0m
[36m2025-10-27 15:37:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (12.4h away)[0m
[36m2025-10-27 15:37:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (11.6h away)[0m
[36m2025-10-27 15:37:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (11.4h away)[0m
[32m2025-10-27 15:37:44.241 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 12.1h away[0m
[36m2025-10-27 15:37:44.245 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 15:37:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 15:37:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 15:37:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 60 quarters available, need 3 quarters (45 min), lookahead 15.0h[0m
[36m2025-10-27 15:37:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 58 windows evaluated[0m
[36m2025-10-27 15:37:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (12.1h away) â† SELECTED[0m
[36m2025-10-27 15:37:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (11.9h away)[0m
[36m2025-10-27 15:37:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (12.4h away)[0m
[36m2025-10-27 15:37:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (11.6h away)[0m
[36m2025-10-27 15:37:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (11.4h away)[0m
[32m2025-10-27 15:37:44.246 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 12.1h away[0m
[36m2025-10-27 15:37:44.246 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-27 15:37:44.246 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.024 seconds (success: True)[0m
[36m2025-10-27 15:37:44.248 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.2 + 0.9 + 0.6)A Ã— 0.95 = 1.30 kW[0m
[33m2025-10-27 15:41:42.921 WARNING (Recorder) [homeassistant.components.recorder.db_schema] State attributes for sensor.zigbee2mqtt_bridge_network_map exceed maximum size of 16384 bytes. This can cause database performance issues; Attributes will not be stored[0m
[33m2025-10-27 15:41:42.922 WARNING (Recorder) [homeassistant.components.recorder.db_schema] State attributes for sensor.zigbee2mqtt_networkmap exceed maximum size of 16384 bytes. This can cause database performance issues; Attributes will not be stored[0m
[36m2025-10-27 15:42:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 15:42:44.223 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.7Â°C (median of 9 sensors: 24.6Â°C, 22.1Â°C, 22.5Â°C, 23.3Â°C, 25.8Â°C, 23.7Â°C, 23.9Â°C, 23.4Â°C, 25.0Â°C)[0m
[36m2025-10-27 15:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -66.0[0m
[36m2025-10-27 15:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 44.1Â°C[0m
[36m2025-10-27 15:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.1Â°C[0m
[36m2025-10-27 15:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.2A, L2=0.9A, L3=0.6A[0m
[36m2025-10-27 15:42:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.7Â°C, outdoor 8.7Â°C, flow 30.1Â°C, DM -66[0m
[36m2025-10-27 15:42:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 1 Hz (1h avg: 1, 6h avg: 1, mode: space) - OK: Normal operation (1 Hz, 6h avg: 1 Hz)[0m
[36m2025-10-27 15:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 15:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 15:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 15:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 15:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 15:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 15:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 15:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 15:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 15:42:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 15:42:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 129}[0m
[36m2025-10-27 15:42:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 15:42:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 15:42:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 15:42:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 15:42:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 15:42:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 15:42:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 15:42:44.224 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 15:42:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q62 = 95.18 Ã¶re/kWh[0m
[36m2025-10-27 15:42:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 15:42:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 15:42:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 15:42:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 15:42:44.225 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 15:42:44.225 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 15:42:44.226 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 15:42:44.226 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 15:42:44.230 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 15:42:44.230 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 15:42:44.230 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 15:42:44.230 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.7Â°C: normal -106 to -306, warning -306[0m
[36m2025-10-27 15:42:44.230 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 15:42:44.231 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -306 (base: -306), critical -1500[0m
[36m2025-10-27 15:42:44.232 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.7Â°C, indoor_target=21.0Â°C, temp_diff=12.3Â°C, HC=0.180 kW/K -> flow=25.7Â°C[0m
[36m2025-10-27 15:42:44.232 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 15:42:44.232 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 15:42:44.232 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.2Â°C, current=30.1Â°C, error=-3.9Â°C, sensitivity=1.5 -> offset=-2.6[0m
[36m2025-10-27 15:42:44.232 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 15:42:44.232 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 30.1Â°C â†’ offset: -2.6Â°C; Weight: 0.24[0m
[36m2025-10-27 15:42:44.232 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Price classification Q62 (15:42): 95.18 â†’ NORMAL[0m
[32m2025-10-27 15:42:44.232 INFO (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.21Â°C - Learned pre-heat: Pre-heating: predicted drop 1.3Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 30.1Â°C â†’ offset: -2.6Â°C; Weight: 0.24 | GE-Spot Q62: NORMAL (day) | Too warm: 2.7Â°C over[0m
[32m2025-10-27 15:42:44.233 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.21Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.3Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 30.1Â°C â†’ offset: -2.6Â°C; Weight: 0.24 | GE-Spot Q62: NORMAL (day) | Too warm: 2.7Â°C over[0m
[36m2025-10-27 15:42:44.233 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.21Â°C, integer=0Â°C, fractional=0.21Â°C, accumulator_before=0.46Â°C[0m
[36m2025-10-27 15:42:44.233 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: 0.68Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-27 15:42:44.233 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.21Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 15:42:44.233 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.000 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 15:42:44.233 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-27 15:42:44.233 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.7Â°C, outdoor=8.7Â°C, offset=0.2Â°C, change=-0.01Â°C, Î”t=0.08h[0m
[36m2025-10-27 15:42:44.233 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.7Â°C, outdoor=8.7Â°C, offset=0.2Â°C, flow=30.1Â°C, DM=-66[0m
[36m2025-10-27 15:42:44.238 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.1Â°C/h trend[0m
[36m2025-10-27 15:42:44.238 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 15:42:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 15:42:44.240 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 15:42:44.240 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=44.1[0m
[36m2025-10-27 15:42:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 15:42:44.244 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 15:42:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 15:42:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 15:42:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 60 quarters available, need 3 quarters (45 min), lookahead 15.0h[0m
[36m2025-10-27 15:42:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 58 windows evaluated[0m
[36m2025-10-27 15:42:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (12.0h away) â† SELECTED[0m
[36m2025-10-27 15:42:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (11.8h away)[0m
[36m2025-10-27 15:42:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (12.3h away)[0m
[36m2025-10-27 15:42:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (11.5h away)[0m
[36m2025-10-27 15:42:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (11.3h away)[0m
[32m2025-10-27 15:42:44.245 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 12.0h away[0m
[36m2025-10-27 15:42:44.248 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 15:42:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 15:42:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 15:42:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 60 quarters available, need 3 quarters (45 min), lookahead 15.0h[0m
[36m2025-10-27 15:42:44.249 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 58 windows evaluated[0m
[36m2025-10-27 15:42:44.249 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (12.0h away) â† SELECTED[0m
[36m2025-10-27 15:42:44.249 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (11.8h away)[0m
[36m2025-10-27 15:42:44.249 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (12.3h away)[0m
[36m2025-10-27 15:42:44.249 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (11.5h away)[0m
[36m2025-10-27 15:42:44.249 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (11.3h away)[0m
[32m2025-10-27 15:42:44.249 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 12.0h away[0m
[36m2025-10-27 15:42:44.249 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-27 15:42:44.249 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.027 seconds (success: True)[0m
[36m2025-10-27 15:42:44.250 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.2 + 0.9 + 0.6)A Ã— 0.95 = 1.30 kW[0m
[36m2025-10-27 15:47:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 15:47:44.223 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.7Â°C (median of 9 sensors: 24.6Â°C, 22.1Â°C, 22.6Â°C, 23.3Â°C, 25.8Â°C, 23.7Â°C, 23.9Â°C, 23.4Â°C, 25.0Â°C)[0m
[36m2025-10-27 15:47:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -35.0[0m
[36m2025-10-27 15:47:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 44.1Â°C[0m
[36m2025-10-27 15:47:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.1Â°C[0m
[36m2025-10-27 15:47:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.2A, L2=0.9A, L3=0.6A[0m
[36m2025-10-27 15:47:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.7Â°C, outdoor 8.7Â°C, flow 30.1Â°C, DM -35[0m
[36m2025-10-27 15:47:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 1 Hz (1h avg: 1, 6h avg: 1, mode: space) - OK: Normal operation (1 Hz, 6h avg: 1 Hz)[0m
[36m2025-10-27 15:47:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 15:47:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 15:47:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 15:47:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 15:47:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 15:47:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 15:47:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 15:47:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 15:47:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 15:47:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 15:47:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 128}[0m
[36m2025-10-27 15:47:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 15:47:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 15:47:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 15:47:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 15:47:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 15:47:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 15:47:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 15:47:44.224 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 15:47:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q63 = 108.72 Ã¶re/kWh[0m
[36m2025-10-27 15:47:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 15:47:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 15:47:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 15:47:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 15:47:44.226 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 15:47:44.226 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 15:47:44.226 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 15:47:44.227 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 15:47:44.228 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 15:47:44.228 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 15:47:44.228 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 15:47:44.228 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.7Â°C: normal -106 to -306, warning -306[0m
[36m2025-10-27 15:47:44.228 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 15:47:44.228 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -306 (base: -306), critical -1500[0m
[36m2025-10-27 15:47:44.228 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.7Â°C, indoor_target=21.0Â°C, temp_diff=12.3Â°C, HC=0.180 kW/K -> flow=25.7Â°C[0m
[36m2025-10-27 15:47:44.229 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 15:47:44.229 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 15:47:44.229 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.2Â°C, current=30.1Â°C, error=-3.9Â°C, sensitivity=1.5 -> offset=-2.6[0m
[36m2025-10-27 15:47:44.229 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 15:47:44.229 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 30.1Â°C â†’ offset: -2.6Â°C; Weight: 0.24[0m
[36m2025-10-27 15:47:44.229 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Price classification Q63 (15:47): 108.72 â†’ EXPENSIVE[0m
[32m2025-10-27 15:47:44.229 INFO (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.11Â°C - Learned pre-heat: Pre-heating: predicted drop 1.3Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 30.1Â°C â†’ offset: -2.6Â°C; Weight: 0.24 | GE-Spot Q63: EXPENSIVE (day) | Too warm: 2.7Â°C over[0m
[32m2025-10-27 15:47:44.229 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.11Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.3Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 30.1Â°C â†’ offset: -2.6Â°C; Weight: 0.24 | GE-Spot Q63: EXPENSIVE (day) | Too warm: 2.7Â°C over[0m
[36m2025-10-27 15:47:44.229 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.11Â°C, integer=0Â°C, fractional=0.11Â°C, accumulator_before=0.68Â°C[0m
[36m2025-10-27 15:47:44.229 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: 0.79Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-27 15:47:44.229 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.11Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 15:47:44.229 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.005 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 15:47:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-27 15:47:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.7Â°C, outdoor=8.7Â°C, offset=0.1Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 15:47:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.7Â°C, outdoor=8.7Â°C, offset=0.1Â°C, flow=30.1Â°C, DM=-35[0m
[36m2025-10-27 15:47:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-27 15:47:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 15:47:44.231 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 15:47:44.231 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 15:47:44.231 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=44.1[0m
[36m2025-10-27 15:47:44.231 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 15:47:44.242 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 15:47:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 15:47:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 15:47:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 60 quarters available, need 3 quarters (45 min), lookahead 15.0h[0m
[36m2025-10-27 15:47:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 58 windows evaluated[0m
[36m2025-10-27 15:47:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (12.0h away) â† SELECTED[0m
[36m2025-10-27 15:47:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (11.7h away)[0m
[36m2025-10-27 15:47:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (12.2h away)[0m
[36m2025-10-27 15:47:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (11.5h away)[0m
[36m2025-10-27 15:47:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (11.2h away)[0m
[32m2025-10-27 15:47:44.243 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 12.0h away[0m
[36m2025-10-27 15:47:44.246 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 15:47:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 15:47:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 15:47:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 60 quarters available, need 3 quarters (45 min), lookahead 15.0h[0m
[36m2025-10-27 15:47:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 58 windows evaluated[0m
[36m2025-10-27 15:47:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (12.0h away) â† SELECTED[0m
[36m2025-10-27 15:47:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (11.7h away)[0m
[36m2025-10-27 15:47:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (12.2h away)[0m
[36m2025-10-27 15:47:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (11.5h away)[0m
[36m2025-10-27 15:47:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (11.2h away)[0m
[32m2025-10-27 15:47:44.247 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 12.0h away[0m
[36m2025-10-27 15:47:44.247 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-27 15:47:44.247 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.025 seconds (success: True)[0m
[36m2025-10-27 15:47:44.249 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.2 + 0.9 + 0.6)A Ã— 0.95 = 1.30 kW[0m
[36m2025-10-27 15:52:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 15:52:44.223 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.7Â°C (median of 9 sensors: 24.6Â°C, 22.1Â°C, 22.6Â°C, 23.3Â°C, 25.7Â°C, 23.7Â°C, 23.9Â°C, 23.4Â°C, 25.0Â°C)[0m
[36m2025-10-27 15:52:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -3.0[0m
[36m2025-10-27 15:52:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 44.1Â°C[0m
[36m2025-10-27 15:52:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.1Â°C[0m
[36m2025-10-27 15:52:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.2A, L2=0.9A, L3=0.6A[0m
[36m2025-10-27 15:52:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.7Â°C, outdoor 8.7Â°C, flow 30.1Â°C, DM -3[0m
[36m2025-10-27 15:52:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 1 Hz (1h avg: 1, 6h avg: 1, mode: space) - OK: Normal operation (1 Hz, 6h avg: 1 Hz)[0m
[36m2025-10-27 15:52:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 15:52:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 15:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 15:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 15:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 15:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 15:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 15:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 15:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 15:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 15:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 128}[0m
[36m2025-10-27 15:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 15:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 15:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 15:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 15:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 15:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 15:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 15:52:44.224 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 15:52:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q63 = 108.72 Ã¶re/kWh[0m
[36m2025-10-27 15:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 15:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 15:52:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 15:52:44.226 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 15:52:44.226 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 15:52:44.226 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 15:52:44.226 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 15:52:44.227 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 15:52:44.227 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 15:52:44.227 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 15:52:44.227 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 15:52:44.228 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.7Â°C: normal -106 to -306, warning -306[0m
[36m2025-10-27 15:52:44.228 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 15:52:44.228 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -306 (base: -306), critical -1500[0m
[36m2025-10-27 15:52:44.228 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.7Â°C, indoor_target=21.0Â°C, temp_diff=12.3Â°C, HC=0.180 kW/K -> flow=25.7Â°C[0m
[36m2025-10-27 15:52:44.228 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 15:52:44.228 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 15:52:44.228 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.2Â°C, current=30.1Â°C, error=-3.9Â°C, sensitivity=1.5 -> offset=-2.6[0m
[36m2025-10-27 15:52:44.228 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 15:52:44.228 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 30.1Â°C â†’ offset: -2.6Â°C; Weight: 0.24[0m
[36m2025-10-27 15:52:44.228 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Price classification Q63 (15:52): 108.72 â†’ EXPENSIVE[0m
[32m2025-10-27 15:52:44.228 INFO (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.11Â°C - Learned pre-heat: Pre-heating: predicted drop 1.3Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 30.1Â°C â†’ offset: -2.6Â°C; Weight: 0.24 | GE-Spot Q63: EXPENSIVE (day) | Too warm: 2.7Â°C over[0m
[32m2025-10-27 15:52:44.229 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.11Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.3Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 30.1Â°C â†’ offset: -2.6Â°C; Weight: 0.24 | GE-Spot Q63: EXPENSIVE (day) | Too warm: 2.7Â°C over[0m
[36m2025-10-27 15:52:44.229 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.11Â°C, integer=0Â°C, fractional=0.11Â°C, accumulator_before=0.79Â°C[0m
[36m2025-10-27 15:52:44.229 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: 0.90Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-27 15:52:44.229 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.11Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 15:52:44.229 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.000 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 15:52:44.229 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-27 15:52:44.229 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.7Â°C, outdoor=8.7Â°C, offset=0.1Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 15:52:44.229 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.7Â°C, outdoor=8.7Â°C, offset=0.1Â°C, flow=30.1Â°C, DM=-3[0m
[36m2025-10-27 15:52:44.233 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -1.8Â°C/h trend[0m
[36m2025-10-27 15:52:44.234 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 15:52:44.235 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 15:52:44.235 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 15:52:44.235 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=44.1[0m
[36m2025-10-27 15:52:44.235 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 15:52:44.241 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 15:52:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 15:52:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 15:52:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 60 quarters available, need 3 quarters (45 min), lookahead 15.0h[0m
[36m2025-10-27 15:52:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 58 windows evaluated[0m
[36m2025-10-27 15:52:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (11.9h away) â† SELECTED[0m
[36m2025-10-27 15:52:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (11.6h away)[0m
[36m2025-10-27 15:52:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (12.1h away)[0m
[36m2025-10-27 15:52:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (11.4h away)[0m
[36m2025-10-27 15:52:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (11.1h away)[0m
[32m2025-10-27 15:52:44.242 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 11.9h away[0m
[36m2025-10-27 15:52:44.245 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 15:52:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 15:52:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 15:52:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 60 quarters available, need 3 quarters (45 min), lookahead 15.0h[0m
[36m2025-10-27 15:52:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 58 windows evaluated[0m
[36m2025-10-27 15:52:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (11.9h away) â† SELECTED[0m
[36m2025-10-27 15:52:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (11.6h away)[0m
[36m2025-10-27 15:52:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (12.1h away)[0m
[36m2025-10-27 15:52:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (11.4h away)[0m
[36m2025-10-27 15:52:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (11.1h away)[0m
[32m2025-10-27 15:52:44.246 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 11.9h away[0m
[36m2025-10-27 15:52:44.246 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-27 15:52:44.246 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.023 seconds (success: True)[0m
[36m2025-10-27 15:52:44.248 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.2 + 0.9 + 0.6)A Ã— 0.95 = 1.30 kW[0m
[33m2025-10-27 15:57:02.987 WARNING (MainThread) [homeassistant.components.automation.led_tak_groventre] LED TAK GROVENTRE: Already running[0m
[36m2025-10-27 15:57:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 15:57:44.223 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.7Â°C (median of 9 sensors: 24.6Â°C, 22.1Â°C, 22.5Â°C, 23.4Â°C, 25.7Â°C, 23.7Â°C, 23.7Â°C, 23.4Â°C, 25.0Â°C)[0m
[36m2025-10-27 15:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = 28.0[0m
[36m2025-10-27 15:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 44.1Â°C[0m
[36m2025-10-27 15:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.1Â°C[0m
[36m2025-10-27 15:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.2A, L2=0.9A, L3=0.6A[0m
[36m2025-10-27 15:57:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.7Â°C, outdoor 8.7Â°C, flow 30.1Â°C, DM 28[0m
[36m2025-10-27 15:57:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 1 Hz (1h avg: 1, 6h avg: 1, mode: space) - OK: Normal operation (1 Hz, 6h avg: 1 Hz)[0m
[36m2025-10-27 15:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 15:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 15:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 15:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 15:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 15:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 15:57:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 15:57:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 15:57:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 15:57:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 15:57:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 128}[0m
[36m2025-10-27 15:57:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 15:57:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 15:57:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 15:57:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 15:57:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 15:57:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 15:57:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 15:57:44.224 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 15:57:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q63 = 108.72 Ã¶re/kWh[0m
[36m2025-10-27 15:57:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 15:57:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 15:57:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 15:57:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 15:57:44.226 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 15:57:44.226 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 15:57:44.226 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 15:57:44.227 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 15:57:44.229 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 15:57:44.229 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 15:57:44.229 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 15:57:44.229 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.7Â°C: normal -106 to -306, warning -306[0m
[36m2025-10-27 15:57:44.229 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 15:57:44.229 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -306 (base: -306), critical -1500[0m
[36m2025-10-27 15:57:44.229 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.7Â°C, indoor_target=21.0Â°C, temp_diff=12.3Â°C, HC=0.180 kW/K -> flow=25.7Â°C[0m
[36m2025-10-27 15:57:44.229 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 15:57:44.230 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 15:57:44.230 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.2Â°C, current=30.1Â°C, error=-3.9Â°C, sensitivity=1.5 -> offset=-2.6[0m
[36m2025-10-27 15:57:44.230 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 15:57:44.230 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 30.1Â°C â†’ offset: -2.6Â°C; Weight: 0.24[0m
[36m2025-10-27 15:57:44.230 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Price classification Q63 (15:57): 108.72 â†’ EXPENSIVE[0m
[32m2025-10-27 15:57:44.230 INFO (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.06Â°C - Peak: PREDICTIVE avoidance (predicted 1.6 kW, cooling rapidly, Q63) | Learned pre-heat: Pre-heating: predicted drop 1.3Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 30.1Â°C â†’ offset: -2.6Â°C; Weight: 0.24 | Weather pre-heat: Indoor cooling -1.82Â°C/h (reactive confirmation) â†’ +0.8Â°C @ weight 0.99 (base 0.85 Ã— thermal_mass 2.0) | GE-Spot Q63: EXPENSIVE (day) | Too warm: 2.7Â°C over (boosted 15%: cooling -1.82Â°C/h)[0m
[32m2025-10-27 15:57:44.231 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.06Â°C, reasoning: Peak: PREDICTIVE avoidance (predicted 1.6 kW, cooling rapidly, Q63) | Learned pre-heat: Pre-heating: predicted drop 1.3Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 30.1Â°C â†’ offset: -2.6Â°C; Weight: 0.24 | Weather pre-heat: Indoor cooling -1.82Â°C/h (reactive confirmation) â†’ +0.8Â°C @ weight 0.99 (base 0.85 Ã— thermal_mass 2.0) | GE-Spot Q63: EXPENSIVE (day) | Too warm: 2.7Â°C over (boosted 15%: cooling -1.82Â°C/h)[0m
[36m2025-10-27 15:57:44.231 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=-0.06Â°C, integer=0Â°C, fractional=-0.06Â°C, accumulator_before=0.90Â°C[0m
[36m2025-10-27 15:57:44.231 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: 0.85Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-27 15:57:44.231 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset -0.06Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 15:57:44.231 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.008 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 15:57:44.231 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.01 kW below 0.5 kW threshold[0m
[36m2025-10-27 15:57:44.231 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.7Â°C, outdoor=8.7Â°C, offset=-0.1Â°C, change=-0.01Â°C, Î”t=0.08h[0m
[36m2025-10-27 15:57:44.231 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.7Â°C, outdoor=8.7Â°C, offset=-0.1Â°C, flow=30.1Â°C, DM=28[0m
[36m2025-10-27 15:57:44.236 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.4Â°C/h trend[0m
[36m2025-10-27 15:57:44.236 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 15:57:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 15:57:44.241 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 15:57:44.241 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=44.1[0m
[36m2025-10-27 15:57:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 15:57:44.247 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 15:57:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 15:57:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 15:57:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 60 quarters available, need 3 quarters (45 min), lookahead 15.0h[0m
[36m2025-10-27 15:57:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 58 windows evaluated[0m
[36m2025-10-27 15:57:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (11.8h away) â† SELECTED[0m
[36m2025-10-27 15:57:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (11.5h away)[0m
[36m2025-10-27 15:57:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (12.0h away)[0m
[36m2025-10-27 15:57:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (11.3h away)[0m
[36m2025-10-27 15:57:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (11.0h away)[0m
[32m2025-10-27 15:57:44.247 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 11.8h away[0m
[36m2025-10-27 15:57:44.250 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 15:57:44.250 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 15:57:44.250 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 15:57:44.250 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 60 quarters available, need 3 quarters (45 min), lookahead 15.0h[0m
[36m2025-10-27 15:57:44.250 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 58 windows evaluated[0m
[36m2025-10-27 15:57:44.250 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (11.8h away) â† SELECTED[0m
[36m2025-10-27 15:57:44.250 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (11.5h away)[0m
[36m2025-10-27 15:57:44.250 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (12.0h away)[0m
[36m2025-10-27 15:57:44.250 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (11.3h away)[0m
[36m2025-10-27 15:57:44.251 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (11.0h away)[0m
[32m2025-10-27 15:57:44.251 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 11.8h away[0m
[36m2025-10-27 15:57:44.251 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-27 15:57:44.251 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.028 seconds (success: True)[0m
[36m2025-10-27 15:57:44.252 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.2 + 0.9 + 0.6)A Ã— 0.95 = 1.30 kW[0m
[36m2025-10-27 15:57:44.252 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 16:02:44.222 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 16:02:44.222 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.7Â°C (median of 9 sensors: 24.6Â°C, 22.1Â°C, 22.6Â°C, 23.2Â°C, 25.7Â°C, 23.7Â°C, 23.7Â°C, 23.4Â°C, 25.0Â°C)[0m
[36m2025-10-27 16:02:44.222 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = 59.0[0m
[36m2025-10-27 16:02:44.222 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 43.6Â°C[0m
[36m2025-10-27 16:02:44.222 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.1Â°C[0m
[36m2025-10-27 16:02:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.2A, L2=0.9A, L3=0.6A[0m
[36m2025-10-27 16:02:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.7Â°C, outdoor 8.7Â°C, flow 30.1Â°C, DM 59[0m
[36m2025-10-27 16:02:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 1 Hz (1h avg: 1, 6h avg: 1, mode: space) - OK: Normal operation (1 Hz, 6h avg: 1 Hz)[0m
[36m2025-10-27 16:02:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 16:02:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 16:02:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 16:02:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 16:02:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 16:02:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 16:02:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 16:02:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 16:02:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 16:02:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 16:02:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 127}[0m
[36m2025-10-27 16:02:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 16:02:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 16:02:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 16:02:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 16:02:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 16:02:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 16:02:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 16:02:44.223 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 16:02:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q64 = 97.44 Ã¶re/kWh[0m
[36m2025-10-27 16:02:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 16:02:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 16:02:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 16:02:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 16:02:44.225 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 16:02:44.225 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 16:02:44.225 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 16:02:44.226 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 16:02:44.227 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 16:02:44.227 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 16:02:44.227 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:02:44.227 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.7Â°C: normal -106 to -306, warning -306[0m
[36m2025-10-27 16:02:44.227 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:02:44.227 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -306 (base: -306), critical -1500[0m
[36m2025-10-27 16:02:44.227 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.7Â°C, indoor_target=21.0Â°C, temp_diff=12.3Â°C, HC=0.180 kW/K -> flow=25.7Â°C[0m
[36m2025-10-27 16:02:44.227 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 16:02:44.227 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 16:02:44.227 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.2Â°C, current=30.1Â°C, error=-3.9Â°C, sensitivity=1.5 -> offset=-2.6[0m
[36m2025-10-27 16:02:44.227 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 16:02:44.227 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 30.1Â°C â†’ offset: -2.6Â°C; Weight: 0.24[0m
[36m2025-10-27 16:02:44.228 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Price classification Q64 (16:02): 97.44 â†’ NORMAL[0m
[32m2025-10-27 16:02:44.228 INFO (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.23Â°C - Learned pre-heat: Pre-heating: predicted drop 1.4Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 30.1Â°C â†’ offset: -2.6Â°C; Weight: 0.24 | GE-Spot Q64: NORMAL (day) | Too warm: 2.7Â°C over (damped 25%: warming 0.39Â°C/h)[0m
[32m2025-10-27 16:02:44.228 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.23Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.4Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 30.1Â°C â†’ offset: -2.6Â°C; Weight: 0.24 | GE-Spot Q64: NORMAL (day) | Too warm: 2.7Â°C over (damped 25%: warming 0.39Â°C/h)[0m
[36m2025-10-27 16:02:44.228 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.23Â°C, integer=0Â°C, fractional=0.23Â°C, accumulator_before=0.85Â°C[0m
[32m2025-10-27 16:02:44.228 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] âœ“ Accumulated fractional offset reached threshold: applying +1Â°C adjustment (accumulator: 1.08Â°C â†’ 0.08Â°C)[0m
[36m2025-10-27 16:02:44.228 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Accumulator triggered: total_accumulated=1.08Â°C, adjustment=+1Â°C, new_integer=1Â°C, remaining=0.08Â°C[0m
[36m2025-10-27 16:02:44.228 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset 0.23Â°C â†’ applying 1Â°C (accumulator: 0.08Â°C, needs 0.92Â°C more to trigger)[0m
[32m2025-10-27 16:02:44.230 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to 1Â°C (calculated: 0.23Â°C, accumulator: 0.08Â°C)[0m
[36m2025-10-27 16:02:44.230 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=1Â°C, original=0.23Â°C, accumulator=0.08Â°C[0m
[32m2025-10-27 16:02:44.230 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset 0.23Â°C to NIBE via MyUplink[0m
[36m2025-10-27 16:02:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.009 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 16:02:44.231 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.01 kW below 0.5 kW threshold[0m
[36m2025-10-27 16:02:44.231 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.7Â°C, outdoor=8.7Â°C, offset=0.2Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 16:02:44.231 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.7Â°C, outdoor=8.7Â°C, offset=0.2Â°C, flow=30.1Â°C, DM=59[0m
[36m2025-10-27 16:02:44.231 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-27 16:02:44.231 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 16:02:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 16:02:44.241 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 16:02:44.241 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=43.6[0m
[36m2025-10-27 16:02:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:02:44.244 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 16:02:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:02:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 16:02:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 56 quarters available, need 3 quarters (45 min), lookahead 14.0h[0m
[36m2025-10-27 16:02:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 54 windows evaluated[0m
[36m2025-10-27 16:02:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (11.7h away) â† SELECTED[0m
[36m2025-10-27 16:02:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (11.5h away)[0m
[36m2025-10-27 16:02:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (12.0h away)[0m
[36m2025-10-27 16:02:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (11.2h away)[0m
[36m2025-10-27 16:02:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (11.0h away)[0m
[32m2025-10-27 16:02:44.245 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 11.7h away[0m
[36m2025-10-27 16:02:44.250 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 16:02:44.250 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:02:44.250 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 16:02:44.250 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 56 quarters available, need 3 quarters (45 min), lookahead 14.0h[0m
[36m2025-10-27 16:02:44.250 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 54 windows evaluated[0m
[36m2025-10-27 16:02:44.250 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (11.7h away) â† SELECTED[0m
[36m2025-10-27 16:02:44.250 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (11.5h away)[0m
[36m2025-10-27 16:02:44.250 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (12.0h away)[0m
[36m2025-10-27 16:02:44.250 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (11.2h away)[0m
[36m2025-10-27 16:02:44.250 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (11.0h away)[0m
[32m2025-10-27 16:02:44.251 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 11.7h away[0m
[36m2025-10-27 16:02:44.251 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-27 16:02:44.251 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.029 seconds (success: True)[0m
[36m2025-10-27 16:02:44.252 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.2 + 0.9 + 0.6)A Ã— 0.95 = 1.30 kW[0m
[36m2025-10-27 16:02:44.252 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 16:07:44.222 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 16:07:44.223 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.6Â°C (median of 9 sensors: 24.6Â°C, 22.1Â°C, 22.5Â°C, 23.3Â°C, 25.7Â°C, 23.6Â°C, 23.7Â°C, 23.4Â°C, 25.0Â°C)[0m
[36m2025-10-27 16:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = 80.0[0m
[36m2025-10-27 16:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 43.6Â°C[0m
[36m2025-10-27 16:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.1Â°C[0m
[36m2025-10-27 16:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.2A, L2=0.7A, L3=0.6A[0m
[36m2025-10-27 16:07:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.6Â°C, outdoor 8.7Â°C, flow 30.1Â°C, DM 80[0m
[36m2025-10-27 16:07:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 1 Hz (1h avg: 1, 6h avg: 1, mode: space) - OK: Normal operation (1 Hz, 6h avg: 1 Hz)[0m
[36m2025-10-27 16:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 16:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 16:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 16:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 16:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 16:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 16:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 16:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 16:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 16:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 16:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 127}[0m
[36m2025-10-27 16:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 16:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 16:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 16:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 16:07:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 16:07:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 16:07:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 16:07:44.224 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 16:07:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q64 = 97.44 Ã¶re/kWh[0m
[36m2025-10-27 16:07:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 16:07:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 16:07:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 16:07:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 16:07:44.225 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 16:07:44.225 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 16:07:44.225 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 16:07:44.226 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 16:07:44.227 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 16:07:44.227 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 16:07:44.227 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:07:44.227 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.7Â°C: normal -106 to -306, warning -306[0m
[36m2025-10-27 16:07:44.227 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:07:44.227 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -306 (base: -306), critical -1500[0m
[36m2025-10-27 16:07:44.227 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.7Â°C, indoor_target=21.0Â°C, temp_diff=12.3Â°C, HC=0.180 kW/K -> flow=25.7Â°C[0m
[36m2025-10-27 16:07:44.228 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 16:07:44.228 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 16:07:44.228 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.2Â°C, current=30.1Â°C, error=-3.9Â°C, sensitivity=1.5 -> offset=-2.6[0m
[36m2025-10-27 16:07:44.228 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 16:07:44.228 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 30.1Â°C â†’ offset: -2.6Â°C; Weight: 0.24[0m
[36m2025-10-27 16:07:44.228 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Price classification Q64 (16:07): 97.44 â†’ NORMAL[0m
[32m2025-10-27 16:07:44.228 INFO (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.31Â°C - Learned pre-heat: Pre-heating: predicted drop 1.4Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 30.1Â°C â†’ offset: -2.6Â°C; Weight: 0.24 | GE-Spot Q64: NORMAL (day) | Too warm: 2.6Â°C over[0m
[32m2025-10-27 16:07:44.229 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.31Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.4Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 30.1Â°C â†’ offset: -2.6Â°C; Weight: 0.24 | GE-Spot Q64: NORMAL (day) | Too warm: 2.6Â°C over[0m
[36m2025-10-27 16:07:44.229 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.31Â°C, integer=0Â°C, fractional=0.31Â°C, accumulator_before=0.08Â°C[0m
[36m2025-10-27 16:07:44.229 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: 0.38Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-27 16:07:44.229 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.31Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 16:07:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.002 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 16:07:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-27 16:07:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.6Â°C, outdoor=8.7Â°C, offset=0.3Â°C, change=-0.02Â°C, Î”t=0.08h[0m
[36m2025-10-27 16:07:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.6Â°C, outdoor=8.7Â°C, offset=0.3Â°C, flow=30.1Â°C, DM=80[0m
[36m2025-10-27 16:07:44.235 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.1Â°C/h trend[0m
[36m2025-10-27 16:07:44.235 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 16:07:44.236 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 16:07:44.236 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 16:07:44.236 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=43.6[0m
[36m2025-10-27 16:07:44.236 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:07:44.238 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 16:07:44.238 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:07:44.238 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 16:07:44.239 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 56 quarters available, need 3 quarters (45 min), lookahead 14.0h[0m
[36m2025-10-27 16:07:44.239 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 54 windows evaluated[0m
[36m2025-10-27 16:07:44.239 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (11.6h away) â† SELECTED[0m
[36m2025-10-27 16:07:44.239 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (11.4h away)[0m
[36m2025-10-27 16:07:44.239 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (11.9h away)[0m
[36m2025-10-27 16:07:44.239 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (11.1h away)[0m
[36m2025-10-27 16:07:44.239 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (10.9h away)[0m
[32m2025-10-27 16:07:44.239 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 11.6h away[0m
[36m2025-10-27 16:07:44.248 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 16:07:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:07:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 16:07:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 56 quarters available, need 3 quarters (45 min), lookahead 14.0h[0m
[36m2025-10-27 16:07:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 54 windows evaluated[0m
[36m2025-10-27 16:07:44.249 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (11.6h away) â† SELECTED[0m
[36m2025-10-27 16:07:44.249 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (11.4h away)[0m
[36m2025-10-27 16:07:44.249 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (11.9h away)[0m
[36m2025-10-27 16:07:44.249 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (11.1h away)[0m
[36m2025-10-27 16:07:44.249 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (10.9h away)[0m
[32m2025-10-27 16:07:44.249 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 11.6h away[0m
[36m2025-10-27 16:07:44.249 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-27 16:07:44.249 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.027 seconds (success: True)[0m
[36m2025-10-27 16:07:44.250 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.2 + 0.7 + 0.6)A Ã— 0.95 = 1.25 kW[0m
[36m2025-10-27 16:12:44.222 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 16:12:44.222 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.6Â°C (median of 9 sensors: 24.6Â°C, 22.1Â°C, 22.6Â°C, 23.3Â°C, 25.8Â°C, 23.6Â°C, 23.7Â°C, 23.4Â°C, 25.0Â°C)[0m
[36m2025-10-27 16:12:44.222 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = 64.0[0m
[36m2025-10-27 16:12:44.222 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 43.6Â°C[0m
[36m2025-10-27 16:12:44.222 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.1Â°C[0m
[36m2025-10-27 16:12:44.222 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.2A, L2=0.7A, L3=0.6A[0m
[36m2025-10-27 16:12:44.222 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.6Â°C, outdoor 8.7Â°C, flow 30.1Â°C, DM 64[0m
[36m2025-10-27 16:12:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 1 Hz (1h avg: 1, 6h avg: 1, mode: space) - OK: Normal operation (1 Hz, 6h avg: 1 Hz)[0m
[36m2025-10-27 16:12:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 16:12:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 16:12:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 16:12:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 16:12:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 16:12:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 16:12:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 16:12:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 16:12:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 16:12:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 16:12:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 127}[0m
[36m2025-10-27 16:12:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 16:12:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 16:12:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 16:12:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 16:12:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 16:12:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 16:12:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 16:12:44.223 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 16:12:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q64 = 97.44 Ã¶re/kWh[0m
[36m2025-10-27 16:12:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 16:12:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 16:12:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 16:12:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 16:12:44.225 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 16:12:44.225 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-27 16:12:44.225 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 16:12:44.226 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 16:12:44.227 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 16:12:44.227 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 16:12:44.227 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:12:44.227 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.7Â°C: normal -106 to -306, warning -306[0m
[36m2025-10-27 16:12:44.227 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:12:44.227 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -306 (base: -306), critical -1500[0m
[36m2025-10-27 16:12:44.228 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.7Â°C, indoor_target=21.0Â°C, temp_diff=12.3Â°C, HC=0.180 kW/K -> flow=25.7Â°C[0m
[36m2025-10-27 16:12:44.228 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 16:12:44.228 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 16:12:44.228 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.2Â°C, current=30.1Â°C, error=-3.9Â°C, sensitivity=1.5 -> offset=-2.6[0m
[36m2025-10-27 16:12:44.228 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 16:12:44.228 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 30.1Â°C â†’ offset: -2.6Â°C; Weight: 0.24[0m
[36m2025-10-27 16:12:44.228 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Price classification Q64 (16:12): 97.44 â†’ NORMAL[0m
[32m2025-10-27 16:12:44.228 INFO (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.35Â°C - Learned pre-heat: Pre-heating: predicted drop 1.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 30.1Â°C â†’ offset: -2.6Â°C; Weight: 0.24 | GE-Spot Q64: NORMAL (day) | Too warm: 2.6Â°C over[0m
[32m2025-10-27 16:12:44.229 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.35Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 30.1Â°C â†’ offset: -2.6Â°C; Weight: 0.24 | GE-Spot Q64: NORMAL (day) | Too warm: 2.6Â°C over[0m
[36m2025-10-27 16:12:44.229 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.35Â°C, integer=0Â°C, fractional=0.35Â°C, accumulator_before=0.38Â°C[0m
[36m2025-10-27 16:12:44.229 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: 0.74Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-27 16:12:44.229 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.35Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 16:12:44.229 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.000 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 16:12:44.229 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-27 16:12:44.229 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.6Â°C, outdoor=8.7Â°C, offset=0.4Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 16:12:44.229 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.6Â°C, outdoor=8.7Â°C, offset=0.4Â°C, flow=30.1Â°C, DM=64[0m
[36m2025-10-27 16:12:44.229 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-27 16:12:44.229 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 16:12:44.231 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 16:12:44.231 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 16:12:44.231 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=43.6[0m
[36m2025-10-27 16:12:44.231 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:12:44.233 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 16:12:44.233 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:12:44.233 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 16:12:44.233 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 56 quarters available, need 3 quarters (45 min), lookahead 14.0h[0m
[36m2025-10-27 16:12:44.233 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 54 windows evaluated[0m
[36m2025-10-27 16:12:44.233 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (11.5h away) â† SELECTED[0m
[36m2025-10-27 16:12:44.233 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (11.3h away)[0m
[36m2025-10-27 16:12:44.233 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (11.8h away)[0m
[36m2025-10-27 16:12:44.234 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (11.0h away)[0m
[36m2025-10-27 16:12:44.234 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (10.8h away)[0m
[32m2025-10-27 16:12:44.234 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 11.5h away[0m
[36m2025-10-27 16:12:44.239 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 16:12:44.239 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:12:44.239 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 16:12:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 56 quarters available, need 3 quarters (45 min), lookahead 14.0h[0m
[36m2025-10-27 16:12:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 54 windows evaluated[0m
[36m2025-10-27 16:12:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (11.5h away) â† SELECTED[0m
[36m2025-10-27 16:12:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (11.3h away)[0m
[36m2025-10-27 16:12:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (11.8h away)[0m
[36m2025-10-27 16:12:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (11.0h away)[0m
[36m2025-10-27 16:12:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (10.8h away)[0m
[32m2025-10-27 16:12:44.240 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 11.5h away[0m
[36m2025-10-27 16:12:44.240 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-27 16:12:44.240 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.018 seconds (success: True)[0m
[36m2025-10-27 16:12:44.242 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.2 + 0.7 + 0.6)A Ã— 0.95 = 1.25 kW[0m
[36m2025-10-27 16:17:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 16:17:44.223 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.5Â°C (median of 9 sensors: 24.6Â°C, 22.1Â°C, 22.6Â°C, 23.2Â°C, 25.7Â°C, 23.6Â°C, 23.5Â°C, 23.4Â°C, 25.0Â°C)[0m
[36m2025-10-27 16:17:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = 50.0[0m
[36m2025-10-27 16:17:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 43.6Â°C[0m
[36m2025-10-27 16:17:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.1Â°C[0m
[36m2025-10-27 16:17:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.1A, L2=0.7A, L3=0.6A[0m
[36m2025-10-27 16:17:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.5Â°C, outdoor 8.7Â°C, flow 30.1Â°C, DM 50[0m
[36m2025-10-27 16:17:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 1 Hz (1h avg: 1, 6h avg: 1, mode: space) - OK: Normal operation (1 Hz, 6h avg: 1 Hz)[0m
[36m2025-10-27 16:17:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 16:17:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 16:17:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 16:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 16:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 16:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 16:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 16:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 16:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 16:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 16:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 126}[0m
[36m2025-10-27 16:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 16:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 16:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 16:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 16:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 16:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 16:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 16:17:44.224 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 16:17:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q65 = 105.65 Ã¶re/kWh[0m
[36m2025-10-27 16:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 16:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 16:17:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 16:17:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 16:17:44.226 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 16:17:44.226 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-27 16:17:44.226 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 16:17:44.227 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 16:17:44.227 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 16:17:44.227 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 16:17:44.227 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:17:44.227 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.7Â°C: normal -106 to -306, warning -306[0m
[36m2025-10-27 16:17:44.227 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:17:44.227 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -306 (base: -306), critical -1500[0m
[36m2025-10-27 16:17:44.228 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.7Â°C, indoor_target=21.0Â°C, temp_diff=12.3Â°C, HC=0.180 kW/K -> flow=25.7Â°C[0m
[36m2025-10-27 16:17:44.228 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 16:17:44.228 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 16:17:44.228 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.2Â°C, current=30.1Â°C, error=-3.9Â°C, sensitivity=1.5 -> offset=-2.6[0m
[36m2025-10-27 16:17:44.228 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 16:17:44.228 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 30.1Â°C â†’ offset: -2.6Â°C; Weight: 0.24[0m
[36m2025-10-27 16:17:44.228 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Price classification Q65 (16:17): 105.65 â†’ NORMAL[0m
[32m2025-10-27 16:17:44.228 INFO (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.37Â°C - Learned pre-heat: Pre-heating: predicted drop 1.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 30.1Â°C â†’ offset: -2.6Â°C; Weight: 0.24 | GE-Spot Q65: NORMAL (day) | Too warm: 2.5Â°C over[0m
[32m2025-10-27 16:17:44.229 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.37Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 30.1Â°C â†’ offset: -2.6Â°C; Weight: 0.24 | GE-Spot Q65: NORMAL (day) | Too warm: 2.5Â°C over[0m
[36m2025-10-27 16:17:44.229 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.37Â°C, integer=0Â°C, fractional=0.37Â°C, accumulator_before=0.74Â°C[0m
[32m2025-10-27 16:17:44.229 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] âœ“ Accumulated fractional offset reached threshold: applying +1Â°C adjustment (accumulator: 1.11Â°C â†’ 0.11Â°C)[0m
[36m2025-10-27 16:17:44.229 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Accumulator triggered: total_accumulated=1.11Â°C, adjustment=+1Â°C, new_integer=1Â°C, remaining=0.11Â°C[0m
[36m2025-10-27 16:17:44.229 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset 0.37Â°C â†’ applying 1Â°C (accumulator: 0.11Â°C, needs 0.89Â°C more to trigger)[0m
[32m2025-10-27 16:17:44.230 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to 1Â°C (calculated: 0.37Â°C, accumulator: 0.11Â°C)[0m
[36m2025-10-27 16:17:44.231 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=1Â°C, original=0.37Â°C, accumulator=0.11Â°C[0m
[32m2025-10-27 16:17:44.231 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset 0.37Â°C to NIBE via MyUplink[0m
[36m2025-10-27 16:17:44.231 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.000 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 16:17:44.231 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-27 16:17:44.231 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.5Â°C, outdoor=8.7Â°C, offset=0.4Â°C, change=-0.15Â°C, Î”t=0.08h[0m
[36m2025-10-27 16:17:44.231 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.5Â°C, outdoor=8.7Â°C, offset=0.4Â°C, flow=30.1Â°C, DM=50[0m
[36m2025-10-27 16:17:44.236 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.3Â°C/h trend[0m
[36m2025-10-27 16:17:44.236 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 16:17:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 16:17:44.241 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 16:17:44.241 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=43.6[0m
[36m2025-10-27 16:17:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:17:44.244 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 16:17:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:17:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 16:17:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 56 quarters available, need 3 quarters (45 min), lookahead 14.0h[0m
[36m2025-10-27 16:17:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 54 windows evaluated[0m
[36m2025-10-27 16:17:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (11.5h away) â† SELECTED[0m
[36m2025-10-27 16:17:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (11.2h away)[0m
[36m2025-10-27 16:17:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (11.7h away)[0m
[36m2025-10-27 16:17:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (11.0h away)[0m
[36m2025-10-27 16:17:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (10.7h away)[0m
[32m2025-10-27 16:17:44.245 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 11.5h away[0m
[36m2025-10-27 16:17:44.255 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 16:17:44.256 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:17:44.256 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 16:17:44.256 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 56 quarters available, need 3 quarters (45 min), lookahead 14.0h[0m
[36m2025-10-27 16:17:44.256 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 54 windows evaluated[0m
[36m2025-10-27 16:17:44.256 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (11.5h away) â† SELECTED[0m
[36m2025-10-27 16:17:44.256 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (11.2h away)[0m
[36m2025-10-27 16:17:44.256 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (11.7h away)[0m
[36m2025-10-27 16:17:44.256 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (11.0h away)[0m
[36m2025-10-27 16:17:44.256 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (10.7h away)[0m
[32m2025-10-27 16:17:44.256 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 11.5h away[0m
[36m2025-10-27 16:17:44.256 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-27 16:17:44.257 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.034 seconds (success: True)[0m
[36m2025-10-27 16:17:44.258 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.1 + 0.7 + 0.6)A Ã— 0.95 = 1.23 kW[0m
[36m2025-10-27 16:22:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 16:22:44.223 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.5Â°C (median of 9 sensors: 24.6Â°C, 22.1Â°C, 22.5Â°C, 23.2Â°C, 25.7Â°C, 23.6Â°C, 23.5Â°C, 23.4Â°C, 25.0Â°C)[0m
[36m2025-10-27 16:22:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = 30.0[0m
[36m2025-10-27 16:22:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 43.6Â°C[0m
[36m2025-10-27 16:22:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.1Â°C[0m
[36m2025-10-27 16:22:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.1A, L2=0.7A, L3=0.6A[0m
[36m2025-10-27 16:22:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.5Â°C, outdoor 8.7Â°C, flow 30.1Â°C, DM 30[0m
[36m2025-10-27 16:22:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 1 Hz (1h avg: 1, 6h avg: 1, mode: space) - OK: Normal operation (1 Hz, 6h avg: 1 Hz)[0m
[36m2025-10-27 16:22:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 16:22:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 16:22:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 16:22:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 16:22:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 16:22:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 16:22:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 16:22:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 16:22:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 16:22:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 16:22:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 126}[0m
[36m2025-10-27 16:22:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 16:22:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 16:22:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 16:22:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 16:22:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 16:22:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 16:22:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 16:22:44.224 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 16:22:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q65 = 105.65 Ã¶re/kWh[0m
[36m2025-10-27 16:22:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 16:22:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 16:22:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 16:22:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 16:22:44.225 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 16:22:44.225 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-27 16:22:44.226 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 16:22:44.226 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 16:22:44.228 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 16:22:44.228 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 16:22:44.228 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:22:44.228 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.7Â°C: normal -106 to -306, warning -306[0m
[36m2025-10-27 16:22:44.228 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:22:44.228 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -306 (base: -306), critical -1500[0m
[36m2025-10-27 16:22:44.228 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.7Â°C, indoor_target=21.0Â°C, temp_diff=12.3Â°C, HC=0.180 kW/K -> flow=25.7Â°C[0m
[36m2025-10-27 16:22:44.228 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 16:22:44.228 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 16:22:44.228 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.2Â°C, current=30.1Â°C, error=-3.9Â°C, sensitivity=1.5 -> offset=-2.6[0m
[36m2025-10-27 16:22:44.228 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 16:22:44.228 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 30.1Â°C â†’ offset: -2.6Â°C; Weight: 0.24[0m
[36m2025-10-27 16:22:44.229 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Price classification Q65 (16:22): 105.65 â†’ NORMAL[0m
[32m2025-10-27 16:22:44.229 INFO (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.18Â°C - Peak: PREDICTIVE avoidance (predicted 0.6 kW, gentle cooling, Q65) | Learned pre-heat: Pre-heating: predicted drop 1.7Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 30.1Â°C â†’ offset: -2.6Â°C; Weight: 0.24 | GE-Spot Q65: NORMAL (day) | Too warm: 2.5Â°C over (boosted 15%: cooling -0.31Â°C/h)[0m
[32m2025-10-27 16:22:44.229 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.18Â°C, reasoning: Peak: PREDICTIVE avoidance (predicted 0.6 kW, gentle cooling, Q65) | Learned pre-heat: Pre-heating: predicted drop 1.7Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 30.1Â°C â†’ offset: -2.6Â°C; Weight: 0.24 | GE-Spot Q65: NORMAL (day) | Too warm: 2.5Â°C over (boosted 15%: cooling -0.31Â°C/h)[0m
[36m2025-10-27 16:22:44.229 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=-0.18Â°C, integer=0Â°C, fractional=-0.18Â°C, accumulator_before=0.11Â°C[0m
[36m2025-10-27 16:22:44.229 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: -0.08Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-27 16:22:44.229 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset -0.18Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 16:22:44.229 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.013 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 16:22:44.229 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.01 kW below 0.5 kW threshold[0m
[36m2025-10-27 16:22:44.229 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.5Â°C, outdoor=8.7Â°C, offset=-0.2Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 16:22:44.229 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.5Â°C, outdoor=8.7Â°C, offset=-0.2Â°C, flow=30.1Â°C, DM=30[0m
[36m2025-10-27 16:22:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-27 16:22:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 16:22:44.235 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved learned data to storage[0m
[36m2025-10-27 16:22:44.235 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 16:22:44.235 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 16:22:44.236 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=43.6[0m
[36m2025-10-27 16:22:44.236 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:22:44.240 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 16:22:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:22:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 16:22:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 56 quarters available, need 3 quarters (45 min), lookahead 14.0h[0m
[36m2025-10-27 16:22:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 54 windows evaluated[0m
[36m2025-10-27 16:22:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (11.4h away) â† SELECTED[0m
[36m2025-10-27 16:22:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (11.1h away)[0m
[36m2025-10-27 16:22:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (11.6h away)[0m
[36m2025-10-27 16:22:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (10.9h away)[0m
[36m2025-10-27 16:22:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (10.6h away)[0m
[32m2025-10-27 16:22:44.241 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 11.4h away[0m
[36m2025-10-27 16:22:44.243 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 16:22:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:22:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 16:22:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 56 quarters available, need 3 quarters (45 min), lookahead 14.0h[0m
[36m2025-10-27 16:22:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 54 windows evaluated[0m
[36m2025-10-27 16:22:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (11.4h away) â† SELECTED[0m
[36m2025-10-27 16:22:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (11.1h away)[0m
[36m2025-10-27 16:22:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (11.6h away)[0m
[36m2025-10-27 16:22:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (10.9h away)[0m
[36m2025-10-27 16:22:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (10.6h away)[0m
[32m2025-10-27 16:22:44.243 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 11.4h away[0m
[36m2025-10-27 16:22:44.244 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-27 16:22:44.244 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.021 seconds (success: True)[0m
[36m2025-10-27 16:22:44.245 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.1 + 0.7 + 0.6)A Ã— 0.95 = 1.23 kW[0m
[36m2025-10-27 16:22:44.245 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[33m2025-10-27 16:25:27.874 WARNING (MainThread) [homeassistant.components.automation.led_tak_groventre] LED TAK GROVENTRE: Already running[0m
[36m2025-10-27 16:27:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 16:27:44.223 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.5Â°C (median of 9 sensors: 24.6Â°C, 22.1Â°C, 22.5Â°C, 23.2Â°C, 25.7Â°C, 23.6Â°C, 23.5Â°C, 23.4Â°C, 25.0Â°C)[0m
[36m2025-10-27 16:27:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = 12.0[0m
[36m2025-10-27 16:27:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 43.1Â°C[0m
[36m2025-10-27 16:27:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.1Â°C[0m
[36m2025-10-27 16:27:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.1A, L2=0.7A, L3=0.6A[0m
[36m2025-10-27 16:27:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.5Â°C, outdoor 8.7Â°C, flow 30.1Â°C, DM 12[0m
[36m2025-10-27 16:27:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 1 Hz (1h avg: 1, 6h avg: 1, mode: space) - OK: Normal operation (1 Hz, 6h avg: 1 Hz)[0m
[36m2025-10-27 16:27:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 16:27:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 16:27:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 16:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 16:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 16:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 16:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 16:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 16:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 16:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 16:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 126}[0m
[36m2025-10-27 16:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 16:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 16:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 16:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 16:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 16:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 16:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 16:27:44.224 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 16:27:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q65 = 105.65 Ã¶re/kWh[0m
[36m2025-10-27 16:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 16:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 16:27:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 16:27:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 16:27:44.226 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 16:27:44.226 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-27 16:27:44.226 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 16:27:44.227 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 16:27:44.227 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 16:27:44.227 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 16:27:44.227 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:27:44.227 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.7Â°C: normal -106 to -306, warning -306[0m
[36m2025-10-27 16:27:44.227 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:27:44.227 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -306 (base: -306), critical -1500[0m
[36m2025-10-27 16:27:44.228 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.7Â°C, indoor_target=21.0Â°C, temp_diff=12.3Â°C, HC=0.180 kW/K -> flow=25.7Â°C[0m
[36m2025-10-27 16:27:44.228 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 16:27:44.228 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 16:27:44.228 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.2Â°C, current=30.1Â°C, error=-3.9Â°C, sensitivity=1.5 -> offset=-2.6[0m
[36m2025-10-27 16:27:44.228 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 16:27:44.228 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 30.1Â°C â†’ offset: -2.6Â°C; Weight: 0.24[0m
[36m2025-10-27 16:27:44.228 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Price classification Q65 (16:27): 105.65 â†’ NORMAL[0m
[32m2025-10-27 16:27:44.228 INFO (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.18Â°C - Peak: PREDICTIVE avoidance (predicted 0.6 kW, gentle cooling, Q65) | Learned pre-heat: Pre-heating: predicted drop 1.7Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 30.1Â°C â†’ offset: -2.6Â°C; Weight: 0.24 | GE-Spot Q65: NORMAL (day) | Too warm: 2.5Â°C over (boosted 15%: cooling -0.31Â°C/h)[0m
[32m2025-10-27 16:27:44.229 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.18Â°C, reasoning: Peak: PREDICTIVE avoidance (predicted 0.6 kW, gentle cooling, Q65) | Learned pre-heat: Pre-heating: predicted drop 1.7Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 30.1Â°C â†’ offset: -2.6Â°C; Weight: 0.24 | GE-Spot Q65: NORMAL (day) | Too warm: 2.5Â°C over (boosted 15%: cooling -0.31Â°C/h)[0m
[36m2025-10-27 16:27:44.230 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=-0.18Â°C, integer=0Â°C, fractional=-0.18Â°C, accumulator_before=-0.08Â°C[0m
[36m2025-10-27 16:27:44.230 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: -0.26Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-27 16:27:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset -0.18Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 16:27:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.000 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 16:27:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-27 16:27:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.5Â°C, outdoor=8.7Â°C, offset=-0.2Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 16:27:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.5Â°C, outdoor=8.7Â°C, offset=-0.2Â°C, flow=30.1Â°C, DM=12[0m
[36m2025-10-27 16:27:44.236 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.3Â°C/h trend[0m
[36m2025-10-27 16:27:44.236 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 16:27:44.239 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 16:27:44.239 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 16:27:44.239 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=43.1[0m
[36m2025-10-27 16:27:44.239 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:27:44.241 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 16:27:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:27:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 16:27:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 56 quarters available, need 3 quarters (45 min), lookahead 14.0h[0m
[36m2025-10-27 16:27:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 54 windows evaluated[0m
[36m2025-10-27 16:27:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (11.3h away) â† SELECTED[0m
[36m2025-10-27 16:27:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (11.0h away)[0m
[36m2025-10-27 16:27:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (11.5h away)[0m
[36m2025-10-27 16:27:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (10.8h away)[0m
[36m2025-10-27 16:27:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (10.5h away)[0m
[32m2025-10-27 16:27:44.242 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 11.3h away[0m
[36m2025-10-27 16:27:44.248 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 16:27:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:27:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 16:27:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 56 quarters available, need 3 quarters (45 min), lookahead 14.0h[0m
[36m2025-10-27 16:27:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 54 windows evaluated[0m
[36m2025-10-27 16:27:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (11.3h away) â† SELECTED[0m
[36m2025-10-27 16:27:44.249 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (11.0h away)[0m
[36m2025-10-27 16:27:44.249 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (11.5h away)[0m
[36m2025-10-27 16:27:44.249 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (10.8h away)[0m
[36m2025-10-27 16:27:44.249 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (10.5h away)[0m
[32m2025-10-27 16:27:44.249 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 11.3h away[0m
[36m2025-10-27 16:27:44.249 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-27 16:27:44.249 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.026 seconds (success: True)[0m
[36m2025-10-27 16:27:44.250 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.1 + 0.7 + 0.6)A Ã— 0.95 = 1.23 kW[0m
[36m2025-10-27 16:27:44.251 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 16:32:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 16:32:44.223 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.5Â°C (median of 9 sensors: 24.6Â°C, 22.1Â°C, 22.5Â°C, 23.3Â°C, 25.7Â°C, 23.6Â°C, 23.5Â°C, 23.4Â°C, 25.0Â°C)[0m
[36m2025-10-27 16:32:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = 6.0[0m
[36m2025-10-27 16:32:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 43.1Â°C[0m
[36m2025-10-27 16:32:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.1Â°C[0m
[36m2025-10-27 16:32:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.1A, L2=0.7A, L3=0.6A[0m
[36m2025-10-27 16:32:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.5Â°C, outdoor 8.7Â°C, flow 30.1Â°C, DM 6[0m
[36m2025-10-27 16:32:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 1 Hz (1h avg: 1, 6h avg: 1, mode: space) - OK: Normal operation (1 Hz, 6h avg: 1 Hz)[0m
[36m2025-10-27 16:32:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 16:32:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 16:32:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 16:32:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 16:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 16:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 16:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 16:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 16:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 16:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 16:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 125}[0m
[36m2025-10-27 16:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 16:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 16:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 16:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 16:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 16:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 16:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 16:32:44.224 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 16:32:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q66 = 115.75 Ã¶re/kWh[0m
[36m2025-10-27 16:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 16:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 16:32:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 16:32:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 16:32:44.226 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 16:32:44.226 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-27 16:32:44.226 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 16:32:44.227 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 16:32:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 16:32:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 16:32:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:32:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.7Â°C: normal -106 to -306, warning -306[0m
[36m2025-10-27 16:32:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:32:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -306 (base: -306), critical -1500[0m
[36m2025-10-27 16:32:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.7Â°C, indoor_target=21.0Â°C, temp_diff=12.3Â°C, HC=0.180 kW/K -> flow=25.7Â°C[0m
[36m2025-10-27 16:32:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 16:32:44.229 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 16:32:44.229 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.2Â°C, current=30.1Â°C, error=-3.9Â°C, sensitivity=1.5 -> offset=-2.6[0m
[36m2025-10-27 16:32:44.229 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 16:32:44.229 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 30.1Â°C â†’ offset: -2.6Â°C; Weight: 0.24[0m
[36m2025-10-27 16:32:44.229 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Price classification Q66 (16:32): 115.75 â†’ EXPENSIVE[0m
[32m2025-10-27 16:32:44.229 INFO (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.27Â°C - Peak: PREDICTIVE avoidance (predicted 0.6 kW, gentle cooling, Q66) | Learned pre-heat: Pre-heating: predicted drop 1.6Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 30.1Â°C â†’ offset: -2.6Â°C; Weight: 0.24 | GE-Spot Q66: EXPENSIVE (day) | Too warm: 2.5Â°C over (boosted 15%: cooling -0.31Â°C/h)[0m
[32m2025-10-27 16:32:44.230 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.27Â°C, reasoning: Peak: PREDICTIVE avoidance (predicted 0.6 kW, gentle cooling, Q66) | Learned pre-heat: Pre-heating: predicted drop 1.6Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 30.1Â°C â†’ offset: -2.6Â°C; Weight: 0.24 | GE-Spot Q66: EXPENSIVE (day) | Too warm: 2.5Â°C over (boosted 15%: cooling -0.31Â°C/h)[0m
[36m2025-10-27 16:32:44.230 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=-0.27Â°C, integer=0Â°C, fractional=-0.27Â°C, accumulator_before=-0.26Â°C[0m
[36m2025-10-27 16:32:44.230 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: -0.53Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-27 16:32:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset -0.27Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 16:32:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.000 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 16:32:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-27 16:32:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.5Â°C, outdoor=8.7Â°C, offset=-0.3Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 16:32:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.5Â°C, outdoor=8.7Â°C, offset=-0.3Â°C, flow=30.1Â°C, DM=6[0m
[36m2025-10-27 16:32:44.233 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.3Â°C/h trend[0m
[36m2025-10-27 16:32:44.233 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 16:32:44.233 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 16:32:44.233 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 16:32:44.234 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=43.1[0m
[36m2025-10-27 16:32:44.234 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:32:44.236 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 16:32:44.236 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:32:44.236 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 16:32:44.236 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 56 quarters available, need 3 quarters (45 min), lookahead 14.0h[0m
[36m2025-10-27 16:32:44.237 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 54 windows evaluated[0m
[36m2025-10-27 16:32:44.237 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (11.2h away) â† SELECTED[0m
[36m2025-10-27 16:32:44.237 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (11.0h away)[0m
[36m2025-10-27 16:32:44.237 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (11.5h away)[0m
[36m2025-10-27 16:32:44.237 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (10.7h away)[0m
[36m2025-10-27 16:32:44.237 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (10.5h away)[0m
[32m2025-10-27 16:32:44.237 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 11.2h away[0m
[36m2025-10-27 16:32:44.246 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 16:32:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:32:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 16:32:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 56 quarters available, need 3 quarters (45 min), lookahead 14.0h[0m
[36m2025-10-27 16:32:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 54 windows evaluated[0m
[36m2025-10-27 16:32:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (11.2h away) â† SELECTED[0m
[36m2025-10-27 16:32:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (11.0h away)[0m
[36m2025-10-27 16:32:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (11.5h away)[0m
[36m2025-10-27 16:32:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (10.7h away)[0m
[36m2025-10-27 16:32:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (10.5h away)[0m
[32m2025-10-27 16:32:44.246 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 11.2h away[0m
[36m2025-10-27 16:32:44.247 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-27 16:32:44.247 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.024 seconds (success: True)[0m
[36m2025-10-27 16:32:44.248 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.1 + 0.7 + 0.6)A Ã— 0.95 = 1.23 kW[0m
[36m2025-10-27 16:32:44.248 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 16:37:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 16:37:44.223 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.5Â°C (median of 9 sensors: 24.6Â°C, 22.1Â°C, 22.4Â°C, 23.3Â°C, 25.7Â°C, 23.6Â°C, 23.5Â°C, 23.4Â°C, 25.0Â°C)[0m
[36m2025-10-27 16:37:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -15.0[0m
[36m2025-10-27 16:37:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 43.1Â°C[0m
[36m2025-10-27 16:37:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.1Â°C[0m
[36m2025-10-27 16:37:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.9A, L2=0.7A, L3=0.6A[0m
[36m2025-10-27 16:37:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.5Â°C, outdoor 8.7Â°C, flow 30.1Â°C, DM -15[0m
[36m2025-10-27 16:37:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 1 Hz (1h avg: 1, 6h avg: 1, mode: space) - OK: Normal operation (1 Hz, 6h avg: 1 Hz)[0m
[36m2025-10-27 16:37:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 16:37:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 16:37:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 16:37:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 16:37:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 16:37:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 16:37:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 16:37:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 16:37:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 16:37:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 16:37:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 125}[0m
[36m2025-10-27 16:37:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 16:37:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 16:37:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 16:37:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 16:37:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 16:37:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 16:37:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 16:37:44.225 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 16:37:44.225 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q66 = 115.75 Ã¶re/kWh[0m
[36m2025-10-27 16:37:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 16:37:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 16:37:44.226 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 16:37:44.226 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 16:37:44.226 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 16:37:44.226 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-27 16:37:44.226 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 16:37:44.227 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 16:37:44.228 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 16:37:44.228 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 16:37:44.228 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:37:44.228 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.7Â°C: normal -106 to -306, warning -306[0m
[36m2025-10-27 16:37:44.228 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:37:44.228 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -306 (base: -306), critical -1500[0m
[36m2025-10-27 16:37:44.228 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.7Â°C, indoor_target=21.0Â°C, temp_diff=12.3Â°C, HC=0.180 kW/K -> flow=25.7Â°C[0m
[36m2025-10-27 16:37:44.228 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 16:37:44.228 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 16:37:44.228 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.2Â°C, current=30.1Â°C, error=-3.9Â°C, sensitivity=1.5 -> offset=-2.6[0m
[36m2025-10-27 16:37:44.229 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 16:37:44.229 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 30.1Â°C â†’ offset: -2.6Â°C; Weight: 0.24[0m
[36m2025-10-27 16:37:44.229 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Price classification Q66 (16:37): 115.75 â†’ EXPENSIVE[0m
[32m2025-10-27 16:37:44.229 INFO (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.24Â°C - Peak: PREDICTIVE avoidance (predicted 0.6 kW, gentle cooling, Q66) | Learned pre-heat: Pre-heating: predicted drop 1.6Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 30.1Â°C â†’ offset: -2.6Â°C; Weight: 0.24 | GE-Spot Q66: EXPENSIVE (day) | Too warm: 2.5Â°C over[0m
[32m2025-10-27 16:37:44.230 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.24Â°C, reasoning: Peak: PREDICTIVE avoidance (predicted 0.6 kW, gentle cooling, Q66) | Learned pre-heat: Pre-heating: predicted drop 1.6Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 30.1Â°C â†’ offset: -2.6Â°C; Weight: 0.24 | GE-Spot Q66: EXPENSIVE (day) | Too warm: 2.5Â°C over[0m
[36m2025-10-27 16:37:44.230 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=-0.24Â°C, integer=0Â°C, fractional=-0.24Â°C, accumulator_before=-0.53Â°C[0m
[36m2025-10-27 16:37:44.230 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: -0.77Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-27 16:37:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset -0.24Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 16:37:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.000 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 16:37:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-27 16:37:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.5Â°C, outdoor=8.7Â°C, offset=-0.2Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 16:37:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.5Â°C, outdoor=8.7Â°C, offset=-0.2Â°C, flow=30.1Â°C, DM=-15[0m
[36m2025-10-27 16:37:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-27 16:37:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 16:37:44.232 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 16:37:44.232 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 16:37:44.232 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=43.1[0m
[36m2025-10-27 16:37:44.232 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:37:44.241 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 16:37:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:37:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 16:37:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 56 quarters available, need 3 quarters (45 min), lookahead 14.0h[0m
[36m2025-10-27 16:37:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 54 windows evaluated[0m
[36m2025-10-27 16:37:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (11.1h away) â† SELECTED[0m
[36m2025-10-27 16:37:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (10.9h away)[0m
[36m2025-10-27 16:37:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (11.4h away)[0m
[36m2025-10-27 16:37:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (10.6h away)[0m
[36m2025-10-27 16:37:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (10.4h away)[0m
[32m2025-10-27 16:37:44.242 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 11.1h away[0m
[36m2025-10-27 16:37:44.245 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 16:37:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:37:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 16:37:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 56 quarters available, need 3 quarters (45 min), lookahead 14.0h[0m
[36m2025-10-27 16:37:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 54 windows evaluated[0m
[36m2025-10-27 16:37:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (11.1h away) â† SELECTED[0m
[36m2025-10-27 16:37:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (10.9h away)[0m
[36m2025-10-27 16:37:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (11.4h away)[0m
[36m2025-10-27 16:37:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (10.6h away)[0m
[36m2025-10-27 16:37:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (10.4h away)[0m
[32m2025-10-27 16:37:44.245 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 11.1h away[0m
[36m2025-10-27 16:37:44.246 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-27 16:37:44.246 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.023 seconds (success: True)[0m
[36m2025-10-27 16:37:44.247 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.9 + 0.7 + 0.6)A Ã— 0.95 = 1.41 kW[0m
[36m2025-10-27 16:37:44.247 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 16:42:44.222 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 16:42:44.223 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.5Â°C (median of 9 sensors: 24.6Â°C, 22.0Â°C, 22.4Â°C, 23.3Â°C, 25.7Â°C, 23.6Â°C, 23.5Â°C, 23.3Â°C, 25.0Â°C)[0m
[36m2025-10-27 16:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -32.0[0m
[36m2025-10-27 16:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 42.6Â°C[0m
[36m2025-10-27 16:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.1Â°C[0m
[36m2025-10-27 16:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.9A, L2=5.1A, L3=0.6A[0m
[36m2025-10-27 16:42:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.5Â°C, outdoor 8.7Â°C, flow 30.1Â°C, DM -32[0m
[36m2025-10-27 16:42:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 1 Hz (1h avg: 1, 6h avg: 1, mode: space) - OK: Normal operation (1 Hz, 6h avg: 1 Hz)[0m
[36m2025-10-27 16:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 16:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 16:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 16:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 16:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 16:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 16:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 16:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 16:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 16:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 16:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 125}[0m
[36m2025-10-27 16:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 16:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 16:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 16:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 16:42:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 16:42:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 16:42:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 16:42:44.225 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 16:42:44.225 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q66 = 115.75 Ã¶re/kWh[0m
[36m2025-10-27 16:42:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 16:42:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 16:42:44.226 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 16:42:44.226 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 16:42:44.226 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 16:42:44.226 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-27 16:42:44.226 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 16:42:44.227 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 16:42:44.231 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 16:42:44.231 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 16:42:44.231 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:42:44.231 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.7Â°C: normal -106 to -306, warning -306[0m
[36m2025-10-27 16:42:44.231 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:42:44.231 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -306 (base: -306), critical -1500[0m
[36m2025-10-27 16:42:44.231 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.7Â°C, indoor_target=21.0Â°C, temp_diff=12.3Â°C, HC=0.180 kW/K -> flow=25.7Â°C[0m
[36m2025-10-27 16:42:44.231 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 16:42:44.232 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 16:42:44.232 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.2Â°C, current=30.1Â°C, error=-3.9Â°C, sensitivity=1.5 -> offset=-2.6[0m
[36m2025-10-27 16:42:44.232 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 16:42:44.232 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 30.1Â°C â†’ offset: -2.6Â°C; Weight: 0.24[0m
[36m2025-10-27 16:42:44.232 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Price classification Q66 (16:42): 115.75 â†’ EXPENSIVE[0m
[32m2025-10-27 16:42:44.232 INFO (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.24Â°C - Peak: PREDICTIVE avoidance (predicted 0.6 kW, gentle cooling, Q66) | Learned pre-heat: Pre-heating: predicted drop 1.6Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 30.1Â°C â†’ offset: -2.6Â°C; Weight: 0.24 | GE-Spot Q66: EXPENSIVE (day) | Too warm: 2.5Â°C over[0m
[32m2025-10-27 16:42:44.233 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.24Â°C, reasoning: Peak: PREDICTIVE avoidance (predicted 0.6 kW, gentle cooling, Q66) | Learned pre-heat: Pre-heating: predicted drop 1.6Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 30.1Â°C â†’ offset: -2.6Â°C; Weight: 0.24 | GE-Spot Q66: EXPENSIVE (day) | Too warm: 2.5Â°C over[0m
[36m2025-10-27 16:42:44.233 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=-0.24Â°C, integer=0Â°C, fractional=-0.24Â°C, accumulator_before=-0.77Â°C[0m
[32m2025-10-27 16:42:44.233 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] âœ“ Accumulated fractional offset reached threshold: applying -1Â°C adjustment (accumulator: -1.00Â°C â†’ -0.00Â°C)[0m
[36m2025-10-27 16:42:44.233 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Accumulator triggered: total_accumulated=-1.00Â°C, adjustment=-1Â°C, new_integer=-1Â°C, remaining=-0.00Â°C[0m
[36m2025-10-27 16:42:44.233 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset -0.24Â°C â†’ applying -1Â°C (accumulator: -0.00Â°C, needs 1.00Â°C more to trigger)[0m
[32m2025-10-27 16:42:44.234 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to -1Â°C (calculated: -0.24Â°C, accumulator: -0.00Â°C)[0m
[36m2025-10-27 16:42:44.234 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=-1Â°C, original=-0.24Â°C, accumulator=-0.00Â°C[0m
[32m2025-10-27 16:42:44.234 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset -0.24Â°C to NIBE via MyUplink[0m
[36m2025-10-27 16:42:44.235 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.000 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 16:42:44.235 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-27 16:42:44.235 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.5Â°C, outdoor=8.7Â°C, offset=-0.2Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 16:42:44.235 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.5Â°C, outdoor=8.7Â°C, offset=-0.2Â°C, flow=30.1Â°C, DM=-32[0m
[36m2025-10-27 16:42:44.240 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.3Â°C/h trend[0m
[36m2025-10-27 16:42:44.240 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 16:42:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 16:42:44.244 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 16:42:44.244 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=42.6[0m
[36m2025-10-27 16:42:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:42:44.247 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 16:42:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:42:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 16:42:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 56 quarters available, need 3 quarters (45 min), lookahead 14.0h[0m
[36m2025-10-27 16:42:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 54 windows evaluated[0m
[36m2025-10-27 16:42:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (11.0h away) â† SELECTED[0m
[36m2025-10-27 16:42:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (10.8h away)[0m
[36m2025-10-27 16:42:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (11.3h away)[0m
[36m2025-10-27 16:42:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (10.5h away)[0m
[36m2025-10-27 16:42:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (10.3h away)[0m
[32m2025-10-27 16:42:44.248 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 11.0h away[0m
[36m2025-10-27 16:42:44.250 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 16:42:44.250 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:42:44.250 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 16:42:44.250 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 56 quarters available, need 3 quarters (45 min), lookahead 14.0h[0m
[36m2025-10-27 16:42:44.250 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 54 windows evaluated[0m
[36m2025-10-27 16:42:44.250 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (11.0h away) â† SELECTED[0m
[36m2025-10-27 16:42:44.250 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (10.8h away)[0m
[36m2025-10-27 16:42:44.251 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (11.3h away)[0m
[36m2025-10-27 16:42:44.251 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (10.5h away)[0m
[36m2025-10-27 16:42:44.251 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (10.3h away)[0m
[32m2025-10-27 16:42:44.251 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 11.0h away[0m
[36m2025-10-27 16:42:44.251 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-27 16:42:44.251 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.029 seconds (success: True)[0m
[36m2025-10-27 16:42:44.252 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.9 + 5.1 + 0.6)A Ã— 0.95 = 2.42 kW[0m
[36m2025-10-27 16:42:44.253 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 16:47:44.222 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 16:47:44.223 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.5Â°C (median of 9 sensors: 24.6Â°C, 22.0Â°C, 22.4Â°C, 23.2Â°C, 25.7Â°C, 23.6Â°C, 23.5Â°C, 23.3Â°C, 25.0Â°C)[0m
[36m2025-10-27 16:47:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -51.0[0m
[36m2025-10-27 16:47:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 41.1Â°C[0m
[36m2025-10-27 16:47:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 29.6Â°C[0m
[36m2025-10-27 16:47:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.9A, L2=1.0A, L3=0.6A[0m
[36m2025-10-27 16:47:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.5Â°C, outdoor 8.7Â°C, flow 29.6Â°C, DM -51[0m
[36m2025-10-27 16:47:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 1 Hz (1h avg: 1, 6h avg: 1, mode: space) - OK: Normal operation (1 Hz, 6h avg: 1 Hz)[0m
[36m2025-10-27 16:47:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 16:47:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 16:47:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 16:47:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 16:47:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 16:47:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 16:47:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 16:47:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 16:47:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 16:47:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 16:47:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 124}[0m
[36m2025-10-27 16:47:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 16:47:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 16:47:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 16:47:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 16:47:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 16:47:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 16:47:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 16:47:44.224 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 16:47:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q67 = 123.58 Ã¶re/kWh[0m
[36m2025-10-27 16:47:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 16:47:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 16:47:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 16:47:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 16:47:44.225 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 16:47:44.225 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-27 16:47:44.225 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 16:47:44.226 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 16:47:44.230 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 16:47:44.230 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 16:47:44.230 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:47:44.230 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.7Â°C: normal -106 to -306, warning -306[0m
[36m2025-10-27 16:47:44.230 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:47:44.230 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -306 (base: -306), critical -1500[0m
[36m2025-10-27 16:47:44.230 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.7Â°C, indoor_target=21.0Â°C, temp_diff=12.3Â°C, HC=0.180 kW/K -> flow=25.7Â°C[0m
[36m2025-10-27 16:47:44.230 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 16:47:44.231 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 16:47:44.231 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.2Â°C, current=29.6Â°C, error=-3.4Â°C, sensitivity=1.5 -> offset=-2.2[0m
[36m2025-10-27 16:47:44.231 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 16:47:44.231 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 29.6Â°C â†’ offset: -2.2Â°C; Weight: 0.24[0m
[36m2025-10-27 16:47:44.231 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Price classification Q67 (16:47): 123.58 â†’ EXPENSIVE[0m
[32m2025-10-27 16:47:44.231 INFO (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.21Â°C - Peak: PREDICTIVE avoidance (predicted 0.6 kW, gentle cooling, Q67) | Learned pre-heat: Pre-heating: predicted drop 1.6Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 29.6Â°C â†’ offset: -2.2Â°C; Weight: 0.24 | GE-Spot Q67: EXPENSIVE (day) | Too warm: 2.5Â°C over[0m
[32m2025-10-27 16:47:44.231 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.21Â°C, reasoning: Peak: PREDICTIVE avoidance (predicted 0.6 kW, gentle cooling, Q67) | Learned pre-heat: Pre-heating: predicted drop 1.6Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 29.6Â°C â†’ offset: -2.2Â°C; Weight: 0.24 | GE-Spot Q67: EXPENSIVE (day) | Too warm: 2.5Â°C over[0m
[36m2025-10-27 16:47:44.231 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Skipping offset write, too soon since last write[0m
[36m2025-10-27 16:47:44.231 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset -0.21Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 16:47:44.232 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.000 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 16:47:44.232 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-27 16:47:44.232 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.5Â°C, outdoor=8.7Â°C, offset=-0.2Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 16:47:44.232 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.5Â°C, outdoor=8.7Â°C, offset=-0.2Â°C, flow=29.6Â°C, DM=-51[0m
[36m2025-10-27 16:47:44.232 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-27 16:47:44.232 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 16:47:44.233 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 16:47:44.233 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 16:47:44.233 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=41.1[0m
[36m2025-10-27 16:47:44.233 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:47:44.238 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 16:47:44.238 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:47:44.238 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 16:47:44.238 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 56 quarters available, need 3 quarters (45 min), lookahead 14.0h[0m
[36m2025-10-27 16:47:44.239 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 54 windows evaluated[0m
[36m2025-10-27 16:47:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (11.0h away) â† SELECTED[0m
[36m2025-10-27 16:47:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (10.7h away)[0m
[36m2025-10-27 16:47:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (11.2h away)[0m
[36m2025-10-27 16:47:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (10.5h away)[0m
[36m2025-10-27 16:47:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (10.2h away)[0m
[32m2025-10-27 16:47:44.240 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 11.0h away[0m
[36m2025-10-27 16:47:44.243 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 16:47:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:47:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 16:47:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 56 quarters available, need 3 quarters (45 min), lookahead 14.0h[0m
[36m2025-10-27 16:47:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 54 windows evaluated[0m
[36m2025-10-27 16:47:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (11.0h away) â† SELECTED[0m
[36m2025-10-27 16:47:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (10.7h away)[0m
[36m2025-10-27 16:47:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (11.2h away)[0m
[36m2025-10-27 16:47:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (10.5h away)[0m
[36m2025-10-27 16:47:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (10.2h away)[0m
[32m2025-10-27 16:47:44.244 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 11.0h away[0m
[36m2025-10-27 16:47:44.244 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-27 16:47:44.244 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.022 seconds (success: True)[0m
[36m2025-10-27 16:47:44.246 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.9 + 1.0 + 0.6)A Ã— 0.95 = 1.48 kW[0m
[36m2025-10-27 16:47:44.246 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 16:52:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 16:52:44.223 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.5Â°C (median of 9 sensors: 24.6Â°C, 22.0Â°C, 22.4Â°C, 23.2Â°C, 25.7Â°C, 23.6Â°C, 23.5Â°C, 23.3Â°C, 25.0Â°C)[0m
[36m2025-10-27 16:52:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -54.0[0m
[36m2025-10-27 16:52:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 36.6Â°C[0m
[36m2025-10-27 16:52:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 29.6Â°C[0m
[36m2025-10-27 16:52:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.9A, L2=1.0A, L3=0.6A[0m
[36m2025-10-27 16:52:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.5Â°C, outdoor 8.7Â°C, flow 29.6Â°C, DM -54[0m
[36m2025-10-27 16:52:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 1 Hz (1h avg: 1, 6h avg: 1, mode: space) - OK: Normal operation (1 Hz, 6h avg: 1 Hz)[0m
[36m2025-10-27 16:52:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 16:52:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 16:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 16:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 16:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 16:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 16:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 16:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 16:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 16:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 16:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 124}[0m
[36m2025-10-27 16:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 16:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 16:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 16:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 16:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 16:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 16:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 16:52:44.224 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 16:52:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q67 = 123.58 Ã¶re/kWh[0m
[36m2025-10-27 16:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 16:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 16:52:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 16:52:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 16:52:44.226 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 16:52:44.226 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-27 16:52:44.226 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 16:52:44.227 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 16:52:44.228 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 16:52:44.228 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 16:52:44.228 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:52:44.228 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.7Â°C: normal -106 to -306, warning -306[0m
[36m2025-10-27 16:52:44.228 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:52:44.228 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -306 (base: -306), critical -1500[0m
[36m2025-10-27 16:52:44.228 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.7Â°C, indoor_target=21.0Â°C, temp_diff=12.3Â°C, HC=0.180 kW/K -> flow=25.7Â°C[0m
[36m2025-10-27 16:52:44.228 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 16:52:44.228 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 16:52:44.229 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.2Â°C, current=29.6Â°C, error=-3.4Â°C, sensitivity=1.5 -> offset=-2.2[0m
[36m2025-10-27 16:52:44.229 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 16:52:44.229 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 29.6Â°C â†’ offset: -2.2Â°C; Weight: 0.24[0m
[36m2025-10-27 16:52:44.229 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Price classification Q67 (16:52): 123.58 â†’ EXPENSIVE[0m
[32m2025-10-27 16:52:44.229 INFO (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.21Â°C - Peak: PREDICTIVE avoidance (predicted 0.6 kW, gentle cooling, Q67) | Learned pre-heat: Pre-heating: predicted drop 1.6Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 29.6Â°C â†’ offset: -2.2Â°C; Weight: 0.24 | GE-Spot Q67: EXPENSIVE (day) | Too warm: 2.5Â°C over[0m
[32m2025-10-27 16:52:44.229 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.21Â°C, reasoning: Peak: PREDICTIVE avoidance (predicted 0.6 kW, gentle cooling, Q67) | Learned pre-heat: Pre-heating: predicted drop 1.6Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 29.6Â°C â†’ offset: -2.2Â°C; Weight: 0.24 | GE-Spot Q67: EXPENSIVE (day) | Too warm: 2.5Â°C over[0m
[36m2025-10-27 16:52:44.229 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=-0.21Â°C, integer=0Â°C, fractional=-0.21Â°C, accumulator_before=-0.00Â°C[0m
[36m2025-10-27 16:52:44.229 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: -0.21Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-27 16:52:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset -0.21Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 16:52:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.000 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 16:52:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-27 16:52:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.5Â°C, outdoor=8.7Â°C, offset=-0.2Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 16:52:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.5Â°C, outdoor=8.7Â°C, offset=-0.2Â°C, flow=29.6Â°C, DM=-54[0m
[36m2025-10-27 16:52:44.232 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.0Â°C/h trend[0m
[36m2025-10-27 16:52:44.232 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 16:52:44.233 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 16:52:44.233 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 16:52:44.234 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=36.6[0m
[36m2025-10-27 16:52:44.234 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:52:44.235 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 16:52:44.236 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:52:44.236 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 16:52:44.236 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 56 quarters available, need 3 quarters (45 min), lookahead 14.0h[0m
[36m2025-10-27 16:52:44.236 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 54 windows evaluated[0m
[36m2025-10-27 16:52:44.236 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (10.9h away) â† SELECTED[0m
[36m2025-10-27 16:52:44.236 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (10.6h away)[0m
[36m2025-10-27 16:52:44.236 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (11.1h away)[0m
[36m2025-10-27 16:52:44.236 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (10.4h away)[0m
[36m2025-10-27 16:52:44.236 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (10.1h away)[0m
[32m2025-10-27 16:52:44.236 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 10.9h away[0m
[36m2025-10-27 16:52:44.241 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 16:52:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:52:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 16:52:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 56 quarters available, need 3 quarters (45 min), lookahead 14.0h[0m
[36m2025-10-27 16:52:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 54 windows evaluated[0m
[36m2025-10-27 16:52:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (10.9h away) â† SELECTED[0m
[36m2025-10-27 16:52:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (10.6h away)[0m
[36m2025-10-27 16:52:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (11.1h away)[0m
[36m2025-10-27 16:52:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (10.4h away)[0m
[36m2025-10-27 16:52:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (10.1h away)[0m
[32m2025-10-27 16:52:44.242 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 10.9h away[0m
[36m2025-10-27 16:52:44.242 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-27 16:52:44.242 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.019 seconds (success: True)[0m
[36m2025-10-27 16:52:44.244 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.9 + 1.0 + 0.6)A Ã— 0.95 = 1.48 kW[0m
[36m2025-10-27 16:52:44.244 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 16:57:44.222 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 16:57:44.223 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.5Â°C (median of 9 sensors: 24.6Â°C, 22.0Â°C, 22.4Â°C, 23.1Â°C, 25.7Â°C, 23.6Â°C, 23.5Â°C, 23.3Â°C, 25.0Â°C)[0m
[36m2025-10-27 16:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -55.0[0m
[36m2025-10-27 16:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 33.6Â°C[0m
[36m2025-10-27 16:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 29.6Â°C[0m
[36m2025-10-27 16:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=3.9A, L2=1.0A, L3=0.6A[0m
[36m2025-10-27 16:57:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.5Â°C, outdoor 8.7Â°C, flow 29.6Â°C, DM -55[0m
[36m2025-10-27 16:57:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 1 Hz (1h avg: 1, 6h avg: 1, mode: space) - OK: Normal operation (1 Hz, 6h avg: 1 Hz)[0m
[36m2025-10-27 16:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 16:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 16:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 16:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 16:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 16:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 16:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 16:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 16:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 16:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 16:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 124}[0m
[36m2025-10-27 16:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 16:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 16:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 16:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 16:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 16:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 16:57:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 16:57:44.224 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 16:57:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q67 = 123.58 Ã¶re/kWh[0m
[36m2025-10-27 16:57:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 16:57:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 16:57:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 16:57:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 16:57:44.225 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 16:57:44.225 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-27 16:57:44.225 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 16:57:44.226 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 16:57:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 16:57:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 16:57:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:57:44.229 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.7Â°C: normal -106 to -306, warning -306[0m
[36m2025-10-27 16:57:44.229 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:57:44.229 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -306 (base: -306), critical -1500[0m
[36m2025-10-27 16:57:44.229 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.7Â°C, indoor_target=21.0Â°C, temp_diff=12.3Â°C, HC=0.180 kW/K -> flow=25.7Â°C[0m
[36m2025-10-27 16:57:44.229 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 16:57:44.229 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 16:57:44.229 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.2Â°C, current=29.6Â°C, error=-3.4Â°C, sensitivity=1.5 -> offset=-2.2[0m
[36m2025-10-27 16:57:44.229 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 16:57:44.229 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 29.6Â°C â†’ offset: -2.2Â°C; Weight: 0.24[0m
[36m2025-10-27 16:57:44.229 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Price classification Q67 (16:57): 123.58 â†’ EXPENSIVE[0m
[32m2025-10-27 16:57:44.230 INFO (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.30Â°C - Learned pre-heat: Pre-heating: predicted drop 1.6Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 29.6Â°C â†’ offset: -2.2Â°C; Weight: 0.24 | GE-Spot Q67: EXPENSIVE (day) | Too warm: 2.5Â°C over[0m
[32m2025-10-27 16:57:44.230 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.30Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.6Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 29.6Â°C â†’ offset: -2.2Â°C; Weight: 0.24 | GE-Spot Q67: EXPENSIVE (day) | Too warm: 2.5Â°C over[0m
[36m2025-10-27 16:57:44.230 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.30Â°C, integer=0Â°C, fractional=0.30Â°C, accumulator_before=-0.21Â°C[0m
[36m2025-10-27 16:57:44.230 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: 0.09Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-27 16:57:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.30Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 16:57:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.000 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 16:57:44.231 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-27 16:57:44.231 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.5Â°C, outdoor=8.7Â°C, offset=0.3Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 16:57:44.231 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.5Â°C, outdoor=8.7Â°C, offset=0.3Â°C, flow=29.6Â°C, DM=-55[0m
[36m2025-10-27 16:57:44.238 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.0Â°C/h trend[0m
[36m2025-10-27 16:57:44.238 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 16:57:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 16:57:44.241 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 16:57:44.241 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=33.6[0m
[36m2025-10-27 16:57:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:57:44.244 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 16:57:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:57:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 16:57:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 56 quarters available, need 3 quarters (45 min), lookahead 14.0h[0m
[36m2025-10-27 16:57:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 54 windows evaluated[0m
[36m2025-10-27 16:57:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (10.8h away) â† SELECTED[0m
[36m2025-10-27 16:57:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (10.5h away)[0m
[36m2025-10-27 16:57:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (11.0h away)[0m
[36m2025-10-27 16:57:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (10.3h away)[0m
[36m2025-10-27 16:57:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (10.0h away)[0m
[32m2025-10-27 16:57:44.245 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 10.8h away[0m
[36m2025-10-27 16:57:44.247 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 16:57:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 16:57:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 16:57:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 56 quarters available, need 3 quarters (45 min), lookahead 14.0h[0m
[36m2025-10-27 16:57:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 54 windows evaluated[0m
[36m2025-10-27 16:57:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (10.8h away) â† SELECTED[0m
[36m2025-10-27 16:57:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (10.5h away)[0m
[36m2025-10-27 16:57:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (11.0h away)[0m
[36m2025-10-27 16:57:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (10.3h away)[0m
[36m2025-10-27 16:57:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (10.0h away)[0m
[32m2025-10-27 16:57:44.248 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 10.8h away[0m
[36m2025-10-27 16:57:44.248 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-27 16:57:44.249 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.026 seconds (success: True)[0m
[36m2025-10-27 16:57:44.250 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (3.9 + 1.0 + 0.6)A Ã— 0.95 = 1.25 kW[0m
[33m2025-10-27 17:00:51.585 WARNING (MainThread) [homeassistant.components.automation.led_tak_groventre] LED TAK GROVENTRE: Already running[0m
[36m2025-10-27 17:02:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 17:02:44.223 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.5Â°C (median of 9 sensors: 24.6Â°C, 21.9Â°C, 22.3Â°C, 23.1Â°C, 25.7Â°C, 23.6Â°C, 23.5Â°C, 23.3Â°C, 25.0Â°C)[0m
[36m2025-10-27 17:02:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -58.0[0m
[36m2025-10-27 17:02:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 31.6Â°C[0m
[36m2025-10-27 17:02:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 29.6Â°C[0m
[36m2025-10-27 17:02:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=3.9A, L2=1.0A, L3=0.6A[0m
[36m2025-10-27 17:02:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.5Â°C, outdoor 8.7Â°C, flow 29.6Â°C, DM -58[0m
[36m2025-10-27 17:02:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 1 Hz (1h avg: 1, 6h avg: 1, mode: space) - OK: Normal operation (1 Hz, 6h avg: 1 Hz)[0m
[36m2025-10-27 17:02:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 17:02:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 17:02:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 17:02:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 17:02:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 17:02:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 17:02:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 17:02:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 17:02:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 17:02:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 17:02:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 123}[0m
[36m2025-10-27 17:02:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 17:02:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 17:02:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 17:02:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 17:02:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 17:02:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 17:02:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 17:02:44.225 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 17:02:44.225 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q68 = 127.35 Ã¶re/kWh[0m
[36m2025-10-27 17:02:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 17:02:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 17:02:44.226 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 17:02:44.226 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 17:02:44.227 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 17:02:44.227 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-27 17:02:44.227 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 17:02:44.229 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 17:02:44.229 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 17:02:44.229 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 17:02:44.229 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:02:44.229 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.7Â°C: normal -106 to -306, warning -306[0m
[36m2025-10-27 17:02:44.229 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:02:44.229 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -306 (base: -306), critical -1500[0m
[36m2025-10-27 17:02:44.230 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.7Â°C, indoor_target=21.0Â°C, temp_diff=12.3Â°C, HC=0.180 kW/K -> flow=25.7Â°C[0m
[36m2025-10-27 17:02:44.230 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 17:02:44.230 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 17:02:44.230 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.2Â°C, current=29.6Â°C, error=-3.4Â°C, sensitivity=1.5 -> offset=-2.2[0m
[36m2025-10-27 17:02:44.230 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 17:02:44.230 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 29.6Â°C â†’ offset: -2.2Â°C; Weight: 0.24[0m
[36m2025-10-27 17:02:44.230 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Price classification Q68 (17:02): 127.35 â†’ PEAK[0m
[32m2025-10-27 17:02:44.230 INFO (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.20Â°C - Learned pre-heat: Pre-heating: predicted drop 1.7Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 29.6Â°C â†’ offset: -2.2Â°C; Weight: 0.24 | GE-Spot Q68: PEAK (day) | Too warm: 2.5Â°C over[0m
[32m2025-10-27 17:02:44.231 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.20Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.7Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 29.6Â°C â†’ offset: -2.2Â°C; Weight: 0.24 | GE-Spot Q68: PEAK (day) | Too warm: 2.5Â°C over[0m
[36m2025-10-27 17:02:44.231 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.20Â°C, integer=0Â°C, fractional=0.20Â°C, accumulator_before=0.09Â°C[0m
[36m2025-10-27 17:02:44.231 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: 0.29Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-27 17:02:44.232 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.20Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 17:02:44.232 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.000 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 17:02:44.232 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-27 17:02:44.232 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.5Â°C, outdoor=8.7Â°C, offset=0.2Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 17:02:44.232 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.5Â°C, outdoor=8.7Â°C, offset=0.2Â°C, flow=29.6Â°C, DM=-58[0m
[36m2025-10-27 17:02:44.238 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.0Â°C/h trend[0m
[36m2025-10-27 17:02:44.238 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 17:02:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 17:02:44.240 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 17:02:44.240 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=31.6[0m
[36m2025-10-27 17:02:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:02:44.243 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 17:02:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:02:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 17:02:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 52 quarters available, need 3 quarters (45 min), lookahead 13.0h[0m
[36m2025-10-27 17:02:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 50 windows evaluated[0m
[36m2025-10-27 17:02:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (10.7h away) â† SELECTED[0m
[36m2025-10-27 17:02:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (10.5h away)[0m
[36m2025-10-27 17:02:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (11.0h away)[0m
[36m2025-10-27 17:02:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (10.2h away)[0m
[36m2025-10-27 17:02:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (10.0h away)[0m
[32m2025-10-27 17:02:44.244 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 10.7h away[0m
[36m2025-10-27 17:02:44.247 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 17:02:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:02:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 17:02:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 52 quarters available, need 3 quarters (45 min), lookahead 13.0h[0m
[36m2025-10-27 17:02:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 50 windows evaluated[0m
[36m2025-10-27 17:02:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (10.7h away) â† SELECTED[0m
[36m2025-10-27 17:02:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (10.5h away)[0m
[36m2025-10-27 17:02:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (11.0h away)[0m
[36m2025-10-27 17:02:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (10.2h away)[0m
[36m2025-10-27 17:02:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (10.0h away)[0m
[32m2025-10-27 17:02:44.248 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 10.7h away[0m
[36m2025-10-27 17:02:44.248 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-27 17:02:44.248 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.026 seconds (success: True)[0m
[36m2025-10-27 17:02:44.250 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (3.9 + 1.0 + 0.6)A Ã— 0.95 = 1.25 kW[0m
[36m2025-10-27 17:07:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 17:07:44.223 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.5Â°C (median of 9 sensors: 24.6Â°C, 22.0Â°C, 22.3Â°C, 23.1Â°C, 25.7Â°C, 23.6Â°C, 23.5Â°C, 23.3Â°C, 25.0Â°C)[0m
[36m2025-10-27 17:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -60.0[0m
[36m2025-10-27 17:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 28.6Â°C[0m
[36m2025-10-27 17:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 29.6Â°C[0m
[36m2025-10-27 17:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=3.9A, L2=1.0A, L3=0.6A[0m
[36m2025-10-27 17:07:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.5Â°C, outdoor 8.7Â°C, flow 29.6Â°C, DM -60[0m
[36m2025-10-27 17:07:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 1 Hz (1h avg: 1, 6h avg: 1, mode: space) - OK: Normal operation (1 Hz, 6h avg: 1 Hz)[0m
[36m2025-10-27 17:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 17:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 17:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 17:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 17:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 17:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 17:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 17:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 17:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 17:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 17:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 123}[0m
[36m2025-10-27 17:07:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 17:07:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 17:07:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 17:07:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 17:07:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 17:07:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 17:07:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 17:07:44.224 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 17:07:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q68 = 127.35 Ã¶re/kWh[0m
[36m2025-10-27 17:07:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 17:07:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 17:07:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 17:07:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 17:07:44.225 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 17:07:44.225 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-27 17:07:44.226 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 17:07:44.228 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 17:07:44.228 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 17:07:44.228 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 17:07:44.228 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:07:44.228 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.7Â°C: normal -106 to -306, warning -306[0m
[36m2025-10-27 17:07:44.229 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:07:44.229 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -306 (base: -306), critical -1500[0m
[36m2025-10-27 17:07:44.229 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.7Â°C, indoor_target=21.0Â°C, temp_diff=12.3Â°C, HC=0.180 kW/K -> flow=25.7Â°C[0m
[36m2025-10-27 17:07:44.229 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 17:07:44.229 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 17:07:44.229 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.2Â°C, current=29.6Â°C, error=-3.4Â°C, sensitivity=1.5 -> offset=-2.2[0m
[36m2025-10-27 17:07:44.229 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 17:07:44.229 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 29.6Â°C â†’ offset: -2.2Â°C; Weight: 0.24[0m
[36m2025-10-27 17:07:44.229 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Price classification Q68 (17:07): 127.35 â†’ PEAK[0m
[32m2025-10-27 17:07:44.229 INFO (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.20Â°C - Learned pre-heat: Pre-heating: predicted drop 1.7Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 29.6Â°C â†’ offset: -2.2Â°C; Weight: 0.24 | GE-Spot Q68: PEAK (day) | Too warm: 2.5Â°C over[0m
[32m2025-10-27 17:07:44.230 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.20Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.7Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 29.6Â°C â†’ offset: -2.2Â°C; Weight: 0.24 | GE-Spot Q68: PEAK (day) | Too warm: 2.5Â°C over[0m
[36m2025-10-27 17:07:44.230 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.20Â°C, integer=0Â°C, fractional=0.20Â°C, accumulator_before=0.29Â°C[0m
[36m2025-10-27 17:07:44.230 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: 0.49Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-27 17:07:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.20Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 17:07:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.000 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 17:07:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-27 17:07:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.5Â°C, outdoor=8.7Â°C, offset=0.2Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 17:07:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.5Â°C, outdoor=8.7Â°C, offset=0.2Â°C, flow=29.6Â°C, DM=-60[0m
[36m2025-10-27 17:07:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-27 17:07:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 17:07:44.233 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 17:07:44.233 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 17:07:44.233 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=28.6[0m
[36m2025-10-27 17:07:44.234 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:07:44.240 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 17:07:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:07:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 17:07:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 52 quarters available, need 3 quarters (45 min), lookahead 13.0h[0m
[36m2025-10-27 17:07:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 50 windows evaluated[0m
[36m2025-10-27 17:07:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (10.6h away) â† SELECTED[0m
[36m2025-10-27 17:07:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (10.4h away)[0m
[36m2025-10-27 17:07:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (10.9h away)[0m
[36m2025-10-27 17:07:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (10.1h away)[0m
[36m2025-10-27 17:07:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (9.9h away)[0m
[32m2025-10-27 17:07:44.241 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 10.6h away[0m
[32m2025-10-27 17:07:44.241 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 28.6Â°C (safe >= 15.0Â°C), next window at 03:45 (10.6h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 17:07:44.244 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 17:07:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:07:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 17:07:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 52 quarters available, need 3 quarters (45 min), lookahead 13.0h[0m
[36m2025-10-27 17:07:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 50 windows evaluated[0m
[36m2025-10-27 17:07:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (10.6h away) â† SELECTED[0m
[36m2025-10-27 17:07:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (10.4h away)[0m
[36m2025-10-27 17:07:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (10.9h away)[0m
[36m2025-10-27 17:07:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (10.1h away)[0m
[36m2025-10-27 17:07:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (9.9h away)[0m
[32m2025-10-27 17:07:44.245 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 10.6h away[0m
[32m2025-10-27 17:07:44.245 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 28.6Â°C (safe >= 15.0Â°C), next window at 03:45 (10.6h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 17:07:44.245 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_SAFETY_WAITING_WINDOW_IN_10.6H_@7.4)[0m
[36m2025-10-27 17:07:44.245 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.023 seconds (success: True)[0m
[36m2025-10-27 17:07:44.247 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (3.9 + 1.0 + 0.6)A Ã— 0.95 = 1.25 kW[0m
[36m2025-10-27 17:12:44.222 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 17:12:44.223 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.5Â°C (median of 9 sensors: 24.6Â°C, 21.9Â°C, 22.3Â°C, 23.1Â°C, 25.7Â°C, 23.6Â°C, 23.5Â°C, 23.3Â°C, 25.0Â°C)[0m
[36m2025-10-27 17:12:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -63.0[0m
[36m2025-10-27 17:12:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 27.6Â°C[0m
[36m2025-10-27 17:12:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 29.1Â°C[0m
[36m2025-10-27 17:12:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=3.9A, L2=1.0A, L3=0.6A[0m
[36m2025-10-27 17:12:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.5Â°C, outdoor 8.7Â°C, flow 29.1Â°C, DM -63[0m
[36m2025-10-27 17:12:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 1 Hz (1h avg: 1, 6h avg: 1, mode: space) - OK: Normal operation (1 Hz, 6h avg: 1 Hz)[0m
[36m2025-10-27 17:12:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 17:12:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 17:12:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 17:12:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 17:12:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 17:12:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 17:12:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 17:12:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 17:12:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 17:12:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 17:12:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 123}[0m
[36m2025-10-27 17:12:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 17:12:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 17:12:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 17:12:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 17:12:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 17:12:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 17:12:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 17:12:44.224 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 17:12:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q68 = 127.35 Ã¶re/kWh[0m
[36m2025-10-27 17:12:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 17:12:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 17:12:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 17:12:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 17:12:44.225 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 17:12:44.225 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 17:12:44.225 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 17:12:44.226 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 17:12:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 17:12:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 17:12:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:12:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.7Â°C: normal -106 to -306, warning -306[0m
[36m2025-10-27 17:12:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:12:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -306 (base: -306), critical -1500[0m
[36m2025-10-27 17:12:44.229 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.7Â°C, indoor_target=21.0Â°C, temp_diff=12.3Â°C, HC=0.180 kW/K -> flow=25.7Â°C[0m
[36m2025-10-27 17:12:44.229 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 17:12:44.229 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 17:12:44.229 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.2Â°C, current=29.1Â°C, error=-2.9Â°C, sensitivity=1.5 -> offset=-1.9[0m
[36m2025-10-27 17:12:44.229 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 17:12:44.229 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 29.1Â°C â†’ offset: -1.9Â°C; Weight: 0.24[0m
[36m2025-10-27 17:12:44.229 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Price classification Q68 (17:12): 127.35 â†’ PEAK[0m
[32m2025-10-27 17:12:44.229 INFO (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.24Â°C - Learned pre-heat: Pre-heating: predicted drop 1.6Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 29.1Â°C â†’ offset: -1.9Â°C; Weight: 0.24 | GE-Spot Q68: PEAK (day) | Too warm: 2.5Â°C over[0m
[32m2025-10-27 17:12:44.230 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.24Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.6Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 29.1Â°C â†’ offset: -1.9Â°C; Weight: 0.24 | GE-Spot Q68: PEAK (day) | Too warm: 2.5Â°C over[0m
[36m2025-10-27 17:12:44.230 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.24Â°C, integer=0Â°C, fractional=0.24Â°C, accumulator_before=0.49Â°C[0m
[36m2025-10-27 17:12:44.230 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: 0.73Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-27 17:12:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.24Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 17:12:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.000 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 17:12:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-27 17:12:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.5Â°C, outdoor=8.7Â°C, offset=0.2Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 17:12:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.5Â°C, outdoor=8.7Â°C, offset=0.2Â°C, flow=29.1Â°C, DM=-63[0m
[36m2025-10-27 17:12:44.240 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.0Â°C/h trend[0m
[36m2025-10-27 17:12:44.240 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 17:12:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 17:12:44.241 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 17:12:44.241 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=27.6[0m
[36m2025-10-27 17:12:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:12:44.244 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 17:12:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:12:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 17:12:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 52 quarters available, need 3 quarters (45 min), lookahead 13.0h[0m
[36m2025-10-27 17:12:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 50 windows evaluated[0m
[36m2025-10-27 17:12:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (10.5h away) â† SELECTED[0m
[36m2025-10-27 17:12:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (10.3h away)[0m
[36m2025-10-27 17:12:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (10.8h away)[0m
[36m2025-10-27 17:12:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (10.0h away)[0m
[36m2025-10-27 17:12:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (9.8h away)[0m
[32m2025-10-27 17:12:44.245 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 10.5h away[0m
[32m2025-10-27 17:12:44.245 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 27.6Â°C (safe >= 15.0Â°C), next window at 03:45 (10.5h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 17:12:44.248 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 17:12:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:12:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 17:12:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 52 quarters available, need 3 quarters (45 min), lookahead 13.0h[0m
[36m2025-10-27 17:12:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 50 windows evaluated[0m
[36m2025-10-27 17:12:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (10.5h away) â† SELECTED[0m
[36m2025-10-27 17:12:44.249 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (10.3h away)[0m
[36m2025-10-27 17:12:44.249 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (10.8h away)[0m
[36m2025-10-27 17:12:44.249 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (10.0h away)[0m
[36m2025-10-27 17:12:44.249 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (9.8h away)[0m
[32m2025-10-27 17:12:44.249 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 10.5h away[0m
[32m2025-10-27 17:12:44.249 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 27.6Â°C (safe >= 15.0Â°C), next window at 03:45 (10.5h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 17:12:44.249 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_SAFETY_WAITING_WINDOW_IN_10.5H_@7.4)[0m
[36m2025-10-27 17:12:44.249 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.027 seconds (success: True)[0m
[36m2025-10-27 17:12:44.250 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (3.9 + 1.0 + 0.6)A Ã— 0.95 = 1.25 kW[0m
[36m2025-10-27 17:17:44.222 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 17:17:44.222 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.5Â°C (median of 9 sensors: 24.6Â°C, 21.9Â°C, 22.3Â°C, 23.2Â°C, 25.8Â°C, 23.6Â°C, 23.5Â°C, 23.3Â°C, 25.0Â°C)[0m
[36m2025-10-27 17:17:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -66.0[0m
[36m2025-10-27 17:17:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 25.6Â°C[0m
[36m2025-10-27 17:17:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 29.1Â°C[0m
[36m2025-10-27 17:17:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=5.1A, L2=1.0A, L3=0.6A[0m
[36m2025-10-27 17:17:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.5Â°C, outdoor 8.7Â°C, flow 29.1Â°C, DM -66[0m
[36m2025-10-27 17:17:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 1 Hz (1h avg: 1, 6h avg: 1, mode: space) - OK: Normal operation (1 Hz, 6h avg: 1 Hz)[0m
[36m2025-10-27 17:17:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 17:17:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 17:17:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 17:17:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 17:17:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 17:17:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 17:17:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 17:17:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 17:17:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 17:17:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 17:17:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 122}[0m
[36m2025-10-27 17:17:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 17:17:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 17:17:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 17:17:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 17:17:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 17:17:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 17:17:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 17:17:44.224 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 17:17:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q69 = 139.75 Ã¶re/kWh[0m
[36m2025-10-27 17:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 17:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 17:17:44.226 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 17:17:44.226 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 17:17:44.226 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 17:17:44.226 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 17:17:44.226 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 17:17:44.227 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 17:17:44.228 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 17:17:44.228 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 17:17:44.228 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:17:44.228 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.7Â°C: normal -106 to -306, warning -306[0m
[36m2025-10-27 17:17:44.228 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:17:44.228 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -306 (base: -306), critical -1500[0m
[36m2025-10-27 17:17:44.228 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.7Â°C, indoor_target=21.0Â°C, temp_diff=12.3Â°C, HC=0.180 kW/K -> flow=25.7Â°C[0m
[36m2025-10-27 17:17:44.228 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 17:17:44.228 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 17:17:44.228 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.2Â°C, current=29.1Â°C, error=-2.9Â°C, sensitivity=1.5 -> offset=-1.9[0m
[36m2025-10-27 17:17:44.228 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 17:17:44.229 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 29.1Â°C â†’ offset: -1.9Â°C; Weight: 0.24[0m
[36m2025-10-27 17:17:44.229 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Price classification Q69 (17:17): 139.75 â†’ PEAK[0m
[32m2025-10-27 17:17:44.229 INFO (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.24Â°C - Learned pre-heat: Pre-heating: predicted drop 1.6Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 29.1Â°C â†’ offset: -1.9Â°C; Weight: 0.24 | GE-Spot Q69: PEAK (day) | Too warm: 2.5Â°C over[0m
[32m2025-10-27 17:17:44.229 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.24Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.6Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 29.1Â°C â†’ offset: -1.9Â°C; Weight: 0.24 | GE-Spot Q69: PEAK (day) | Too warm: 2.5Â°C over[0m
[36m2025-10-27 17:17:44.229 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.24Â°C, integer=0Â°C, fractional=0.24Â°C, accumulator_before=0.73Â°C[0m
[36m2025-10-27 17:17:44.229 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: 0.96Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-27 17:17:44.229 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.24Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 17:17:44.229 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.000 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 17:17:44.229 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-27 17:17:44.229 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.5Â°C, outdoor=8.7Â°C, offset=0.2Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 17:17:44.229 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.5Â°C, outdoor=8.7Â°C, offset=0.2Â°C, flow=29.1Â°C, DM=-66[0m
[36m2025-10-27 17:17:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-27 17:17:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 17:17:44.233 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 17:17:44.233 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 17:17:44.233 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=25.6[0m
[36m2025-10-27 17:17:44.233 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:17:44.238 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 17:17:44.238 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:17:44.238 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 17:17:44.238 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 52 quarters available, need 3 quarters (45 min), lookahead 13.0h[0m
[36m2025-10-27 17:17:44.238 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 50 windows evaluated[0m
[36m2025-10-27 17:17:44.239 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (10.5h away) â† SELECTED[0m
[36m2025-10-27 17:17:44.239 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (10.2h away)[0m
[36m2025-10-27 17:17:44.239 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (10.7h away)[0m
[36m2025-10-27 17:17:44.239 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (10.0h away)[0m
[36m2025-10-27 17:17:44.239 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (9.7h away)[0m
[32m2025-10-27 17:17:44.239 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 10.5h away[0m
[32m2025-10-27 17:17:44.239 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 25.6Â°C (safe >= 15.0Â°C), next window at 03:45 (10.5h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 17:17:44.247 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 17:17:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:17:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 17:17:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 52 quarters available, need 3 quarters (45 min), lookahead 13.0h[0m
[36m2025-10-27 17:17:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 50 windows evaluated[0m
[36m2025-10-27 17:17:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (10.5h away) â† SELECTED[0m
[36m2025-10-27 17:17:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (10.2h away)[0m
[36m2025-10-27 17:17:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (10.7h away)[0m
[36m2025-10-27 17:17:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (10.0h away)[0m
[36m2025-10-27 17:17:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (9.7h away)[0m
[32m2025-10-27 17:17:44.247 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 10.5h away[0m
[32m2025-10-27 17:17:44.247 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 25.6Â°C (safe >= 15.0Â°C), next window at 03:45 (10.5h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 17:17:44.247 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_SAFETY_WAITING_WINDOW_IN_10.5H_@7.4)[0m
[36m2025-10-27 17:17:44.248 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.025 seconds (success: True)[0m
[36m2025-10-27 17:17:44.249 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (5.1 + 1.0 + 0.6)A Ã— 0.95 = 1.53 kW[0m
[33m2025-10-27 17:21:35.772 WARNING (MainThread) [homeassistant.components.automation.led_tak_groventre] LED TAK GROVENTRE: Already running[0m
[33m2025-10-27 17:22:01.052 WARNING (MainThread) [pysignalr.client] No client method with the name 'CommandResponse' found.[0m
[36m2025-10-27 17:22:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 17:22:44.223 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.5Â°C (median of 9 sensors: 24.6Â°C, 21.9Â°C, 22.4Â°C, 23.1Â°C, 25.7Â°C, 23.6Â°C, 23.5Â°C, 23.2Â°C, 25.0Â°C)[0m
[36m2025-10-27 17:22:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -68.0[0m
[36m2025-10-27 17:22:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 24.6Â°C[0m
[36m2025-10-27 17:22:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 29.1Â°C[0m
[36m2025-10-27 17:22:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=5.1A, L2=1.0A, L3=0.6A[0m
[36m2025-10-27 17:22:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.5Â°C, outdoor 8.7Â°C, flow 29.1Â°C, DM -68[0m
[36m2025-10-27 17:22:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 1 Hz (1h avg: 1, 6h avg: 1, mode: space) - OK: Normal operation (1 Hz, 6h avg: 1 Hz)[0m
[36m2025-10-27 17:22:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 17:22:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 17:22:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 17:22:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 17:22:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 17:22:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 17:22:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 17:22:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 17:22:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 17:22:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 17:22:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 122}[0m
[36m2025-10-27 17:22:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 17:22:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 17:22:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 17:22:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 17:22:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 17:22:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 17:22:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 17:22:44.224 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 17:22:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q69 = 139.75 Ã¶re/kWh[0m
[36m2025-10-27 17:22:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 17:22:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 17:22:44.226 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 17:22:44.226 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 17:22:44.226 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 17:22:44.226 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 17:22:44.226 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 17:22:44.227 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 17:22:44.229 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 17:22:44.229 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 17:22:44.229 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:22:44.229 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.7Â°C: normal -106 to -306, warning -306[0m
[36m2025-10-27 17:22:44.229 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:22:44.229 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -306 (base: -306), critical -1500[0m
[36m2025-10-27 17:22:44.229 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.7Â°C, indoor_target=21.0Â°C, temp_diff=12.3Â°C, HC=0.180 kW/K -> flow=25.7Â°C[0m
[36m2025-10-27 17:22:44.229 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 17:22:44.230 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 17:22:44.230 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.2Â°C, current=29.1Â°C, error=-2.9Â°C, sensitivity=1.5 -> offset=-1.9[0m
[36m2025-10-27 17:22:44.230 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 17:22:44.230 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 29.1Â°C â†’ offset: -1.9Â°C; Weight: 0.24[0m
[36m2025-10-27 17:22:44.230 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Price classification Q69 (17:22): 139.75 â†’ PEAK[0m
[32m2025-10-27 17:22:44.230 INFO (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.24Â°C - Learned pre-heat: Pre-heating: predicted drop 1.6Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 29.1Â°C â†’ offset: -1.9Â°C; Weight: 0.24 | GE-Spot Q69: PEAK (day) | Too warm: 2.5Â°C over[0m
[32m2025-10-27 17:22:44.231 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.24Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.6Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 29.1Â°C â†’ offset: -1.9Â°C; Weight: 0.24 | GE-Spot Q69: PEAK (day) | Too warm: 2.5Â°C over[0m
[36m2025-10-27 17:22:44.231 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.24Â°C, integer=0Â°C, fractional=0.24Â°C, accumulator_before=0.96Â°C[0m
[32m2025-10-27 17:22:44.231 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] âœ“ Accumulated fractional offset reached threshold: applying +1Â°C adjustment (accumulator: 1.20Â°C â†’ 0.20Â°C)[0m
[36m2025-10-27 17:22:44.231 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Accumulator triggered: total_accumulated=1.20Â°C, adjustment=+1Â°C, new_integer=1Â°C, remaining=0.20Â°C[0m
[36m2025-10-27 17:22:44.231 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset 0.24Â°C â†’ applying 1Â°C (accumulator: 0.20Â°C, needs 0.80Â°C more to trigger)[0m
[32m2025-10-27 17:22:44.232 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to 1Â°C (calculated: 0.24Â°C, accumulator: 0.20Â°C)[0m
[36m2025-10-27 17:22:44.232 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=1Â°C, original=0.24Â°C, accumulator=0.20Â°C[0m
[32m2025-10-27 17:22:44.233 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset 0.24Â°C to NIBE via MyUplink[0m
[36m2025-10-27 17:22:44.233 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.000 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 17:22:44.233 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-27 17:22:44.233 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.5Â°C, outdoor=8.7Â°C, offset=0.2Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 17:22:44.233 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.5Â°C, outdoor=8.7Â°C, offset=0.2Â°C, flow=29.1Â°C, DM=-68[0m
[36m2025-10-27 17:22:44.238 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.0Â°C/h trend[0m
[36m2025-10-27 17:22:44.238 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 17:22:44.246 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved learned data to storage[0m
[36m2025-10-27 17:22:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 17:22:44.246 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 17:22:44.246 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=24.6[0m
[36m2025-10-27 17:22:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:22:44.251 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 17:22:44.251 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:22:44.251 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 17:22:44.251 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 52 quarters available, need 3 quarters (45 min), lookahead 13.0h[0m
[36m2025-10-27 17:22:44.251 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 50 windows evaluated[0m
[36m2025-10-27 17:22:44.251 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (10.4h away) â† SELECTED[0m
[36m2025-10-27 17:22:44.251 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (10.1h away)[0m
[36m2025-10-27 17:22:44.251 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (10.6h away)[0m
[36m2025-10-27 17:22:44.251 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (9.9h away)[0m
[36m2025-10-27 17:22:44.251 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (9.6h away)[0m
[32m2025-10-27 17:22:44.251 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 10.4h away[0m
[32m2025-10-27 17:22:44.251 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 24.6Â°C (safe >= 15.0Â°C), next window at 03:45 (10.4h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 17:22:44.257 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 17:22:44.257 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:22:44.257 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 17:22:44.258 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 52 quarters available, need 3 quarters (45 min), lookahead 13.0h[0m
[36m2025-10-27 17:22:44.258 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 50 windows evaluated[0m
[36m2025-10-27 17:22:44.258 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (10.4h away) â† SELECTED[0m
[36m2025-10-27 17:22:44.258 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (10.1h away)[0m
[36m2025-10-27 17:22:44.258 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (10.6h away)[0m
[36m2025-10-27 17:22:44.258 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (9.9h away)[0m
[36m2025-10-27 17:22:44.258 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (9.6h away)[0m
[32m2025-10-27 17:22:44.258 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 10.4h away[0m
[32m2025-10-27 17:22:44.258 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 24.6Â°C (safe >= 15.0Â°C), next window at 03:45 (10.4h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 17:22:44.258 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_SAFETY_WAITING_WINDOW_IN_10.4H_@7.4)[0m
[36m2025-10-27 17:22:44.259 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.036 seconds (success: True)[0m
[36m2025-10-27 17:22:44.260 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (5.1 + 1.0 + 0.6)A Ã— 0.95 = 1.53 kW[0m
[36m2025-10-27 17:27:44.222 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 17:27:44.222 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.5Â°C (median of 9 sensors: 24.6Â°C, 21.9Â°C, 22.3Â°C, 23.2Â°C, 25.7Â°C, 23.5Â°C, 23.5Â°C, 23.2Â°C, 25.0Â°C)[0m
[36m2025-10-27 17:27:44.222 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -81.0[0m
[36m2025-10-27 17:27:44.222 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 24.1Â°C[0m
[36m2025-10-27 17:27:44.222 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 29.1Â°C[0m
[36m2025-10-27 17:27:44.222 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.6A, L2=1.0A, L3=0.6A[0m
[36m2025-10-27 17:27:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.5Â°C, outdoor 8.7Â°C, flow 29.1Â°C, DM -81[0m
[36m2025-10-27 17:27:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 1 Hz (1h avg: 1, 6h avg: 1, mode: space) - OK: Normal operation (1 Hz, 6h avg: 1 Hz)[0m
[36m2025-10-27 17:27:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 17:27:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 17:27:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 17:27:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 17:27:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 17:27:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 17:27:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 17:27:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 17:27:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 17:27:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 17:27:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 122}[0m
[36m2025-10-27 17:27:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 17:27:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 17:27:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 17:27:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 17:27:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 17:27:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 17:27:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 17:27:44.223 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 17:27:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q69 = 139.75 Ã¶re/kWh[0m
[36m2025-10-27 17:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 17:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 17:27:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 17:27:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 17:27:44.226 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 17:27:44.226 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 17:27:44.226 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 17:27:44.227 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 17:27:44.232 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 17:27:44.232 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 17:27:44.232 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:27:44.232 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.7Â°C: normal -106 to -306, warning -306[0m
[36m2025-10-27 17:27:44.232 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:27:44.232 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -306 (base: -306), critical -1500[0m
[36m2025-10-27 17:27:44.232 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.7Â°C, indoor_target=21.0Â°C, temp_diff=12.3Â°C, HC=0.180 kW/K -> flow=25.7Â°C[0m
[36m2025-10-27 17:27:44.232 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 17:27:44.232 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 17:27:44.232 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.2Â°C, current=29.1Â°C, error=-2.9Â°C, sensitivity=1.5 -> offset=-1.9[0m
[36m2025-10-27 17:27:44.232 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 17:27:44.232 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 29.1Â°C â†’ offset: -1.9Â°C; Weight: 0.24[0m
[36m2025-10-27 17:27:44.233 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Price classification Q69 (17:27): 139.75 â†’ PEAK[0m
[32m2025-10-27 17:27:44.233 INFO (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.24Â°C - Learned pre-heat: Pre-heating: predicted drop 1.6Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 29.1Â°C â†’ offset: -1.9Â°C; Weight: 0.24 | GE-Spot Q69: PEAK (day) | Too warm: 2.5Â°C over[0m
[32m2025-10-27 17:27:44.233 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.24Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.6Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 29.1Â°C â†’ offset: -1.9Â°C; Weight: 0.24 | GE-Spot Q69: PEAK (day) | Too warm: 2.5Â°C over[0m
[36m2025-10-27 17:27:44.233 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.24Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-27 17:27:44.233 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.000 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 17:27:44.233 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-27 17:27:44.233 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.5Â°C, outdoor=8.7Â°C, offset=0.2Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 17:27:44.233 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.5Â°C, outdoor=8.7Â°C, offset=0.2Â°C, flow=29.1Â°C, DM=-81[0m
[36m2025-10-27 17:27:44.238 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.0Â°C/h trend[0m
[36m2025-10-27 17:27:44.238 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 17:27:44.239 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 17:27:44.239 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 17:27:44.239 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=24.1[0m
[36m2025-10-27 17:27:44.239 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:27:44.242 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 17:27:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:27:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 17:27:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 52 quarters available, need 3 quarters (45 min), lookahead 13.0h[0m
[36m2025-10-27 17:27:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 50 windows evaluated[0m
[36m2025-10-27 17:27:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (10.3h away) â† SELECTED[0m
[36m2025-10-27 17:27:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (10.0h away)[0m
[36m2025-10-27 17:27:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (10.5h away)[0m
[36m2025-10-27 17:27:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (9.8h away)[0m
[36m2025-10-27 17:27:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (9.5h away)[0m
[32m2025-10-27 17:27:44.242 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 10.3h away[0m
[32m2025-10-27 17:27:44.242 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 24.1Â°C (safe >= 15.0Â°C), next window at 03:45 (10.3h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 17:27:44.246 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 17:27:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:27:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 17:27:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 52 quarters available, need 3 quarters (45 min), lookahead 13.0h[0m
[36m2025-10-27 17:27:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 50 windows evaluated[0m
[36m2025-10-27 17:27:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (10.3h away) â† SELECTED[0m
[36m2025-10-27 17:27:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (10.0h away)[0m
[36m2025-10-27 17:27:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (10.5h away)[0m
[36m2025-10-27 17:27:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (9.8h away)[0m
[36m2025-10-27 17:27:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (9.5h away)[0m
[32m2025-10-27 17:27:44.247 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 10.3h away[0m
[32m2025-10-27 17:27:44.247 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 24.1Â°C (safe >= 15.0Â°C), next window at 03:45 (10.3h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 17:27:44.247 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_SAFETY_WAITING_WINDOW_IN_10.3H_@7.4)[0m
[36m2025-10-27 17:27:44.247 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.025 seconds (success: True)[0m
[36m2025-10-27 17:27:44.248 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.6 + 1.0 + 0.6)A Ã— 0.95 = 1.41 kW[0m
[36m2025-10-27 17:32:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 17:32:44.223 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.5Â°C (median of 9 sensors: 24.6Â°C, 21.9Â°C, 22.3Â°C, 23.1Â°C, 25.7Â°C, 23.5Â°C, 23.5Â°C, 23.2Â°C, 25.0Â°C)[0m
[36m2025-10-27 17:32:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -99.0[0m
[36m2025-10-27 17:32:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 23.6Â°C[0m
[36m2025-10-27 17:32:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 28.6Â°C[0m
[36m2025-10-27 17:32:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=13.0A, L2=1.0A, L3=0.6A[0m
[36m2025-10-27 17:32:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.5Â°C, outdoor 8.7Â°C, flow 28.6Â°C, DM -99[0m
[36m2025-10-27 17:32:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 1 Hz (1h avg: 1, 6h avg: 1, mode: space) - OK: Normal operation (1 Hz, 6h avg: 1 Hz)[0m
[36m2025-10-27 17:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 17:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 17:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 17:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 17:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 17:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 17:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 17:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 17:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 17:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 17:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 121}[0m
[36m2025-10-27 17:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 17:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 17:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 17:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 17:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 17:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 17:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 17:32:44.226 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 17:32:44.226 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q70 = 152.17 Ã¶re/kWh[0m
[36m2025-10-27 17:32:44.226 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 17:32:44.226 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 17:32:44.227 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 17:32:44.227 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 17:32:44.227 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 17:32:44.227 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 17:32:44.227 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 17:32:44.228 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 17:32:44.229 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 17:32:44.229 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 17:32:44.229 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:32:44.229 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.7Â°C: normal -106 to -306, warning -306[0m
[36m2025-10-27 17:32:44.229 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:32:44.229 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -306 (base: -306), critical -1500[0m
[36m2025-10-27 17:32:44.229 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.7Â°C, indoor_target=21.0Â°C, temp_diff=12.3Â°C, HC=0.180 kW/K -> flow=25.7Â°C[0m
[36m2025-10-27 17:32:44.229 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 17:32:44.230 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 17:32:44.230 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.2Â°C, current=28.6Â°C, error=-2.4Â°C, sensitivity=1.5 -> offset=-1.6[0m
[36m2025-10-27 17:32:44.230 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 17:32:44.230 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 28.6Â°C â†’ offset: -1.6Â°C; Weight: 0.24[0m
[36m2025-10-27 17:32:44.230 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Price classification Q70 (17:32): 152.17 â†’ PEAK[0m
[32m2025-10-27 17:32:44.230 INFO (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.27Â°C - Learned pre-heat: Pre-heating: predicted drop 1.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 28.6Â°C â†’ offset: -1.6Â°C; Weight: 0.24 | GE-Spot Q70: PEAK (day) | Too warm: 2.5Â°C over[0m
[32m2025-10-27 17:32:44.230 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.27Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 28.6Â°C â†’ offset: -1.6Â°C; Weight: 0.24 | GE-Spot Q70: PEAK (day) | Too warm: 2.5Â°C over[0m
[36m2025-10-27 17:32:44.230 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.27Â°C, integer=0Â°C, fractional=0.27Â°C, accumulator_before=0.20Â°C[0m
[36m2025-10-27 17:32:44.230 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: 0.47Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-27 17:32:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.27Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 17:32:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.000 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 17:32:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-27 17:32:44.231 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.5Â°C, outdoor=8.7Â°C, offset=0.3Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 17:32:44.231 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.5Â°C, outdoor=8.7Â°C, offset=0.3Â°C, flow=28.6Â°C, DM=-99[0m
[36m2025-10-27 17:32:44.231 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-27 17:32:44.231 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 17:32:44.235 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 17:32:44.235 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 17:32:44.235 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=23.6[0m
[36m2025-10-27 17:32:44.235 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:32:44.237 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 17:32:44.237 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:32:44.238 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 17:32:44.238 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 52 quarters available, need 3 quarters (45 min), lookahead 13.0h[0m
[36m2025-10-27 17:32:44.238 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 50 windows evaluated[0m
[36m2025-10-27 17:32:44.238 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (10.2h away) â† SELECTED[0m
[36m2025-10-27 17:32:44.238 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (10.0h away)[0m
[36m2025-10-27 17:32:44.238 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (10.5h away)[0m
[36m2025-10-27 17:32:44.238 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (9.7h away)[0m
[36m2025-10-27 17:32:44.238 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (9.5h away)[0m
[32m2025-10-27 17:32:44.238 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 10.2h away[0m
[32m2025-10-27 17:32:44.238 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 23.6Â°C (safe >= 15.0Â°C), next window at 03:45 (10.2h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 17:32:44.246 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 05:32:49.347476+00:00[0m
[36m2025-10-27 17:32:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:32:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 17:32:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 52 quarters available, need 3 quarters (45 min), lookahead 13.0h[0m
[36m2025-10-27 17:32:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 50 windows evaluated[0m
[36m2025-10-27 17:32:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (10.2h away) â† SELECTED[0m
[36m2025-10-27 17:32:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (10.0h away)[0m
[36m2025-10-27 17:32:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (10.5h away)[0m
[36m2025-10-27 17:32:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (9.7h away)[0m
[36m2025-10-27 17:32:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (9.5h away)[0m
[32m2025-10-27 17:32:44.247 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 10.2h away[0m
[32m2025-10-27 17:32:44.247 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 23.6Â°C (safe >= 15.0Â°C), next window at 03:45 (10.2h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 17:32:44.247 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_SAFETY_WAITING_WINDOW_IN_10.2H_@7.4)[0m
[36m2025-10-27 17:32:44.248 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.025 seconds (success: True)[0m
[36m2025-10-27 17:32:44.249 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (13.0 + 1.0 + 0.6)A Ã— 0.95 = 3.33 kW[0m
[32m2025-10-27 17:36:48.466 INFO (MainThread) [custom_components.effektguard] Runtime options changed, updating coordinator without reload[0m
[36m2025-10-27 17:36:48.466 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updating configuration: {'optimization_mode': 'balanced', 'tolerance': 1.0, 'thermal_mass': 2.0, 'insulation_quality': 1.5, 'dhw_target_temp': 50.0, 'dhw_morning_hour': 7, 'dhw_evening_hour': 20, 'dhw_morning_enabled': True, 'dhw_evening_enabled': True}[0m
[36m2025-10-27 17:36:48.466 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated tolerance: 1.0 (range: 0.4Â°C)[0m
[36m2025-10-27 17:36:48.466 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated thermal mass: 2.00[0m
[32m2025-10-27 17:36:48.466 INFO (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Insulation quality set to 1.50 (heat loss: 120.0 W/Â°C) - will be refined through learning[0m
[36m2025-10-27 17:36:48.466 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated insulation quality: 1.50[0m
[36m2025-10-27 17:36:48.466 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated optimization mode: balanced[0m
[36m2025-10-27 17:36:48.466 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated DHW demand periods: 2 periods (target: 50.0Â°C)[0m
[32m2025-10-27 17:36:48.466 INFO (MainThread) [custom_components.effektguard.coordinator] Configuration updated without reload - changes apply on next cycle[0m
[32m2025-10-27 17:37:17.893 INFO (MainThread) [custom_components.effektguard] Runtime options changed, updating coordinator without reload[0m
[36m2025-10-27 17:37:17.893 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updating configuration: {'optimization_mode': 'balanced', 'tolerance': 1.0, 'thermal_mass': 2.0, 'insulation_quality': 1.5, 'dhw_target_temp': 45.0, 'dhw_morning_hour': 7, 'dhw_evening_hour': 20, 'dhw_morning_enabled': True, 'dhw_evening_enabled': True}[0m
[36m2025-10-27 17:37:17.893 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated tolerance: 1.0 (range: 0.4Â°C)[0m
[36m2025-10-27 17:37:17.893 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated thermal mass: 2.00[0m
[32m2025-10-27 17:37:17.893 INFO (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Insulation quality set to 1.50 (heat loss: 120.0 W/Â°C) - will be refined through learning[0m
[36m2025-10-27 17:37:17.893 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated insulation quality: 1.50[0m
[36m2025-10-27 17:37:17.893 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated optimization mode: balanced[0m
[36m2025-10-27 17:37:17.894 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated DHW demand periods: 2 periods (target: 45.0Â°C)[0m
[32m2025-10-27 17:37:17.894 INFO (MainThread) [custom_components.effektguard.coordinator] Configuration updated without reload - changes apply on next cycle[0m
[36m2025-10-27 17:37:44.222 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 17:37:44.222 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.3Â°C (median of 9 sensors: 24.6Â°C, 21.9Â°C, 22.3Â°C, 23.1Â°C, 25.7Â°C, 23.5Â°C, 23.3Â°C, 23.2Â°C, 25.0Â°C)[0m
[36m2025-10-27 17:37:44.222 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -111.0[0m
[36m2025-10-27 17:37:44.222 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 22.1Â°C[0m
[36m2025-10-27 17:37:44.222 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 21.3Â°C[0m
[36m2025-10-27 17:37:44.222 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.5A, L2=1.0A, L3=0.6A[0m
[36m2025-10-27 17:37:44.222 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.3Â°C, outdoor 8.7Â°C, flow 21.3Â°C, DM -111[0m
[36m2025-10-27 17:37:44.222 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor Hz not available from NIBE adapter[0m
[36m2025-10-27 17:37:44.222 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 17:37:44.222 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 17:37:44.222 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 17:37:44.222 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 17:37:44.222 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 17:37:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 17:37:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 17:37:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 17:37:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 17:37:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 17:37:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 121}[0m
[36m2025-10-27 17:37:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 17:37:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 17:37:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 17:37:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 17:37:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 17:37:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 17:37:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 17:37:44.223 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 17:37:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q70 = 152.17 Ã¶re/kWh[0m
[36m2025-10-27 17:37:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 17:37:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 17:37:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 17:37:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 17:37:44.225 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 17:37:44.225 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 17:37:44.225 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 17:37:44.226 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 17:37:44.227 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 17:37:44.227 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 17:37:44.227 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:37:44.227 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.7Â°C: normal -106 to -306, warning -306[0m
[36m2025-10-27 17:37:44.227 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:37:44.227 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -306 (base: -306), critical -1500[0m
[36m2025-10-27 17:37:44.227 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.7Â°C, indoor_target=21.0Â°C, temp_diff=12.3Â°C, HC=0.180 kW/K -> flow=25.7Â°C[0m
[36m2025-10-27 17:37:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 17:37:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 17:37:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.2Â°C, current=21.3Â°C, error=4.9Â°C, sensitivity=1.5 -> offset=3.3[0m
[36m2025-10-27 17:37:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 17:37:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 21.3Â°C â†’ offset: +3.3Â°C; Weight: 0.24[0m
[36m2025-10-27 17:37:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Price classification Q70 (17:37): 152.17 â†’ PEAK[0m
[32m2025-10-27 17:37:44.228 INFO (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.08Â°C - Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 21.3Â°C â†’ offset: +3.3Â°C; Weight: 0.24 | GE-Spot Q70: PEAK (day) | Too warm: 2.3Â°C over[0m
[32m2025-10-27 17:37:44.228 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.08Â°C, reasoning: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 21.3Â°C â†’ offset: +3.3Â°C; Weight: 0.24 | GE-Spot Q70: PEAK (day) | Too warm: 2.3Â°C over[0m
[36m2025-10-27 17:37:44.228 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=-0.08Â°C, integer=0Â°C, fractional=-0.08Â°C, accumulator_before=0.47Â°C[0m
[36m2025-10-27 17:37:44.229 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: 0.40Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-27 17:37:44.229 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset -0.08Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 17:37:44.229 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.009 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 17:37:44.229 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.01 kW below 0.5 kW threshold[0m
[36m2025-10-27 17:37:44.229 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.3Â°C, outdoor=8.7Â°C, offset=-0.1Â°C, change=-0.20Â°C, Î”t=0.08h[0m
[36m2025-10-27 17:37:44.229 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.3Â°C, outdoor=8.7Â°C, offset=-0.1Â°C, flow=21.3Â°C, DM=-111[0m
[36m2025-10-27 17:37:44.236 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.3Â°C/h trend[0m
[36m2025-10-27 17:37:44.236 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 17:37:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 17:37:44.240 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 17:37:44.240 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=22.1[0m
[36m2025-10-27 17:37:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:37:44.242 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 17:37:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:37:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 17:37:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 52 quarters available, need 3 quarters (45 min), lookahead 13.0h[0m
[36m2025-10-27 17:37:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 50 windows evaluated[0m
[36m2025-10-27 17:37:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (10.1h away) â† SELECTED[0m
[36m2025-10-27 17:37:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (9.9h away)[0m
[36m2025-10-27 17:37:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (10.4h away)[0m
[36m2025-10-27 17:37:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (9.6h away)[0m
[36m2025-10-27 17:37:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (9.4h away)[0m
[32m2025-10-27 17:37:44.243 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 10.1h away[0m
[32m2025-10-27 17:37:44.243 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 22.1Â°C (safe >= 15.0Â°C), next window at 03:45 (10.1h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 17:37:44.246 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 17:37:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:37:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 17:37:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 52 quarters available, need 3 quarters (45 min), lookahead 13.0h[0m
[36m2025-10-27 17:37:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 50 windows evaluated[0m
[36m2025-10-27 17:37:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (10.1h away) â† SELECTED[0m
[36m2025-10-27 17:37:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (9.9h away)[0m
[36m2025-10-27 17:37:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (10.4h away)[0m
[36m2025-10-27 17:37:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (9.6h away)[0m
[36m2025-10-27 17:37:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (9.4h away)[0m
[32m2025-10-27 17:37:44.247 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 10.1h away[0m
[32m2025-10-27 17:37:44.247 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 22.1Â°C (safe >= 15.0Â°C), next window at 03:45 (10.1h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 17:37:44.247 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_SAFETY_WAITING_WINDOW_IN_10.1H_@7.4)[0m
[36m2025-10-27 17:37:44.248 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.026 seconds (success: True)[0m
[36m2025-10-27 17:37:44.249 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.5 + 1.0 + 0.6)A Ã— 0.95 = 1.39 kW[0m
[36m2025-10-27 17:42:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 17:42:44.223 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.3Â°C (median of 9 sensors: 24.6Â°C, 21.9Â°C, 22.2Â°C, 23.1Â°C, 25.7Â°C, 23.5Â°C, 23.3Â°C, 23.2Â°C, 25.0Â°C)[0m
[36m2025-10-27 17:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -133.0[0m
[36m2025-10-27 17:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 21.6Â°C[0m
[36m2025-10-27 17:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 21.3Â°C[0m
[36m2025-10-27 17:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.5A, L2=1.0A, L3=0.6A[0m
[36m2025-10-27 17:42:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.3Â°C, outdoor 8.7Â°C, flow 21.3Â°C, DM -133[0m
[36m2025-10-27 17:42:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor Hz not available from NIBE adapter[0m
[36m2025-10-27 17:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 17:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 17:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 17:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 17:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 17:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 17:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 17:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 17:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 17:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 17:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 121}[0m
[36m2025-10-27 17:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 17:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 17:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 17:42:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 17:42:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 17:42:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 17:42:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 17:42:44.224 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 17:42:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q70 = 152.17 Ã¶re/kWh[0m
[36m2025-10-27 17:42:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 17:42:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 17:42:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 17:42:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 17:42:44.225 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 17:42:44.225 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 17:42:44.226 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 17:42:44.227 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 17:42:44.228 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 17:42:44.228 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 17:42:44.228 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:42:44.228 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.7Â°C: normal -106 to -306, warning -306[0m
[36m2025-10-27 17:42:44.228 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:42:44.228 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -306 (base: -306), critical -1500[0m
[36m2025-10-27 17:42:44.229 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.7Â°C, indoor_target=21.0Â°C, temp_diff=12.3Â°C, HC=0.180 kW/K -> flow=25.7Â°C[0m
[36m2025-10-27 17:42:44.229 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 17:42:44.229 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 17:42:44.229 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.2Â°C, current=21.3Â°C, error=4.9Â°C, sensitivity=1.5 -> offset=3.3[0m
[36m2025-10-27 17:42:44.229 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 17:42:44.229 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 21.3Â°C â†’ offset: +3.3Â°C; Weight: 0.24[0m
[36m2025-10-27 17:42:44.229 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Price classification Q70 (17:42): 152.17 â†’ PEAK[0m
[32m2025-10-27 17:42:44.229 INFO (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.68Â°C - Peak: PREDICTIVE avoidance (predicted 0.6 kW, gentle cooling, Q70) | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 21.3Â°C â†’ offset: +3.3Â°C; Weight: 0.24 | GE-Spot Q70: PEAK (day) | Too warm: 2.3Â°C over (boosted 15%: cooling -0.34Â°C/h)[0m
[32m2025-10-27 17:42:44.230 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.68Â°C, reasoning: Peak: PREDICTIVE avoidance (predicted 0.6 kW, gentle cooling, Q70) | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 21.3Â°C â†’ offset: +3.3Â°C; Weight: 0.24 | GE-Spot Q70: PEAK (day) | Too warm: 2.3Â°C over (boosted 15%: cooling -0.34Â°C/h)[0m
[36m2025-10-27 17:42:44.230 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=-0.68Â°C, integer=0Â°C, fractional=-0.68Â°C, accumulator_before=0.40Â°C[0m
[36m2025-10-27 17:42:44.230 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: -0.29Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-27 17:42:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset -0.68Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 17:42:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.001 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 17:42:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-27 17:42:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.3Â°C, outdoor=8.7Â°C, offset=-0.7Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 17:42:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.3Â°C, outdoor=8.7Â°C, offset=-0.7Â°C, flow=21.3Â°C, DM=-133[0m
[36m2025-10-27 17:42:44.237 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.3Â°C/h trend[0m
[36m2025-10-27 17:42:44.237 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 17:42:44.239 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 17:42:44.239 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 17:42:44.239 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=21.6[0m
[36m2025-10-27 17:42:44.239 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:42:44.244 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 17:42:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:42:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 17:42:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 52 quarters available, need 3 quarters (45 min), lookahead 13.0h[0m
[36m2025-10-27 17:42:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 50 windows evaluated[0m
[36m2025-10-27 17:42:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (10.0h away) â† SELECTED[0m
[36m2025-10-27 17:42:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (9.8h away)[0m
[36m2025-10-27 17:42:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (10.3h away)[0m
[36m2025-10-27 17:42:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (9.5h away)[0m
[36m2025-10-27 17:42:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (9.3h away)[0m
[32m2025-10-27 17:42:44.245 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 10.0h away[0m
[32m2025-10-27 17:42:44.245 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 21.6Â°C (safe >= 15.0Â°C), next window at 03:45 (10.0h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 17:42:44.249 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 17:42:44.249 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:42:44.249 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 17:42:44.249 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 52 quarters available, need 3 quarters (45 min), lookahead 13.0h[0m
[36m2025-10-27 17:42:44.250 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 50 windows evaluated[0m
[36m2025-10-27 17:42:44.250 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (10.0h away) â† SELECTED[0m
[36m2025-10-27 17:42:44.250 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (9.8h away)[0m
[36m2025-10-27 17:42:44.250 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (10.3h away)[0m
[36m2025-10-27 17:42:44.250 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (9.5h away)[0m
[36m2025-10-27 17:42:44.250 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (9.3h away)[0m
[32m2025-10-27 17:42:44.250 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 10.0h away[0m
[32m2025-10-27 17:42:44.250 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 21.6Â°C (safe >= 15.0Â°C), next window at 03:45 (10.0h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 17:42:44.250 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_SAFETY_WAITING_WINDOW_IN_10.0H_@7.4)[0m
[36m2025-10-27 17:42:44.250 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.028 seconds (success: True)[0m
[36m2025-10-27 17:42:44.252 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.5 + 1.0 + 0.6)A Ã— 0.95 = 1.39 kW[0m
[36m2025-10-27 17:42:44.252 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[33m2025-10-27 17:44:03.051 WARNING (MainThread) [homeassistant.components.automation.led_tak_groventre] LED TAK GROVENTRE: Already running[0m
[36m2025-10-27 17:47:44.222 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 17:47:44.223 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.3Â°C (median of 9 sensors: 24.6Â°C, 21.9Â°C, 22.2Â°C, 23.1Â°C, 25.7Â°C, 23.5Â°C, 23.3Â°C, 23.2Â°C, 25.0Â°C)[0m
[36m2025-10-27 17:47:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -141.0[0m
[36m2025-10-27 17:47:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 21.6Â°C[0m
[36m2025-10-27 17:47:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 21.3Â°C[0m
[36m2025-10-27 17:47:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.5A, L2=1.0A, L3=0.6A[0m
[36m2025-10-27 17:47:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.3Â°C, outdoor 8.7Â°C, flow 21.3Â°C, DM -141[0m
[36m2025-10-27 17:47:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor Hz not available from NIBE adapter[0m
[36m2025-10-27 17:47:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 17:47:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 17:47:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 17:47:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 17:47:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 17:47:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 17:47:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 17:47:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 17:47:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 17:47:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 17:47:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 120}[0m
[36m2025-10-27 17:47:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 17:47:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 17:47:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 17:47:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 17:47:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 17:47:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 17:47:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 17:47:44.224 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 17:47:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q71 = 170.61 Ã¶re/kWh[0m
[36m2025-10-27 17:47:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 17:47:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 17:47:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 17:47:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 17:47:44.225 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 17:47:44.225 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 17:47:44.225 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 17:47:44.226 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 17:47:44.227 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 17:47:44.227 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 17:47:44.227 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:47:44.227 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.7Â°C: normal -106 to -306, warning -306[0m
[36m2025-10-27 17:47:44.227 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:47:44.227 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -306 (base: -306), critical -1500[0m
[36m2025-10-27 17:47:44.227 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.7Â°C, indoor_target=21.0Â°C, temp_diff=12.3Â°C, HC=0.180 kW/K -> flow=25.7Â°C[0m
[36m2025-10-27 17:47:44.228 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 17:47:44.228 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 17:47:44.228 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.2Â°C, current=21.3Â°C, error=4.9Â°C, sensitivity=1.5 -> offset=3.3[0m
[36m2025-10-27 17:47:44.228 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 17:47:44.228 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 21.3Â°C â†’ offset: +3.3Â°C; Weight: 0.24[0m
[36m2025-10-27 17:47:44.228 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Price classification Q71 (17:47): 170.61 â†’ PEAK[0m
[32m2025-10-27 17:47:44.228 INFO (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.68Â°C - Peak: PREDICTIVE avoidance (predicted 0.6 kW, gentle cooling, Q71) | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 21.3Â°C â†’ offset: +3.3Â°C; Weight: 0.24 | GE-Spot Q71: PEAK (day) | Too warm: 2.3Â°C over (boosted 15%: cooling -0.34Â°C/h)[0m
[32m2025-10-27 17:47:44.228 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.68Â°C, reasoning: Peak: PREDICTIVE avoidance (predicted 0.6 kW, gentle cooling, Q71) | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 21.3Â°C â†’ offset: +3.3Â°C; Weight: 0.24 | GE-Spot Q71: PEAK (day) | Too warm: 2.3Â°C over (boosted 15%: cooling -0.34Â°C/h)[0m
[36m2025-10-27 17:47:44.229 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=-0.68Â°C, integer=0Â°C, fractional=-0.68Â°C, accumulator_before=-0.29Â°C[0m
[36m2025-10-27 17:47:44.229 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: -0.97Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-27 17:47:44.229 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset -0.68Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 17:47:44.229 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.000 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 17:47:44.229 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-27 17:47:44.229 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.3Â°C, outdoor=8.7Â°C, offset=-0.7Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 17:47:44.229 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.3Â°C, outdoor=8.7Â°C, offset=-0.7Â°C, flow=21.3Â°C, DM=-141[0m
[36m2025-10-27 17:47:44.229 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-27 17:47:44.229 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 17:47:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 17:47:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 17:47:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=21.6[0m
[36m2025-10-27 17:47:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:47:44.234 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 17:47:44.234 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:47:44.234 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 17:47:44.234 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 52 quarters available, need 3 quarters (45 min), lookahead 13.0h[0m
[36m2025-10-27 17:47:44.235 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 50 windows evaluated[0m
[36m2025-10-27 17:47:44.235 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (10.0h away) â† SELECTED[0m
[36m2025-10-27 17:47:44.235 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (9.7h away)[0m
[36m2025-10-27 17:47:44.235 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (10.2h away)[0m
[36m2025-10-27 17:47:44.235 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (9.5h away)[0m
[36m2025-10-27 17:47:44.235 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (9.2h away)[0m
[32m2025-10-27 17:47:44.235 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 10.0h away[0m
[32m2025-10-27 17:47:44.235 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 21.6Â°C (safe >= 15.0Â°C), next window at 03:45 (10.0h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 17:47:44.237 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 17:47:44.237 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:47:44.237 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 17:47:44.237 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 52 quarters available, need 3 quarters (45 min), lookahead 13.0h[0m
[36m2025-10-27 17:47:44.238 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 50 windows evaluated[0m
[36m2025-10-27 17:47:44.238 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (10.0h away) â† SELECTED[0m
[36m2025-10-27 17:47:44.238 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (9.7h away)[0m
[36m2025-10-27 17:47:44.238 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (10.2h away)[0m
[36m2025-10-27 17:47:44.238 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (9.5h away)[0m
[36m2025-10-27 17:47:44.238 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (9.2h away)[0m
[32m2025-10-27 17:47:44.238 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 10.0h away[0m
[32m2025-10-27 17:47:44.238 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 21.6Â°C (safe >= 15.0Â°C), next window at 03:45 (10.0h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 17:47:44.238 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_SAFETY_WAITING_WINDOW_IN_10.0H_@7.4)[0m
[36m2025-10-27 17:47:44.238 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.016 seconds (success: True)[0m
[36m2025-10-27 17:47:44.240 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.5 + 1.0 + 0.6)A Ã— 0.95 = 1.39 kW[0m
[36m2025-10-27 17:47:44.240 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 17:52:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 17:52:44.223 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.3Â°C (median of 9 sensors: 24.6Â°C, 21.9Â°C, 22.3Â°C, 23.0Â°C, 25.7Â°C, 23.5Â°C, 23.3Â°C, 23.2Â°C, 25.0Â°C)[0m
[36m2025-10-27 17:52:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -162.0[0m
[36m2025-10-27 17:52:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 21.6Â°C[0m
[36m2025-10-27 17:52:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 21.3Â°C[0m
[36m2025-10-27 17:52:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.5A, L2=1.0A, L3=0.6A[0m
[36m2025-10-27 17:52:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.3Â°C, outdoor 8.7Â°C, flow 21.3Â°C, DM -162[0m
[36m2025-10-27 17:52:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor Hz not available from NIBE adapter[0m
[36m2025-10-27 17:52:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 17:52:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 17:52:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 17:52:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 17:52:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 17:52:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 17:52:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 17:52:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 17:52:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 17:52:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 17:52:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 120}[0m
[36m2025-10-27 17:52:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 17:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 17:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 17:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 17:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 17:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 17:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 17:52:44.224 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 17:52:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q71 = 170.61 Ã¶re/kWh[0m
[36m2025-10-27 17:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 17:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 17:52:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 17:52:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 17:52:44.225 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 17:52:44.225 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 17:52:44.226 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 17:52:44.227 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 17:52:44.231 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 17:52:44.232 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 17:52:44.232 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:52:44.232 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.7Â°C: normal -106 to -306, warning -306[0m
[36m2025-10-27 17:52:44.232 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:52:44.232 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -306 (base: -306), critical -1500[0m
[36m2025-10-27 17:52:44.232 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.7Â°C, indoor_target=21.0Â°C, temp_diff=12.3Â°C, HC=0.180 kW/K -> flow=25.7Â°C[0m
[36m2025-10-27 17:52:44.232 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 17:52:44.232 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 17:52:44.232 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.2Â°C, current=21.3Â°C, error=4.9Â°C, sensitivity=1.5 -> offset=3.3[0m
[36m2025-10-27 17:52:44.232 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 17:52:44.232 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 21.3Â°C â†’ offset: +3.3Â°C; Weight: 0.23; Deferred: Light debt (DM -162)[0m
[36m2025-10-27 17:52:44.233 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Price classification Q71 (17:52): 170.61 â†’ PEAK[0m
[32m2025-10-27 17:52:44.233 INFO (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.72Â°C - Peak: PREDICTIVE avoidance (predicted 0.6 kW, gentle cooling, Q71) | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 21.3Â°C â†’ offset: +3.3Â°C; Weight: 0.23; Deferred: Light debt (DM -162) | GE-Spot Q71: PEAK (day) | Too warm: 2.3Â°C over (boosted 15%: cooling -0.34Â°C/h)[0m
[32m2025-10-27 17:52:44.233 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.72Â°C, reasoning: Peak: PREDICTIVE avoidance (predicted 0.6 kW, gentle cooling, Q71) | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 21.3Â°C â†’ offset: +3.3Â°C; Weight: 0.23; Deferred: Light debt (DM -162) | GE-Spot Q71: PEAK (day) | Too warm: 2.3Â°C over (boosted 15%: cooling -0.34Â°C/h)[0m
[36m2025-10-27 17:52:44.233 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=-0.72Â°C, integer=0Â°C, fractional=-0.72Â°C, accumulator_before=-0.97Â°C[0m
[32m2025-10-27 17:52:44.233 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] âœ“ Accumulated fractional offset reached threshold: applying -1Â°C adjustment (accumulator: -1.69Â°C â†’ -0.69Â°C)[0m
[36m2025-10-27 17:52:44.233 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Accumulator triggered: total_accumulated=-1.69Â°C, adjustment=-1Â°C, new_integer=-1Â°C, remaining=-0.69Â°C[0m
[36m2025-10-27 17:52:44.233 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset -0.72Â°C â†’ applying -1Â°C (accumulator: -0.69Â°C, needs 0.31Â°C more to trigger)[0m
[32m2025-10-27 17:52:44.236 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to -1Â°C (calculated: -0.72Â°C, accumulator: -0.69Â°C)[0m
[36m2025-10-27 17:52:44.236 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=-1Â°C, original=-0.72Â°C, accumulator=-0.69Â°C[0m
[32m2025-10-27 17:52:44.236 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset -0.72Â°C to NIBE via MyUplink[0m
[36m2025-10-27 17:52:44.236 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.000 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 17:52:44.236 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-27 17:52:44.236 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.3Â°C, outdoor=8.7Â°C, offset=-0.7Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 17:52:44.236 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.3Â°C, outdoor=8.7Â°C, offset=-0.7Â°C, flow=21.3Â°C, DM=-162[0m
[36m2025-10-27 17:52:44.238 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.3Â°C/h trend[0m
[36m2025-10-27 17:52:44.238 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 17:52:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 17:52:44.241 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 17:52:44.241 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=21.6[0m
[36m2025-10-27 17:52:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:52:44.243 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 17:52:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:52:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 17:52:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 52 quarters available, need 3 quarters (45 min), lookahead 13.0h[0m
[36m2025-10-27 17:52:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 50 windows evaluated[0m
[36m2025-10-27 17:52:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (9.9h away) â† SELECTED[0m
[36m2025-10-27 17:52:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (9.6h away)[0m
[36m2025-10-27 17:52:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (10.1h away)[0m
[36m2025-10-27 17:52:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (9.4h away)[0m
[36m2025-10-27 17:52:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (9.1h away)[0m
[32m2025-10-27 17:52:44.244 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 9.9h away[0m
[32m2025-10-27 17:52:44.244 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 21.6Â°C (safe >= 15.0Â°C), next window at 03:45 (9.9h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 17:52:44.247 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 17:52:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:52:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 17:52:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 52 quarters available, need 3 quarters (45 min), lookahead 13.0h[0m
[36m2025-10-27 17:52:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 50 windows evaluated[0m
[36m2025-10-27 17:52:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (9.9h away) â† SELECTED[0m
[36m2025-10-27 17:52:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (9.6h away)[0m
[36m2025-10-27 17:52:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (10.1h away)[0m
[36m2025-10-27 17:52:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (9.4h away)[0m
[36m2025-10-27 17:52:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (9.1h away)[0m
[32m2025-10-27 17:52:44.247 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 9.9h away[0m
[32m2025-10-27 17:52:44.248 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 21.6Â°C (safe >= 15.0Â°C), next window at 03:45 (9.9h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 17:52:44.248 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_SAFETY_WAITING_WINDOW_IN_9.9H_@7.4)[0m
[36m2025-10-27 17:52:44.248 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.025 seconds (success: True)[0m
[36m2025-10-27 17:52:44.249 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.5 + 1.0 + 0.6)A Ã— 0.95 = 1.39 kW[0m
[36m2025-10-27 17:52:44.249 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 17:57:44.222 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 17:57:44.223 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.3Â°C (median of 9 sensors: 24.1Â°C, 21.9Â°C, 22.3Â°C, 23.1Â°C, 25.7Â°C, 23.5Â°C, 23.3Â°C, 23.2Â°C, 25.0Â°C)[0m
[36m2025-10-27 17:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -184.0[0m
[36m2025-10-27 17:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 21.1Â°C[0m
[36m2025-10-27 17:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 21.3Â°C[0m
[36m2025-10-27 17:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=9.1A, L2=1.9A, L3=0.6A[0m
[36m2025-10-27 17:57:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.3Â°C, outdoor 8.7Â°C, flow 21.3Â°C, DM -184[0m
[36m2025-10-27 17:57:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor Hz not available from NIBE adapter[0m
[36m2025-10-27 17:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 17:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 17:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 17:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 17:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 17:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 17:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 17:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 17:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 17:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 17:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 120}[0m
[36m2025-10-27 17:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 17:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 17:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 17:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 17:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 17:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 17:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 17:57:44.224 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 17:57:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q71 = 170.61 Ã¶re/kWh[0m
[36m2025-10-27 17:57:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 17:57:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 17:57:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 17:57:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 17:57:44.225 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 17:57:44.225 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 17:57:44.225 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 17:57:44.226 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 17:57:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 17:57:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 17:57:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:57:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.7Â°C: normal -106 to -306, warning -306[0m
[36m2025-10-27 17:57:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:57:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -306 (base: -306), critical -1500[0m
[36m2025-10-27 17:57:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.7Â°C, indoor_target=21.0Â°C, temp_diff=12.3Â°C, HC=0.180 kW/K -> flow=25.7Â°C[0m
[36m2025-10-27 17:57:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 17:57:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 17:57:44.229 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.2Â°C, current=21.3Â°C, error=4.9Â°C, sensitivity=1.5 -> offset=3.3[0m
[36m2025-10-27 17:57:44.229 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 17:57:44.229 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 21.3Â°C â†’ offset: +3.3Â°C; Weight: 0.23; Deferred: Light debt (DM -184)[0m
[36m2025-10-27 17:57:44.229 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Price classification Q71 (17:57): 170.61 â†’ PEAK[0m
[32m2025-10-27 17:57:44.229 INFO (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.72Â°C - Peak: PREDICTIVE avoidance (predicted 0.6 kW, gentle cooling, Q71) | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 21.3Â°C â†’ offset: +3.3Â°C; Weight: 0.23; Deferred: Light debt (DM -184) | GE-Spot Q71: PEAK (day) | Too warm: 2.3Â°C over (boosted 15%: cooling -0.34Â°C/h)[0m
[32m2025-10-27 17:57:44.229 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.72Â°C, reasoning: Peak: PREDICTIVE avoidance (predicted 0.6 kW, gentle cooling, Q71) | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 21.3Â°C â†’ offset: +3.3Â°C; Weight: 0.23; Deferred: Light debt (DM -184) | GE-Spot Q71: PEAK (day) | Too warm: 2.3Â°C over (boosted 15%: cooling -0.34Â°C/h)[0m
[36m2025-10-27 17:57:44.229 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset -0.72Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-27 17:57:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.000 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 17:57:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-27 17:57:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.3Â°C, outdoor=8.7Â°C, offset=-0.7Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 17:57:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.3Â°C, outdoor=8.7Â°C, offset=-0.7Â°C, flow=21.3Â°C, DM=-184[0m
[36m2025-10-27 17:57:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-27 17:57:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 17:57:44.232 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 17:57:44.232 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 17:57:44.232 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=21.1[0m
[36m2025-10-27 17:57:44.232 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:57:44.237 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 17:57:44.237 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:57:44.237 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 17:57:44.237 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 52 quarters available, need 3 quarters (45 min), lookahead 13.0h[0m
[36m2025-10-27 17:57:44.237 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 50 windows evaluated[0m
[36m2025-10-27 17:57:44.237 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (9.8h away) â† SELECTED[0m
[36m2025-10-27 17:57:44.237 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (9.5h away)[0m
[36m2025-10-27 17:57:44.237 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (10.0h away)[0m
[36m2025-10-27 17:57:44.237 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (9.3h away)[0m
[36m2025-10-27 17:57:44.237 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (9.0h away)[0m
[32m2025-10-27 17:57:44.237 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 9.8h away[0m
[32m2025-10-27 17:57:44.237 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 21.1Â°C (safe >= 15.0Â°C), next window at 03:45 (9.8h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 17:57:44.239 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 17:57:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 17:57:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 17:57:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 52 quarters available, need 3 quarters (45 min), lookahead 13.0h[0m
[36m2025-10-27 17:57:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 50 windows evaluated[0m
[36m2025-10-27 17:57:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (9.8h away) â† SELECTED[0m
[36m2025-10-27 17:57:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (9.5h away)[0m
[36m2025-10-27 17:57:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (10.0h away)[0m
[36m2025-10-27 17:57:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (9.3h away)[0m
[36m2025-10-27 17:57:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (9.0h away)[0m
[32m2025-10-27 17:57:44.240 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 9.8h away[0m
[32m2025-10-27 17:57:44.240 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 21.1Â°C (safe >= 15.0Â°C), next window at 03:45 (9.8h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 17:57:44.240 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_SAFETY_WAITING_WINDOW_IN_9.8H_@7.4)[0m
[36m2025-10-27 17:57:44.241 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.018 seconds (success: True)[0m
[36m2025-10-27 17:57:44.242 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (9.1 + 1.9 + 0.6)A Ã— 0.95 = 2.64 kW[0m
[36m2025-10-27 17:57:44.242 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 18:02:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 18:02:44.223 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.3Â°C (median of 9 sensors: 24.1Â°C, 21.9Â°C, 22.3Â°C, 23.1Â°C, 25.7Â°C, 23.5Â°C, 23.3Â°C, 23.2Â°C, 25.0Â°C)[0m
[36m2025-10-27 18:02:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -190.0[0m
[36m2025-10-27 18:02:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 21.1Â°C[0m
[36m2025-10-27 18:02:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 21.3Â°C[0m
[36m2025-10-27 18:02:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=9.2A, L2=1.9A, L3=0.6A[0m
[36m2025-10-27 18:02:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.3Â°C, outdoor 8.7Â°C, flow 21.3Â°C, DM -190[0m
[36m2025-10-27 18:02:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor Hz not available from NIBE adapter[0m
[36m2025-10-27 18:02:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 18:02:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 18:02:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 18:02:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 18:02:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 18:02:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 18:02:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 18:02:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 18:02:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 18:02:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 18:02:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 119}[0m
[36m2025-10-27 18:02:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 18:02:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 18:02:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 18:02:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 18:02:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 18:02:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 18:02:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 18:02:44.224 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 18:02:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q72 = 135.04 Ã¶re/kWh[0m
[36m2025-10-27 18:02:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 18:02:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 18:02:44.226 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 18:02:44.226 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 18:02:44.226 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 18:02:44.226 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 18:02:44.226 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 18:02:44.227 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 18:02:44.227 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 18:02:44.228 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 18:02:44.228 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:02:44.228 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.7Â°C: normal -106 to -306, warning -306[0m
[36m2025-10-27 18:02:44.228 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:02:44.228 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -306 (base: -306), critical -1500[0m
[36m2025-10-27 18:02:44.228 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.7Â°C, indoor_target=21.0Â°C, temp_diff=12.3Â°C, HC=0.180 kW/K -> flow=25.7Â°C[0m
[36m2025-10-27 18:02:44.228 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 18:02:44.228 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 18:02:44.228 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.2Â°C, current=21.3Â°C, error=4.9Â°C, sensitivity=1.5 -> offset=3.3[0m
[36m2025-10-27 18:02:44.228 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 18:02:44.228 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 21.3Â°C â†’ offset: +3.3Â°C; Weight: 0.23; Deferred: Light debt (DM -190)[0m
[36m2025-10-27 18:02:44.228 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Price classification Q72 (18:02): 135.04 â†’ PEAK[0m
[32m2025-10-27 18:02:44.229 INFO (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.29Â°C - Peak: PREDICTIVE avoidance (predicted 0.6 kW, gentle cooling, Q72) | Learned pre-heat: Pre-heating: predicted drop 0.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 21.3Â°C â†’ offset: +3.3Â°C; Weight: 0.23; Deferred: Light debt (DM -190) | GE-Spot Q72: PEAK (day) | Too warm: 2.3Â°C over (boosted 15%: cooling -0.34Â°C/h)[0m
[32m2025-10-27 18:02:44.231 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.29Â°C, reasoning: Peak: PREDICTIVE avoidance (predicted 0.6 kW, gentle cooling, Q72) | Learned pre-heat: Pre-heating: predicted drop 0.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 21.3Â°C â†’ offset: +3.3Â°C; Weight: 0.23; Deferred: Light debt (DM -190) | GE-Spot Q72: PEAK (day) | Too warm: 2.3Â°C over (boosted 15%: cooling -0.34Â°C/h)[0m
[36m2025-10-27 18:02:44.231 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=-0.29Â°C, integer=0Â°C, fractional=-0.29Â°C, accumulator_before=-0.69Â°C[0m
[36m2025-10-27 18:02:44.231 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: -0.98Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-27 18:02:44.231 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset -0.29Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 18:02:44.231 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.000 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 18:02:44.231 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-27 18:02:44.231 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.3Â°C, outdoor=8.7Â°C, offset=-0.3Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 18:02:44.231 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.3Â°C, outdoor=8.7Â°C, offset=-0.3Â°C, flow=21.3Â°C, DM=-190[0m
[36m2025-10-27 18:02:44.237 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.3Â°C/h trend[0m
[36m2025-10-27 18:02:44.237 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 18:02:44.238 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 18:02:44.238 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 18:02:44.238 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=21.1[0m
[36m2025-10-27 18:02:44.238 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:02:44.240 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 18:02:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:02:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 18:02:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 48 quarters available, need 3 quarters (45 min), lookahead 12.0h[0m
[36m2025-10-27 18:02:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 46 windows evaluated[0m
[36m2025-10-27 18:02:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (9.7h away) â† SELECTED[0m
[36m2025-10-27 18:02:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (9.5h away)[0m
[36m2025-10-27 18:02:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (10.0h away)[0m
[36m2025-10-27 18:02:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (9.2h away)[0m
[36m2025-10-27 18:02:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (9.0h away)[0m
[32m2025-10-27 18:02:44.241 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 9.7h away[0m
[32m2025-10-27 18:02:44.241 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 21.1Â°C (safe >= 15.0Â°C), next window at 03:45 (9.7h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 18:02:44.243 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 18:02:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:02:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 18:02:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 48 quarters available, need 3 quarters (45 min), lookahead 12.0h[0m
[36m2025-10-27 18:02:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 46 windows evaluated[0m
[36m2025-10-27 18:02:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (9.7h away) â† SELECTED[0m
[36m2025-10-27 18:02:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (9.5h away)[0m
[36m2025-10-27 18:02:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (10.0h away)[0m
[36m2025-10-27 18:02:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (9.2h away)[0m
[36m2025-10-27 18:02:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (9.0h away)[0m
[32m2025-10-27 18:02:44.244 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 9.7h away[0m
[32m2025-10-27 18:02:44.244 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 21.1Â°C (safe >= 15.0Â°C), next window at 03:45 (9.7h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 18:02:44.244 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_SAFETY_WAITING_WINDOW_IN_9.7H_@7.4)[0m
[36m2025-10-27 18:02:44.244 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.021 seconds (success: True)[0m
[36m2025-10-27 18:02:44.246 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (9.2 + 1.9 + 0.6)A Ã— 0.95 = 2.67 kW[0m
[36m2025-10-27 18:02:44.246 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 18:07:44.222 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 18:07:44.222 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.3Â°C (median of 9 sensors: 24.1Â°C, 21.9Â°C, 22.3Â°C, 23.1Â°C, 25.6Â°C, 23.4Â°C, 23.3Â°C, 23.1Â°C, 25.0Â°C)[0m
[36m2025-10-27 18:07:44.222 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -192.0[0m
[36m2025-10-27 18:07:44.222 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 20.6Â°C[0m
[36m2025-10-27 18:07:44.222 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 21.3Â°C[0m
[36m2025-10-27 18:07:44.222 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=9.2A, L2=1.9A, L3=0.6A[0m
[36m2025-10-27 18:07:44.222 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.3Â°C, outdoor 8.7Â°C, flow 21.3Â°C, DM -192[0m
[36m2025-10-27 18:07:44.222 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor Hz not available from NIBE adapter[0m
[36m2025-10-27 18:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 18:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 18:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 18:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 18:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 18:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 18:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 18:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 18:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 18:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 18:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 119}[0m
[36m2025-10-27 18:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 18:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 18:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 18:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 18:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 18:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 18:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 18:07:44.223 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 18:07:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q72 = 135.04 Ã¶re/kWh[0m
[36m2025-10-27 18:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 18:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 18:07:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 18:07:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 18:07:44.225 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 18:07:44.225 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 18:07:44.225 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 18:07:44.229 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 18:07:44.229 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 18:07:44.229 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 18:07:44.229 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:07:44.230 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.7Â°C: normal -106 to -306, warning -306[0m
[36m2025-10-27 18:07:44.230 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:07:44.230 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -306 (base: -306), critical -1500[0m
[36m2025-10-27 18:07:44.230 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.7Â°C, indoor_target=21.0Â°C, temp_diff=12.3Â°C, HC=0.180 kW/K -> flow=25.7Â°C[0m
[36m2025-10-27 18:07:44.230 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 18:07:44.230 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 18:07:44.230 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.2Â°C, current=21.3Â°C, error=4.9Â°C, sensitivity=1.5 -> offset=3.3[0m
[36m2025-10-27 18:07:44.230 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 18:07:44.230 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 21.3Â°C â†’ offset: +3.3Â°C; Weight: 0.23; Deferred: Light debt (DM -192)[0m
[36m2025-10-27 18:07:44.230 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Price classification Q72 (18:07): 135.04 â†’ PEAK[0m
[32m2025-10-27 18:07:44.231 INFO (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.29Â°C - Peak: PREDICTIVE avoidance (predicted 0.6 kW, gentle cooling, Q72) | Learned pre-heat: Pre-heating: predicted drop 0.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 21.3Â°C â†’ offset: +3.3Â°C; Weight: 0.23; Deferred: Light debt (DM -192) | GE-Spot Q72: PEAK (day) | Too warm: 2.3Â°C over (boosted 15%: cooling -0.34Â°C/h)[0m
[32m2025-10-27 18:07:44.231 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.29Â°C, reasoning: Peak: PREDICTIVE avoidance (predicted 0.6 kW, gentle cooling, Q72) | Learned pre-heat: Pre-heating: predicted drop 0.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 21.3Â°C â†’ offset: +3.3Â°C; Weight: 0.23; Deferred: Light debt (DM -192) | GE-Spot Q72: PEAK (day) | Too warm: 2.3Â°C over (boosted 15%: cooling -0.34Â°C/h)[0m
[36m2025-10-27 18:07:44.231 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=-0.29Â°C, integer=0Â°C, fractional=-0.29Â°C, accumulator_before=-0.98Â°C[0m
[32m2025-10-27 18:07:44.231 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] âœ“ Accumulated fractional offset reached threshold: applying -1Â°C adjustment (accumulator: -1.28Â°C â†’ -0.28Â°C)[0m
[36m2025-10-27 18:07:44.231 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Accumulator triggered: total_accumulated=-1.28Â°C, adjustment=-1Â°C, new_integer=-1Â°C, remaining=-0.28Â°C[0m
[36m2025-10-27 18:07:44.231 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset -0.29Â°C â†’ applying -1Â°C (accumulator: -0.28Â°C, needs 0.72Â°C more to trigger)[0m
[32m2025-10-27 18:07:44.232 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to -1Â°C (calculated: -0.29Â°C, accumulator: -0.28Â°C)[0m
[36m2025-10-27 18:07:44.233 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=-1Â°C, original=-0.29Â°C, accumulator=-0.28Â°C[0m
[32m2025-10-27 18:07:44.233 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset -0.29Â°C to NIBE via MyUplink[0m
[36m2025-10-27 18:07:44.233 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.000 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 18:07:44.233 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-27 18:07:44.233 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.3Â°C, outdoor=8.7Â°C, offset=-0.3Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 18:07:44.233 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.3Â°C, outdoor=8.7Â°C, offset=-0.3Â°C, flow=21.3Â°C, DM=-192[0m
[36m2025-10-27 18:07:44.237 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.3Â°C/h trend[0m
[36m2025-10-27 18:07:44.237 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 18:07:44.239 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 18:07:44.239 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 18:07:44.239 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=20.6[0m
[36m2025-10-27 18:07:44.239 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:07:44.242 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 18:07:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:07:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 18:07:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 48 quarters available, need 3 quarters (45 min), lookahead 12.0h[0m
[36m2025-10-27 18:07:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 46 windows evaluated[0m
[36m2025-10-27 18:07:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (9.6h away) â† SELECTED[0m
[36m2025-10-27 18:07:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (9.4h away)[0m
[36m2025-10-27 18:07:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (9.9h away)[0m
[36m2025-10-27 18:07:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (9.1h away)[0m
[36m2025-10-27 18:07:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (8.9h away)[0m
[32m2025-10-27 18:07:44.243 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 9.6h away[0m
[32m2025-10-27 18:07:44.243 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 20.6Â°C (safe >= 15.0Â°C), next window at 03:45 (9.6h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 18:07:44.247 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 18:07:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:07:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 18:07:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 48 quarters available, need 3 quarters (45 min), lookahead 12.0h[0m
[36m2025-10-27 18:07:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 46 windows evaluated[0m
[36m2025-10-27 18:07:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (9.6h away) â† SELECTED[0m
[36m2025-10-27 18:07:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (9.4h away)[0m
[36m2025-10-27 18:07:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (9.9h away)[0m
[36m2025-10-27 18:07:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (9.1h away)[0m
[36m2025-10-27 18:07:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (8.9h away)[0m
[32m2025-10-27 18:07:44.248 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 9.6h away[0m
[32m2025-10-27 18:07:44.248 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 20.6Â°C (safe >= 15.0Â°C), next window at 03:45 (9.6h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 18:07:44.248 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_SAFETY_WAITING_WINDOW_IN_9.6H_@7.4)[0m
[36m2025-10-27 18:07:44.248 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.026 seconds (success: True)[0m
[36m2025-10-27 18:07:44.250 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (9.2 + 1.9 + 0.6)A Ã— 0.95 = 2.67 kW[0m
[36m2025-10-27 18:07:44.250 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 18:12:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 18:12:44.224 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.3Â°C (median of 9 sensors: 24.1Â°C, 21.9Â°C, 22.2Â°C, 23.0Â°C, 25.6Â°C, 23.4Â°C, 23.3Â°C, 23.1Â°C, 25.0Â°C)[0m
[36m2025-10-27 18:12:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -198.0[0m
[36m2025-10-27 18:12:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 20.6Â°C[0m
[36m2025-10-27 18:12:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 21.3Â°C[0m
[36m2025-10-27 18:12:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.7A, L2=3.2A, L3=0.6A[0m
[36m2025-10-27 18:12:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.3Â°C, outdoor 8.7Â°C, flow 21.3Â°C, DM -198[0m
[36m2025-10-27 18:12:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor Hz not available from NIBE adapter[0m
[36m2025-10-27 18:12:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 18:12:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 18:12:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 18:12:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 18:12:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 18:12:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 18:12:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 18:12:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 18:12:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 18:12:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 18:12:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 119}[0m
[36m2025-10-27 18:12:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 18:12:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 18:12:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 18:12:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 18:12:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 18:12:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 18:12:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 18:12:44.225 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 18:12:44.225 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q72 = 135.04 Ã¶re/kWh[0m
[36m2025-10-27 18:12:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 18:12:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 18:12:44.226 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 18:12:44.226 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 18:12:44.227 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 18:12:44.227 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 18:12:44.227 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 18:12:44.229 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 18:12:44.229 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 18:12:44.229 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 18:12:44.229 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:12:44.230 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.7Â°C: normal -106 to -306, warning -306[0m
[36m2025-10-27 18:12:44.230 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:12:44.230 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -306 (base: -306), critical -1500[0m
[36m2025-10-27 18:12:44.230 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.7Â°C, indoor_target=21.0Â°C, temp_diff=12.3Â°C, HC=0.180 kW/K -> flow=25.7Â°C[0m
[36m2025-10-27 18:12:44.230 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 18:12:44.230 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 18:12:44.230 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.2Â°C, current=21.3Â°C, error=4.9Â°C, sensitivity=1.5 -> offset=3.3[0m
[36m2025-10-27 18:12:44.230 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 18:12:44.230 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 21.3Â°C â†’ offset: +3.3Â°C; Weight: 0.23; Deferred: Light debt (DM -198)[0m
[36m2025-10-27 18:12:44.230 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Price classification Q72 (18:12): 135.04 â†’ PEAK[0m
[32m2025-10-27 18:12:44.230 INFO (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.29Â°C - Peak: PREDICTIVE avoidance (predicted 0.6 kW, gentle cooling, Q72) | Learned pre-heat: Pre-heating: predicted drop 0.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 21.3Â°C â†’ offset: +3.3Â°C; Weight: 0.23; Deferred: Light debt (DM -198) | GE-Spot Q72: PEAK (day) | Too warm: 2.3Â°C over (boosted 15%: cooling -0.34Â°C/h)[0m
[32m2025-10-27 18:12:44.231 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.29Â°C, reasoning: Peak: PREDICTIVE avoidance (predicted 0.6 kW, gentle cooling, Q72) | Learned pre-heat: Pre-heating: predicted drop 0.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 21.3Â°C â†’ offset: +3.3Â°C; Weight: 0.23; Deferred: Light debt (DM -198) | GE-Spot Q72: PEAK (day) | Too warm: 2.3Â°C over (boosted 15%: cooling -0.34Â°C/h)[0m
[36m2025-10-27 18:12:44.231 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset -0.29Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-27 18:12:44.231 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.023 kW from sensor.gen24_elnat_import_effekt[0m
[32m2025-10-27 18:12:44.231 INFO (MainThread) [custom_components.effektguard.coordinator] New daily peak: 0.02 kW at 18:12:44 (quarter 72, source: nibe_currents)[0m
[36m2025-10-27 18:12:44.231 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.02 kW below 0.5 kW threshold[0m
[36m2025-10-27 18:12:44.231 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.3Â°C, outdoor=8.7Â°C, offset=-0.3Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 18:12:44.231 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.3Â°C, outdoor=8.7Â°C, offset=-0.3Â°C, flow=21.3Â°C, DM=-198[0m
[36m2025-10-27 18:12:44.231 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-27 18:12:44.231 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 18:12:44.234 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 18:12:44.234 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 18:12:44.234 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=20.6[0m
[36m2025-10-27 18:12:44.234 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:12:44.237 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 18:12:44.237 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:12:44.237 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 18:12:44.238 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 48 quarters available, need 3 quarters (45 min), lookahead 12.0h[0m
[36m2025-10-27 18:12:44.238 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 46 windows evaluated[0m
[36m2025-10-27 18:12:44.238 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (9.5h away) â† SELECTED[0m
[36m2025-10-27 18:12:44.238 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (9.3h away)[0m
[36m2025-10-27 18:12:44.238 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (9.8h away)[0m
[36m2025-10-27 18:12:44.238 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (9.0h away)[0m
[36m2025-10-27 18:12:44.238 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (8.8h away)[0m
[32m2025-10-27 18:12:44.238 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 9.5h away[0m
[32m2025-10-27 18:12:44.238 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 20.6Â°C (safe >= 15.0Â°C), next window at 03:45 (9.5h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 18:12:44.240 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 18:12:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:12:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 18:12:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 48 quarters available, need 3 quarters (45 min), lookahead 12.0h[0m
[36m2025-10-27 18:12:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 46 windows evaluated[0m
[36m2025-10-27 18:12:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (9.5h away) â† SELECTED[0m
[36m2025-10-27 18:12:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (9.3h away)[0m
[36m2025-10-27 18:12:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (9.8h away)[0m
[36m2025-10-27 18:12:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (9.0h away)[0m
[36m2025-10-27 18:12:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (8.8h away)[0m
[32m2025-10-27 18:12:44.240 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 9.5h away[0m
[32m2025-10-27 18:12:44.240 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 20.6Â°C (safe >= 15.0Â°C), next window at 03:45 (9.5h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 18:12:44.241 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_SAFETY_WAITING_WINDOW_IN_9.5H_@7.4)[0m
[36m2025-10-27 18:12:44.241 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.017 seconds (success: True)[0m
[36m2025-10-27 18:12:44.242 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.7 + 3.2 + 0.6)A Ã— 0.95 = 1.94 kW[0m
[36m2025-10-27 18:12:44.242 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 18:17:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 18:17:44.223 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.3Â°C (median of 9 sensors: 24.1Â°C, 21.8Â°C, 22.2Â°C, 23.0Â°C, 25.6Â°C, 23.4Â°C, 23.3Â°C, 23.1Â°C, 25.0Â°C)[0m
[36m2025-10-27 18:17:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -201.0[0m
[36m2025-10-27 18:17:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 20.6Â°C[0m
[36m2025-10-27 18:17:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 21.3Â°C[0m
[36m2025-10-27 18:17:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.6A, L2=1.0A, L3=0.6A[0m
[36m2025-10-27 18:17:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.3Â°C, outdoor 8.7Â°C, flow 21.3Â°C, DM -201[0m
[36m2025-10-27 18:17:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor Hz not available from NIBE adapter[0m
[36m2025-10-27 18:17:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 18:17:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 18:17:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 18:17:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 18:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 18:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 18:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 18:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 18:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 18:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 18:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 118}[0m
[36m2025-10-27 18:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 18:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 18:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 18:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 18:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 18:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 18:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 18:17:44.224 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 18:17:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q73 = 135.71 Ã¶re/kWh[0m
[36m2025-10-27 18:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 18:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 18:17:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 18:17:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 18:17:44.226 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 18:17:44.226 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 18:17:44.226 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 18:17:44.229 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 18:17:44.230 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 18:17:44.230 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 18:17:44.230 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:17:44.230 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.7Â°C: normal -106 to -306, warning -306[0m
[36m2025-10-27 18:17:44.230 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:17:44.230 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -306 (base: -306), critical -1500[0m
[36m2025-10-27 18:17:44.230 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.7Â°C, indoor_target=21.0Â°C, temp_diff=12.3Â°C, HC=0.180 kW/K -> flow=25.7Â°C[0m
[36m2025-10-27 18:17:44.230 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 18:17:44.230 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 18:17:44.230 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.2Â°C, current=21.3Â°C, error=4.9Â°C, sensitivity=1.5 -> offset=3.3[0m
[36m2025-10-27 18:17:44.230 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 18:17:44.231 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 21.3Â°C â†’ offset: +3.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -201)[0m
[36m2025-10-27 18:17:44.231 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Price classification Q73 (18:17): 135.71 â†’ PEAK[0m
[32m2025-10-27 18:17:44.231 INFO (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.21Â°C - Learned pre-heat: Pre-heating: predicted drop 0.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 21.3Â°C â†’ offset: +3.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -201) | GE-Spot Q73: PEAK (day) | Too warm: 2.3Â°C over[0m
[32m2025-10-27 18:17:44.231 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.21Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 0.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 21.3Â°C â†’ offset: +3.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -201) | GE-Spot Q73: PEAK (day) | Too warm: 2.3Â°C over[0m
[36m2025-10-27 18:17:44.231 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.21Â°C, integer=0Â°C, fractional=0.21Â°C, accumulator_before=-0.28Â°C[0m
[36m2025-10-27 18:17:44.231 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: -0.06Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-27 18:17:44.231 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.21Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 18:17:44.231 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.000 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 18:17:44.231 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-27 18:17:44.231 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.3Â°C, outdoor=8.7Â°C, offset=0.2Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 18:17:44.231 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.3Â°C, outdoor=8.7Â°C, offset=0.2Â°C, flow=21.3Â°C, DM=-201[0m
[36m2025-10-27 18:17:44.238 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.0Â°C/h trend[0m
[36m2025-10-27 18:17:44.239 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 18:17:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 18:17:44.240 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 18:17:44.240 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=20.6[0m
[36m2025-10-27 18:17:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:17:44.243 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 18:17:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:17:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 18:17:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 48 quarters available, need 3 quarters (45 min), lookahead 12.0h[0m
[36m2025-10-27 18:17:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 46 windows evaluated[0m
[36m2025-10-27 18:17:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (9.5h away) â† SELECTED[0m
[36m2025-10-27 18:17:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (9.2h away)[0m
[36m2025-10-27 18:17:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (9.7h away)[0m
[36m2025-10-27 18:17:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (9.0h away)[0m
[36m2025-10-27 18:17:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (8.7h away)[0m
[32m2025-10-27 18:17:44.243 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 9.5h away[0m
[32m2025-10-27 18:17:44.244 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 20.6Â°C (safe >= 15.0Â°C), next window at 03:45 (9.5h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 18:17:44.247 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 18:17:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:17:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 18:17:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 48 quarters available, need 3 quarters (45 min), lookahead 12.0h[0m
[36m2025-10-27 18:17:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 46 windows evaluated[0m
[36m2025-10-27 18:17:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (9.5h away) â† SELECTED[0m
[36m2025-10-27 18:17:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (9.2h away)[0m
[36m2025-10-27 18:17:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (9.7h away)[0m
[36m2025-10-27 18:17:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (9.0h away)[0m
[36m2025-10-27 18:17:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (8.7h away)[0m
[32m2025-10-27 18:17:44.248 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 9.5h away[0m
[32m2025-10-27 18:17:44.248 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 20.6Â°C (safe >= 15.0Â°C), next window at 03:45 (9.5h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 18:17:44.248 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_SAFETY_WAITING_WINDOW_IN_9.5H_@7.4)[0m
[36m2025-10-27 18:17:44.248 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.025 seconds (success: True)[0m
[36m2025-10-27 18:17:44.249 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.6 + 1.0 + 0.6)A Ã— 0.95 = 1.41 kW[0m
[36m2025-10-27 18:17:44.250 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 18:22:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 18:22:44.223 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.3Â°C (median of 9 sensors: 24.1Â°C, 21.8Â°C, 22.3Â°C, 23.0Â°C, 25.6Â°C, 23.4Â°C, 23.3Â°C, 23.1Â°C, 25.0Â°C)[0m
[36m2025-10-27 18:22:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -203.0[0m
[36m2025-10-27 18:22:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 20.6Â°C[0m
[36m2025-10-27 18:22:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 21.3Â°C[0m
[36m2025-10-27 18:22:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.6A, L2=1.0A, L3=0.6A[0m
[36m2025-10-27 18:22:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.3Â°C, outdoor 8.7Â°C, flow 21.3Â°C, DM -203[0m
[36m2025-10-27 18:22:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor Hz not available from NIBE adapter[0m
[36m2025-10-27 18:22:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 18:22:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 18:22:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 18:22:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 18:22:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 18:22:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 18:22:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 18:22:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 18:22:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 18:22:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 18:22:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 118}[0m
[36m2025-10-27 18:22:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 18:22:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 18:22:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 18:22:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 18:22:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 18:22:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 18:22:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 18:22:44.224 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 18:22:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q73 = 135.71 Ã¶re/kWh[0m
[36m2025-10-27 18:22:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 18:22:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 18:22:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 18:22:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 18:22:44.225 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 18:22:44.225 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 18:22:44.226 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 18:22:44.226 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 18:22:44.227 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 18:22:44.227 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 18:22:44.227 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:22:44.227 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.7Â°C: normal -106 to -306, warning -306[0m
[36m2025-10-27 18:22:44.227 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:22:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -306 (base: -306), critical -1500[0m
[36m2025-10-27 18:22:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.7Â°C, indoor_target=21.0Â°C, temp_diff=12.3Â°C, HC=0.180 kW/K -> flow=25.7Â°C[0m
[36m2025-10-27 18:22:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 18:22:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 18:22:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.2Â°C, current=21.3Â°C, error=4.9Â°C, sensitivity=1.5 -> offset=3.3[0m
[36m2025-10-27 18:22:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 18:22:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 21.3Â°C â†’ offset: +3.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -203)[0m
[36m2025-10-27 18:22:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Price classification Q73 (18:22): 135.71 â†’ PEAK[0m
[32m2025-10-27 18:22:44.228 INFO (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.21Â°C - Learned pre-heat: Pre-heating: predicted drop 0.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 21.3Â°C â†’ offset: +3.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -203) | GE-Spot Q73: PEAK (day) | Too warm: 2.3Â°C over[0m
[32m2025-10-27 18:22:44.229 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.21Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 0.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 21.3Â°C â†’ offset: +3.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -203) | GE-Spot Q73: PEAK (day) | Too warm: 2.3Â°C over[0m
[36m2025-10-27 18:22:44.229 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.21Â°C, integer=0Â°C, fractional=0.21Â°C, accumulator_before=-0.06Â°C[0m
[36m2025-10-27 18:22:44.229 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: 0.15Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-27 18:22:44.229 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.21Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 18:22:44.229 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.000 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 18:22:44.229 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-27 18:22:44.229 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.3Â°C, outdoor=8.7Â°C, offset=0.2Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 18:22:44.229 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.3Â°C, outdoor=8.7Â°C, offset=0.2Â°C, flow=21.3Â°C, DM=-203[0m
[36m2025-10-27 18:22:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-27 18:22:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 18:22:44.231 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 18:22:44.231 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 18:22:44.231 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=20.6[0m
[36m2025-10-27 18:22:44.231 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:22:44.237 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 18:22:44.237 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:22:44.237 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 18:22:44.237 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 48 quarters available, need 3 quarters (45 min), lookahead 12.0h[0m
[36m2025-10-27 18:22:44.237 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 46 windows evaluated[0m
[36m2025-10-27 18:22:44.237 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (9.4h away) â† SELECTED[0m
[36m2025-10-27 18:22:44.237 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (9.1h away)[0m
[36m2025-10-27 18:22:44.238 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (9.6h away)[0m
[36m2025-10-27 18:22:44.238 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (8.9h away)[0m
[36m2025-10-27 18:22:44.238 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (8.6h away)[0m
[32m2025-10-27 18:22:44.238 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 9.4h away[0m
[32m2025-10-27 18:22:44.238 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 20.6Â°C (safe >= 15.0Â°C), next window at 03:45 (9.4h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 18:22:44.244 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 18:22:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:22:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 18:22:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 48 quarters available, need 3 quarters (45 min), lookahead 12.0h[0m
[36m2025-10-27 18:22:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 46 windows evaluated[0m
[36m2025-10-27 18:22:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (9.4h away) â† SELECTED[0m
[36m2025-10-27 18:22:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (9.1h away)[0m
[36m2025-10-27 18:22:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (9.6h away)[0m
[36m2025-10-27 18:22:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (8.9h away)[0m
[36m2025-10-27 18:22:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (8.6h away)[0m
[32m2025-10-27 18:22:44.245 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 9.4h away[0m
[32m2025-10-27 18:22:44.245 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 20.6Â°C (safe >= 15.0Â°C), next window at 03:45 (9.4h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 18:22:44.245 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_SAFETY_WAITING_WINDOW_IN_9.4H_@7.4)[0m
[36m2025-10-27 18:22:44.245 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.023 seconds (success: True)[0m
[36m2025-10-27 18:22:44.247 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.6 + 1.0 + 0.6)A Ã— 0.95 = 1.41 kW[0m
[36m2025-10-27 18:22:44.247 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 18:27:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 18:27:44.223 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.3Â°C (median of 9 sensors: 24.1Â°C, 21.9Â°C, 22.2Â°C, 22.9Â°C, 25.6Â°C, 23.4Â°C, 23.3Â°C, 23.1Â°C, 25.0Â°C)[0m
[36m2025-10-27 18:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -207.0[0m
[36m2025-10-27 18:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 20.1Â°C[0m
[36m2025-10-27 18:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 21.3Â°C[0m
[36m2025-10-27 18:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.6A, L2=1.0A, L3=0.6A[0m
[36m2025-10-27 18:27:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.3Â°C, outdoor 8.7Â°C, flow 21.3Â°C, DM -207[0m
[36m2025-10-27 18:27:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor Hz not available from NIBE adapter[0m
[36m2025-10-27 18:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 18:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 18:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 18:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 18:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 18:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 18:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 18:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 18:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 18:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 18:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 118}[0m
[36m2025-10-27 18:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 18:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 18:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 18:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 18:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 18:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 18:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 18:27:44.225 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 18:27:44.225 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q73 = 135.71 Ã¶re/kWh[0m
[36m2025-10-27 18:27:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 18:27:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 18:27:44.226 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 18:27:44.226 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 18:27:44.226 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 18:27:44.226 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 18:27:44.226 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 18:27:44.227 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 18:27:44.228 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 18:27:44.228 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 18:27:44.228 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:27:44.228 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.7Â°C: normal -106 to -306, warning -306[0m
[36m2025-10-27 18:27:44.228 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:27:44.228 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -306 (base: -306), critical -1500[0m
[36m2025-10-27 18:27:44.229 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.7Â°C, indoor_target=21.0Â°C, temp_diff=12.3Â°C, HC=0.180 kW/K -> flow=25.7Â°C[0m
[36m2025-10-27 18:27:44.229 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 18:27:44.229 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 18:27:44.229 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.2Â°C, current=21.3Â°C, error=4.9Â°C, sensitivity=1.5 -> offset=3.3[0m
[36m2025-10-27 18:27:44.229 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 18:27:44.229 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 21.3Â°C â†’ offset: +3.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -207)[0m
[36m2025-10-27 18:27:44.229 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Price classification Q73 (18:27): 135.71 â†’ PEAK[0m
[32m2025-10-27 18:27:44.229 INFO (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.21Â°C - Learned pre-heat: Pre-heating: predicted drop 0.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 21.3Â°C â†’ offset: +3.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -207) | GE-Spot Q73: PEAK (day) | Too warm: 2.3Â°C over[0m
[32m2025-10-27 18:27:44.231 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.21Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 0.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 21.3Â°C â†’ offset: +3.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -207) | GE-Spot Q73: PEAK (day) | Too warm: 2.3Â°C over[0m
[36m2025-10-27 18:27:44.231 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.21Â°C, integer=0Â°C, fractional=0.21Â°C, accumulator_before=0.15Â°C[0m
[36m2025-10-27 18:27:44.231 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: 0.36Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-27 18:27:44.231 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.21Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 18:27:44.231 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.000 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 18:27:44.231 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-27 18:27:44.231 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.3Â°C, outdoor=8.7Â°C, offset=0.2Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 18:27:44.231 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.3Â°C, outdoor=8.7Â°C, offset=0.2Â°C, flow=21.3Â°C, DM=-207[0m
[36m2025-10-27 18:27:44.240 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.0Â°C/h trend[0m
[36m2025-10-27 18:27:44.240 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 18:27:44.246 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved learned data to storage[0m
[36m2025-10-27 18:27:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 18:27:44.246 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 18:27:44.246 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=20.1[0m
[36m2025-10-27 18:27:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:27:44.249 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 18:27:44.249 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:27:44.249 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 18:27:44.249 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 48 quarters available, need 3 quarters (45 min), lookahead 12.0h[0m
[36m2025-10-27 18:27:44.249 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 46 windows evaluated[0m
[36m2025-10-27 18:27:44.249 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (9.3h away) â† SELECTED[0m
[36m2025-10-27 18:27:44.249 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (9.0h away)[0m
[36m2025-10-27 18:27:44.250 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (9.5h away)[0m
[36m2025-10-27 18:27:44.250 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (8.8h away)[0m
[36m2025-10-27 18:27:44.250 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (8.5h away)[0m
[32m2025-10-27 18:27:44.250 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 9.3h away[0m
[32m2025-10-27 18:27:44.250 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 20.1Â°C (safe >= 15.0Â°C), next window at 03:45 (9.3h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 18:27:44.253 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 18:27:44.253 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:27:44.253 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 18:27:44.253 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 48 quarters available, need 3 quarters (45 min), lookahead 12.0h[0m
[36m2025-10-27 18:27:44.254 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 46 windows evaluated[0m
[36m2025-10-27 18:27:44.254 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (9.3h away) â† SELECTED[0m
[36m2025-10-27 18:27:44.254 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (9.0h away)[0m
[36m2025-10-27 18:27:44.254 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (9.5h away)[0m
[36m2025-10-27 18:27:44.254 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (8.8h away)[0m
[36m2025-10-27 18:27:44.254 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (8.5h away)[0m
[32m2025-10-27 18:27:44.254 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 9.3h away[0m
[32m2025-10-27 18:27:44.254 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 20.1Â°C (safe >= 15.0Â°C), next window at 03:45 (9.3h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 18:27:44.254 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_SAFETY_WAITING_WINDOW_IN_9.3H_@7.4)[0m
[36m2025-10-27 18:27:44.254 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.031 seconds (success: True)[0m
[36m2025-10-27 18:27:44.255 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.6 + 1.0 + 0.6)A Ã— 0.95 = 1.41 kW[0m
[36m2025-10-27 18:27:44.256 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 18:32:44.222 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 18:32:44.223 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.3Â°C (median of 9 sensors: 24.1Â°C, 21.8Â°C, 22.3Â°C, 22.9Â°C, 25.5Â°C, 23.4Â°C, 23.3Â°C, 23.1Â°C, 25.0Â°C)[0m
[36m2025-10-27 18:32:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -212.0[0m
[36m2025-10-27 18:32:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 20.1Â°C[0m
[36m2025-10-27 18:32:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 21.3Â°C[0m
[36m2025-10-27 18:32:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.6A, L2=1.3A, L3=0.6A[0m
[36m2025-10-27 18:32:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.3Â°C, outdoor 8.7Â°C, flow 21.3Â°C, DM -212[0m
[36m2025-10-27 18:32:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor Hz not available from NIBE adapter[0m
[36m2025-10-27 18:32:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 18:32:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 18:32:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 18:32:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 18:32:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 18:32:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 18:32:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 18:32:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 18:32:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 18:32:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 18:32:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 117}[0m
[36m2025-10-27 18:32:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 18:32:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 18:32:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 18:32:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 18:32:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 18:32:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 18:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 18:32:44.224 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 18:32:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q74 = 158.77 Ã¶re/kWh[0m
[36m2025-10-27 18:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 18:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 18:32:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 18:32:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 18:32:44.225 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 18:32:44.225 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 18:32:44.225 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 18:32:44.226 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 18:32:44.228 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 18:32:44.228 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 18:32:44.228 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:32:44.228 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.7Â°C: normal -106 to -306, warning -306[0m
[36m2025-10-27 18:32:44.228 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:32:44.228 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -306 (base: -306), critical -1500[0m
[36m2025-10-27 18:32:44.229 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.7Â°C, indoor_target=21.0Â°C, temp_diff=12.3Â°C, HC=0.180 kW/K -> flow=25.7Â°C[0m
[36m2025-10-27 18:32:44.229 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 18:32:44.229 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 18:32:44.229 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.2Â°C, current=21.3Â°C, error=4.9Â°C, sensitivity=1.5 -> offset=3.3[0m
[36m2025-10-27 18:32:44.229 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 18:32:44.229 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 21.3Â°C â†’ offset: +3.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -212)[0m
[36m2025-10-27 18:32:44.229 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Price classification Q74 (18:32): 158.77 â†’ PEAK[0m
[32m2025-10-27 18:32:44.229 INFO (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.17Â°C - Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 21.3Â°C â†’ offset: +3.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -212) | GE-Spot Q74: PEAK (day) | Too warm: 2.3Â°C over[0m
[32m2025-10-27 18:32:44.230 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.17Â°C, reasoning: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 21.3Â°C â†’ offset: +3.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -212) | GE-Spot Q74: PEAK (day) | Too warm: 2.3Â°C over[0m
[36m2025-10-27 18:32:44.230 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=-0.17Â°C, integer=0Â°C, fractional=-0.17Â°C, accumulator_before=0.36Â°C[0m
[36m2025-10-27 18:32:44.230 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: 0.19Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-27 18:32:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset -0.17Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 18:32:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.143 kW from sensor.gen24_elnat_import_effekt[0m
[32m2025-10-27 18:32:44.230 INFO (MainThread) [custom_components.effektguard.coordinator] New daily peak: 0.14 kW at 18:32:44 (quarter 74, source: nibe_currents)[0m
[36m2025-10-27 18:32:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.14 kW below 0.5 kW threshold[0m
[36m2025-10-27 18:32:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.3Â°C, outdoor=8.7Â°C, offset=-0.2Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 18:32:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.3Â°C, outdoor=8.7Â°C, offset=-0.2Â°C, flow=21.3Â°C, DM=-212[0m
[36m2025-10-27 18:32:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-27 18:32:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 18:32:44.233 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 18:32:44.233 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 18:32:44.233 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=20.1[0m
[36m2025-10-27 18:32:44.233 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:32:44.236 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 18:32:44.236 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:32:44.236 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 18:32:44.236 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 48 quarters available, need 3 quarters (45 min), lookahead 12.0h[0m
[36m2025-10-27 18:32:44.236 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 46 windows evaluated[0m
[36m2025-10-27 18:32:44.236 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (9.2h away) â† SELECTED[0m
[36m2025-10-27 18:32:44.236 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (9.0h away)[0m
[36m2025-10-27 18:32:44.236 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (9.5h away)[0m
[36m2025-10-27 18:32:44.236 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (8.7h away)[0m
[36m2025-10-27 18:32:44.236 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (8.5h away)[0m
[32m2025-10-27 18:32:44.236 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 9.2h away[0m
[32m2025-10-27 18:32:44.236 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 20.1Â°C (safe >= 15.0Â°C), next window at 03:45 (9.2h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 18:32:44.246 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 18:32:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:32:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 18:32:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 48 quarters available, need 3 quarters (45 min), lookahead 12.0h[0m
[36m2025-10-27 18:32:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 46 windows evaluated[0m
[36m2025-10-27 18:32:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (9.2h away) â† SELECTED[0m
[36m2025-10-27 18:32:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (9.0h away)[0m
[36m2025-10-27 18:32:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (9.5h away)[0m
[36m2025-10-27 18:32:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (8.7h away)[0m
[36m2025-10-27 18:32:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (8.5h away)[0m
[32m2025-10-27 18:32:44.247 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 9.2h away[0m
[32m2025-10-27 18:32:44.247 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 20.1Â°C (safe >= 15.0Â°C), next window at 03:45 (9.2h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 18:32:44.247 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_SAFETY_WAITING_WINDOW_IN_9.2H_@7.4)[0m
[36m2025-10-27 18:32:44.247 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.024 seconds (success: True)[0m
[36m2025-10-27 18:32:44.248 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.6 + 1.3 + 0.6)A Ã— 0.95 = 1.48 kW[0m
[36m2025-10-27 18:37:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 18:37:44.223 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.3Â°C (median of 9 sensors: 24.1Â°C, 21.8Â°C, 22.3Â°C, 22.9Â°C, 25.6Â°C, 23.4Â°C, 23.3Â°C, 23.1Â°C, 25.0Â°C)[0m
[36m2025-10-27 18:37:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -216.0[0m
[36m2025-10-27 18:37:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 20.1Â°C[0m
[36m2025-10-27 18:37:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 21.3Â°C[0m
[36m2025-10-27 18:37:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.6A, L2=3.5A, L3=0.7A[0m
[36m2025-10-27 18:37:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.3Â°C, outdoor 8.7Â°C, flow 21.3Â°C, DM -216[0m
[36m2025-10-27 18:37:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor Hz not available from NIBE adapter[0m
[36m2025-10-27 18:37:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 18:37:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 18:37:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 18:37:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 18:37:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 18:37:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 18:37:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 18:37:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 18:37:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 18:37:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 18:37:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 117}[0m
[36m2025-10-27 18:37:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 18:37:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 18:37:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 18:37:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 18:37:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 18:37:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 18:37:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 18:37:44.224 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 18:37:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q74 = 158.77 Ã¶re/kWh[0m
[36m2025-10-27 18:37:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 18:37:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 18:37:44.226 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 18:37:44.226 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 18:37:44.226 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 18:37:44.226 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 18:37:44.226 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 18:37:44.227 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 18:37:44.228 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 18:37:44.228 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 18:37:44.228 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:37:44.228 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.7Â°C: normal -106 to -306, warning -306[0m
[36m2025-10-27 18:37:44.228 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:37:44.228 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -306 (base: -306), critical -1500[0m
[36m2025-10-27 18:37:44.229 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.7Â°C, indoor_target=21.0Â°C, temp_diff=12.3Â°C, HC=0.180 kW/K -> flow=25.7Â°C[0m
[36m2025-10-27 18:37:44.229 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 18:37:44.229 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 18:37:44.229 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.2Â°C, current=21.3Â°C, error=4.9Â°C, sensitivity=1.5 -> offset=3.3[0m
[36m2025-10-27 18:37:44.229 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 18:37:44.229 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 21.3Â°C â†’ offset: +3.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -216)[0m
[36m2025-10-27 18:37:44.229 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Price classification Q74 (18:37): 158.77 â†’ PEAK[0m
[32m2025-10-27 18:37:44.229 INFO (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.17Â°C - Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 21.3Â°C â†’ offset: +3.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -216) | GE-Spot Q74: PEAK (day) | Too warm: 2.3Â°C over[0m
[32m2025-10-27 18:37:44.230 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.17Â°C, reasoning: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 21.3Â°C â†’ offset: +3.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -216) | GE-Spot Q74: PEAK (day) | Too warm: 2.3Â°C over[0m
[36m2025-10-27 18:37:44.230 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=-0.17Â°C, integer=0Â°C, fractional=-0.17Â°C, accumulator_before=0.19Â°C[0m
[36m2025-10-27 18:37:44.230 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: 0.02Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-27 18:37:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset -0.17Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 18:37:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.000 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 18:37:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-27 18:37:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.3Â°C, outdoor=8.7Â°C, offset=-0.2Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 18:37:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.3Â°C, outdoor=8.7Â°C, offset=-0.2Â°C, flow=21.3Â°C, DM=-216[0m
[36m2025-10-27 18:37:44.236 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.0Â°C/h trend[0m
[36m2025-10-27 18:37:44.236 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 18:37:44.238 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 18:37:44.238 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 18:37:44.238 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=20.1[0m
[36m2025-10-27 18:37:44.238 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:37:44.241 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 18:37:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:37:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 18:37:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 48 quarters available, need 3 quarters (45 min), lookahead 12.0h[0m
[36m2025-10-27 18:37:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 46 windows evaluated[0m
[36m2025-10-27 18:37:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (9.1h away) â† SELECTED[0m
[36m2025-10-27 18:37:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (8.9h away)[0m
[36m2025-10-27 18:37:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (9.4h away)[0m
[36m2025-10-27 18:37:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (8.6h away)[0m
[36m2025-10-27 18:37:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (8.4h away)[0m
[32m2025-10-27 18:37:44.242 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 9.1h away[0m
[32m2025-10-27 18:37:44.242 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 20.1Â°C (safe >= 15.0Â°C), next window at 03:45 (9.1h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 18:37:44.249 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 18:37:44.249 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:37:44.249 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 18:37:44.249 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 48 quarters available, need 3 quarters (45 min), lookahead 12.0h[0m
[36m2025-10-27 18:37:44.250 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 46 windows evaluated[0m
[36m2025-10-27 18:37:44.250 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (9.1h away) â† SELECTED[0m
[36m2025-10-27 18:37:44.250 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (8.9h away)[0m
[36m2025-10-27 18:37:44.250 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (9.4h away)[0m
[36m2025-10-27 18:37:44.250 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (8.6h away)[0m
[36m2025-10-27 18:37:44.250 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (8.4h away)[0m
[32m2025-10-27 18:37:44.250 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 9.1h away[0m
[32m2025-10-27 18:37:44.250 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 20.1Â°C (safe >= 15.0Â°C), next window at 03:45 (9.1h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 18:37:44.250 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_SAFETY_WAITING_WINDOW_IN_9.1H_@7.4)[0m
[36m2025-10-27 18:37:44.250 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.027 seconds (success: True)[0m
[36m2025-10-27 18:37:44.251 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.6 + 3.5 + 0.7)A Ã— 0.95 = 2.01 kW[0m
[36m2025-10-27 18:42:44.222 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 18:42:44.222 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.3Â°C (median of 9 sensors: 24.1Â°C, 21.8Â°C, 22.3Â°C, 22.9Â°C, 25.5Â°C, 23.4Â°C, 23.3Â°C, 23.1Â°C, 25.0Â°C)[0m
[36m2025-10-27 18:42:44.222 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -220.0[0m
[36m2025-10-27 18:42:44.222 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 20.1Â°C[0m
[36m2025-10-27 18:42:44.222 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 21.3Â°C[0m
[36m2025-10-27 18:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.6A, L2=1.6A, L3=0.7A[0m
[36m2025-10-27 18:42:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.3Â°C, outdoor 8.7Â°C, flow 21.3Â°C, DM -220[0m
[36m2025-10-27 18:42:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor Hz not available from NIBE adapter[0m
[36m2025-10-27 18:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 18:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 18:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 18:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 18:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 18:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 18:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 18:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 18:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 18:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 18:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 117}[0m
[36m2025-10-27 18:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 18:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 18:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 18:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 18:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 18:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 18:42:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 18:42:44.223 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 18:42:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q74 = 158.77 Ã¶re/kWh[0m
[36m2025-10-27 18:42:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 18:42:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 18:42:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 18:42:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 18:42:44.225 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 18:42:44.225 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 18:42:44.225 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 18:42:44.226 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 18:42:44.227 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 18:42:44.227 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 18:42:44.227 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:42:44.227 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.7Â°C: normal -106 to -306, warning -306[0m
[36m2025-10-27 18:42:44.227 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:42:44.227 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -306 (base: -306), critical -1500[0m
[36m2025-10-27 18:42:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.7Â°C, indoor_target=21.0Â°C, temp_diff=12.3Â°C, HC=0.180 kW/K -> flow=25.7Â°C[0m
[36m2025-10-27 18:42:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 18:42:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 18:42:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.2Â°C, current=21.3Â°C, error=4.9Â°C, sensitivity=1.5 -> offset=3.3[0m
[36m2025-10-27 18:42:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 18:42:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 21.3Â°C â†’ offset: +3.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -220)[0m
[36m2025-10-27 18:42:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Price classification Q74 (18:42): 158.77 â†’ PEAK[0m
[32m2025-10-27 18:42:44.228 INFO (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.17Â°C - Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 21.3Â°C â†’ offset: +3.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -220) | GE-Spot Q74: PEAK (day) | Too warm: 2.3Â°C over[0m
[32m2025-10-27 18:42:44.230 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.17Â°C, reasoning: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 21.3Â°C â†’ offset: +3.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -220) | GE-Spot Q74: PEAK (day) | Too warm: 2.3Â°C over[0m
[36m2025-10-27 18:42:44.230 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=-0.17Â°C, integer=0Â°C, fractional=-0.17Â°C, accumulator_before=0.02Â°C[0m
[36m2025-10-27 18:42:44.230 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: -0.15Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-27 18:42:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset -0.17Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 18:42:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.000 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 18:42:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-27 18:42:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.3Â°C, outdoor=8.7Â°C, offset=-0.2Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 18:42:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.3Â°C, outdoor=8.7Â°C, offset=-0.2Â°C, flow=21.3Â°C, DM=-220[0m
[36m2025-10-27 18:42:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-27 18:42:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 18:42:44.233 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 18:42:44.233 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 18:42:44.233 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=20.1[0m
[36m2025-10-27 18:42:44.233 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:42:44.241 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 18:42:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:42:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 18:42:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 48 quarters available, need 3 quarters (45 min), lookahead 12.0h[0m
[36m2025-10-27 18:42:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 46 windows evaluated[0m
[36m2025-10-27 18:42:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (9.0h away) â† SELECTED[0m
[36m2025-10-27 18:42:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (8.8h away)[0m
[36m2025-10-27 18:42:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (9.3h away)[0m
[36m2025-10-27 18:42:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (8.5h away)[0m
[36m2025-10-27 18:42:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (8.3h away)[0m
[32m2025-10-27 18:42:44.242 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 9.0h away[0m
[32m2025-10-27 18:42:44.242 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 20.1Â°C (safe >= 15.0Â°C), next window at 03:45 (9.0h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 18:42:44.244 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 18:42:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:42:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 18:42:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 48 quarters available, need 3 quarters (45 min), lookahead 12.0h[0m
[36m2025-10-27 18:42:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 46 windows evaluated[0m
[36m2025-10-27 18:42:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (9.0h away) â† SELECTED[0m
[36m2025-10-27 18:42:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (8.8h away)[0m
[36m2025-10-27 18:42:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (9.3h away)[0m
[36m2025-10-27 18:42:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (8.5h away)[0m
[36m2025-10-27 18:42:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (8.3h away)[0m
[32m2025-10-27 18:42:44.245 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 9.0h away[0m
[32m2025-10-27 18:42:44.245 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 20.1Â°C (safe >= 15.0Â°C), next window at 03:45 (9.0h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 18:42:44.245 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_SAFETY_WAITING_WINDOW_IN_9.0H_@7.4)[0m
[36m2025-10-27 18:42:44.245 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.023 seconds (success: True)[0m
[36m2025-10-27 18:42:44.247 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.6 + 1.6 + 0.7)A Ã— 0.95 = 1.57 kW[0m
[36m2025-10-27 18:47:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 18:47:44.223 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.3Â°C (median of 9 sensors: 24.1Â°C, 21.8Â°C, 22.3Â°C, 22.9Â°C, 25.5Â°C, 23.3Â°C, 23.3Â°C, 23.1Â°C, 25.0Â°C)[0m
[36m2025-10-27 18:47:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -225.0[0m
[36m2025-10-27 18:47:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 20.1Â°C[0m
[36m2025-10-27 18:47:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 21.3Â°C[0m
[36m2025-10-27 18:47:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.6A, L2=1.6A, L3=0.7A[0m
[36m2025-10-27 18:47:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.3Â°C, outdoor 8.7Â°C, flow 21.3Â°C, DM -225[0m
[36m2025-10-27 18:47:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor Hz not available from NIBE adapter[0m
[36m2025-10-27 18:47:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 18:47:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 18:47:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 18:47:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 18:47:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 18:47:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 18:47:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 18:47:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 18:47:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 18:47:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 18:47:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 116}[0m
[36m2025-10-27 18:47:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 18:47:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 18:47:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 18:47:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 18:47:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 18:47:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 18:47:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 18:47:44.224 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 18:47:44.225 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q75 = 157.22 Ã¶re/kWh[0m
[36m2025-10-27 18:47:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 18:47:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 18:47:44.226 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 18:47:44.226 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 18:47:44.226 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 18:47:44.226 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 18:47:44.226 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 18:47:44.227 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 18:47:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 18:47:44.229 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 18:47:44.229 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:47:44.229 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.7Â°C: normal -106 to -306, warning -306[0m
[36m2025-10-27 18:47:44.229 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:47:44.229 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -306 (base: -306), critical -1500[0m
[36m2025-10-27 18:47:44.229 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.7Â°C, indoor_target=21.0Â°C, temp_diff=12.3Â°C, HC=0.180 kW/K -> flow=25.7Â°C[0m
[36m2025-10-27 18:47:44.229 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 18:47:44.229 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 18:47:44.229 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.2Â°C, current=21.3Â°C, error=4.9Â°C, sensitivity=1.5 -> offset=3.3[0m
[36m2025-10-27 18:47:44.229 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 18:47:44.229 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 21.3Â°C â†’ offset: +3.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -225)[0m
[36m2025-10-27 18:47:44.230 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Price classification Q75 (18:47): 157.22 â†’ PEAK[0m
[32m2025-10-27 18:47:44.230 INFO (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.17Â°C - Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 21.3Â°C â†’ offset: +3.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -225) | GE-Spot Q75: PEAK (day) | Too warm: 2.3Â°C over[0m
[32m2025-10-27 18:47:44.230 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.17Â°C, reasoning: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 21.3Â°C â†’ offset: +3.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -225) | GE-Spot Q75: PEAK (day) | Too warm: 2.3Â°C over[0m
[36m2025-10-27 18:47:44.230 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=-0.17Â°C, integer=0Â°C, fractional=-0.17Â°C, accumulator_before=-0.15Â°C[0m
[36m2025-10-27 18:47:44.230 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: -0.33Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-27 18:47:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset -0.17Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 18:47:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.000 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 18:47:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-27 18:47:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.3Â°C, outdoor=8.7Â°C, offset=-0.2Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 18:47:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.3Â°C, outdoor=8.7Â°C, offset=-0.2Â°C, flow=21.3Â°C, DM=-225[0m
[36m2025-10-27 18:47:44.235 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.0Â°C/h trend[0m
[36m2025-10-27 18:47:44.235 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 18:47:44.237 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 18:47:44.237 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 18:47:44.237 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=20.1[0m
[36m2025-10-27 18:47:44.237 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:47:44.239 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 18:47:44.239 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:47:44.239 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 18:47:44.239 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 48 quarters available, need 3 quarters (45 min), lookahead 12.0h[0m
[36m2025-10-27 18:47:44.239 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 46 windows evaluated[0m
[36m2025-10-27 18:47:44.239 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (9.0h away) â† SELECTED[0m
[36m2025-10-27 18:47:44.239 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (8.7h away)[0m
[36m2025-10-27 18:47:44.239 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (9.2h away)[0m
[36m2025-10-27 18:47:44.239 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (8.5h away)[0m
[36m2025-10-27 18:47:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (8.2h away)[0m
[32m2025-10-27 18:47:44.240 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 9.0h away[0m
[32m2025-10-27 18:47:44.240 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 20.1Â°C (safe >= 15.0Â°C), next window at 03:45 (9.0h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 18:47:44.246 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 18:47:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:47:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 18:47:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 48 quarters available, need 3 quarters (45 min), lookahead 12.0h[0m
[36m2025-10-27 18:47:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 46 windows evaluated[0m
[36m2025-10-27 18:47:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (9.0h away) â† SELECTED[0m
[36m2025-10-27 18:47:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (8.7h away)[0m
[36m2025-10-27 18:47:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (9.2h away)[0m
[36m2025-10-27 18:47:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (8.5h away)[0m
[36m2025-10-27 18:47:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (8.2h away)[0m
[32m2025-10-27 18:47:44.247 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 9.0h away[0m
[32m2025-10-27 18:47:44.247 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 20.1Â°C (safe >= 15.0Â°C), next window at 03:45 (9.0h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 18:47:44.247 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_SAFETY_WAITING_WINDOW_IN_9.0H_@7.4)[0m
[36m2025-10-27 18:47:44.247 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.024 seconds (success: True)[0m
[36m2025-10-27 18:47:44.249 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.6 + 1.6 + 0.7)A Ã— 0.95 = 1.57 kW[0m
[36m2025-10-27 18:52:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 18:52:44.223 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.3Â°C (median of 9 sensors: 24.1Â°C, 21.9Â°C, 22.3Â°C, 22.9Â°C, 25.5Â°C, 23.3Â°C, 23.3Â°C, 23.1Â°C, 25.0Â°C)[0m
[36m2025-10-27 18:52:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -230.0[0m
[36m2025-10-27 18:52:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 20.1Â°C[0m
[36m2025-10-27 18:52:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 21.3Â°C[0m
[36m2025-10-27 18:52:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.5A, L2=1.6A, L3=0.7A[0m
[36m2025-10-27 18:52:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.3Â°C, outdoor 8.7Â°C, flow 21.3Â°C, DM -230[0m
[36m2025-10-27 18:52:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor Hz not available from NIBE adapter[0m
[36m2025-10-27 18:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 18:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 18:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 18:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 18:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 18:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 18:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 18:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 18:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 18:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 18:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 116}[0m
[36m2025-10-27 18:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 18:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 18:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 18:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 18:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 18:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 18:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 18:52:44.224 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 18:52:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q75 = 157.22 Ã¶re/kWh[0m
[36m2025-10-27 18:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 18:52:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 18:52:44.226 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 18:52:44.226 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 18:52:44.226 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 18:52:44.226 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 18:52:44.226 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 18:52:44.227 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 18:52:44.229 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 18:52:44.229 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 18:52:44.229 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:52:44.229 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.7Â°C: normal -106 to -306, warning -306[0m
[36m2025-10-27 18:52:44.229 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:52:44.229 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -306 (base: -306), critical -1500[0m
[36m2025-10-27 18:52:44.229 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.7Â°C, indoor_target=21.0Â°C, temp_diff=12.3Â°C, HC=0.180 kW/K -> flow=25.7Â°C[0m
[36m2025-10-27 18:52:44.229 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 18:52:44.230 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 18:52:44.230 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.2Â°C, current=21.3Â°C, error=4.9Â°C, sensitivity=1.5 -> offset=3.3[0m
[36m2025-10-27 18:52:44.230 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 18:52:44.230 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 21.3Â°C â†’ offset: +3.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -230)[0m
[36m2025-10-27 18:52:44.230 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Price classification Q75 (18:52): 157.22 â†’ PEAK[0m
[32m2025-10-27 18:52:44.230 INFO (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.17Â°C - Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 21.3Â°C â†’ offset: +3.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -230) | GE-Spot Q75: PEAK (day) | Too warm: 2.3Â°C over[0m
[32m2025-10-27 18:52:44.231 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.17Â°C, reasoning: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.7Â°C; Safety: +0.5Â°C; Adjusted: 26.2Â°C; Current: 21.3Â°C â†’ offset: +3.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -230) | GE-Spot Q75: PEAK (day) | Too warm: 2.3Â°C over[0m
[36m2025-10-27 18:52:44.231 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=-0.17Â°C, integer=0Â°C, fractional=-0.17Â°C, accumulator_before=-0.33Â°C[0m
[36m2025-10-27 18:52:44.231 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: -0.50Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-27 18:52:44.231 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset -0.17Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 18:52:44.231 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.000 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 18:52:44.231 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-27 18:52:44.231 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.3Â°C, outdoor=8.7Â°C, offset=-0.2Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 18:52:44.232 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.3Â°C, outdoor=8.7Â°C, offset=-0.2Â°C, flow=21.3Â°C, DM=-230[0m
[36m2025-10-27 18:52:44.237 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.0Â°C/h trend[0m
[36m2025-10-27 18:52:44.237 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 18:52:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 18:52:44.240 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 18:52:44.240 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=20.1[0m
[36m2025-10-27 18:52:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:52:44.243 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 18:52:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:52:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 18:52:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 48 quarters available, need 3 quarters (45 min), lookahead 12.0h[0m
[36m2025-10-27 18:52:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 46 windows evaluated[0m
[36m2025-10-27 18:52:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (8.9h away) â† SELECTED[0m
[36m2025-10-27 18:52:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (8.6h away)[0m
[36m2025-10-27 18:52:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (9.1h away)[0m
[36m2025-10-27 18:52:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (8.4h away)[0m
[36m2025-10-27 18:52:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (8.1h away)[0m
[32m2025-10-27 18:52:44.244 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 8.9h away[0m
[32m2025-10-27 18:52:44.244 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 20.1Â°C (safe >= 15.0Â°C), next window at 03:45 (8.9h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 18:52:44.249 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 18:52:44.249 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.7Â°C (zone avg: -1.0Â°C, delta: 9.7Â°C): normal -106 to -306, warning -306, critical -1500[0m
[36m2025-10-27 18:52:44.249 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.7Â°C (zone: Moderate Cold): block=-306, abort=-386[0m
[36m2025-10-27 18:52:44.249 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 48 quarters available, need 3 quarters (45 min), lookahead 12.0h[0m
[36m2025-10-27 18:52:44.249 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 46 windows evaluated[0m
[36m2025-10-27 18:52:44.249 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (8.9h away) â† SELECTED[0m
[36m2025-10-27 18:52:44.249 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (8.6h away)[0m
[36m2025-10-27 18:52:44.249 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (9.1h away)[0m
[36m2025-10-27 18:52:44.249 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (8.4h away)[0m
[36m2025-10-27 18:52:44.250 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (8.1h away)[0m
[32m2025-10-27 18:52:44.250 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 8.9h away[0m
[32m2025-10-27 18:52:44.250 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 20.1Â°C (safe >= 15.0Â°C), next window at 03:45 (8.9h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 18:52:44.250 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_SAFETY_WAITING_WINDOW_IN_8.9H_@7.4)[0m
[36m2025-10-27 18:52:44.250 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.027 seconds (success: True)[0m
[36m2025-10-27 18:52:44.251 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.5 + 1.6 + 0.7)A Ã— 0.95 = 1.55 kW[0m
[36m2025-10-27 18:57:44.222 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 18:57:44.222 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.3Â°C (median of 9 sensors: 24.1Â°C, 21.9Â°C, 22.3Â°C, 22.8Â°C, 25.5Â°C, 23.3Â°C, 23.5Â°C, 23.1Â°C, 24.0Â°C)[0m
[36m2025-10-27 18:57:44.222 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -234.0[0m
[36m2025-10-27 18:57:44.222 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 19.6Â°C[0m
[36m2025-10-27 18:57:44.222 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 21.3Â°C[0m
[36m2025-10-27 18:57:44.222 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.5A, L2=1.6A, L3=0.7A[0m
[36m2025-10-27 18:57:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.3Â°C, outdoor 8.2Â°C, flow 21.3Â°C, DM -234[0m
[36m2025-10-27 18:57:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor Hz not available from NIBE adapter[0m
[36m2025-10-27 18:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 18:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 18:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 18:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 18:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 18:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 18:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 18:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 18:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 18:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 18:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 116}[0m
[36m2025-10-27 18:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 18:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 18:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 18:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 18:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 18:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 18:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 18:57:44.223 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 18:57:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q75 = 157.22 Ã¶re/kWh[0m
[36m2025-10-27 18:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 18:57:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 18:57:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 18:57:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 18:57:44.225 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 18:57:44.225 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 18:57:44.225 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 18:57:44.228 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 18:57:44.228 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 18:57:44.228 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 18:57:44.228 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 18:57:44.229 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-27 18:57:44.229 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 18:57:44.229 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-27 18:57:44.229 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-27 18:57:44.229 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 18:57:44.229 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 18:57:44.229 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=21.3Â°C, error=5.1Â°C, sensitivity=1.5 -> offset=3.4[0m
[36m2025-10-27 18:57:44.229 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 18:57:44.229 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 21.3Â°C â†’ offset: +3.4Â°C; Weight: 0.20; Deferred: Moderate debt (DM -234)[0m
[36m2025-10-27 18:57:44.229 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Price classification Q75 (18:57): 157.22 â†’ PEAK[0m
[32m2025-10-27 18:57:44.230 INFO (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.16Â°C - Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 21.3Â°C â†’ offset: +3.4Â°C; Weight: 0.20; Deferred: Moderate debt (DM -234) | GE-Spot Q75: PEAK (day) | Too warm: 2.3Â°C over[0m
[32m2025-10-27 18:57:44.230 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.16Â°C, reasoning: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 21.3Â°C â†’ offset: +3.4Â°C; Weight: 0.20; Deferred: Moderate debt (DM -234) | GE-Spot Q75: PEAK (day) | Too warm: 2.3Â°C over[0m
[36m2025-10-27 18:57:44.230 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=-0.16Â°C, integer=0Â°C, fractional=-0.16Â°C, accumulator_before=-0.50Â°C[0m
[36m2025-10-27 18:57:44.230 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: -0.66Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-27 18:57:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset -0.16Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 18:57:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.000 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 18:57:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-27 18:57:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.3Â°C, outdoor=8.2Â°C, offset=-0.2Â°C, change=0.02Â°C, Î”t=0.08h[0m
[36m2025-10-27 18:57:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.3Â°C, outdoor=8.2Â°C, offset=-0.2Â°C, flow=21.3Â°C, DM=-234[0m
[36m2025-10-27 18:57:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-27 18:57:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 18:57:44.232 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 18:57:44.232 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 18:57:44.232 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=19.6[0m
[36m2025-10-27 18:57:44.233 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 18:57:44.234 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 18:57:44.235 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 18:57:44.235 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-27 18:57:44.235 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 48 quarters available, need 3 quarters (45 min), lookahead 12.0h[0m
[36m2025-10-27 18:57:44.235 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 46 windows evaluated[0m
[36m2025-10-27 18:57:44.235 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (8.8h away) â† SELECTED[0m
[36m2025-10-27 18:57:44.235 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (8.5h away)[0m
[36m2025-10-27 18:57:44.235 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (9.0h away)[0m
[36m2025-10-27 18:57:44.235 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (8.3h away)[0m
[36m2025-10-27 18:57:44.235 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (8.0h away)[0m
[32m2025-10-27 18:57:44.235 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 8.8h away[0m
[32m2025-10-27 18:57:44.235 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 19.6Â°C (safe >= 15.0Â°C), next window at 03:45 (8.8h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 18:57:44.238 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 18:57:44.238 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 18:57:44.238 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-27 18:57:44.238 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 48 quarters available, need 3 quarters (45 min), lookahead 12.0h[0m
[36m2025-10-27 18:57:44.238 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 46 windows evaluated[0m
[36m2025-10-27 18:57:44.238 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (8.8h away) â† SELECTED[0m
[36m2025-10-27 18:57:44.238 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (8.5h away)[0m
[36m2025-10-27 18:57:44.238 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (9.0h away)[0m
[36m2025-10-27 18:57:44.238 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (8.3h away)[0m
[36m2025-10-27 18:57:44.238 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (8.0h away)[0m
[32m2025-10-27 18:57:44.238 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 8.8h away[0m
[32m2025-10-27 18:57:44.238 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 19.6Â°C (safe >= 15.0Â°C), next window at 03:45 (8.8h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 18:57:44.238 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_SAFETY_WAITING_WINDOW_IN_8.8H_@7.4)[0m
[36m2025-10-27 18:57:44.239 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.017 seconds (success: True)[0m
[36m2025-10-27 18:57:44.240 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.5 + 1.6 + 0.7)A Ã— 0.95 = 1.55 kW[0m
[31m2025-10-27 18:59:08.647 ERROR (MainThread) [homeassistant.components.mobile_app.webhook] Error when calling service during mobile_app webhook (device name: OP 12 KELLY): Action sensor.turn_on not found[0m
[31m2025-10-27 18:59:08.647 ERROR (MainThread) [homeassistant.components.webhook] Error processing webhook 35584d61b0059f359bb5f5482c4bcdae2d2c92999bb8ac074eaa983ac2aba86d
Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/mobile_app/webhook.py", line 283, in webhook_call_service
    await hass.services.async_call(
    ...<5 lines>...
    )
  File "/usr/src/homeassistant/homeassistant/core.py", line 2768, in async_call
    raise ServiceNotFound(domain, service) from None
homeassistant.exceptions.ServiceNotFound: Action sensor.turn_on not found

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/src/homeassistant/homeassistant/components/webhook/__init__.py", line 194, in async_handle_webhook
    response: Response | None = await webhook["handler"](hass, webhook_id, request)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/mobile_app/webhook.py", line 265, in handle_webhook
    return await asyncio.shield(
           ^^^^^^^^^^^^^^^^^^^^^
        WEBHOOK_COMMANDS[webhook_type](hass, config_entry, webhook_payload)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/usr/src/homeassistant/homeassistant/components/mobile_app/webhook.py", line 175, in validate_and_run
    return await func(hass, config_entry, data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/src/homeassistant/homeassistant/components/mobile_app/webhook.py", line 299, in webhook_call_service
    raise HTTPBadRequest from ex
aiohttp.web_exceptions.HTTPBadRequest: Bad Request[0m
[36m2025-10-27 19:02:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 19:02:44.223 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.3Â°C (median of 9 sensors: 24.1Â°C, 21.9Â°C, 22.4Â°C, 22.8Â°C, 25.4Â°C, 23.3Â°C, 23.5Â°C, 23.1Â°C, 24.0Â°C)[0m
[36m2025-10-27 19:02:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -238.0[0m
[36m2025-10-27 19:02:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 19.6Â°C[0m
[36m2025-10-27 19:02:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 21.3Â°C[0m
[36m2025-10-27 19:02:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.5A, L2=1.6A, L3=0.7A[0m
[36m2025-10-27 19:02:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.3Â°C, outdoor 8.2Â°C, flow 21.3Â°C, DM -238[0m
[36m2025-10-27 19:02:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor Hz not available from NIBE adapter[0m
[36m2025-10-27 19:02:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 19:02:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 19:02:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 19:02:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 19:02:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 19:02:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 19:02:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 19:02:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 19:02:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 19:02:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 19:02:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 115}[0m
[36m2025-10-27 19:02:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 19:02:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 19:02:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 19:02:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 19:02:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 19:02:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 19:02:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 19:02:44.224 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 19:02:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q76 = 151.86 Ã¶re/kWh[0m
[36m2025-10-27 19:02:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 19:02:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 19:02:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 19:02:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 19:02:44.225 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 19:02:44.225 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 19:02:44.226 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 19:02:44.227 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 19:02:44.228 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 19:02:44.228 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 19:02:44.228 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:02:44.228 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-27 19:02:44.228 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:02:44.228 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-27 19:02:44.229 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-27 19:02:44.229 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 19:02:44.229 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 19:02:44.229 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=21.3Â°C, error=5.1Â°C, sensitivity=1.5 -> offset=3.4[0m
[36m2025-10-27 19:02:44.229 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 19:02:44.229 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 21.3Â°C â†’ offset: +3.4Â°C; Weight: 0.20; Deferred: Moderate debt (DM -238)[0m
[36m2025-10-27 19:02:44.229 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Price classification Q76 (19:02): 151.86 â†’ PEAK[0m
[32m2025-10-27 19:02:44.229 INFO (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.22Â°C - Learned pre-heat: Pre-heating: predicted drop 0.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 21.3Â°C â†’ offset: +3.4Â°C; Weight: 0.20; Deferred: Moderate debt (DM -238) | GE-Spot Q76: PEAK (day) | Too warm: 2.3Â°C over[0m
[32m2025-10-27 19:02:44.230 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.22Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 0.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 21.3Â°C â†’ offset: +3.4Â°C; Weight: 0.20; Deferred: Moderate debt (DM -238) | GE-Spot Q76: PEAK (day) | Too warm: 2.3Â°C over[0m
[36m2025-10-27 19:02:44.230 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.22Â°C, integer=0Â°C, fractional=0.22Â°C, accumulator_before=-0.66Â°C[0m
[36m2025-10-27 19:02:44.230 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: -0.44Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-27 19:02:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.22Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 19:02:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.000 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 19:02:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-27 19:02:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.3Â°C, outdoor=8.2Â°C, offset=0.2Â°C, change=-0.01Â°C, Î”t=0.08h[0m
[36m2025-10-27 19:02:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.3Â°C, outdoor=8.2Â°C, offset=0.2Â°C, flow=21.3Â°C, DM=-238[0m
[36m2025-10-27 19:02:44.235 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.0Â°C/h trend[0m
[36m2025-10-27 19:02:44.235 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 19:02:44.236 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 19:02:44.236 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 19:02:44.236 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=19.6[0m
[36m2025-10-27 19:02:44.236 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:02:44.244 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 19:02:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:02:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-27 19:02:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 44 quarters available, need 3 quarters (45 min), lookahead 11.0h[0m
[36m2025-10-27 19:02:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 42 windows evaluated[0m
[36m2025-10-27 19:02:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (8.7h away) â† SELECTED[0m
[36m2025-10-27 19:02:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (8.5h away)[0m
[36m2025-10-27 19:02:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (9.0h away)[0m
[36m2025-10-27 19:02:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (8.2h away)[0m
[36m2025-10-27 19:02:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (8.0h away)[0m
[32m2025-10-27 19:02:44.246 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 8.7h away[0m
[32m2025-10-27 19:02:44.246 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 19.6Â°C (safe >= 15.0Â°C), next window at 03:45 (8.7h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 19:02:44.250 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 19:02:44.250 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:02:44.250 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-27 19:02:44.250 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 44 quarters available, need 3 quarters (45 min), lookahead 11.0h[0m
[36m2025-10-27 19:02:44.250 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 42 windows evaluated[0m
[36m2025-10-27 19:02:44.250 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (8.7h away) â† SELECTED[0m
[36m2025-10-27 19:02:44.250 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (8.5h away)[0m
[36m2025-10-27 19:02:44.250 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (9.0h away)[0m
[36m2025-10-27 19:02:44.251 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (8.2h away)[0m
[36m2025-10-27 19:02:44.251 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (8.0h away)[0m
[32m2025-10-27 19:02:44.251 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 8.7h away[0m
[32m2025-10-27 19:02:44.251 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 19.6Â°C (safe >= 15.0Â°C), next window at 03:45 (8.7h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 19:02:44.251 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_SAFETY_WAITING_WINDOW_IN_8.7H_@7.4)[0m
[36m2025-10-27 19:02:44.251 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.028 seconds (success: True)[0m
[36m2025-10-27 19:02:44.252 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.5 + 1.6 + 0.7)A Ã— 0.95 = 1.55 kW[0m
[36m2025-10-27 19:02:44.253 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[33m2025-10-27 19:05:11.637 WARNING (MainThread) [homeassistant.components.automation.led_tak_groventre] LED TAK GROVENTRE: Already running[0m
[36m2025-10-27 19:07:44.222 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 19:07:44.222 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.3Â°C (median of 9 sensors: 24.1Â°C, 21.9Â°C, 22.4Â°C, 22.9Â°C, 25.4Â°C, 23.3Â°C, 23.5Â°C, 23.0Â°C, 24.0Â°C)[0m
[36m2025-10-27 19:07:44.222 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -243.0[0m
[36m2025-10-27 19:07:44.222 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 19.6Â°C[0m
[36m2025-10-27 19:07:44.222 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 21.3Â°C[0m
[36m2025-10-27 19:07:44.222 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.5A, L2=1.6A, L3=0.7A[0m
[36m2025-10-27 19:07:44.222 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.3Â°C, outdoor 8.2Â°C, flow 21.3Â°C, DM -243[0m
[36m2025-10-27 19:07:44.222 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor Hz not available from NIBE adapter[0m
[36m2025-10-27 19:07:44.222 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 19:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 19:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 19:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 19:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 19:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 19:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 19:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 19:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 19:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 19:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 115}[0m
[36m2025-10-27 19:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 19:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 19:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 19:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 19:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 19:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 19:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 19:07:44.223 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 19:07:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q76 = 151.86 Ã¶re/kWh[0m
[36m2025-10-27 19:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 19:07:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 19:07:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 19:07:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 19:07:44.225 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 19:07:44.225 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 19:07:44.225 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 19:07:44.227 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 19:07:44.229 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 19:07:44.229 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 19:07:44.229 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:07:44.229 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-27 19:07:44.229 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:07:44.229 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-27 19:07:44.229 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-27 19:07:44.230 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 19:07:44.230 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 19:07:44.230 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=21.3Â°C, error=5.1Â°C, sensitivity=1.5 -> offset=3.4[0m
[36m2025-10-27 19:07:44.230 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 19:07:44.230 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 21.3Â°C â†’ offset: +3.4Â°C; Weight: 0.20; Deferred: Moderate debt (DM -243)[0m
[36m2025-10-27 19:07:44.230 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Price classification Q76 (19:07): 151.86 â†’ PEAK[0m
[32m2025-10-27 19:07:44.230 INFO (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.23Â°C - Learned pre-heat: Pre-heating: predicted drop 0.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 21.3Â°C â†’ offset: +3.4Â°C; Weight: 0.20; Deferred: Moderate debt (DM -243) | GE-Spot Q76: PEAK (day) | Too warm: 2.3Â°C over[0m
[32m2025-10-27 19:07:44.230 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.23Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 0.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 21.3Â°C â†’ offset: +3.4Â°C; Weight: 0.20; Deferred: Moderate debt (DM -243) | GE-Spot Q76: PEAK (day) | Too warm: 2.3Â°C over[0m
[36m2025-10-27 19:07:44.230 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.23Â°C, integer=0Â°C, fractional=0.23Â°C, accumulator_before=-0.44Â°C[0m
[36m2025-10-27 19:07:44.231 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: -0.21Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-27 19:07:44.231 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.23Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 19:07:44.231 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.000 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 19:07:44.231 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-27 19:07:44.231 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.3Â°C, outdoor=8.2Â°C, offset=0.2Â°C, change=-0.01Â°C, Î”t=0.08h[0m
[36m2025-10-27 19:07:44.231 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.3Â°C, outdoor=8.2Â°C, offset=0.2Â°C, flow=21.3Â°C, DM=-243[0m
[36m2025-10-27 19:07:44.236 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.0Â°C/h trend[0m
[36m2025-10-27 19:07:44.236 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 19:07:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 19:07:44.241 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 19:07:44.241 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=19.6[0m
[36m2025-10-27 19:07:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:07:44.243 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 19:07:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:07:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-27 19:07:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 44 quarters available, need 3 quarters (45 min), lookahead 11.0h[0m
[36m2025-10-27 19:07:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 42 windows evaluated[0m
[36m2025-10-27 19:07:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (8.6h away) â† SELECTED[0m
[36m2025-10-27 19:07:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (8.4h away)[0m
[36m2025-10-27 19:07:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (8.9h away)[0m
[36m2025-10-27 19:07:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (8.1h away)[0m
[36m2025-10-27 19:07:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (7.9h away)[0m
[32m2025-10-27 19:07:44.243 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 8.6h away[0m
[32m2025-10-27 19:07:44.244 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 19.6Â°C (safe >= 15.0Â°C), next window at 03:45 (8.6h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 19:07:44.247 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 19:07:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:07:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-27 19:07:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 44 quarters available, need 3 quarters (45 min), lookahead 11.0h[0m
[36m2025-10-27 19:07:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 42 windows evaluated[0m
[36m2025-10-27 19:07:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (8.6h away) â† SELECTED[0m
[36m2025-10-27 19:07:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (8.4h away)[0m
[36m2025-10-27 19:07:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (8.9h away)[0m
[36m2025-10-27 19:07:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (8.1h away)[0m
[36m2025-10-27 19:07:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (7.9h away)[0m
[32m2025-10-27 19:07:44.248 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 8.6h away[0m
[32m2025-10-27 19:07:44.248 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 19.6Â°C (safe >= 15.0Â°C), next window at 03:45 (8.6h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 19:07:44.248 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_SAFETY_WAITING_WINDOW_IN_8.6H_@7.4)[0m
[36m2025-10-27 19:07:44.248 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.026 seconds (success: True)[0m
[36m2025-10-27 19:07:44.250 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.5 + 1.6 + 0.7)A Ã— 0.95 = 1.55 kW[0m
[36m2025-10-27 19:07:44.250 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 19:12:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 19:12:44.223 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.3Â°C (median of 9 sensors: 24.1Â°C, 21.9Â°C, 22.2Â°C, 22.8Â°C, 25.4Â°C, 23.3Â°C, 23.5Â°C, 23.0Â°C, 24.0Â°C)[0m
[36m2025-10-27 19:12:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -248.0[0m
[36m2025-10-27 19:12:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 19.6Â°C[0m
[36m2025-10-27 19:12:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 21.3Â°C[0m
[36m2025-10-27 19:12:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.5A, L2=1.6A, L3=0.7A[0m
[36m2025-10-27 19:12:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.3Â°C, outdoor 8.2Â°C, flow 21.3Â°C, DM -248[0m
[36m2025-10-27 19:12:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor Hz not available from NIBE adapter[0m
[36m2025-10-27 19:12:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 19:12:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 19:12:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 19:12:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 19:12:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 19:12:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 19:12:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 19:12:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 19:12:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 19:12:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 19:12:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 115}[0m
[36m2025-10-27 19:12:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 19:12:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 19:12:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 19:12:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 19:12:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 19:12:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 19:12:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 19:12:44.224 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 19:12:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q76 = 151.86 Ã¶re/kWh[0m
[36m2025-10-27 19:12:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 19:12:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 19:12:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 19:12:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 19:12:44.226 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 19:12:44.226 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 19:12:44.226 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 19:12:44.228 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 19:12:44.231 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 19:12:44.231 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 19:12:44.231 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:12:44.231 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-27 19:12:44.231 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:12:44.231 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-27 19:12:44.231 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-27 19:12:44.231 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 19:12:44.232 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 19:12:44.232 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=21.3Â°C, error=5.1Â°C, sensitivity=1.5 -> offset=3.4[0m
[36m2025-10-27 19:12:44.232 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 19:12:44.232 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 21.3Â°C â†’ offset: +3.4Â°C; Weight: 0.20; Deferred: Moderate debt (DM -248)[0m
[36m2025-10-27 19:12:44.232 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Price classification Q76 (19:12): 151.86 â†’ PEAK[0m
[32m2025-10-27 19:12:44.232 INFO (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.23Â°C - Learned pre-heat: Pre-heating: predicted drop 0.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 21.3Â°C â†’ offset: +3.4Â°C; Weight: 0.20; Deferred: Moderate debt (DM -248) | GE-Spot Q76: PEAK (day) | Too warm: 2.3Â°C over[0m
[32m2025-10-27 19:12:44.232 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.23Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 0.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 21.3Â°C â†’ offset: +3.4Â°C; Weight: 0.20; Deferred: Moderate debt (DM -248) | GE-Spot Q76: PEAK (day) | Too warm: 2.3Â°C over[0m
[36m2025-10-27 19:12:44.233 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.23Â°C, integer=0Â°C, fractional=0.23Â°C, accumulator_before=-0.21Â°C[0m
[36m2025-10-27 19:12:44.233 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: 0.02Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-27 19:12:44.233 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.23Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 19:12:44.233 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.000 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 19:12:44.233 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-27 19:12:44.233 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.3Â°C, outdoor=8.2Â°C, offset=0.2Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 19:12:44.233 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.3Â°C, outdoor=8.2Â°C, offset=0.2Â°C, flow=21.3Â°C, DM=-248[0m
[36m2025-10-27 19:12:44.236 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.0Â°C/h trend[0m
[36m2025-10-27 19:12:44.236 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 19:12:44.238 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 19:12:44.238 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 19:12:44.238 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=19.6[0m
[36m2025-10-27 19:12:44.238 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:12:44.242 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 19:12:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:12:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-27 19:12:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 44 quarters available, need 3 quarters (45 min), lookahead 11.0h[0m
[36m2025-10-27 19:12:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 42 windows evaluated[0m
[36m2025-10-27 19:12:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (8.5h away) â† SELECTED[0m
[36m2025-10-27 19:12:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (8.3h away)[0m
[36m2025-10-27 19:12:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (8.8h away)[0m
[36m2025-10-27 19:12:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (8.0h away)[0m
[36m2025-10-27 19:12:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (7.8h away)[0m
[32m2025-10-27 19:12:44.243 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 8.5h away[0m
[32m2025-10-27 19:12:44.243 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 19.6Â°C (safe >= 15.0Â°C), next window at 03:45 (8.5h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 19:12:44.250 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 19:12:44.250 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:12:44.251 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-27 19:12:44.251 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 44 quarters available, need 3 quarters (45 min), lookahead 11.0h[0m
[36m2025-10-27 19:12:44.251 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 42 windows evaluated[0m
[36m2025-10-27 19:12:44.251 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (8.5h away) â† SELECTED[0m
[36m2025-10-27 19:12:44.251 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (8.3h away)[0m
[36m2025-10-27 19:12:44.251 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (8.8h away)[0m
[36m2025-10-27 19:12:44.251 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (8.0h away)[0m
[36m2025-10-27 19:12:44.251 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (7.8h away)[0m
[32m2025-10-27 19:12:44.251 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 8.5h away[0m
[32m2025-10-27 19:12:44.251 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 19.6Â°C (safe >= 15.0Â°C), next window at 03:45 (8.5h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 19:12:44.251 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_SAFETY_WAITING_WINDOW_IN_8.5H_@7.4)[0m
[36m2025-10-27 19:12:44.251 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.029 seconds (success: True)[0m
[36m2025-10-27 19:12:44.253 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.5 + 1.6 + 0.7)A Ã— 0.95 = 1.55 kW[0m
[36m2025-10-27 19:12:44.253 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
fetch https://api.home-connect.com/api/homeappliances/events failed: 401
[36m2025-10-27 19:17:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 19:17:44.223 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.3Â°C (median of 9 sensors: 24.1Â°C, 21.9Â°C, 22.3Â°C, 22.8Â°C, 25.4Â°C, 23.3Â°C, 23.3Â°C, 23.0Â°C, 24.0Â°C)[0m
[36m2025-10-27 19:17:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -247.0[0m
[36m2025-10-27 19:17:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 19.6Â°C[0m
[36m2025-10-27 19:17:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 27.8Â°C[0m
[36m2025-10-27 19:17:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=6.6A, L2=1.6A, L3=0.7A[0m
[36m2025-10-27 19:17:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.3Â°C, outdoor 8.2Â°C, flow 27.8Â°C, DM -247[0m
[36m2025-10-27 19:17:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 32 Hz (1h avg: 32, 6h avg: 2, mode: space) - OK: Normal operation (32 Hz, 6h avg: 2 Hz)[0m
[36m2025-10-27 19:17:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 19:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 19:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 19:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 19:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 19:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 19:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 19:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 19:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 19:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 19:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 114}[0m
[36m2025-10-27 19:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 19:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 19:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 19:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 19:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 19:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 19:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 19:17:44.224 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 19:17:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q77 = 137.68 Ã¶re/kWh[0m
[36m2025-10-27 19:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 19:17:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 19:17:44.226 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 19:17:44.226 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 19:17:44.226 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 19:17:44.226 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 19:17:44.226 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 19:17:44.227 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 19:17:44.228 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 19:17:44.228 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 19:17:44.228 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:17:44.228 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-27 19:17:44.228 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:17:44.228 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-27 19:17:44.229 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-27 19:17:44.229 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 19:17:44.229 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 19:17:44.229 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=27.8Â°C, error=-1.4Â°C, sensitivity=1.5 -> offset=-0.9[0m
[36m2025-10-27 19:17:44.229 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 19:17:44.229 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 27.8Â°C â†’ offset: -0.9Â°C; Weight: 0.20; Deferred: Moderate debt (DM -247)[0m
[36m2025-10-27 19:17:44.229 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Price classification Q77 (19:17): 137.68 â†’ PEAK[0m
[32m2025-10-27 19:17:44.229 INFO (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.19Â°C - Learned pre-heat: Pre-heating: predicted drop 0.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 27.8Â°C â†’ offset: -0.9Â°C; Weight: 0.20; Deferred: Moderate debt (DM -247) | GE-Spot Q77: PEAK (day) | Too warm: 2.3Â°C over[0m
[32m2025-10-27 19:17:44.230 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.19Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 0.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 27.8Â°C â†’ offset: -0.9Â°C; Weight: 0.20; Deferred: Moderate debt (DM -247) | GE-Spot Q77: PEAK (day) | Too warm: 2.3Â°C over[0m
[36m2025-10-27 19:17:44.230 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=-0.19Â°C, integer=0Â°C, fractional=-0.19Â°C, accumulator_before=0.02Â°C[0m
[36m2025-10-27 19:17:44.230 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: -0.17Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-27 19:17:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset -0.19Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 19:17:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.008 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 19:17:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.01 kW below 0.5 kW threshold[0m
[36m2025-10-27 19:17:44.231 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.3Â°C, outdoor=8.2Â°C, offset=-0.2Â°C, change=-0.02Â°C, Î”t=0.08h[0m
[36m2025-10-27 19:17:44.231 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.3Â°C, outdoor=8.2Â°C, offset=-0.2Â°C, flow=27.8Â°C, DM=-247[0m
[36m2025-10-27 19:17:44.231 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-27 19:17:44.231 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 19:17:44.232 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 19:17:44.232 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 19:17:44.232 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=19.6[0m
[36m2025-10-27 19:17:44.232 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:17:44.241 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 19:17:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:17:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-27 19:17:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 44 quarters available, need 3 quarters (45 min), lookahead 11.0h[0m
[36m2025-10-27 19:17:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 42 windows evaluated[0m
[36m2025-10-27 19:17:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (8.5h away) â† SELECTED[0m
[36m2025-10-27 19:17:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (8.2h away)[0m
[36m2025-10-27 19:17:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (8.7h away)[0m
[36m2025-10-27 19:17:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (8.0h away)[0m
[36m2025-10-27 19:17:44.241 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (7.7h away)[0m
[32m2025-10-27 19:17:44.241 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 8.5h away[0m
[32m2025-10-27 19:17:44.242 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 19.6Â°C (safe >= 15.0Â°C), next window at 03:45 (8.5h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 19:17:44.244 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 19:17:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:17:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-27 19:17:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 44 quarters available, need 3 quarters (45 min), lookahead 11.0h[0m
[36m2025-10-27 19:17:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 42 windows evaluated[0m
[36m2025-10-27 19:17:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (8.5h away) â† SELECTED[0m
[36m2025-10-27 19:17:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (8.2h away)[0m
[36m2025-10-27 19:17:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (8.7h away)[0m
[36m2025-10-27 19:17:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (8.0h away)[0m
[36m2025-10-27 19:17:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (7.7h away)[0m
[32m2025-10-27 19:17:44.245 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 8.5h away[0m
[32m2025-10-27 19:17:44.245 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 19.6Â°C (safe >= 15.0Â°C), next window at 03:45 (8.5h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 19:17:44.245 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_SAFETY_WAITING_WINDOW_IN_8.5H_@7.4)[0m
[36m2025-10-27 19:17:44.245 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.022 seconds (success: True)[0m
[36m2025-10-27 19:17:44.246 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (6.6 + 1.6 + 0.7)A Ã— 0.95 = 2.03 kW[0m
[36m2025-10-27 19:17:44.247 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 19:22:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 19:22:44.223 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.3Â°C (median of 9 sensors: 24.1Â°C, 21.9Â°C, 22.3Â°C, 22.8Â°C, 25.4Â°C, 23.3Â°C, 23.3Â°C, 23.0Â°C, 24.0Â°C)[0m
[36m2025-10-27 19:22:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -242.0[0m
[36m2025-10-27 19:22:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 19.6Â°C[0m
[36m2025-10-27 19:22:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 27.3Â°C[0m
[36m2025-10-27 19:22:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=5.6A, L2=1.6A, L3=0.7A[0m
[36m2025-10-27 19:22:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.3Â°C, outdoor 8.2Â°C, flow 27.3Â°C, DM -242[0m
[36m2025-10-27 19:22:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 20 Hz (1h avg: 26, 6h avg: 3, mode: space) - OK: Normal operation (20 Hz, 6h avg: 3 Hz)[0m
[36m2025-10-27 19:22:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 19:22:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 19:22:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 19:22:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 19:22:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 19:22:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 19:22:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 19:22:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 19:22:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 19:22:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 19:22:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 114}[0m
[36m2025-10-27 19:22:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 19:22:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 19:22:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 19:22:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 19:22:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 19:22:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 19:22:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 19:22:44.224 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 19:22:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q77 = 137.68 Ã¶re/kWh[0m
[36m2025-10-27 19:22:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 19:22:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 19:22:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 19:22:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 19:22:44.225 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 19:22:44.225 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 19:22:44.226 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 19:22:44.227 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 19:22:44.227 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 19:22:44.227 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 19:22:44.227 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:22:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-27 19:22:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:22:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-27 19:22:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-27 19:22:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 19:22:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 19:22:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=27.3Â°C, error=-0.9Â°C, sensitivity=1.5 -> offset=-0.6[0m
[36m2025-10-27 19:22:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 19:22:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 27.3Â°C â†’ offset: -0.6Â°C; Weight: 0.20; Deferred: Moderate debt (DM -242)[0m
[36m2025-10-27 19:22:44.228 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Price classification Q77 (19:22): 137.68 â†’ PEAK[0m
[32m2025-10-27 19:22:44.229 INFO (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.15Â°C - Learned pre-heat: Pre-heating: predicted drop 0.6Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 27.3Â°C â†’ offset: -0.6Â°C; Weight: 0.20; Deferred: Moderate debt (DM -242) | GE-Spot Q77: PEAK (day) | Too warm: 2.3Â°C over[0m
[32m2025-10-27 19:22:44.229 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.15Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 0.6Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 27.3Â°C â†’ offset: -0.6Â°C; Weight: 0.20; Deferred: Moderate debt (DM -242) | GE-Spot Q77: PEAK (day) | Too warm: 2.3Â°C over[0m
[36m2025-10-27 19:22:44.229 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=-0.15Â°C, integer=0Â°C, fractional=-0.15Â°C, accumulator_before=-0.17Â°C[0m
[36m2025-10-27 19:22:44.229 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: -0.32Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-27 19:22:44.229 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset -0.15Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 19:22:44.229 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.000 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 19:22:44.229 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-27 19:22:44.229 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.3Â°C, outdoor=8.2Â°C, offset=-0.1Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 19:22:44.229 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.3Â°C, outdoor=8.2Â°C, offset=-0.1Â°C, flow=27.3Â°C, DM=-242[0m
[36m2025-10-27 19:22:44.236 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.0Â°C/h trend[0m
[36m2025-10-27 19:22:44.236 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 19:22:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 19:22:44.240 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 19:22:44.240 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=19.6[0m
[36m2025-10-27 19:22:44.240 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:22:44.242 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 19:22:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:22:44.242 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-27 19:22:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 44 quarters available, need 3 quarters (45 min), lookahead 11.0h[0m
[36m2025-10-27 19:22:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 42 windows evaluated[0m
[36m2025-10-27 19:22:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (8.4h away) â† SELECTED[0m
[36m2025-10-27 19:22:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (8.1h away)[0m
[36m2025-10-27 19:22:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (8.6h away)[0m
[36m2025-10-27 19:22:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (7.9h away)[0m
[36m2025-10-27 19:22:44.243 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (7.6h away)[0m
[32m2025-10-27 19:22:44.243 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 8.4h away[0m
[32m2025-10-27 19:22:44.243 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 19.6Â°C (safe >= 15.0Â°C), next window at 03:45 (8.4h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 19:22:44.245 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 19:22:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:22:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-27 19:22:44.245 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 44 quarters available, need 3 quarters (45 min), lookahead 11.0h[0m
[36m2025-10-27 19:22:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 42 windows evaluated[0m
[36m2025-10-27 19:22:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (8.4h away) â† SELECTED[0m
[36m2025-10-27 19:22:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (8.1h away)[0m
[36m2025-10-27 19:22:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (8.6h away)[0m
[36m2025-10-27 19:22:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (7.9h away)[0m
[36m2025-10-27 19:22:44.246 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (7.6h away)[0m
[32m2025-10-27 19:22:44.246 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 8.4h away[0m
[32m2025-10-27 19:22:44.246 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 19.6Â°C (safe >= 15.0Â°C), next window at 03:45 (8.4h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 19:22:44.246 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_SAFETY_WAITING_WINDOW_IN_8.4H_@7.4)[0m
[36m2025-10-27 19:22:44.246 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.024 seconds (success: True)[0m
[36m2025-10-27 19:22:44.248 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (5.6 + 1.6 + 0.7)A Ã— 0.95 = 1.80 kW[0m
[36m2025-10-27 19:22:44.248 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 19:27:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 19:27:44.223 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.3Â°C (median of 9 sensors: 24.1Â°C, 21.9Â°C, 22.3Â°C, 22.9Â°C, 25.5Â°C, 23.3Â°C, 23.3Â°C, 23.0Â°C, 24.0Â°C)[0m
[36m2025-10-27 19:27:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -235.0[0m
[36m2025-10-27 19:27:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 19.6Â°C[0m
[36m2025-10-27 19:27:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 27.8Â°C[0m
[36m2025-10-27 19:27:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=5.6A, L2=1.6A, L3=0.7A[0m
[36m2025-10-27 19:27:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.3Â°C, outdoor 8.2Â°C, flow 27.8Â°C, DM -235[0m
[36m2025-10-27 19:27:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 20 Hz (1h avg: 24, 6h avg: 3, mode: space) - OK: Normal operation (20 Hz, 6h avg: 3 Hz)[0m
[36m2025-10-27 19:27:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 19:27:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 19:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 19:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 19:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 19:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 19:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 19:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 19:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 19:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 19:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 114}[0m
[36m2025-10-27 19:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 19:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 19:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 19:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 19:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 19:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 19:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 19:27:44.224 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 19:27:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q77 = 137.68 Ã¶re/kWh[0m
[36m2025-10-27 19:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 19:27:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 19:27:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 19:27:44.226 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 19:27:44.226 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 19:27:44.226 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 19:27:44.226 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 19:27:44.227 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 19:27:44.228 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 19:27:44.228 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 19:27:44.228 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:27:44.228 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-27 19:27:44.229 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:27:44.229 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-27 19:27:44.229 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-27 19:27:44.229 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 19:27:44.229 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 19:27:44.229 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=27.8Â°C, error=-1.4Â°C, sensitivity=1.5 -> offset=-0.9[0m
[36m2025-10-27 19:27:44.229 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 19:27:44.229 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 27.8Â°C â†’ offset: -0.9Â°C; Weight: 0.20; Deferred: Moderate debt (DM -235)[0m
[36m2025-10-27 19:27:44.229 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Price classification Q77 (19:27): 137.68 â†’ PEAK[0m
[32m2025-10-27 19:27:44.229 INFO (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.18Â°C - Learned pre-heat: Pre-heating: predicted drop 0.6Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 27.8Â°C â†’ offset: -0.9Â°C; Weight: 0.20; Deferred: Moderate debt (DM -235) | GE-Spot Q77: PEAK (day) | Too warm: 2.3Â°C over[0m
[32m2025-10-27 19:27:44.230 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.18Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 0.6Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 27.8Â°C â†’ offset: -0.9Â°C; Weight: 0.20; Deferred: Moderate debt (DM -235) | GE-Spot Q77: PEAK (day) | Too warm: 2.3Â°C over[0m
[36m2025-10-27 19:27:44.230 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=-0.18Â°C, integer=0Â°C, fractional=-0.18Â°C, accumulator_before=-0.32Â°C[0m
[36m2025-10-27 19:27:44.230 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: -0.50Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-27 19:27:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset -0.18Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 19:27:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.000 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 19:27:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-27 19:27:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.3Â°C, outdoor=8.2Â°C, offset=-0.2Â°C, change=-0.01Â°C, Î”t=0.08h[0m
[36m2025-10-27 19:27:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.3Â°C, outdoor=8.2Â°C, offset=-0.2Â°C, flow=27.8Â°C, DM=-235[0m
[36m2025-10-27 19:27:44.235 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.1Â°C/h trend[0m
[36m2025-10-27 19:27:44.235 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 19:27:44.236 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 19:27:44.236 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 19:27:44.236 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=19.6[0m
[36m2025-10-27 19:27:44.237 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:27:44.244 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 19:27:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:27:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-27 19:27:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 44 quarters available, need 3 quarters (45 min), lookahead 11.0h[0m
[36m2025-10-27 19:27:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 42 windows evaluated[0m
[36m2025-10-27 19:27:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (8.3h away) â† SELECTED[0m
[36m2025-10-27 19:27:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (8.0h away)[0m
[36m2025-10-27 19:27:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (8.5h away)[0m
[36m2025-10-27 19:27:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (7.8h away)[0m
[36m2025-10-27 19:27:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (7.5h away)[0m
[32m2025-10-27 19:27:44.245 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 8.3h away[0m
[32m2025-10-27 19:27:44.245 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 19.6Â°C (safe >= 15.0Â°C), next window at 03:45 (8.3h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 19:27:44.247 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 19:27:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:27:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-27 19:27:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 44 quarters available, need 3 quarters (45 min), lookahead 11.0h[0m
[36m2025-10-27 19:27:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 42 windows evaluated[0m
[36m2025-10-27 19:27:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (8.3h away) â† SELECTED[0m
[36m2025-10-27 19:27:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (8.0h away)[0m
[36m2025-10-27 19:27:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (8.5h away)[0m
[36m2025-10-27 19:27:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (7.8h away)[0m
[36m2025-10-27 19:27:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (7.5h away)[0m
[32m2025-10-27 19:27:44.248 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 8.3h away[0m
[32m2025-10-27 19:27:44.248 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 19.6Â°C (safe >= 15.0Â°C), next window at 03:45 (8.3h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 19:27:44.248 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_SAFETY_WAITING_WINDOW_IN_8.3H_@7.4)[0m
[36m2025-10-27 19:27:44.248 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.025 seconds (success: True)[0m
[36m2025-10-27 19:27:44.249 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (5.6 + 1.6 + 0.7)A Ã— 0.95 = 1.80 kW[0m
[36m2025-10-27 19:27:44.250 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 19:32:44.222 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 19:32:44.223 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.2Â°C (median of 9 sensors: 24.1Â°C, 21.9Â°C, 22.4Â°C, 22.9Â°C, 25.5Â°C, 23.2Â°C, 23.3Â°C, 23.0Â°C, 24.0Â°C)[0m
[36m2025-10-27 19:32:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -227.0[0m
[36m2025-10-27 19:32:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 19.6Â°C[0m
[36m2025-10-27 19:32:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 27.8Â°C[0m
[36m2025-10-27 19:32:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=5.6A, L2=1.6A, L3=0.7A[0m
[36m2025-10-27 19:32:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.2Â°C, outdoor 8.2Â°C, flow 27.8Â°C, DM -227[0m
[36m2025-10-27 19:32:44.223 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 20 Hz (1h avg: 23, 6h avg: 4, mode: space) - OK: Normal operation (20 Hz, 6h avg: 4 Hz)[0m
[36m2025-10-27 19:32:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 19:32:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 19:32:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 19:32:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 19:32:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 19:32:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 19:32:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 19:32:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 19:32:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 19:32:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 19:32:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 113}[0m
[36m2025-10-27 19:32:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 19:32:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 19:32:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 19:32:44.223 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 19:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 19:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 19:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 19:32:44.224 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 19:32:44.224 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q78 = 112.79 Ã¶re/kWh[0m
[36m2025-10-27 19:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 19:32:44.224 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 19:32:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 19:32:44.225 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 19:32:44.225 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 19:32:44.225 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 19:32:44.225 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 19:32:44.226 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 19:32:44.227 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 19:32:44.227 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 19:32:44.227 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:32:44.227 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-27 19:32:44.227 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:32:44.227 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-27 19:32:44.227 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-27 19:32:44.228 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 19:32:44.228 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 19:32:44.228 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=27.8Â°C, error=-1.4Â°C, sensitivity=1.5 -> offset=-0.9[0m
[36m2025-10-27 19:32:44.228 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 19:32:44.228 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 27.8Â°C â†’ offset: -0.9Â°C; Weight: 0.20; Deferred: Moderate debt (DM -227)[0m
[36m2025-10-27 19:32:44.228 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Price classification Q78 (19:32): 112.79 â†’ EXPENSIVE[0m
[32m2025-10-27 19:32:44.228 INFO (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.60Â°C - Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 27.8Â°C â†’ offset: -0.9Â°C; Weight: 0.20; Deferred: Moderate debt (DM -227) | GE-Spot Q78: EXPENSIVE (day) | Too warm: 2.2Â°C over[0m
[32m2025-10-27 19:32:44.228 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.60Â°C, reasoning: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 27.8Â°C â†’ offset: -0.9Â°C; Weight: 0.20; Deferred: Moderate debt (DM -227) | GE-Spot Q78: EXPENSIVE (day) | Too warm: 2.2Â°C over[0m
[36m2025-10-27 19:32:44.228 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=-0.60Â°C, integer=0Â°C, fractional=-0.60Â°C, accumulator_before=-0.50Â°C[0m
[32m2025-10-27 19:32:44.228 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] âœ“ Accumulated fractional offset reached threshold: applying -1Â°C adjustment (accumulator: -1.10Â°C â†’ -0.10Â°C)[0m
[36m2025-10-27 19:32:44.228 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Accumulator triggered: total_accumulated=-1.10Â°C, adjustment=-1Â°C, new_integer=-1Â°C, remaining=-0.10Â°C[0m
[36m2025-10-27 19:32:44.228 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset -0.60Â°C â†’ applying -1Â°C (accumulator: -0.10Â°C, needs 0.90Â°C more to trigger)[0m
[32m2025-10-27 19:32:44.230 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to -1Â°C (calculated: -0.60Â°C, accumulator: -0.10Â°C)[0m
[36m2025-10-27 19:32:44.230 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=-1Â°C, original=-0.60Â°C, accumulator=-0.10Â°C[0m
[32m2025-10-27 19:32:44.230 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset -0.60Â°C to NIBE via MyUplink[0m
[36m2025-10-27 19:32:44.230 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.004 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 19:32:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-27 19:32:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.2Â°C, outdoor=8.2Â°C, offset=-0.6Â°C, change=-0.02Â°C, Î”t=0.08h[0m
[36m2025-10-27 19:32:44.230 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.2Â°C, outdoor=8.2Â°C, offset=-0.6Â°C, flow=27.8Â°C, DM=-227[0m
[36m2025-10-27 19:32:44.236 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.1Â°C/h trend[0m
[36m2025-10-27 19:32:44.236 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 19:32:44.244 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved learned data to storage[0m
[36m2025-10-27 19:32:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 19:32:44.244 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 19:32:44.244 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=19.6[0m
[36m2025-10-27 19:32:44.244 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:32:44.247 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 19:32:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:32:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-27 19:32:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 44 quarters available, need 3 quarters (45 min), lookahead 11.0h[0m
[36m2025-10-27 19:32:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 42 windows evaluated[0m
[36m2025-10-27 19:32:44.247 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (8.2h away) â† SELECTED[0m
[36m2025-10-27 19:32:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (8.0h away)[0m
[36m2025-10-27 19:32:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (8.5h away)[0m
[36m2025-10-27 19:32:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (7.7h away)[0m
[36m2025-10-27 19:32:44.248 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (7.5h away)[0m
[32m2025-10-27 19:32:44.248 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 8.2h away[0m
[32m2025-10-27 19:32:44.248 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 19.6Â°C (safe >= 15.0Â°C), next window at 03:45 (8.2h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 19:32:44.257 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 19:32:44.257 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:32:44.257 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-27 19:32:44.257 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 44 quarters available, need 3 quarters (45 min), lookahead 11.0h[0m
[36m2025-10-27 19:32:44.258 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 42 windows evaluated[0m
[36m2025-10-27 19:32:44.258 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (8.2h away) â† SELECTED[0m
[36m2025-10-27 19:32:44.258 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (8.0h away)[0m
[36m2025-10-27 19:32:44.258 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (8.5h away)[0m
[36m2025-10-27 19:32:44.258 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (7.7h away)[0m
[36m2025-10-27 19:32:44.258 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (7.5h away)[0m
[32m2025-10-27 19:32:44.258 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 8.2h away[0m
[32m2025-10-27 19:32:44.258 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 19.6Â°C (safe >= 15.0Â°C), next window at 03:45 (8.2h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 19:32:44.258 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_SAFETY_WAITING_WINDOW_IN_8.2H_@7.4)[0m
[36m2025-10-27 19:32:44.258 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.036 seconds (success: True)[0m
[36m2025-10-27 19:32:44.260 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (5.6 + 1.6 + 0.7)A Ã— 0.95 = 1.80 kW[0m
[32m2025-10-27 19:35:33.055 INFO (MainThread) [custom_components.effektguard] Unloading EffektGuard integration[0m
[36m2025-10-27 19:35:33.055 DEBUG (MainThread) [custom_components.effektguard.coordinator] Shutting down EffektGuard coordinator[0m
[36m2025-10-27 19:35:33.057 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved learned data to storage[0m
[36m2025-10-27 19:35:33.057 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved learning data[0m
[36m2025-10-27 19:35:33.058 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved effect tracking data[0m
[32m2025-10-27 19:35:33.058 INFO (MainThread) [custom_components.effektguard.coordinator] Coordinator shutdown complete[0m
[36m2025-10-27 19:35:33.059 DEBUG (MainThread) [custom_components.effektguard] Coordinator shutdown complete[0m
[36m2025-10-27 19:35:33.062 DEBUG (MainThread) [custom_components.effektguard] Unregistered service: force_offset[0m
[36m2025-10-27 19:35:33.062 DEBUG (MainThread) [custom_components.effektguard] Unregistered service: reset_peak_tracking[0m
[36m2025-10-27 19:35:33.062 DEBUG (MainThread) [custom_components.effektguard] Unregistered service: boost_heating[0m
[36m2025-10-27 19:35:33.062 DEBUG (MainThread) [custom_components.effektguard] Unregistered service: calculate_optimal_schedule[0m
[32m2025-10-27 19:35:33.062 INFO (MainThread) [custom_components.effektguard] EffektGuard services unregistered successfully[0m
[36m2025-10-27 19:35:33.063 DEBUG (MainThread) [custom_components.effektguard.coordinator] Shutting down EffektGuard coordinator[0m
[36m2025-10-27 19:35:33.070 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved learned data to storage[0m
[36m2025-10-27 19:35:33.070 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved learning data[0m
[36m2025-10-27 19:35:33.072 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved effect tracking data[0m
[32m2025-10-27 19:35:33.072 INFO (MainThread) [custom_components.effektguard.coordinator] Coordinator shutdown complete[0m
[32m2025-10-27 19:35:33.072 INFO (MainThread) [custom_components.effektguard] Setting up EffektGuard integration[0m
[36m2025-10-27 19:35:33.072 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] Latitude 55.60 matches zone 'moderate_cold' (54.5-56.0)[0m
[32m2025-10-27 19:35:33.072 INFO (MainThread) [custom_components.effektguard.optimization.climate_zones] Climate zone detected: Moderate Cold (Moderate winter heating demands) at latitude 55.60Â°N - Winter avg: -1.0Â°C, DM normal range: -300 to -500[0m
[32m2025-10-27 19:35:33.072 INFO (MainThread) [custom_components.effektguard.optimization.weather_compensation] AdaptiveClimateSystem initialized: latitude=55.60Â° -> Moderate Cold zone (winter avg low: -1.0Â°C, base safety margin: 0.5Â°C)[0m
[36m2025-10-27 19:35:33.072 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] Latitude 55.60 matches zone 'moderate_cold' (54.5-56.0)[0m
[32m2025-10-27 19:35:33.072 INFO (MainThread) [custom_components.effektguard.optimization.climate_zones] Climate zone detected: Moderate Cold (Moderate winter heating demands) at latitude 55.60Â°N - Winter avg: -1.0Â°C, DM normal range: -300 to -500[0m
[32m2025-10-27 19:35:33.072 INFO (MainThread) [custom_components.effektguard.optimization.decision_engine] Climate zone: Moderate Cold (moderate_cold) - DM thresholds adapted for Moderate winter heating demands[0m
[36m2025-10-27 19:35:33.073 DEBUG (MainThread) [custom_components.effektguard.optimization.weather_compensation] WeatherCompensationCalculator initialized: HC=180.0 W/Â°C, radiator_output=None W, type=radiator[0m
[32m2025-10-27 19:35:33.073 INFO (MainThread) [custom_components.effektguard.optimization.decision_engine] Weather compensation initialized: HC=180.0 W/Â°C, radiator=not configured W, type=radiator[0m
[32m2025-10-27 19:35:33.077 INFO (MainThread) [custom_components.effektguard.optimization.effect_manager] Loaded 3 monthly peaks[0m
[32m2025-10-27 19:35:33.080 INFO (MainThread) [custom_components.effektguard.coordinator] Loaded heat pump model: F750 (F-series ASHP)[0m
[32m2025-10-27 19:35:33.081 INFO (MainThread) [custom_components.effektguard.coordinator] Detected climate region: Southern Sweden (MalmÃ¶/Gothenburg) (latitude: 55.60Â°N)[0m
[36m2025-10-27 19:35:33.081 DEBUG (MainThread) [custom_components.effektguard.utils.compressor_monitor] CompressorHealthMonitor initialized (max 24 hours, 1440 samples)[0m
[32m2025-10-27 19:35:33.081 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimizer initialized with climate-aware thresholds: Moderate Cold zone[0m
[32m2025-10-27 19:35:33.081 INFO (MainThread) [custom_components.effektguard.coordinator] DHW demand periods configured: ['07:00 (45.0Â°C)', '20:00 (45.0Â°C)'][0m
[36m2025-10-27 19:35:33.081 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW periods configured: ['7:00', '20:00'] (types: ['int', 'int'])[0m
[32m2025-10-27 19:35:33.081 INFO (MainThread) [custom_components.effektguard.coordinator] Restored monthly peak: 11.32 kW (3 peaks loaded)[0m
[36m2025-10-27 19:35:33.081 DEBUG (MainThread) [custom_components.effektguard.coordinator] Initializing learning modules...[0m
[32m2025-10-27 19:35:33.084 INFO (MainThread) [custom_components.effektguard.coordinator] Loaded learned data from storage (version 1, updated 2025-10-27T18:35:33.063074+00:00)[0m
[32m2025-10-27 19:35:33.084 INFO (MainThread) [custom_components.effektguard.coordinator] Restored last offset: -0.6Â°C from 2025-10-27T18:32:44.230376+00:00[0m
[32m2025-10-27 19:35:33.084 INFO (MainThread) [custom_components.effektguard.coordinator] Restored thermal model: mass=2.00, UFH=unknown[0m
[32m2025-10-27 19:35:33.085 INFO (MainThread) [custom_components.effektguard.coordinator] Restored thermal predictor with 96 historical snapshots[0m
[32m2025-10-27 19:35:33.085 INFO (MainThread) [custom_components.effektguard.coordinator] Restored weather patterns: 0 weeks of data[0m
[32m2025-10-27 19:35:33.085 INFO (MainThread) [custom_components.effektguard.coordinator] Restored last Legionella boost: 2025-10-20 00:35:42.242714+00:00[0m
[36m2025-10-27 19:35:33.088 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Found NIBE entity offset: number.f750_cu_3x400v_heating_offset_climate_system_1[0m
[36m2025-10-27 19:35:33.088 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Found NIBE entity outdoor_temp: sensor.f750_cu_3x400v_current_outd_temp_bt1[0m
[36m2025-10-27 19:35:33.088 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Found NIBE entity supply_temp: sensor.f750_cu_3x400v_heating_medium_supply_bt63[0m
[36m2025-10-27 19:35:33.088 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Found NIBE entity dhw_charging_temp: sensor.f750_cu_3x400v_heating_medium_supply_bt63[0m
[36m2025-10-27 19:35:33.088 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Found NIBE entity return_temp: sensor.f750_cu_3x400v_return_line_bt3[0m
[36m2025-10-27 19:35:33.088 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Found NIBE entity hot_water_status: sensor.f750_cu_3x400v_hot_water_top_bt7[0m
[36m2025-10-27 19:35:33.088 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Found NIBE entity dhw_top_temp: sensor.f750_cu_3x400v_hot_water_top_bt7[0m
[36m2025-10-27 19:35:33.088 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Found NIBE entity indoor_temp: sensor.f750_cu_3x400v_room_temperature_bt50[0m
[36m2025-10-27 19:35:33.088 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Found NIBE entity phase3_current: sensor.f750_cu_3x400v_current_be3[0m
[36m2025-10-27 19:35:33.088 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Found NIBE entity phase2_current: sensor.f750_cu_3x400v_current_be2[0m
[36m2025-10-27 19:35:33.088 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Found NIBE entity phase1_current: sensor.f750_cu_3x400v_current_be1[0m
[36m2025-10-27 19:35:33.088 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Found NIBE entity degree_minutes: sensor.f750_cu_3x400v_degree_minutes[0m
[36m2025-10-27 19:35:33.088 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Found NIBE entity compressor_status: sensor.f750_cu_3x400v_current_compressor_frequency[0m
[36m2025-10-27 19:35:33.088 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Found NIBE entity compressor_hz: sensor.f750_cu_3x400v_current_compressor_frequency[0m
[32m2025-10-27 19:35:33.089 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE Entity Discovery: Found 14 entities[0m
[32m2025-10-27 19:35:33.089 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter]   offset: number.f750_cu_3x400v_heating_offset_climate_system_1 = -1.0 [0m
[32m2025-10-27 19:35:33.089 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter]   outdoor_temp: sensor.f750_cu_3x400v_current_outd_temp_bt1 = 8.2 Â°C[0m
[32m2025-10-27 19:35:33.089 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter]   supply_temp: sensor.f750_cu_3x400v_heating_medium_supply_bt63 = 27.8 Â°C[0m
[32m2025-10-27 19:35:33.089 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter]   dhw_charging_temp: sensor.f750_cu_3x400v_heating_medium_supply_bt63 = 27.8 Â°C[0m
[32m2025-10-27 19:35:33.089 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter]   return_temp: sensor.f750_cu_3x400v_return_line_bt3 = 26.6 Â°C[0m
[32m2025-10-27 19:35:33.089 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter]   hot_water_status: sensor.f750_cu_3x400v_hot_water_top_bt7 = 19.6 Â°C[0m
[32m2025-10-27 19:35:33.089 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter]   dhw_top_temp: sensor.f750_cu_3x400v_hot_water_top_bt7 = 19.6 Â°C[0m
[32m2025-10-27 19:35:33.089 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter]   indoor_temp: sensor.f750_cu_3x400v_room_temperature_bt50 = 24.1 Â°C[0m
[32m2025-10-27 19:35:33.089 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter]   phase3_current: sensor.f750_cu_3x400v_current_be3 = 0.7 A[0m
[32m2025-10-27 19:35:33.089 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter]   phase2_current: sensor.f750_cu_3x400v_current_be2 = 1.6 A[0m
[32m2025-10-27 19:35:33.089 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter]   phase1_current: sensor.f750_cu_3x400v_current_be1 = 5.6 A[0m
[32m2025-10-27 19:35:33.089 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter]   degree_minutes: sensor.f750_cu_3x400v_degree_minutes = -219.0 [0m
[32m2025-10-27 19:35:33.089 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter]   compressor_status: sensor.f750_cu_3x400v_current_compressor_frequency = 20.0 Hz[0m
[32m2025-10-27 19:35:33.089 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter]   compressor_hz: sensor.f750_cu_3x400v_current_compressor_frequency = 20.0 Hz[0m
[36m2025-10-27 19:35:33.089 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] Loading BT7 temperature history from 2025-10-13 18:35:33.089925+00:00 to 2025-10-27 18:35:33.089925+00:00 (14 days)[0m
[32m2025-10-27 19:35:33.126 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] Loaded 866 BT7 temperature readings from past 14 days (max: 56.1Â°C at 2025-10-20 00:35:42.242714+00:00)[0m
[32m2025-10-27 19:35:33.126 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] Detected previous Legionella boost from history: 56.1Â°C at 2025-10-20 00:35:42.242714+00:00 (186.0 hours ago)[0m
[32m2025-10-27 19:35:33.126 INFO (MainThread) [custom_components.effektguard.coordinator] Learning modules initialized successfully[0m
[36m2025-10-27 19:35:33.126 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 19:35:33.126 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.2Â°C (median of 9 sensors: 24.1Â°C, 21.9Â°C, 22.4Â°C, 22.8Â°C, 25.5Â°C, 23.2Â°C, 23.3Â°C, 23.0Â°C, 24.0Â°C)[0m
[36m2025-10-27 19:35:33.126 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -219.0[0m
[36m2025-10-27 19:35:33.126 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 19.6Â°C[0m
[36m2025-10-27 19:35:33.126 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 27.8Â°C[0m
[36m2025-10-27 19:35:33.126 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=5.6A, L2=1.6A, L3=0.7A[0m
[36m2025-10-27 19:35:33.126 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.2Â°C, outdoor 8.2Â°C, flow 27.8Â°C, DM -219[0m
[32m2025-10-27 19:35:33.126 INFO (MainThread) [custom_components.effektguard.coordinator] EffektGuard fully initialized - NIBE entities available[0m
[36m2025-10-27 19:35:33.126 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 20 Hz (1h avg: 20, 6h avg: 20, mode: space) - OK: Normal operation (20 Hz, 6h avg: 20 Hz)[0m
[36m2025-10-27 19:35:33.126 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 19:35:33.126 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 19:35:33.126 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 19:35:33.126 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 19:35:33.126 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 19:35:33.126 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 19:35:33.127 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 19:35:33.127 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 19:35:33.127 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 19:35:33.127 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 19:35:33.127 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 113}[0m
[36m2025-10-27 19:35:33.127 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 19:35:33.127 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 19:35:33.127 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 19:35:33.127 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 19:35:33.127 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 19:35:33.127 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 19:35:33.127 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 19:35:33.127 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 19:35:33.127 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q78 = 112.79 Ã¶re/kWh[0m
[36m2025-10-27 19:35:33.127 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 19:35:33.127 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 19:35:33.128 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 19:35:33.128 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 19:35:33.128 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 19:35:33.129 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 19:35:33.129 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 19:35:33.130 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 19:35:33.132 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 19:35:33.132 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 19:35:33.132 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:35:33.132 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-27 19:35:33.132 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:35:33.132 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-27 19:35:33.133 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-27 19:35:33.133 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 19:35:33.133 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 19:35:33.133 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=27.8Â°C, error=-1.4Â°C, sensitivity=1.5 -> offset=-0.9[0m
[36m2025-10-27 19:35:33.133 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 19:35:33.133 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 27.8Â°C â†’ offset: -0.9Â°C; Weight: 0.20; Deferred: Moderate debt (DM -219)[0m
[36m2025-10-27 19:35:33.133 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Price classification Q78 (19:35): 112.79 â†’ EXPENSIVE[0m
[32m2025-10-27 19:35:33.133 INFO (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.51Â°C - Learned pre-heat: Pre-heating: predicted drop 1.7Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 27.8Â°C â†’ offset: -0.9Â°C; Weight: 0.20; Deferred: Moderate debt (DM -219) | GE-Spot Q78: EXPENSIVE (day) | Too warm: 2.2Â°C over[0m
[32m2025-10-27 19:35:33.134 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.51Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.7Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 27.8Â°C â†’ offset: -0.9Â°C; Weight: 0.20; Deferred: Moderate debt (DM -219) | GE-Spot Q78: EXPENSIVE (day) | Too warm: 2.2Â°C over[0m
[36m2025-10-27 19:35:33.134 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.51Â°C, integer=0Â°C, fractional=0.51Â°C, accumulator_before=0.00Â°C[0m
[36m2025-10-27 19:35:33.134 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: 0.51Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-27 19:35:33.135 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.51Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 19:35:33.135 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.000 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 19:35:33.135 DEBUG (MainThread) [custom_components.effektguard.coordinator] External power sensor marked as available[0m
[36m2025-10-27 19:35:33.135 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-27 19:35:33.135 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.2Â°C, outdoor=8.2Â°C, offset=0.5Â°C, change=0.00Â°C, Î”t=0.00h[0m
[36m2025-10-27 19:35:33.135 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.2Â°C, outdoor=8.2Â°C, offset=0.5Â°C, flow=27.8Â°C, DM=-219[0m
[36m2025-10-27 19:35:33.140 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.1Â°C/h trend[0m
[36m2025-10-27 19:35:33.140 DEBUG (MainThread) [custom_components.effektguard.optimization.weather_learning] Recorded weather pattern 10-4: avg=8.0Â°C, range=3.9Â°C, volatility=1.2[0m
[36m2025-10-27 19:35:33.140 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded weather pattern for 2025-10-27[0m
[36m2025-10-27 19:35:33.140 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 19:35:33.147 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved learned data to storage[0m
[36m2025-10-27 19:35:33.147 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 19:35:33.147 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 19:35:33.147 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=19.6[0m
[36m2025-10-27 19:35:33.147 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:35:33.150 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 19:35:33.150 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:35:33.150 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-27 19:35:33.150 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 44 quarters available, need 3 quarters (45 min), lookahead 11.0h[0m
[36m2025-10-27 19:35:33.150 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 42 windows evaluated[0m
[36m2025-10-27 19:35:33.150 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (8.2h away) â† SELECTED[0m
[36m2025-10-27 19:35:33.150 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (7.9h away)[0m
[36m2025-10-27 19:35:33.150 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (8.4h away)[0m
[36m2025-10-27 19:35:33.150 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (7.7h away)[0m
[36m2025-10-27 19:35:33.150 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (7.4h away)[0m
[32m2025-10-27 19:35:33.151 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 8.2h away[0m
[32m2025-10-27 19:35:33.151 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 19.6Â°C (safe >= 15.0Â°C), next window at 03:45 (8.2h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 19:35:33.153 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 19:35:33.153 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:35:33.153 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-27 19:35:33.153 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 44 quarters available, need 3 quarters (45 min), lookahead 11.0h[0m
[36m2025-10-27 19:35:33.153 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 42 windows evaluated[0m
[36m2025-10-27 19:35:33.153 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (8.2h away) â† SELECTED[0m
[36m2025-10-27 19:35:33.153 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (7.9h away)[0m
[36m2025-10-27 19:35:33.153 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (8.4h away)[0m
[36m2025-10-27 19:35:33.153 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (7.7h away)[0m
[36m2025-10-27 19:35:33.153 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (7.4h away)[0m
[32m2025-10-27 19:35:33.153 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 8.2h away[0m
[32m2025-10-27 19:35:33.153 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 19.6Â°C (safe >= 15.0Â°C), next window at 03:45 (8.2h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 19:35:33.153 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_SAFETY_WAITING_WINDOW_IN_8.2H_@7.4)[0m
[36m2025-10-27 19:35:33.154 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.028 seconds (success: True)[0m
[32m2025-10-27 19:35:33.154 INFO (MainThread) [custom_components.effektguard.coordinator] External power sensor sensor.gen24_elnat_import_effekt already available at startup[0m
[36m2025-10-27 19:35:33.154 DEBUG (MainThread) [custom_components.effektguard.climate] Restored HVAC mode: heat from previous state[0m
[36m2025-10-27 19:35:33.157 DEBUG (MainThread) [custom_components.effektguard.sensor] Restored peak_today: 0.14[0m
[36m2025-10-27 19:35:33.157 DEBUG (MainThread) [custom_components.effektguard.sensor] Restored peak_this_month: 11.32[0m
[36m2025-10-27 19:35:33.157 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (5.6 + 1.6 + 0.7)A Ã— 0.95 = 1.80 kW[0m
[36m2025-10-27 19:35:33.161 DEBUG (MainThread) [custom_components.effektguard.sensor] Could not restore compressor_health, will use coordinator value[0m
[36m2025-10-27 19:35:33.162 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 19:35:33.163 DEBUG (MainThread) [custom_components.effektguard.sensor] Restored savings_estimate: 100.00[0m
[36m2025-10-27 19:35:33.166 DEBUG (MainThread) [custom_components.effektguard] Registered service: force_offset[0m
[36m2025-10-27 19:35:33.166 DEBUG (MainThread) [custom_components.effektguard] Registered service: reset_peak_tracking[0m
[36m2025-10-27 19:35:33.166 DEBUG (MainThread) [custom_components.effektguard] Registered service: boost_heating[0m
[36m2025-10-27 19:35:33.166 DEBUG (MainThread) [custom_components.effektguard] Registered service: calculate_optimal_schedule[0m
[32m2025-10-27 19:35:33.169 INFO (MainThread) [custom_components.effektguard] EffektGuard services registered successfully[0m
[32m2025-10-27 19:35:33.169 INFO (MainThread) [custom_components.effektguard] EffektGuard setup complete[0m
[36m2025-10-27 19:40:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 19:40:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.2Â°C (median of 9 sensors: 24.1Â°C, 21.9Â°C, 22.3Â°C, 22.9Â°C, 25.4Â°C, 23.2Â°C, 23.3Â°C, 23.0Â°C, 24.0Â°C)[0m
[36m2025-10-27 19:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -210.0[0m
[36m2025-10-27 19:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 19.6Â°C[0m
[36m2025-10-27 19:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 28.3Â°C[0m
[36m2025-10-27 19:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=5.6A, L2=1.6A, L3=9.4A[0m
[36m2025-10-27 19:40:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.2Â°C, outdoor 8.2Â°C, flow 28.3Â°C, DM -210[0m
[36m2025-10-27 19:40:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 20 Hz (1h avg: 20, 6h avg: 20, mode: space) - OK: Normal operation (20 Hz, 6h avg: 20 Hz)[0m
[36m2025-10-27 19:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 19:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 19:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 19:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 19:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 19:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 19:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 19:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 19:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 19:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 19:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 113}[0m
[36m2025-10-27 19:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 19:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 19:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 19:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 19:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 19:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 19:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 19:40:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 19:40:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q78 = 112.79 Ã¶re/kWh[0m
[36m2025-10-27 19:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 19:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 19:40:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 19:40:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 19:40:32.962 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 19:40:32.962 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 19:40:32.962 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 19:40:32.966 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 19:40:32.968 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 19:40:32.968 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 19:40:32.968 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:40:32.968 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-27 19:40:32.968 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:40:32.968 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-27 19:40:32.968 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-27 19:40:32.968 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 19:40:32.968 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 19:40:32.968 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=28.3Â°C, error=-1.9Â°C, sensitivity=1.5 -> offset=-1.3[0m
[36m2025-10-27 19:40:32.968 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 19:40:32.968 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 28.3Â°C â†’ offset: -1.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -210)[0m
[36m2025-10-27 19:40:32.969 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Price classification Q78 (19:40): 112.79 â†’ EXPENSIVE[0m
[32m2025-10-27 19:40:32.969 INFO (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.48Â°C - Learned pre-heat: Pre-heating: predicted drop 1.7Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 28.3Â°C â†’ offset: -1.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -210) | GE-Spot Q78: EXPENSIVE (day) | Too warm: 2.2Â°C over[0m
[32m2025-10-27 19:40:32.970 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.48Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.7Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 28.3Â°C â†’ offset: -1.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -210) | GE-Spot Q78: EXPENSIVE (day) | Too warm: 2.2Â°C over[0m
[36m2025-10-27 19:40:32.970 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.48Â°C, integer=0Â°C, fractional=0.48Â°C, accumulator_before=0.51Â°C[0m
[36m2025-10-27 19:40:32.970 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: 0.98Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-27 19:40:32.970 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.48Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 19:40:32.970 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.021 kW from sensor.gen24_elnat_import_effekt[0m
[32m2025-10-27 19:40:32.970 INFO (MainThread) [custom_components.effektguard.coordinator] New daily peak: 0.02 kW at 19:40:32 (quarter 78, source: nibe_currents)[0m
[36m2025-10-27 19:40:32.970 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.02 kW below 0.5 kW threshold[0m
[36m2025-10-27 19:40:32.971 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.2Â°C, outdoor=8.2Â°C, offset=0.5Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 19:40:32.971 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.2Â°C, outdoor=8.2Â°C, offset=0.5Â°C, flow=28.3Â°C, DM=-210[0m
[36m2025-10-27 19:40:32.971 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-27 19:40:32.971 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 19:40:32.973 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 19:40:32.973 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 19:40:32.973 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=19.6[0m
[36m2025-10-27 19:40:32.973 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:40:32.977 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 19:40:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:40:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-27 19:40:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 44 quarters available, need 3 quarters (45 min), lookahead 11.0h[0m
[36m2025-10-27 19:40:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 42 windows evaluated[0m
[36m2025-10-27 19:40:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (8.1h away) â† SELECTED[0m
[36m2025-10-27 19:40:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (7.8h away)[0m
[36m2025-10-27 19:40:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (8.3h away)[0m
[36m2025-10-27 19:40:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (7.6h away)[0m
[36m2025-10-27 19:40:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (7.3h away)[0m
[32m2025-10-27 19:40:32.977 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 8.1h away[0m
[32m2025-10-27 19:40:32.977 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 19.6Â°C (safe >= 15.0Â°C), next window at 03:45 (8.1h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 19:40:32.981 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 19:40:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:40:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-27 19:40:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 44 quarters available, need 3 quarters (45 min), lookahead 11.0h[0m
[36m2025-10-27 19:40:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 42 windows evaluated[0m
[36m2025-10-27 19:40:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (8.1h away) â† SELECTED[0m
[36m2025-10-27 19:40:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (7.8h away)[0m
[36m2025-10-27 19:40:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (8.3h away)[0m
[36m2025-10-27 19:40:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (7.6h away)[0m
[36m2025-10-27 19:40:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (7.3h away)[0m
[32m2025-10-27 19:40:32.982 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 8.1h away[0m
[32m2025-10-27 19:40:32.982 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW safety defer: temp 19.6Â°C (safe >= 15.0Â°C), next window at 03:45 (8.1h, 7.4Ã¶re/kWh)[0m
[36m2025-10-27 19:40:32.982 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_SAFETY_WAITING_WINDOW_IN_8.1H_@7.4)[0m
[36m2025-10-27 19:40:32.982 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.023 seconds (success: True)[0m
[36m2025-10-27 19:40:32.983 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (5.6 + 1.6 + 9.4)A Ã— 0.95 = 3.78 kW[0m
[36m2025-10-27 19:40:32.984 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 19:45:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 19:45:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.2Â°C (median of 9 sensors: 24.1Â°C, 21.9Â°C, 22.2Â°C, 22.8Â°C, 25.4Â°C, 23.2Â°C, 23.3Â°C, 23.0Â°C, 24.0Â°C)[0m
[36m2025-10-27 19:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -200.0[0m
[36m2025-10-27 19:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 19.6Â°C[0m
[36m2025-10-27 19:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 28.3Â°C[0m
[36m2025-10-27 19:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=5.6A, L2=1.6A, L3=9.4A[0m
[36m2025-10-27 19:45:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.2Â°C, outdoor 8.2Â°C, flow 28.3Â°C, DM -200[0m
[36m2025-10-27 19:45:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 20 Hz (1h avg: 20, 6h avg: 20, mode: space) - OK: Normal operation (20 Hz, 6h avg: 20 Hz)[0m
[36m2025-10-27 19:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 19:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 19:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 19:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 19:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 19:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 19:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 19:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 19:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 19:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 19:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 112}[0m
[36m2025-10-27 19:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 19:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 19:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 19:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 19:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 19:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 19:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 19:45:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 19:45:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q79 = 98.57 Ã¶re/kWh[0m
[36m2025-10-27 19:45:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 19:45:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 19:45:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 19:45:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 19:45:32.962 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 19:45:32.962 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-27 19:45:32.962 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 19:45:32.967 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 19:45:32.968 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 19:45:32.968 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 19:45:32.968 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:45:32.968 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-27 19:45:32.969 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:45:32.969 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-27 19:45:32.969 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-27 19:45:32.969 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 19:45:32.969 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 19:45:32.969 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=28.3Â°C, error=-1.9Â°C, sensitivity=1.5 -> offset=-1.3[0m
[36m2025-10-27 19:45:32.969 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 19:45:32.969 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 28.3Â°C â†’ offset: -1.3Â°C; Weight: 0.23; Deferred: Light debt (DM -200)[0m
[36m2025-10-27 19:45:32.969 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Price classification Q79 (19:45): 98.57 â†’ NORMAL[0m
[32m2025-10-27 19:45:32.969 INFO (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.57Â°C - Learned pre-heat: Pre-heating: predicted drop 1.9Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 28.3Â°C â†’ offset: -1.3Â°C; Weight: 0.23; Deferred: Light debt (DM -200) | GE-Spot Q79: NORMAL (day) | Too warm: 2.2Â°C over[0m
[32m2025-10-27 19:45:32.970 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.57Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.9Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 28.3Â°C â†’ offset: -1.3Â°C; Weight: 0.23; Deferred: Light debt (DM -200) | GE-Spot Q79: NORMAL (day) | Too warm: 2.2Â°C over[0m
[36m2025-10-27 19:45:32.970 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.57Â°C, integer=0Â°C, fractional=0.57Â°C, accumulator_before=0.98Â°C[0m
[32m2025-10-27 19:45:32.970 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] âœ“ Accumulated fractional offset reached threshold: applying +1Â°C adjustment (accumulator: 1.55Â°C â†’ 0.55Â°C)[0m
[36m2025-10-27 19:45:32.970 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Accumulator triggered: total_accumulated=1.55Â°C, adjustment=+1Â°C, new_integer=1Â°C, remaining=0.55Â°C[0m
[36m2025-10-27 19:45:32.970 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset 0.57Â°C â†’ applying 1Â°C (accumulator: 0.55Â°C, needs 0.45Â°C more to trigger)[0m
[32m2025-10-27 19:45:32.971 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to 1Â°C (calculated: 0.57Â°C, accumulator: 0.55Â°C)[0m
[36m2025-10-27 19:45:32.971 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=1Â°C, original=0.57Â°C, accumulator=0.55Â°C[0m
[32m2025-10-27 19:45:32.971 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset 0.57Â°C to NIBE via MyUplink[0m
[36m2025-10-27 19:45:32.971 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.289 kW from sensor.gen24_elnat_import_effekt[0m
[32m2025-10-27 19:45:32.971 INFO (MainThread) [custom_components.effektguard.coordinator] New daily peak: 1.29 kW at 19:45:32 (quarter 79, source: external_meter)[0m
[36m2025-10-27 19:45:32.971 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.2Â°C, outdoor=8.2Â°C, offset=0.6Â°C, change=-0.02Â°C, Î”t=0.08h[0m
[36m2025-10-27 19:45:32.971 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.2Â°C, outdoor=8.2Â°C, offset=0.6Â°C, flow=28.3Â°C, DM=-200[0m
[36m2025-10-27 19:45:32.976 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.1Â°C/h trend[0m
[36m2025-10-27 19:45:32.976 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 19:45:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 19:45:32.977 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 19:45:32.977 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=19.6[0m
[36m2025-10-27 19:45:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:45:32.982 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 19:45:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:45:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-27 19:45:32.985 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 16:32:59.069186+00:00[0m
[36m2025-10-27 19:45:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:45:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[32m2025-10-27 19:45:32.985 INFO (MainThread) [custom_components.effektguard.coordinator] DHW control: Activating temporary lux - DHW_SAFETY_MINIMUM (DHW: 19.6Â°C, DM: -200)[0m
[36m2025-10-27 19:45:32.986 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.027 seconds (success: True)[0m
[36m2025-10-27 19:45:32.987 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (5.6 + 1.6 + 9.4)A Ã— 0.95 = 3.78 kW[0m
[36m2025-10-27 19:45:32.988 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 19:50:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 19:50:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.2Â°C (median of 9 sensors: 24.1Â°C, 21.9Â°C, 22.3Â°C, 22.8Â°C, 25.4Â°C, 23.2Â°C, 23.3Â°C, 23.0Â°C, 24.0Â°C)[0m
[36m2025-10-27 19:50:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -200.0[0m
[36m2025-10-27 19:50:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 19.6Â°C[0m
[36m2025-10-27 19:50:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 26.5Â°C[0m
[36m2025-10-27 19:50:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=8.6A, L2=1.6A, L3=0.7A[0m
[36m2025-10-27 19:50:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.2Â°C, outdoor 8.2Â°C, flow 26.5Â°C, DM -200[0m
[32m2025-10-27 19:50:32.960 INFO (MainThread) [custom_components.effektguard.utils.compressor_monitor] Compressor entered HIGH zone: 80 Hz for space heating (monitor for sustained operation)[0m
[36m2025-10-27 19:50:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 80 Hz (1h avg: 35, 6h avg: 35, mode: space) - OK: Normal operation (80 Hz, 6h avg: 35 Hz)[0m
[36m2025-10-27 19:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 19:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 19:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 19:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 19:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 19:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 19:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 19:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 19:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 19:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 19:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 112}[0m
[36m2025-10-27 19:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 19:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 19:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 19:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 19:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 19:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 19:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 19:50:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 19:50:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q79 = 98.57 Ã¶re/kWh[0m
[36m2025-10-27 19:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 19:50:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 19:50:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 19:50:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 19:50:32.962 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 19:50:32.962 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-27 19:50:32.962 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 19:50:32.965 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 19:50:32.965 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 19:50:32.965 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 19:50:32.965 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:50:32.965 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-27 19:50:32.965 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:50:32.965 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-27 19:50:32.966 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-27 19:50:32.966 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 19:50:32.966 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 19:50:32.966 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=26.5Â°C, error=-0.1Â°C, sensitivity=1.5 -> offset=-0.1[0m
[36m2025-10-27 19:50:32.966 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 19:50:32.966 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 26.5Â°C â†’ offset: -0.1Â°C; Weight: 0.23; Deferred: Light debt (DM -200)[0m
[36m2025-10-27 19:50:32.966 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Price classification Q79 (19:50): 98.57 â†’ NORMAL[0m
[32m2025-10-27 19:50:32.966 INFO (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.69Â°C - Learned pre-heat: Pre-heating: predicted drop 1.9Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 26.5Â°C â†’ offset: -0.1Â°C; Weight: 0.23; Deferred: Light debt (DM -200) | GE-Spot Q79: NORMAL (day) | Too warm: 2.2Â°C over[0m
[32m2025-10-27 19:50:32.967 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.69Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.9Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 26.5Â°C â†’ offset: -0.1Â°C; Weight: 0.23; Deferred: Light debt (DM -200) | GE-Spot Q79: NORMAL (day) | Too warm: 2.2Â°C over[0m
[36m2025-10-27 19:50:32.967 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Skipping offset write, too soon since last write[0m
[36m2025-10-27 19:50:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.69Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 19:50:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 2.234 kW from sensor.gen24_elnat_import_effekt[0m
[32m2025-10-27 19:50:32.967 INFO (MainThread) [custom_components.effektguard.coordinator] New daily peak: 2.23 kW at 19:50:32 (quarter 79, source: external_meter)[0m
[36m2025-10-27 19:50:32.967 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.2Â°C, outdoor=8.2Â°C, offset=0.7Â°C, change=0.02Â°C, Î”t=0.08h[0m
[36m2025-10-27 19:50:32.967 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.2Â°C, outdoor=8.2Â°C, offset=0.7Â°C, flow=26.5Â°C, DM=-200[0m
[36m2025-10-27 19:50:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-27 19:50:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 19:50:32.969 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 19:50:32.969 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 19:50:32.969 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=19.6[0m
[36m2025-10-27 19:50:32.969 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:50:32.969 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW temp lux currently ON, last_changed: 2025-10-27 18:46:36.685787+00:00[0m
[36m2025-10-27 19:50:32.969 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:50:32.969 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-27 19:50:32.969 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW temp lux currently ON, last_changed: 2025-10-27 18:46:36.685787+00:00[0m
[36m2025-10-27 19:50:32.969 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:50:32.969 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-27 19:50:32.970 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control rate limited: 5.0 min since last change (min 60 min)[0m
[36m2025-10-27 19:50:32.970 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.011 seconds (success: True)[0m
[36m2025-10-27 19:50:32.971 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (8.6 + 1.6 + 0.7)A Ã— 0.95 = 2.49 kW[0m
[36m2025-10-27 19:50:32.971 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 19:55:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 19:55:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.1Â°C (median of 9 sensors: 24.1Â°C, 21.8Â°C, 22.1Â°C, 22.8Â°C, 25.4Â°C, 23.2Â°C, 23.1Â°C, 23.0Â°C, 24.0Â°C)[0m
[36m2025-10-27 19:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -215.0[0m
[36m2025-10-27 19:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 20.6Â°C[0m
[36m2025-10-27 19:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 35.0Â°C[0m
[36m2025-10-27 19:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=8.6A, L2=1.6A, L3=0.7A[0m
[36m2025-10-27 19:55:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.1Â°C, outdoor 8.2Â°C, flow 35.0Â°C, DM -215[0m
[36m2025-10-27 19:55:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 80 Hz (1h avg: 44, 6h avg: 44, mode: space) - OK: Normal operation (80 Hz, 6h avg: 44 Hz)[0m
[36m2025-10-27 19:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 19:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 19:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 19:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 19:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 19:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 19:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 19:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 19:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 19:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 19:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 112}[0m
[36m2025-10-27 19:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 19:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 19:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 19:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 19:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 19:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 19:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 19:55:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 19:55:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q79 = 98.57 Ã¶re/kWh[0m
[36m2025-10-27 19:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 19:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 19:55:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 19:55:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 19:55:32.961 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 19:55:32.961 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-27 19:55:32.962 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 19:55:32.963 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 19:55:32.964 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 19:55:32.964 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 19:55:32.964 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:55:32.964 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-27 19:55:32.964 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:55:32.964 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-27 19:55:32.964 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-27 19:55:32.964 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 19:55:32.964 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 19:55:32.964 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=35.0Â°C, error=-8.6Â°C, sensitivity=1.5 -> offset=-5.7[0m
[36m2025-10-27 19:55:32.964 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 19:55:32.964 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 35.0Â°C â†’ offset: -5.7Â°C; Weight: 0.20; Deferred: Moderate debt (DM -215)[0m
[36m2025-10-27 19:55:32.965 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Price classification Q79 (19:55): 98.57 â†’ NORMAL[0m
[32m2025-10-27 19:55:32.965 INFO (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.17Â°C - Learned pre-heat: Pre-heating: predicted drop 1.9Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 35.0Â°C â†’ offset: -5.7Â°C; Weight: 0.20; Deferred: Moderate debt (DM -215) | GE-Spot Q79: NORMAL (day) | Too warm: 2.1Â°C over[0m
[32m2025-10-27 19:55:32.965 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.17Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.9Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 35.0Â°C â†’ offset: -5.7Â°C; Weight: 0.20; Deferred: Moderate debt (DM -215) | GE-Spot Q79: NORMAL (day) | Too warm: 2.1Â°C over[0m
[36m2025-10-27 19:55:32.965 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.17Â°C, integer=0Â°C, fractional=0.17Â°C, accumulator_before=0.55Â°C[0m
[36m2025-10-27 19:55:32.965 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: 0.72Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-27 19:55:32.965 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.17Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 19:55:32.965 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 2.553 kW from sensor.gen24_elnat_import_effekt[0m
[32m2025-10-27 19:55:32.965 INFO (MainThread) [custom_components.effektguard.coordinator] New daily peak: 2.55 kW at 19:55:32 (quarter 79, source: external_meter)[0m
[36m2025-10-27 19:55:32.966 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.1Â°C, outdoor=8.2Â°C, offset=0.2Â°C, change=-0.15Â°C, Î”t=0.08h[0m
[36m2025-10-27 19:55:32.966 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.1Â°C, outdoor=8.2Â°C, offset=0.2Â°C, flow=35.0Â°C, DM=-215[0m
[36m2025-10-27 19:55:32.969 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.3Â°C/h trend[0m
[36m2025-10-27 19:55:32.970 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 19:55:32.975 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 19:55:32.975 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 19:55:32.975 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=20.6[0m
[36m2025-10-27 19:55:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:55:32.976 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW temp lux currently ON, last_changed: 2025-10-27 18:46:36.685787+00:00[0m
[36m2025-10-27 19:55:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:55:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-27 19:55:32.976 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW temp lux currently ON, last_changed: 2025-10-27 18:46:36.685787+00:00[0m
[36m2025-10-27 19:55:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 19:55:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-27 19:55:32.976 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control rate limited: 10.0 min since last change (min 60 min)[0m
[36m2025-10-27 19:55:32.976 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.018 seconds (success: True)[0m
[36m2025-10-27 19:55:32.978 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (8.6 + 1.6 + 0.7)A Ã— 0.95 = 2.49 kW[0m
[36m2025-10-27 19:55:32.978 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[31m2025-10-27 19:55:47.231 ERROR (MainThread) [homeassistant.components.myuplink.coordinator] Timeout fetching myuplink data[0m
[36m2025-10-27 20:00:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 20:00:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.0Â°C (median of 9 sensors: 21.0Â°C, 21.8Â°C, 22.2Â°C, 22.8Â°C, 25.4Â°C, 23.2Â°C, 23.1Â°C, 23.0Â°C, 24.0Â°C)[0m
[36m2025-10-27 20:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Estimating degree minutes from thermal model: -51.5[0m
[36m2025-10-27 20:00:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.0Â°C, outdoor 0.0Â°C, flow 35.0Â°C, DM -52[0m
[36m2025-10-27 20:00:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor Hz not available from NIBE adapter[0m
[36m2025-10-27 20:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 20:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 20:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 20:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 20:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 20:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 20:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 20:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 20:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 20:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 20:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 111}[0m
[36m2025-10-27 20:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 20:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 20:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 20:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 20:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 20:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 20:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 20:00:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 20:00:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q80 = 115.07 Ã¶re/kWh[0m
[36m2025-10-27 20:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 20:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 20:00:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 20:00:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 20:00:32.961 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 20:00:32.961 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-27 20:00:32.963 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 20:00:32.964 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 20:00:32.966 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 20:00:32.966 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 20:00:32.966 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 0.0Â°C (zone avg: -1.0Â°C, delta: 1.0Â°C): normal -280 to -480, warning -480, critical -1500[0m
[36m2025-10-27 20:00:32.966 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 0.0Â°C: normal -280 to -480, warning -480[0m
[36m2025-10-27 20:00:32.966 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 0.0Â°C (zone avg: -1.0Â°C, delta: 1.0Â°C): normal -280 to -480, warning -480, critical -1500[0m
[36m2025-10-27 20:00:32.966 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -480 (base: -480), critical -1500[0m
[36m2025-10-27 20:00:32.966 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=0.0Â°C, indoor_target=21.0Â°C, temp_diff=21.0Â°C, HC=0.180 kW/K -> flow=28.2Â°C[0m
[36m2025-10-27 20:00:32.966 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 20:00:32.967 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 20:00:32.967 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=28.7Â°C, current=35.0Â°C, error=-6.3Â°C, sensitivity=1.5 -> offset=-4.2[0m
[36m2025-10-27 20:00:32.967 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=0.0Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.75[0m
[36m2025-10-27 20:00:32.967 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 28.2Â°C; Safety: +0.5Â°C; Adjusted: 28.7Â°C; Current: 35.0Â°C â†’ offset: -4.2Â°C; Weight: 0.37[0m
[36m2025-10-27 20:00:32.967 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Price classification Q80 (20:00): 115.07 â†’ EXPENSIVE[0m
[32m2025-10-27 20:00:32.967 INFO (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.11Â°C - Learned pre-heat: Pre-heating: predicted drop 2.0Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 28.2Â°C; Safety: +0.5Â°C; Adjusted: 28.7Â°C; Current: 35.0Â°C â†’ offset: -4.2Â°C; Weight: 0.37 | GE-Spot Q80: EXPENSIVE (day) | Too warm: 2.0Â°C over (boosted 15%: cooling -0.33Â°C/h)[0m
[32m2025-10-27 20:00:32.967 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.11Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 2.0Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 28.2Â°C; Safety: +0.5Â°C; Adjusted: 28.7Â°C; Current: 35.0Â°C â†’ offset: -4.2Â°C; Weight: 0.37 | GE-Spot Q80: EXPENSIVE (day) | Too warm: 2.0Â°C over (boosted 15%: cooling -0.33Â°C/h)[0m
[33m2025-10-27 20:00:32.968 WARNING (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset entity number.f750_cu_3x400v_heating_offset_climate_system_1 not ready (state: unavailable), skipping write[0m
[36m2025-10-27 20:00:32.968 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset -0.11Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 20:00:32.968 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 2.647 kW from sensor.gen24_elnat_import_effekt[0m
[32m2025-10-27 20:00:32.968 INFO (MainThread) [custom_components.effektguard.coordinator] New daily peak: 2.65 kW at 20:00:32 (quarter 80, source: external_meter)[0m
[36m2025-10-27 20:00:32.968 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.0Â°C, outdoor=0.0Â°C, offset=-0.1Â°C, change=-0.13Â°C, Î”t=0.08h[0m
[36m2025-10-27 20:00:32.968 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.0Â°C, outdoor=0.0Â°C, offset=-0.1Â°C, flow=35.0Â°C, DM=-52[0m
[36m2025-10-27 20:00:32.974 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.5Â°C/h trend[0m
[36m2025-10-27 20:00:32.974 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 20:00:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 20:00:32.976 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 20:00:32.976 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=None[0m
[33m2025-10-27 20:00:32.976 WARNING (MainThread) [custom_components.effektguard.coordinator] DHW sensor (BT7) not found - check MyUplink integration has exposed BT7/40013 sensor[0m
[36m2025-10-27 20:00:32.976 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.018 seconds (success: True)[0m
[36m2025-10-27 20:00:32.978 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 20:05:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 20:05:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.0Â°C (median of 9 sensors: 21.0Â°C, 21.8Â°C, 22.1Â°C, 22.8Â°C, 25.4Â°C, 23.2Â°C, 23.1Â°C, 23.0Â°C, 24.0Â°C)[0m
[36m2025-10-27 20:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Estimating degree minutes from thermal model: -51.5[0m
[36m2025-10-27 20:05:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.0Â°C, outdoor 0.0Â°C, flow 35.0Â°C, DM -52[0m
[36m2025-10-27 20:05:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor Hz not available from NIBE adapter[0m
[36m2025-10-27 20:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 20:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 20:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 20:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 20:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 20:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 20:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 20:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 20:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 20:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 20:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 111}[0m
[36m2025-10-27 20:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 20:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 20:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 20:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 20:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 20:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 20:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 20:05:32.961 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 20:05:32.961 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q80 = 115.07 Ã¶re/kWh[0m
[36m2025-10-27 20:05:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 20:05:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 20:05:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 20:05:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 20:05:32.962 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 20:05:32.962 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-27 20:05:32.962 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 20:05:32.963 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 20:05:32.965 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 20:05:32.965 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 20:05:32.965 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.climate_zones] DM range for 0.0Â°C (zone avg: -1.0Â°C, delta: 1.0Â°C): normal -280 to -480, warning -480, critical -1500[0m
[36m2025-10-27 20:05:32.965 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 0.0Â°C: normal -280 to -480, warning -480[0m
[36m2025-10-27 20:05:32.965 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.climate_zones] DM range for 0.0Â°C (zone avg: -1.0Â°C, delta: 1.0Â°C): normal -280 to -480, warning -480, critical -1500[0m
[36m2025-10-27 20:05:32.965 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -480 (base: -480), critical -1500[0m
[36m2025-10-27 20:05:32.966 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=0.0Â°C, indoor_target=21.0Â°C, temp_diff=21.0Â°C, HC=0.180 kW/K -> flow=28.2Â°C[0m
[36m2025-10-27 20:05:32.966 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 20:05:32.966 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 20:05:32.966 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=28.7Â°C, current=35.0Â°C, error=-6.3Â°C, sensitivity=1.5 -> offset=-4.2[0m
[36m2025-10-27 20:05:32.966 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=0.0Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.75[0m
[36m2025-10-27 20:05:32.966 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 28.2Â°C; Safety: +0.5Â°C; Adjusted: 28.7Â°C; Current: 35.0Â°C â†’ offset: -4.2Â°C; Weight: 0.37[0m
[36m2025-10-27 20:05:32.966 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Price classification Q80 (20:05): 115.07 â†’ EXPENSIVE[0m
[32m2025-10-27 20:05:32.966 INFO (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.22Â°C - Learned pre-heat: Pre-heating: predicted drop 2.2Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 28.2Â°C; Safety: +0.5Â°C; Adjusted: 28.7Â°C; Current: 35.0Â°C â†’ offset: -4.2Â°C; Weight: 0.37 | Weather pre-heat: Indoor cooling -0.55Â°C/h (reactive confirmation) â†’ +0.8Â°C @ weight 0.99 (base 0.85 Ã— thermal_mass 2.0) | GE-Spot Q80: EXPENSIVE (day) | Too warm: 2.0Â°C over (boosted 15%: cooling -0.55Â°C/h)[0m
[32m2025-10-27 20:05:32.967 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.22Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 2.2Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 28.2Â°C; Safety: +0.5Â°C; Adjusted: 28.7Â°C; Current: 35.0Â°C â†’ offset: -4.2Â°C; Weight: 0.37 | Weather pre-heat: Indoor cooling -0.55Â°C/h (reactive confirmation) â†’ +0.8Â°C @ weight 0.99 (base 0.85 Ã— thermal_mass 2.0) | GE-Spot Q80: EXPENSIVE (day) | Too warm: 2.0Â°C over (boosted 15%: cooling -0.55Â°C/h)[0m
[33m2025-10-27 20:05:32.967 WARNING (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset entity number.f750_cu_3x400v_heating_offset_climate_system_1 not ready (state: unavailable), skipping write[0m
[36m2025-10-27 20:05:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.22Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 20:05:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 2.648 kW from sensor.gen24_elnat_import_effekt[0m
[32m2025-10-27 20:05:32.967 INFO (MainThread) [custom_components.effektguard.coordinator] New daily peak: 2.65 kW at 20:05:32 (quarter 80, source: external_meter)[0m
[36m2025-10-27 20:05:32.967 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.0Â°C, outdoor=0.0Â°C, offset=0.2Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 20:05:32.967 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.0Â°C, outdoor=0.0Â°C, offset=0.2Â°C, flow=35.0Â°C, DM=-52[0m
[36m2025-10-27 20:05:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-27 20:05:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 20:05:32.969 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 20:05:32.969 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 20:05:32.969 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=None[0m
[33m2025-10-27 20:05:32.969 WARNING (MainThread) [custom_components.effektguard.coordinator] DHW sensor (BT7) not found - check MyUplink integration has exposed BT7/40013 sensor[0m
[36m2025-10-27 20:05:32.970 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.011 seconds (success: True)[0m
[36m2025-10-27 20:05:32.971 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 20:10:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 20:10:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.0Â°C (median of 9 sensors: 21.0Â°C, 21.7Â°C, 22.2Â°C, 22.8Â°C, 25.4Â°C, 23.2Â°C, 23.1Â°C, 23.0Â°C, 24.0Â°C)[0m
[36m2025-10-27 20:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Estimating degree minutes from thermal model: -51.5[0m
[36m2025-10-27 20:10:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.0Â°C, outdoor 0.0Â°C, flow 35.0Â°C, DM -52[0m
[36m2025-10-27 20:10:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor Hz not available from NIBE adapter[0m
[36m2025-10-27 20:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 20:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 20:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 20:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 20:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 20:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 20:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 20:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 20:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 20:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 20:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 111}[0m
[36m2025-10-27 20:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 20:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 20:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 20:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 20:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 20:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 20:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 20:10:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 20:10:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q80 = 115.07 Ã¶re/kWh[0m
[36m2025-10-27 20:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 20:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 20:10:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 20:10:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 20:10:32.962 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 20:10:32.962 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-27 20:10:32.963 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 20:10:32.963 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 20:10:32.964 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 20:10:32.964 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 20:10:32.964 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 0.0Â°C (zone avg: -1.0Â°C, delta: 1.0Â°C): normal -280 to -480, warning -480, critical -1500[0m
[36m2025-10-27 20:10:32.964 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 0.0Â°C: normal -280 to -480, warning -480[0m
[36m2025-10-27 20:10:32.964 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 0.0Â°C (zone avg: -1.0Â°C, delta: 1.0Â°C): normal -280 to -480, warning -480, critical -1500[0m
[36m2025-10-27 20:10:32.964 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -480 (base: -480), critical -1500[0m
[36m2025-10-27 20:10:32.965 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=0.0Â°C, indoor_target=21.0Â°C, temp_diff=21.0Â°C, HC=0.180 kW/K -> flow=28.2Â°C[0m
[36m2025-10-27 20:10:32.965 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 20:10:32.965 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 20:10:32.965 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=28.7Â°C, current=35.0Â°C, error=-6.3Â°C, sensitivity=1.5 -> offset=-4.2[0m
[36m2025-10-27 20:10:32.965 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=0.0Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.75[0m
[36m2025-10-27 20:10:32.965 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 28.2Â°C; Safety: +0.5Â°C; Adjusted: 28.7Â°C; Current: 35.0Â°C â†’ offset: -4.2Â°C; Weight: 0.37[0m
[36m2025-10-27 20:10:32.965 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Price classification Q80 (20:10): 115.07 â†’ EXPENSIVE[0m
[32m2025-10-27 20:10:32.965 INFO (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.22Â°C - Learned pre-heat: Pre-heating: predicted drop 2.2Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 28.2Â°C; Safety: +0.5Â°C; Adjusted: 28.7Â°C; Current: 35.0Â°C â†’ offset: -4.2Â°C; Weight: 0.37 | Weather pre-heat: Indoor cooling -0.51Â°C/h (reactive confirmation) â†’ +0.8Â°C @ weight 0.99 (base 0.85 Ã— thermal_mass 2.0) | GE-Spot Q80: EXPENSIVE (day) | Too warm: 2.0Â°C over (boosted 15%: cooling -0.51Â°C/h)[0m
[32m2025-10-27 20:10:32.965 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.22Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 2.2Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 28.2Â°C; Safety: +0.5Â°C; Adjusted: 28.7Â°C; Current: 35.0Â°C â†’ offset: -4.2Â°C; Weight: 0.37 | Weather pre-heat: Indoor cooling -0.51Â°C/h (reactive confirmation) â†’ +0.8Â°C @ weight 0.99 (base 0.85 Ã— thermal_mass 2.0) | GE-Spot Q80: EXPENSIVE (day) | Too warm: 2.0Â°C over (boosted 15%: cooling -0.51Â°C/h)[0m
[33m2025-10-27 20:10:32.965 WARNING (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset entity number.f750_cu_3x400v_heating_offset_climate_system_1 not ready (state: unavailable), skipping write[0m
[36m2025-10-27 20:10:32.966 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.22Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 20:10:32.966 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 2.899 kW from sensor.gen24_elnat_import_effekt[0m
[32m2025-10-27 20:10:32.966 INFO (MainThread) [custom_components.effektguard.coordinator] New daily peak: 2.90 kW at 20:10:32 (quarter 80, source: external_meter)[0m
[36m2025-10-27 20:10:32.966 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.0Â°C, outdoor=0.0Â°C, offset=0.2Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 20:10:32.966 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.0Â°C, outdoor=0.0Â°C, offset=0.2Â°C, flow=35.0Â°C, DM=-52[0m
[36m2025-10-27 20:10:32.968 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.5Â°C/h trend[0m
[36m2025-10-27 20:10:32.968 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 20:10:32.970 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 20:10:32.970 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 20:10:32.970 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=None[0m
[33m2025-10-27 20:10:32.971 WARNING (MainThread) [custom_components.effektguard.coordinator] DHW sensor (BT7) not found - check MyUplink integration has exposed BT7/40013 sensor[0m
[36m2025-10-27 20:10:32.971 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.012 seconds (success: True)[0m
[36m2025-10-27 20:10:32.972 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 20:15:32.958 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 20:15:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.0Â°C (median of 9 sensors: 21.0Â°C, 21.7Â°C, 22.1Â°C, 22.8Â°C, 25.4Â°C, 23.3Â°C, 23.1Â°C, 23.0Â°C, 24.0Â°C)[0m
[36m2025-10-27 20:15:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Estimating degree minutes from thermal model: -51.5[0m
[36m2025-10-27 20:15:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.0Â°C, outdoor 0.0Â°C, flow 35.0Â°C, DM -52[0m
[36m2025-10-27 20:15:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor Hz not available from NIBE adapter[0m
[36m2025-10-27 20:15:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 20:15:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 20:15:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 20:15:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 20:15:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 20:15:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 20:15:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 20:15:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 20:15:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 20:15:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 20:15:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 110}[0m
[36m2025-10-27 20:15:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 20:15:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 20:15:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 20:15:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 20:15:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 20:15:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 20:15:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 20:15:32.961 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 20:15:32.961 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q81 = 118.40 Ã¶re/kWh[0m
[36m2025-10-27 20:15:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 20:15:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 20:15:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 20:15:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 20:15:32.962 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 20:15:32.962 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-27 20:15:32.962 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 20:15:32.963 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 20:15:32.964 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 20:15:32.964 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 20:15:32.964 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.climate_zones] DM range for 0.0Â°C (zone avg: -1.0Â°C, delta: 1.0Â°C): normal -280 to -480, warning -480, critical -1500[0m
[36m2025-10-27 20:15:32.965 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 0.0Â°C: normal -280 to -480, warning -480[0m
[36m2025-10-27 20:15:32.965 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.climate_zones] DM range for 0.0Â°C (zone avg: -1.0Â°C, delta: 1.0Â°C): normal -280 to -480, warning -480, critical -1500[0m
[36m2025-10-27 20:15:32.965 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -480 (base: -480), critical -1500[0m
[36m2025-10-27 20:15:32.965 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=0.0Â°C, indoor_target=21.0Â°C, temp_diff=21.0Â°C, HC=0.180 kW/K -> flow=28.2Â°C[0m
[36m2025-10-27 20:15:32.965 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 20:15:32.965 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 20:15:32.965 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=28.7Â°C, current=35.0Â°C, error=-6.3Â°C, sensitivity=1.5 -> offset=-4.2[0m
[36m2025-10-27 20:15:32.965 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=0.0Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.75[0m
[36m2025-10-27 20:15:32.965 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 28.2Â°C; Safety: +0.5Â°C; Adjusted: 28.7Â°C; Current: 35.0Â°C â†’ offset: -4.2Â°C; Weight: 0.37[0m
[36m2025-10-27 20:15:32.965 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Price classification Q81 (20:15): 118.40 â†’ EXPENSIVE[0m
[32m2025-10-27 20:15:32.965 INFO (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.11Â°C - Learned pre-heat: Pre-heating: predicted drop 2.2Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 28.2Â°C; Safety: +0.5Â°C; Adjusted: 28.7Â°C; Current: 35.0Â°C â†’ offset: -4.2Â°C; Weight: 0.37 | GE-Spot Q81: EXPENSIVE (day) | Too warm: 2.0Â°C over (boosted 15%: cooling -0.48Â°C/h)[0m
[32m2025-10-27 20:15:32.967 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.11Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 2.2Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 28.2Â°C; Safety: +0.5Â°C; Adjusted: 28.7Â°C; Current: 35.0Â°C â†’ offset: -4.2Â°C; Weight: 0.37 | GE-Spot Q81: EXPENSIVE (day) | Too warm: 2.0Â°C over (boosted 15%: cooling -0.48Â°C/h)[0m
[33m2025-10-27 20:15:32.968 WARNING (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset entity number.f750_cu_3x400v_heating_offset_climate_system_1 not ready (state: unavailable), skipping write[0m
[36m2025-10-27 20:15:32.968 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset -0.11Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 20:15:32.968 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 2.872 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 20:15:32.968 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.0Â°C, outdoor=0.0Â°C, offset=-0.1Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 20:15:32.968 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.0Â°C, outdoor=0.0Â°C, offset=-0.1Â°C, flow=35.0Â°C, DM=-52[0m
[36m2025-10-27 20:15:32.972 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.5Â°C/h trend[0m
[36m2025-10-27 20:15:32.972 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 20:15:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 20:15:32.976 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 20:15:32.976 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=None[0m
[33m2025-10-27 20:15:32.976 WARNING (MainThread) [custom_components.effektguard.coordinator] DHW sensor (BT7) not found - check MyUplink integration has exposed BT7/40013 sensor[0m
[36m2025-10-27 20:15:32.976 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.018 seconds (success: True)[0m
[36m2025-10-27 20:15:32.978 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 20:20:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 20:20:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.0Â°C (median of 9 sensors: 21.0Â°C, 21.7Â°C, 22.1Â°C, 22.9Â°C, 25.4Â°C, 23.3Â°C, 23.1Â°C, 23.0Â°C, 24.0Â°C)[0m
[36m2025-10-27 20:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Estimating degree minutes from thermal model: -52.0[0m
[36m2025-10-27 20:20:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.0Â°C, outdoor 0.0Â°C, flow 35.0Â°C, DM -52[0m
[36m2025-10-27 20:20:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor Hz not available from NIBE adapter[0m
[36m2025-10-27 20:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 20:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 20:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 20:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 20:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 20:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 20:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 20:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 20:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 20:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 20:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 110}[0m
[36m2025-10-27 20:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 20:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 20:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 20:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 20:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 20:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 20:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 20:20:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 20:20:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q81 = 118.40 Ã¶re/kWh[0m
[36m2025-10-27 20:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 20:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 20:20:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 20:20:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 20:20:32.961 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 20:20:32.961 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-27 20:20:32.961 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 20:20:32.962 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 20:20:32.963 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 20:20:32.963 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 20:20:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 0.0Â°C (zone avg: -1.0Â°C, delta: 1.0Â°C): normal -280 to -480, warning -480, critical -1500[0m
[36m2025-10-27 20:20:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 0.0Â°C: normal -280 to -480, warning -480[0m
[36m2025-10-27 20:20:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 0.0Â°C (zone avg: -1.0Â°C, delta: 1.0Â°C): normal -280 to -480, warning -480, critical -1500[0m
[36m2025-10-27 20:20:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -480 (base: -480), critical -1500[0m
[36m2025-10-27 20:20:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=0.0Â°C, indoor_target=21.0Â°C, temp_diff=21.0Â°C, HC=0.180 kW/K -> flow=28.2Â°C[0m
[36m2025-10-27 20:20:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 20:20:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 20:20:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=28.7Â°C, current=35.0Â°C, error=-6.3Â°C, sensitivity=1.5 -> offset=-4.2[0m
[36m2025-10-27 20:20:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=0.0Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.75[0m
[36m2025-10-27 20:20:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 28.2Â°C; Safety: +0.5Â°C; Adjusted: 28.7Â°C; Current: 35.0Â°C â†’ offset: -4.2Â°C; Weight: 0.37[0m
[36m2025-10-27 20:20:32.965 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Price classification Q81 (20:20): 118.40 â†’ EXPENSIVE[0m
[32m2025-10-27 20:20:32.965 INFO (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.11Â°C - Learned pre-heat: Pre-heating: predicted drop 2.2Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 28.2Â°C; Safety: +0.5Â°C; Adjusted: 28.7Â°C; Current: 35.0Â°C â†’ offset: -4.2Â°C; Weight: 0.37 | GE-Spot Q81: EXPENSIVE (day) | Too warm: 2.0Â°C over (boosted 15%: cooling -0.48Â°C/h)[0m
[32m2025-10-27 20:20:32.965 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.11Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 2.2Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 28.2Â°C; Safety: +0.5Â°C; Adjusted: 28.7Â°C; Current: 35.0Â°C â†’ offset: -4.2Â°C; Weight: 0.37 | GE-Spot Q81: EXPENSIVE (day) | Too warm: 2.0Â°C over (boosted 15%: cooling -0.48Â°C/h)[0m
[33m2025-10-27 20:20:32.965 WARNING (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset entity number.f750_cu_3x400v_heating_offset_climate_system_1 not ready (state: unavailable), skipping write[0m
[36m2025-10-27 20:20:32.965 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset -0.11Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 20:20:32.965 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 2.913 kW from sensor.gen24_elnat_import_effekt[0m
[32m2025-10-27 20:20:32.965 INFO (MainThread) [custom_components.effektguard.coordinator] New daily peak: 2.91 kW at 20:20:32 (quarter 81, source: external_meter)[0m
[36m2025-10-27 20:20:32.965 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.0Â°C, outdoor=0.0Â°C, offset=-0.1Â°C, change=-0.01Â°C, Î”t=0.08h[0m
[36m2025-10-27 20:20:32.965 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.0Â°C, outdoor=0.0Â°C, offset=-0.1Â°C, flow=35.0Â°C, DM=-52[0m
[36m2025-10-27 20:20:32.965 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-27 20:20:32.965 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 20:20:32.967 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 20:20:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 20:20:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=None[0m
[33m2025-10-27 20:20:32.967 WARNING (MainThread) [custom_components.effektguard.coordinator] DHW sensor (BT7) not found - check MyUplink integration has exposed BT7/40013 sensor[0m
[36m2025-10-27 20:20:32.968 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.009 seconds (success: True)[0m
[36m2025-10-27 20:20:32.969 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 20:25:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 20:25:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.0Â°C (median of 9 sensors: 24.1Â°C, 21.7Â°C, 22.1Â°C, 22.8Â°C, 25.3Â°C, 23.3Â°C, 22.9Â°C, 23.0Â°C, 24.0Â°C)[0m
[36m2025-10-27 20:25:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -332.0[0m
[36m2025-10-27 20:25:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 32.1Â°C[0m
[36m2025-10-27 20:25:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 55.0Â°C[0m
[36m2025-10-27 20:25:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=10.9A, L2=0.6A, L3=2.1A[0m
[36m2025-10-27 20:25:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.0Â°C, outdoor 8.2Â°C, flow 55.0Â°C, DM -332[0m
[36m2025-10-27 20:25:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 80 Hz (1h avg: 50, 6h avg: 50, mode: space) - OK: Normal operation (80 Hz, 6h avg: 50 Hz)[0m
[36m2025-10-27 20:25:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 20:25:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 20:25:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 20:25:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 20:25:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 20:25:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 20:25:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 20:25:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 20:25:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 20:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 20:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 110}[0m
[36m2025-10-27 20:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 20:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 20:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 20:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 20:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 20:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 20:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 20:25:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 20:25:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q81 = 118.40 Ã¶re/kWh[0m
[36m2025-10-27 20:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 20:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 20:25:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 20:25:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 20:25:32.961 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 20:25:32.961 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-27 20:25:32.962 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 20:25:32.962 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 20:25:32.963 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 20:25:32.964 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 20:25:32.964 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 20:25:32.964 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-27 20:25:32.964 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 20:25:32.964 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[32m2025-10-27 20:25:32.964 INFO (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] T1 overshoot damping: severe overshoot +2.0Â°C, offset 4.00Â°C â†’ 3.20Â°C (factor 0.80, min 1.0Â°C)[0m
[36m2025-10-27 20:25:32.964 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-27 20:25:32.964 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 20:25:32.964 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 20:25:32.964 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=55.0Â°C, error=-28.6Â°C, sensitivity=1.5 -> offset=-19.1[0m
[36m2025-10-27 20:25:32.964 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 20:25:32.965 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 55.0Â°C â†’ offset: -19.1Â°C; Weight: 0.18; Deferred: Significant debt (DM -332)[0m
[36m2025-10-27 20:25:32.965 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Price classification Q81 (20:25): 118.40 â†’ EXPENSIVE[0m
[32m2025-10-27 20:25:32.965 INFO (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.36Â°C - MODERATE RECOVERY: DM -332 beyond expected for 8.2Â°C (threshold: -316) [severe overshoot +2.0Â°C] | Learned pre-heat: Pre-heating: predicted drop 2.2Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 55.0Â°C â†’ offset: -19.1Â°C; Weight: 0.18; Deferred: Significant debt (DM -332) | GE-Spot Q81: EXPENSIVE (day) | Too warm: 2.0Â°C over (boosted 15%: cooling -0.46Â°C/h)[0m
[32m2025-10-27 20:25:32.965 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.36Â°C, reasoning: MODERATE RECOVERY: DM -332 beyond expected for 8.2Â°C (threshold: -316) [severe overshoot +2.0Â°C] | Learned pre-heat: Pre-heating: predicted drop 2.2Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 55.0Â°C â†’ offset: -19.1Â°C; Weight: 0.18; Deferred: Significant debt (DM -332) | GE-Spot Q81: EXPENSIVE (day) | Too warm: 2.0Â°C over (boosted 15%: cooling -0.46Â°C/h)[0m
[36m2025-10-27 20:25:32.965 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.36Â°C, integer=0Â°C, fractional=0.36Â°C, accumulator_before=0.72Â°C[0m
[32m2025-10-27 20:25:32.965 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] âœ“ Accumulated fractional offset reached threshold: applying +1Â°C adjustment (accumulator: 1.07Â°C â†’ 0.07Â°C)[0m
[36m2025-10-27 20:25:32.965 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Accumulator triggered: total_accumulated=1.07Â°C, adjustment=+1Â°C, new_integer=1Â°C, remaining=0.07Â°C[0m
[36m2025-10-27 20:25:32.965 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset 0.36Â°C â†’ applying 1Â°C (accumulator: 0.07Â°C, needs 0.93Â°C more to trigger)[0m
[32m2025-10-27 20:25:32.967 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to 1Â°C (calculated: 0.36Â°C, accumulator: 0.07Â°C)[0m
[36m2025-10-27 20:25:32.967 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=1Â°C, original=0.36Â°C, accumulator=0.07Â°C[0m
[32m2025-10-27 20:25:32.967 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset 0.36Â°C to NIBE via MyUplink[0m
[36m2025-10-27 20:25:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 2.858 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 20:25:32.967 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.0Â°C, outdoor=8.2Â°C, offset=0.4Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 20:25:32.967 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.0Â°C, outdoor=8.2Â°C, offset=0.4Â°C, flow=55.0Â°C, DM=-332[0m
[36m2025-10-27 20:25:32.976 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.5Â°C/h trend[0m
[36m2025-10-27 20:25:32.977 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 20:25:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 20:25:32.978 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 20:25:32.978 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=32.1[0m
[36m2025-10-27 20:25:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 20:25:32.978 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW temp lux currently ON, last_changed: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 20:25:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 20:25:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-27 20:25:32.979 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW temp lux currently ON, last_changed: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 20:25:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 20:25:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-27 20:25:32.979 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control rate limited: 40.0 min since last change (min 60 min)[0m
[36m2025-10-27 20:25:32.979 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.020 seconds (success: True)[0m
[36m2025-10-27 20:25:32.981 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (10.9 + 0.6 + 2.1)A Ã— 0.95 = 3.10 kW[0m
[36m2025-10-27 20:25:32.981 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 20:30:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 20:30:32.960 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 22.9Â°C (median of 9 sensors: 24.1Â°C, 21.7Â°C, 22.0Â°C, 22.9Â°C, 25.3Â°C, 23.3Â°C, 22.9Â°C, 22.9Â°C, 24.0Â°C)[0m
[36m2025-10-27 20:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -353.0[0m
[36m2025-10-27 20:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 33.1Â°C[0m
[36m2025-10-27 20:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 55.0Â°C[0m
[36m2025-10-27 20:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=10.9A, L2=0.6A, L3=1.1A[0m
[36m2025-10-27 20:30:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 22.9Â°C, outdoor 8.2Â°C, flow 55.0Â°C, DM -353[0m
[36m2025-10-27 20:30:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 80 Hz (1h avg: 54, 6h avg: 54, mode: space) - OK: Normal operation (80 Hz, 6h avg: 54 Hz)[0m
[36m2025-10-27 20:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 20:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 20:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 20:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 20:30:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 20:30:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 20:30:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 20:30:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 20:30:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 20:30:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 20:30:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 109}[0m
[36m2025-10-27 20:30:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 20:30:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 20:30:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 20:30:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 20:30:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 20:30:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 20:30:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 20:30:32.961 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 20:30:32.961 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q82 = 101.20 Ã¶re/kWh[0m
[36m2025-10-27 20:30:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 20:30:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 20:30:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 20:30:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 20:30:32.963 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 20:30:32.963 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-27 20:30:32.963 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 20:30:32.964 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 20:30:32.966 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 20:30:32.967 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 20:30:32.967 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 20:30:32.967 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-27 20:30:32.967 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 20:30:32.967 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[32m2025-10-27 20:30:32.967 INFO (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] T1 overshoot damping: severe overshoot +1.9Â°C, offset 4.00Â°C â†’ 3.20Â°C (factor 0.80, min 1.0Â°C)[0m
[36m2025-10-27 20:30:32.967 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-27 20:30:32.967 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 20:30:32.967 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 20:30:32.967 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=55.0Â°C, error=-28.6Â°C, sensitivity=1.5 -> offset=-19.1[0m
[36m2025-10-27 20:30:32.967 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 20:30:32.967 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 55.0Â°C â†’ offset: -19.1Â°C; Weight: 0.18; Deferred: Significant debt (DM -353)[0m
[36m2025-10-27 20:30:32.968 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Price classification Q82 (20:30): 101.20 â†’ NORMAL[0m
[32m2025-10-27 20:30:32.968 INFO (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.44Â°C - MODERATE RECOVERY: DM -353 beyond expected for 8.2Â°C (threshold: -316) [severe overshoot +1.9Â°C] | Learned pre-heat: Pre-heating: predicted drop 2.2Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 55.0Â°C â†’ offset: -19.1Â°C; Weight: 0.18; Deferred: Significant debt (DM -353) | GE-Spot Q82: NORMAL (day) | Too warm: 1.9Â°C over (boosted 15%: cooling -0.50Â°C/h)[0m
[32m2025-10-27 20:30:32.968 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.44Â°C, reasoning: MODERATE RECOVERY: DM -353 beyond expected for 8.2Â°C (threshold: -316) [severe overshoot +1.9Â°C] | Learned pre-heat: Pre-heating: predicted drop 2.2Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 55.0Â°C â†’ offset: -19.1Â°C; Weight: 0.18; Deferred: Significant debt (DM -353) | GE-Spot Q82: NORMAL (day) | Too warm: 1.9Â°C over (boosted 15%: cooling -0.50Â°C/h)[0m
[36m2025-10-27 20:30:32.968 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.44Â°C, integer=0Â°C, fractional=0.44Â°C, accumulator_before=0.07Â°C[0m
[36m2025-10-27 20:30:32.968 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: 0.52Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-27 20:30:32.968 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.44Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 20:30:32.968 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 2.794 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 20:30:32.968 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=22.9Â°C, outdoor=8.2Â°C, offset=0.4Â°C, change=-0.02Â°C, Î”t=0.08h[0m
[36m2025-10-27 20:30:32.968 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=22.9Â°C, outdoor=8.2Â°C, offset=0.4Â°C, flow=55.0Â°C, DM=-353[0m
[36m2025-10-27 20:30:32.973 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.3Â°C/h trend[0m
[36m2025-10-27 20:30:32.973 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 20:30:32.974 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 20:30:32.974 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 20:30:32.974 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=33.1[0m
[36m2025-10-27 20:30:32.974 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 20:30:32.974 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW temp lux currently ON, last_changed: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 20:30:32.974 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 20:30:32.974 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-27 20:30:32.974 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW temp lux currently ON, last_changed: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 20:30:32.974 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 20:30:32.975 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-27 20:30:32.975 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control rate limited: 45.0 min since last change (min 60 min)[0m
[36m2025-10-27 20:30:32.975 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.015 seconds (success: True)[0m
[36m2025-10-27 20:30:32.976 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (10.9 + 0.6 + 1.1)A Ã— 0.95 = 2.87 kW[0m
[36m2025-10-27 20:30:32.976 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 20:35:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 20:35:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 22.9Â°C (median of 9 sensors: 24.1Â°C, 21.6Â°C, 22.0Â°C, 22.8Â°C, 25.3Â°C, 23.3Â°C, 22.9Â°C, 22.9Â°C, 24.0Â°C)[0m
[36m2025-10-27 20:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -375.0[0m
[36m2025-10-27 20:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 34.6Â°C[0m
[36m2025-10-27 20:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 55.0Â°C[0m
[36m2025-10-27 20:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=10.9A, L2=0.6A, L3=1.1A[0m
[36m2025-10-27 20:35:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 22.9Â°C, outdoor 8.2Â°C, flow 55.0Â°C, DM -375[0m
[36m2025-10-27 20:35:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 80 Hz (1h avg: 58, 6h avg: 58, mode: space) - OK: Normal operation (80 Hz, 6h avg: 58 Hz)[0m
[36m2025-10-27 20:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 20:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 20:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 20:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 20:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 20:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 20:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 20:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 20:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 20:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 20:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 109}[0m
[36m2025-10-27 20:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 20:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 20:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 20:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 20:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 20:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 20:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 20:35:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 20:35:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q82 = 101.20 Ã¶re/kWh[0m
[36m2025-10-27 20:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 20:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 20:35:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 20:35:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 20:35:32.962 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 20:35:32.962 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-27 20:35:32.962 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 20:35:32.964 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 20:35:32.964 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 20:35:32.964 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 20:35:32.965 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 20:35:32.965 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-27 20:35:32.965 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 20:35:32.965 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[32m2025-10-27 20:35:32.965 INFO (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] T1 overshoot damping: severe overshoot +1.9Â°C, offset 4.00Â°C â†’ 3.20Â°C (factor 0.80, min 1.0Â°C)[0m
[36m2025-10-27 20:35:32.965 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-27 20:35:32.965 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 20:35:32.965 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 20:35:32.965 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=55.0Â°C, error=-28.6Â°C, sensitivity=1.5 -> offset=-19.1[0m
[36m2025-10-27 20:35:32.965 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 20:35:32.966 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 55.0Â°C â†’ offset: -19.1Â°C; Weight: 0.18; Deferred: Significant debt (DM -375)[0m
[36m2025-10-27 20:35:32.966 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Price classification Q82 (20:35): 101.20 â†’ NORMAL[0m
[32m2025-10-27 20:35:32.966 INFO (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.39Â°C - MODERATE RECOVERY: DM -375 beyond expected for 8.2Â°C (threshold: -316) [severe overshoot +1.9Â°C] | Learned pre-heat: Pre-heating: predicted drop 2.1Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 55.0Â°C â†’ offset: -19.1Â°C; Weight: 0.18; Deferred: Significant debt (DM -375) | GE-Spot Q82: NORMAL (day) | Too warm: 1.9Â°C over[0m
[32m2025-10-27 20:35:32.966 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.39Â°C, reasoning: MODERATE RECOVERY: DM -375 beyond expected for 8.2Â°C (threshold: -316) [severe overshoot +1.9Â°C] | Learned pre-heat: Pre-heating: predicted drop 2.1Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 55.0Â°C â†’ offset: -19.1Â°C; Weight: 0.18; Deferred: Significant debt (DM -375) | GE-Spot Q82: NORMAL (day) | Too warm: 1.9Â°C over[0m
[36m2025-10-27 20:35:32.966 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.39Â°C, integer=0Â°C, fractional=0.39Â°C, accumulator_before=0.52Â°C[0m
[36m2025-10-27 20:35:32.966 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: 0.91Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-27 20:35:32.966 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.39Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 20:35:32.966 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 2.622 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 20:35:32.966 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=22.9Â°C, outdoor=8.2Â°C, offset=0.4Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 20:35:32.966 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=22.9Â°C, outdoor=8.2Â°C, offset=0.4Â°C, flow=55.0Â°C, DM=-375[0m
[36m2025-10-27 20:35:32.966 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-27 20:35:32.966 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 20:35:32.967 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 20:35:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 20:35:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=34.6[0m
[36m2025-10-27 20:35:32.968 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 20:35:32.968 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW temp lux currently ON, last_changed: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 20:35:32.968 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 20:35:32.968 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-27 20:35:32.968 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW temp lux currently ON, last_changed: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 20:35:32.968 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 20:35:32.968 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-27 20:35:32.968 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control rate limited: 50.0 min since last change (min 60 min)[0m
[36m2025-10-27 20:35:32.968 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.010 seconds (success: True)[0m
[36m2025-10-27 20:35:32.969 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (10.9 + 0.6 + 1.1)A Ã— 0.95 = 2.87 kW[0m
[36m2025-10-27 20:35:32.970 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 20:40:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 20:40:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.0Â°C (median of 9 sensors: 24.1Â°C, 21.6Â°C, 22.0Â°C, 22.8Â°C, 25.3Â°C, 23.3Â°C, 22.9Â°C, 23.0Â°C, 25.0Â°C)[0m
[36m2025-10-27 20:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -396.0[0m
[36m2025-10-27 20:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 36.6Â°C[0m
[36m2025-10-27 20:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 55.5Â°C[0m
[36m2025-10-27 20:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=10.9A, L2=0.6A, L3=1.1A[0m
[36m2025-10-27 20:40:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.0Â°C, outdoor 8.2Â°C, flow 55.5Â°C, DM -396[0m
[36m2025-10-27 20:40:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 80 Hz (1h avg: 71, 6h avg: 60, mode: space) - OK: Normal operation (80 Hz, 6h avg: 60 Hz)[0m
[36m2025-10-27 20:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 20:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 20:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 20:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 20:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 20:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 20:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 20:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 20:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 20:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 20:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 109}[0m
[36m2025-10-27 20:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 20:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 20:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 20:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 20:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 20:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 20:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 20:40:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 20:40:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q82 = 101.20 Ã¶re/kWh[0m
[36m2025-10-27 20:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 20:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 20:40:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 20:40:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 20:40:32.962 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 20:40:32.962 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-27 20:40:32.962 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 20:40:32.963 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 20:40:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 20:40:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 20:40:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 20:40:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-27 20:40:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 20:40:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[32m2025-10-27 20:40:32.964 INFO (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] T1 overshoot damping: severe overshoot +2.0Â°C, offset 4.00Â°C â†’ 3.20Â°C (factor 0.80, min 1.0Â°C)[0m
[36m2025-10-27 20:40:32.965 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-27 20:40:32.965 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 20:40:32.965 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 20:40:32.965 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=55.5Â°C, error=-29.1Â°C, sensitivity=1.5 -> offset=-19.4[0m
[36m2025-10-27 20:40:32.965 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 20:40:32.965 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 55.5Â°C â†’ offset: -19.4Â°C; Weight: 0.18; Deferred: Significant debt (DM -396)[0m
[36m2025-10-27 20:40:32.965 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Price classification Q82 (20:40): 101.20 â†’ NORMAL[0m
[32m2025-10-27 20:40:32.965 INFO (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.37Â°C - MODERATE RECOVERY: DM -396 beyond expected for 8.2Â°C (threshold: -316) [severe overshoot +2.0Â°C] | Learned pre-heat: Pre-heating: predicted drop 2.1Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 55.5Â°C â†’ offset: -19.4Â°C; Weight: 0.18; Deferred: Significant debt (DM -396) | GE-Spot Q82: NORMAL (day) | Too warm: 2.0Â°C over[0m
[32m2025-10-27 20:40:32.967 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.37Â°C, reasoning: MODERATE RECOVERY: DM -396 beyond expected for 8.2Â°C (threshold: -316) [severe overshoot +2.0Â°C] | Learned pre-heat: Pre-heating: predicted drop 2.1Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 55.5Â°C â†’ offset: -19.4Â°C; Weight: 0.18; Deferred: Significant debt (DM -396) | GE-Spot Q82: NORMAL (day) | Too warm: 2.0Â°C over[0m
[36m2025-10-27 20:40:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.37Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-27 20:40:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 2.721 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 20:40:32.967 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.0Â°C, outdoor=8.2Â°C, offset=0.4Â°C, change=0.02Â°C, Î”t=0.08h[0m
[36m2025-10-27 20:40:32.967 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.0Â°C, outdoor=8.2Â°C, offset=0.4Â°C, flow=55.5Â°C, DM=-396[0m
[36m2025-10-27 20:40:32.971 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.0Â°C/h trend[0m
[36m2025-10-27 20:40:32.971 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 20:40:32.976 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved learned data to storage[0m
[36m2025-10-27 20:40:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 20:40:32.976 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 20:40:32.976 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=36.6[0m
[36m2025-10-27 20:40:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 20:40:32.977 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW temp lux currently ON, last_changed: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 20:40:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 20:40:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-27 20:40:32.977 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW temp lux currently ON, last_changed: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 20:40:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 20:40:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-27 20:40:32.977 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control rate limited: 55.0 min since last change (min 60 min)[0m
[36m2025-10-27 20:40:32.977 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.018 seconds (success: True)[0m
[36m2025-10-27 20:40:32.979 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (10.9 + 0.6 + 1.1)A Ã— 0.95 = 2.87 kW[0m
[36m2025-10-27 20:40:32.980 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 20:45:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 20:45:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 22.9Â°C (median of 9 sensors: 24.1Â°C, 21.6Â°C, 22.0Â°C, 22.9Â°C, 25.3Â°C, 23.3Â°C, 22.9Â°C, 22.9Â°C, 25.0Â°C)[0m
[36m2025-10-27 20:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -418.0[0m
[36m2025-10-27 20:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 37.6Â°C[0m
[36m2025-10-27 20:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 55.0Â°C[0m
[36m2025-10-27 20:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=10.9A, L2=0.6A, L3=1.1A[0m
[36m2025-10-27 20:45:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 22.9Â°C, outdoor 8.2Â°C, flow 55.0Â°C, DM -418[0m
[36m2025-10-27 20:45:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 80 Hz (1h avg: 72, 6h avg: 62, mode: space) - OK: Normal operation (80 Hz, 6h avg: 62 Hz)[0m
[36m2025-10-27 20:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 20:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 20:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 20:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 20:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 20:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 20:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 20:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 20:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 20:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 20:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 108}[0m
[36m2025-10-27 20:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 20:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 20:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 20:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 20:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 20:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 20:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 20:45:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 20:45:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q83 = 80.81 Ã¶re/kWh[0m
[36m2025-10-27 20:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 20:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 20:45:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 20:45:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 20:45:32.961 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 20:45:32.962 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 20:45:32.962 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 20:45:32.962 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 20:45:32.963 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 20:45:32.963 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 20:45:32.963 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 20:45:32.963 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-27 20:45:32.963 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 20:45:32.963 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[32m2025-10-27 20:45:32.964 INFO (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] T1 overshoot damping: severe overshoot +1.9Â°C, offset 4.00Â°C â†’ 3.20Â°C (factor 0.80, min 1.0Â°C)[0m
[36m2025-10-27 20:45:32.964 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-27 20:45:32.964 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 20:45:32.964 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 20:45:32.964 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=55.0Â°C, error=-28.6Â°C, sensitivity=1.5 -> offset=-19.1[0m
[36m2025-10-27 20:45:32.964 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 20:45:32.964 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 55.0Â°C â†’ offset: -19.1Â°C; Weight: 0.15; Deferred: Critical debt (DM -418)[0m
[36m2025-10-27 20:45:32.964 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Price classification Q83 (20:45): 80.81 â†’ NORMAL[0m
[32m2025-10-27 20:45:32.964 INFO (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.58Â°C - MODERATE RECOVERY: DM -418 beyond expected for 8.2Â°C (threshold: -316) [severe overshoot +1.9Â°C] | Learned pre-heat: Pre-heating: predicted drop 2.0Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 55.0Â°C â†’ offset: -19.1Â°C; Weight: 0.15; Deferred: Critical debt (DM -418) | GE-Spot Q83: NORMAL (day) | Too warm: 1.9Â°C over[0m
[32m2025-10-27 20:45:32.966 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.58Â°C, reasoning: MODERATE RECOVERY: DM -418 beyond expected for 8.2Â°C (threshold: -316) [severe overshoot +1.9Â°C] | Learned pre-heat: Pre-heating: predicted drop 2.0Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 55.0Â°C â†’ offset: -19.1Â°C; Weight: 0.15; Deferred: Critical debt (DM -418) | GE-Spot Q83: NORMAL (day) | Too warm: 1.9Â°C over[0m
[36m2025-10-27 20:45:32.966 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.58Â°C, integer=0Â°C, fractional=0.58Â°C, accumulator_before=0.91Â°C[0m
[32m2025-10-27 20:45:32.966 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] âœ“ Accumulated fractional offset reached threshold: applying +1Â°C adjustment (accumulator: 1.49Â°C â†’ 0.49Â°C)[0m
[36m2025-10-27 20:45:32.966 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Accumulator triggered: total_accumulated=1.49Â°C, adjustment=+1Â°C, new_integer=1Â°C, remaining=0.49Â°C[0m
[36m2025-10-27 20:45:32.966 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset 0.58Â°C â†’ applying 1Â°C (accumulator: 0.49Â°C, needs 0.51Â°C more to trigger)[0m
[32m2025-10-27 20:45:32.967 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to 1Â°C (calculated: 0.58Â°C, accumulator: 0.49Â°C)[0m
[36m2025-10-27 20:45:32.967 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=1Â°C, original=0.58Â°C, accumulator=0.49Â°C[0m
[32m2025-10-27 20:45:32.967 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset 0.58Â°C to NIBE via MyUplink[0m
[36m2025-10-27 20:45:32.968 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 2.700 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 20:45:32.968 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=22.9Â°C, outdoor=8.2Â°C, offset=0.6Â°C, change=-0.02Â°C, Î”t=0.08h[0m
[36m2025-10-27 20:45:32.968 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=22.9Â°C, outdoor=8.2Â°C, offset=0.6Â°C, flow=55.0Â°C, DM=-418[0m
[36m2025-10-27 20:45:32.978 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.1Â°C/h trend[0m
[36m2025-10-27 20:45:32.978 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 20:45:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 20:45:32.980 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 20:45:32.981 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=37.6[0m
[36m2025-10-27 20:45:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 20:45:32.981 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW temp lux currently ON, last_changed: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 20:45:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 20:45:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-27 20:45:32.981 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW temp lux currently ON, last_changed: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 20:45:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 20:45:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[32m2025-10-27 20:45:32.981 INFO (MainThread) [custom_components.effektguard.coordinator] DHW control: Deactivating temporary lux - CRITICAL_THERMAL_DEBT (DHW: 37.6Â°C, DM: -418)[0m
[36m2025-10-27 20:45:32.982 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.023 seconds (success: True)[0m
[36m2025-10-27 20:45:32.983 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (10.9 + 0.6 + 1.1)A Ã— 0.95 = 2.87 kW[0m
[36m2025-10-27 20:45:32.984 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 20:50:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 20:50:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 22.9Â°C (median of 9 sensors: 24.1Â°C, 21.6Â°C, 22.0Â°C, 22.8Â°C, 25.3Â°C, 23.3Â°C, 22.9Â°C, 22.9Â°C, 25.0Â°C)[0m
[36m2025-10-27 20:50:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -421.0[0m
[36m2025-10-27 20:50:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 38.6Â°C[0m
[36m2025-10-27 20:50:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 31.0Â°C[0m
[36m2025-10-27 20:50:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=8.9A, L2=0.6A, L3=1.1A[0m
[36m2025-10-27 20:50:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 22.9Â°C, outdoor 8.2Â°C, flow 31.0Â°C, DM -421[0m
[36m2025-10-27 20:50:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 80 Hz (1h avg: 80, 6h avg: 64, mode: space) - WATCH: High demand period (1h avg: 80 Hz, current: 80 Hz)[0m
[36m2025-10-27 20:50:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 20:50:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 20:50:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 20:50:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 20:50:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 20:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 20:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 20:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 20:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 20:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 20:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 108}[0m
[36m2025-10-27 20:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 20:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 20:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 20:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 20:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 20:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 20:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 20:50:32.961 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 20:50:32.961 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q83 = 80.81 Ã¶re/kWh[0m
[36m2025-10-27 20:50:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 20:50:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 20:50:32.963 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 20:50:32.963 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 20:50:32.963 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 20:50:32.963 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 20:50:32.963 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 20:50:32.964 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 20:50:32.964 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 20:50:32.964 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 20:50:32.964 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 20:50:32.965 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-27 20:50:32.965 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 20:50:32.965 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[32m2025-10-27 20:50:32.965 INFO (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] T1 overshoot damping: severe overshoot +1.9Â°C, offset 4.00Â°C â†’ 3.20Â°C (factor 0.80, min 1.0Â°C)[0m
[36m2025-10-27 20:50:32.965 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-27 20:50:32.965 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 20:50:32.965 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 20:50:32.965 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=31.0Â°C, error=-4.6Â°C, sensitivity=1.5 -> offset=-3.1[0m
[36m2025-10-27 20:50:32.965 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 20:50:32.965 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 31.0Â°C â†’ offset: -3.1Â°C; Weight: 0.15; Deferred: Critical debt (DM -421)[0m
[36m2025-10-27 20:50:32.965 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Price classification Q83 (20:50): 80.81 â†’ NORMAL[0m
[32m2025-10-27 20:50:32.966 INFO (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Decision: offset 1.38Â°C - MODERATE RECOVERY: DM -421 beyond expected for 8.2Â°C (threshold: -316) [severe overshoot +1.9Â°C] | Learned pre-heat: Pre-heating: predicted drop 2.0Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 31.0Â°C â†’ offset: -3.1Â°C; Weight: 0.15; Deferred: Critical debt (DM -421) | GE-Spot Q83: NORMAL (day) | Too warm: 1.9Â°C over[0m
[32m2025-10-27 20:50:32.972 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 1.38Â°C, reasoning: MODERATE RECOVERY: DM -421 beyond expected for 8.2Â°C (threshold: -316) [severe overshoot +1.9Â°C] | Learned pre-heat: Pre-heating: predicted drop 2.0Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 31.0Â°C â†’ offset: -3.1Â°C; Weight: 0.15; Deferred: Critical debt (DM -421) | GE-Spot Q83: NORMAL (day) | Too warm: 1.9Â°C over[0m
[36m2025-10-27 20:50:32.972 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=1.38Â°C, integer=1Â°C, fractional=0.38Â°C, accumulator_before=0.49Â°C[0m
[36m2025-10-27 20:50:32.972 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset 1.38Â°C â†’ applying 1Â°C (accumulator: 0.87Â°C, needs 0.13Â°C more to trigger)[0m
[32m2025-10-27 20:50:32.974 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to 1Â°C (calculated: 1.38Â°C, accumulator: 0.87Â°C)[0m
[36m2025-10-27 20:50:32.974 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=1Â°C, original=1.38Â°C, accumulator=0.87Â°C[0m
[32m2025-10-27 20:50:32.974 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset 1.38Â°C to NIBE via MyUplink[0m
[36m2025-10-27 20:50:32.974 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 2.399 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 20:50:32.974 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=22.9Â°C, outdoor=8.2Â°C, offset=1.4Â°C, change=-0.01Â°C, Î”t=0.08h[0m
[36m2025-10-27 20:50:32.974 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=22.9Â°C, outdoor=8.2Â°C, offset=1.4Â°C, flow=31.0Â°C, DM=-421[0m
[36m2025-10-27 20:50:32.980 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.1Â°C/h trend[0m
[36m2025-10-27 20:50:32.980 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 20:50:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 20:50:32.982 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 20:50:32.982 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=38.6[0m
[36m2025-10-27 20:50:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 20:50:32.985 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 20:50:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 20:50:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-27 20:50:32.987 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 20:50:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 20:50:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-27 20:50:32.987 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control rate limited: 5.0 min since last change (min 60 min)[0m
[36m2025-10-27 20:50:32.988 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.029 seconds (success: True)[0m
[36m2025-10-27 20:50:32.989 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (8.9 + 0.6 + 1.1)A Ã— 0.95 = 2.42 kW[0m
[36m2025-10-27 20:50:32.989 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 20:55:32.958 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 20:55:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 22.9Â°C (median of 9 sensors: 24.1Â°C, 21.6Â°C, 21.9Â°C, 22.8Â°C, 25.3Â°C, 23.3Â°C, 22.9Â°C, 22.9Â°C, 25.0Â°C)[0m
[36m2025-10-27 20:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -417.0[0m
[36m2025-10-27 20:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 38.1Â°C[0m
[36m2025-10-27 20:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.5Â°C[0m
[36m2025-10-27 20:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=9.5A, L2=0.6A, L3=1.1A[0m
[36m2025-10-27 20:55:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 22.9Â°C, outdoor 8.2Â°C, flow 30.5Â°C, DM -417[0m
[36m2025-10-27 20:55:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 80 Hz (1h avg: 80, 6h avg: 65, mode: space) - WATCH: High demand period (1h avg: 80 Hz, current: 80 Hz)[0m
[36m2025-10-27 20:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 20:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 20:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 20:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 20:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 20:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 20:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 20:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 20:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 20:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 20:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 108}[0m
[36m2025-10-27 20:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 20:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 20:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 20:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 20:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 20:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 20:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 20:55:32.961 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 20:55:32.961 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q83 = 80.81 Ã¶re/kWh[0m
[36m2025-10-27 20:55:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 20:55:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 20:55:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 20:55:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 20:55:32.962 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 20:55:32.962 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 20:55:32.962 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 20:55:32.963 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 20:55:32.965 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 20:55:32.965 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 20:55:32.965 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 20:55:32.965 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-27 20:55:32.965 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 20:55:32.965 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[32m2025-10-27 20:55:32.965 INFO (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] T1 overshoot damping: severe overshoot +1.9Â°C, offset 4.00Â°C â†’ 3.20Â°C (factor 0.80, min 1.0Â°C)[0m
[36m2025-10-27 20:55:32.965 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-27 20:55:32.965 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 20:55:32.965 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 20:55:32.966 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=30.5Â°C, error=-4.1Â°C, sensitivity=1.5 -> offset=-2.7[0m
[36m2025-10-27 20:55:32.966 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 20:55:32.966 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.15; Deferred: Critical debt (DM -417)[0m
[36m2025-10-27 20:55:32.966 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Price classification Q83 (20:55): 80.81 â†’ NORMAL[0m
[32m2025-10-27 20:55:32.966 INFO (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Decision: offset 1.40Â°C - MODERATE RECOVERY: DM -417 beyond expected for 8.2Â°C (threshold: -316) [severe overshoot +1.9Â°C] | Learned pre-heat: Pre-heating: predicted drop 2.0Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.15; Deferred: Critical debt (DM -417) | GE-Spot Q83: NORMAL (day) | Too warm: 1.9Â°C over[0m
[32m2025-10-27 20:55:32.967 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 1.40Â°C, reasoning: MODERATE RECOVERY: DM -417 beyond expected for 8.2Â°C (threshold: -316) [severe overshoot +1.9Â°C] | Learned pre-heat: Pre-heating: predicted drop 2.0Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.15; Deferred: Critical debt (DM -417) | GE-Spot Q83: NORMAL (day) | Too warm: 1.9Â°C over[0m
[36m2025-10-27 20:55:32.967 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Skipping offset write, too soon since last write[0m
[36m2025-10-27 20:55:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 1.40Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 20:55:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 2.316 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 20:55:32.967 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=22.9Â°C, outdoor=8.2Â°C, offset=1.4Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 20:55:32.967 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=22.9Â°C, outdoor=8.2Â°C, offset=1.4Â°C, flow=30.5Â°C, DM=-417[0m
[36m2025-10-27 20:55:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-27 20:55:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 20:55:32.968 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 20:55:32.968 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 20:55:32.968 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=38.1[0m
[36m2025-10-27 20:55:32.969 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 20:55:32.972 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 20:55:32.972 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 20:55:32.972 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-27 20:55:32.979 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 20:55:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 20:55:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-27 20:55:32.979 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control rate limited: 10.0 min since last change (min 60 min)[0m
[36m2025-10-27 20:55:32.980 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.021 seconds (success: True)[0m
[36m2025-10-27 20:55:32.981 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (9.5 + 0.6 + 1.1)A Ã— 0.95 = 2.55 kW[0m
[36m2025-10-27 20:55:32.982 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 21:00:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 21:00:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 22.9Â°C (median of 9 sensors: 24.1Â°C, 21.6Â°C, 21.9Â°C, 22.8Â°C, 25.2Â°C, 23.3Â°C, 22.9Â°C, 22.9Â°C, 25.0Â°C)[0m
[36m2025-10-27 21:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -412.0[0m
[36m2025-10-27 21:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 38.1Â°C[0m
[36m2025-10-27 21:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.5Â°C[0m
[36m2025-10-27 21:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=9.5A, L2=0.6A, L3=1.1A[0m
[36m2025-10-27 21:00:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 22.9Â°C, outdoor 8.2Â°C, flow 30.5Â°C, DM -412[0m
[36m2025-10-27 21:00:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 78 Hz (1h avg: 80, 6h avg: 66, mode: space) - WATCH: High demand period (1h avg: 80 Hz, current: 78 Hz)[0m
[36m2025-10-27 21:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 21:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 21:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 21:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 21:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 21:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 21:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 21:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 21:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 21:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 21:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 107}[0m
[36m2025-10-27 21:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 21:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 21:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 21:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 21:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 21:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 21:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 21:00:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 21:00:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q84 = 96.85 Ã¶re/kWh[0m
[36m2025-10-27 21:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 21:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 21:00:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 21:00:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 21:00:32.961 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 21:00:32.961 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 21:00:32.962 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 21:00:32.962 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 21:00:32.964 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 21:00:32.964 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 21:00:32.964 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 21:00:32.964 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-27 21:00:32.964 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 21:00:32.964 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[32m2025-10-27 21:00:32.964 INFO (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] T1 overshoot damping: severe overshoot +1.9Â°C, offset 4.00Â°C â†’ 3.20Â°C (factor 0.80, min 1.0Â°C)[0m
[36m2025-10-27 21:00:32.965 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-27 21:00:32.965 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 21:00:32.965 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 21:00:32.965 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=30.5Â°C, error=-4.1Â°C, sensitivity=1.5 -> offset=-2.7[0m
[36m2025-10-27 21:00:32.965 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 21:00:32.965 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.15; Deferred: Critical debt (DM -412)[0m
[36m2025-10-27 21:00:32.965 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Price classification Q84 (21:00): 96.85 â†’ NORMAL[0m
[32m2025-10-27 21:00:32.965 INFO (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Decision: offset 1.40Â°C - MODERATE RECOVERY: DM -412 beyond expected for 8.2Â°C (threshold: -316) [severe overshoot +1.9Â°C] | Learned pre-heat: Pre-heating: predicted drop 2.0Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.15; Deferred: Critical debt (DM -412) | GE-Spot Q84: NORMAL (day) | Too warm: 1.9Â°C over[0m
[32m2025-10-27 21:00:32.967 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 1.40Â°C, reasoning: MODERATE RECOVERY: DM -412 beyond expected for 8.2Â°C (threshold: -316) [severe overshoot +1.9Â°C] | Learned pre-heat: Pre-heating: predicted drop 2.0Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.15; Deferred: Critical debt (DM -412) | GE-Spot Q84: NORMAL (day) | Too warm: 1.9Â°C over[0m
[36m2025-10-27 21:00:32.967 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=1.40Â°C, integer=1Â°C, fractional=0.40Â°C, accumulator_before=0.87Â°C[0m
[32m2025-10-27 21:00:32.967 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] âœ“ Accumulated fractional offset reached threshold: applying +1Â°C adjustment (accumulator: 1.27Â°C â†’ 0.27Â°C)[0m
[36m2025-10-27 21:00:32.967 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Accumulator triggered: total_accumulated=1.27Â°C, adjustment=+1Â°C, new_integer=2Â°C, remaining=0.27Â°C[0m
[36m2025-10-27 21:00:32.967 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset 1.40Â°C â†’ applying 2Â°C (accumulator: 0.27Â°C, needs 0.73Â°C more to trigger)[0m
[32m2025-10-27 21:00:32.970 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to 2Â°C (calculated: 1.40Â°C, accumulator: 0.27Â°C)[0m
[36m2025-10-27 21:00:32.970 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=2Â°C, original=1.40Â°C, accumulator=0.27Â°C[0m
[32m2025-10-27 21:00:32.970 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset 1.40Â°C to NIBE via MyUplink[0m
[36m2025-10-27 21:00:32.970 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 2.501 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 21:00:32.970 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=22.9Â°C, outdoor=8.2Â°C, offset=1.4Â°C, change=-0.02Â°C, Î”t=0.08h[0m
[36m2025-10-27 21:00:32.970 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=22.9Â°C, outdoor=8.2Â°C, offset=1.4Â°C, flow=30.5Â°C, DM=-412[0m
[36m2025-10-27 21:00:32.978 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.1Â°C/h trend[0m
[36m2025-10-27 21:00:32.978 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 21:00:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 21:00:32.979 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 21:00:32.979 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=38.1[0m
[36m2025-10-27 21:00:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 21:00:32.982 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 21:00:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 21:00:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-27 21:00:32.985 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 21:00:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 21:00:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-27 21:00:32.985 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control rate limited: 15.0 min since last change (min 60 min)[0m
[36m2025-10-27 21:00:32.986 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.027 seconds (success: True)[0m
[36m2025-10-27 21:00:32.987 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (9.5 + 0.6 + 1.1)A Ã— 0.95 = 2.55 kW[0m
[36m2025-10-27 21:00:32.987 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[33m2025-10-27 21:00:54.835 WARNING (MainThread) [homeassistant.components.websocket_api.http.connection] [139821934674144] Kelly from 192.168.2.160 (Home Assistant/2025.8.7-17352 (Android 15; CPH2581)): Disconnected: Received error message during command phase: No PONG received after 27.5 seconds[0m
[36m2025-10-27 21:05:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 21:05:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 22.9Â°C (median of 9 sensors: 24.1Â°C, 21.6Â°C, 21.8Â°C, 22.8Â°C, 25.2Â°C, 23.3Â°C, 22.9Â°C, 22.9Â°C, 25.0Â°C)[0m
[36m2025-10-27 21:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -408.0[0m
[36m2025-10-27 21:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 38.1Â°C[0m
[36m2025-10-27 21:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 31.5Â°C[0m
[36m2025-10-27 21:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=10.2A, L2=0.6A, L3=1.1A[0m
[36m2025-10-27 21:05:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 22.9Â°C, outdoor 8.2Â°C, flow 31.5Â°C, DM -408[0m
[36m2025-10-27 21:05:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 78 Hz (1h avg: 80, 6h avg: 67, mode: space) - WATCH: High demand period (1h avg: 80 Hz, current: 78 Hz)[0m
[36m2025-10-27 21:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 21:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 21:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 21:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 21:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 21:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 21:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 21:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 21:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 21:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 21:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 107}[0m
[36m2025-10-27 21:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 21:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 21:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 21:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 21:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 21:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 21:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 21:05:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 21:05:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q84 = 96.85 Ã¶re/kWh[0m
[36m2025-10-27 21:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 21:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 21:05:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 21:05:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 21:05:32.962 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 21:05:32.962 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 21:05:32.962 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 21:05:32.964 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 21:05:32.965 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 21:05:32.965 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 21:05:32.965 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 21:05:32.965 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-27 21:05:32.965 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 21:05:32.965 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[32m2025-10-27 21:05:32.966 INFO (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] T1 overshoot damping: severe overshoot +1.9Â°C, offset 4.00Â°C â†’ 3.20Â°C (factor 0.80, min 1.0Â°C)[0m
[36m2025-10-27 21:05:32.966 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-27 21:05:32.966 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 21:05:32.966 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 21:05:32.966 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=31.5Â°C, error=-5.1Â°C, sensitivity=1.5 -> offset=-3.4[0m
[36m2025-10-27 21:05:32.966 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 21:05:32.966 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 31.5Â°C â†’ offset: -3.4Â°C; Weight: 0.15; Deferred: Critical debt (DM -408)[0m
[36m2025-10-27 21:05:32.966 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Price classification Q84 (21:05): 96.85 â†’ NORMAL[0m
[32m2025-10-27 21:05:32.966 INFO (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Decision: offset 1.37Â°C - MODERATE RECOVERY: DM -408 beyond expected for 8.2Â°C (threshold: -316) [severe overshoot +1.9Â°C] | Learned pre-heat: Pre-heating: predicted drop 2.1Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 31.5Â°C â†’ offset: -3.4Â°C; Weight: 0.15; Deferred: Critical debt (DM -408) | GE-Spot Q84: NORMAL (day) | Too warm: 1.9Â°C over[0m
[32m2025-10-27 21:05:32.967 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 1.37Â°C, reasoning: MODERATE RECOVERY: DM -408 beyond expected for 8.2Â°C (threshold: -316) [severe overshoot +1.9Â°C] | Learned pre-heat: Pre-heating: predicted drop 2.1Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 31.5Â°C â†’ offset: -3.4Â°C; Weight: 0.15; Deferred: Critical debt (DM -408) | GE-Spot Q84: NORMAL (day) | Too warm: 1.9Â°C over[0m
[36m2025-10-27 21:05:32.967 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Skipping offset write, too soon since last write[0m
[36m2025-10-27 21:05:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 1.37Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 21:05:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 2.470 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 21:05:32.967 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=22.9Â°C, outdoor=8.2Â°C, offset=1.4Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 21:05:32.967 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=22.9Â°C, outdoor=8.2Â°C, offset=1.4Â°C, flow=31.5Â°C, DM=-408[0m
[36m2025-10-27 21:05:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-27 21:05:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 21:05:32.969 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 21:05:32.969 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 21:05:32.969 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=38.1[0m
[36m2025-10-27 21:05:32.969 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 21:05:32.972 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 21:05:32.972 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 21:05:32.972 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-27 21:05:32.980 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 21:05:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 21:05:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-27 21:05:32.980 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control rate limited: 20.0 min since last change (min 60 min)[0m
[36m2025-10-27 21:05:32.980 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.022 seconds (success: True)[0m
[36m2025-10-27 21:05:32.982 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (10.2 + 0.6 + 1.1)A Ã— 0.95 = 2.71 kW[0m
[36m2025-10-27 21:05:32.982 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 21:10:32.958 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 21:10:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 22.9Â°C (median of 9 sensors: 24.1Â°C, 21.6Â°C, 21.8Â°C, 22.9Â°C, 25.2Â°C, 23.3Â°C, 22.9Â°C, 22.9Â°C, 25.0Â°C)[0m
[36m2025-10-27 21:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -410.0[0m
[36m2025-10-27 21:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 37.6Â°C[0m
[36m2025-10-27 21:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.0Â°C[0m
[36m2025-10-27 21:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.8A, L2=0.6A, L3=1.1A[0m
[36m2025-10-27 21:10:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 22.9Â°C, outdoor 8.2Â°C, flow 30.0Â°C, DM -410[0m
[36m2025-10-27 21:10:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 1 Hz (1h avg: 72, 6h avg: 62, mode: space) - OK: Normal operation (1 Hz, 6h avg: 62 Hz)[0m
[36m2025-10-27 21:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 21:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 21:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 21:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 21:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 21:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 21:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 21:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 21:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 21:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 21:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 107}[0m
[36m2025-10-27 21:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 21:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 21:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 21:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 21:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 21:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 21:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 21:10:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 21:10:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q84 = 96.85 Ã¶re/kWh[0m
[36m2025-10-27 21:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 21:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 21:10:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 21:10:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 21:10:32.961 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 21:10:32.961 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 21:10:32.961 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 21:10:32.962 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 21:10:32.964 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 21:10:32.965 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 21:10:32.965 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 21:10:32.965 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-27 21:10:32.965 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 21:10:32.965 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[32m2025-10-27 21:10:32.965 INFO (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] T1 overshoot damping: severe overshoot +1.9Â°C, offset 4.00Â°C â†’ 3.20Â°C (factor 0.80, min 1.0Â°C)[0m
[36m2025-10-27 21:10:32.965 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-27 21:10:32.965 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 21:10:32.965 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 21:10:32.965 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=30.0Â°C, error=-3.6Â°C, sensitivity=1.5 -> offset=-2.4[0m
[36m2025-10-27 21:10:32.965 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 21:10:32.966 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.0Â°C â†’ offset: -2.4Â°C; Weight: 0.15; Deferred: Critical debt (DM -410)[0m
[36m2025-10-27 21:10:32.966 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Price classification Q84 (21:10): 96.85 â†’ NORMAL[0m
[32m2025-10-27 21:10:32.966 INFO (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Decision: offset 1.42Â°C - MODERATE RECOVERY: DM -410 beyond expected for 8.2Â°C (threshold: -316) [severe overshoot +1.9Â°C] | Learned pre-heat: Pre-heating: predicted drop 2.1Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.0Â°C â†’ offset: -2.4Â°C; Weight: 0.15; Deferred: Critical debt (DM -410) | GE-Spot Q84: NORMAL (day) | Too warm: 1.9Â°C over[0m
[32m2025-10-27 21:10:32.966 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 1.42Â°C, reasoning: MODERATE RECOVERY: DM -410 beyond expected for 8.2Â°C (threshold: -316) [severe overshoot +1.9Â°C] | Learned pre-heat: Pre-heating: predicted drop 2.1Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.0Â°C â†’ offset: -2.4Â°C; Weight: 0.15; Deferred: Critical debt (DM -410) | GE-Spot Q84: NORMAL (day) | Too warm: 1.9Â°C over[0m
[36m2025-10-27 21:10:32.966 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=1.42Â°C, integer=1Â°C, fractional=0.42Â°C, accumulator_before=0.27Â°C[0m
[36m2025-10-27 21:10:32.966 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset 1.42Â°C â†’ applying 1Â°C (accumulator: 0.69Â°C, needs 0.31Â°C more to trigger)[0m
[32m2025-10-27 21:10:32.968 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to 1Â°C (calculated: 1.42Â°C, accumulator: 0.69Â°C)[0m
[36m2025-10-27 21:10:32.968 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=1Â°C, original=1.42Â°C, accumulator=0.69Â°C[0m
[32m2025-10-27 21:10:32.969 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset 1.42Â°C to NIBE via MyUplink[0m
[36m2025-10-27 21:10:32.969 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.339 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 21:10:32.969 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=22.9Â°C, outdoor=8.2Â°C, offset=1.4Â°C, change=0.02Â°C, Î”t=0.08h[0m
[36m2025-10-27 21:10:32.969 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=22.9Â°C, outdoor=8.2Â°C, offset=1.4Â°C, flow=30.0Â°C, DM=-410[0m
[36m2025-10-27 21:10:32.977 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.0Â°C/h trend[0m
[36m2025-10-27 21:10:32.977 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 21:10:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 21:10:32.981 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 21:10:32.981 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=37.6[0m
[36m2025-10-27 21:10:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 21:10:32.984 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 21:10:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 21:10:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-27 21:10:32.987 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 21:10:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 21:10:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-27 21:10:32.987 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control rate limited: 25.0 min since last change (min 60 min)[0m
[36m2025-10-27 21:10:32.987 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.029 seconds (success: True)[0m
[36m2025-10-27 21:10:32.989 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.8 + 0.6 + 1.1)A Ã— 0.95 = 1.48 kW[0m
[36m2025-10-27 21:10:32.989 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 21:15:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 21:15:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 22.9Â°C (median of 9 sensors: 24.1Â°C, 21.6Â°C, 21.9Â°C, 22.8Â°C, 25.2Â°C, 23.3Â°C, 22.7Â°C, 22.9Â°C, 25.0Â°C)[0m
[36m2025-10-27 21:15:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -421.0[0m
[36m2025-10-27 21:15:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 37.6Â°C[0m
[36m2025-10-27 21:15:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.5Â°C[0m
[36m2025-10-27 21:15:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=6.1A, L2=0.6A, L3=1.1A[0m
[36m2025-10-27 21:15:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 22.9Â°C, outdoor 8.2Â°C, flow 30.5Â°C, DM -421[0m
[36m2025-10-27 21:15:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 41 Hz (1h avg: 69, 6h avg: 61, mode: space) - OK: Normal operation (41 Hz, 6h avg: 61 Hz)[0m
[36m2025-10-27 21:15:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 21:15:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 21:15:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 21:15:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 21:15:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 21:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 21:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 21:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 21:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 21:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 21:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 106}[0m
[36m2025-10-27 21:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 21:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 21:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 21:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 21:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 21:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 21:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 21:15:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 21:15:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q85 = 95.02 Ã¶re/kWh[0m
[36m2025-10-27 21:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 21:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 21:15:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 21:15:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 21:15:32.962 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 21:15:32.962 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-27 21:15:32.962 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 21:15:32.963 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 21:15:32.963 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 21:15:32.963 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 21:15:32.963 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 21:15:32.963 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-27 21:15:32.963 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 21:15:32.963 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[32m2025-10-27 21:15:32.964 INFO (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] T1 overshoot damping: severe overshoot +1.9Â°C, offset 4.00Â°C â†’ 3.20Â°C (factor 0.80, min 1.0Â°C)[0m
[36m2025-10-27 21:15:32.964 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-27 21:15:32.964 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 21:15:32.964 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 21:15:32.964 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=30.5Â°C, error=-4.1Â°C, sensitivity=1.5 -> offset=-2.7[0m
[36m2025-10-27 21:15:32.964 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 21:15:32.964 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.15; Deferred: Critical debt (DM -421)[0m
[36m2025-10-27 21:15:32.964 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Price classification Q85 (21:15): 95.02 â†’ NORMAL[0m
[32m2025-10-27 21:15:32.966 INFO (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Decision: offset 1.40Â°C - MODERATE RECOVERY: DM -421 beyond expected for 8.2Â°C (threshold: -316) [severe overshoot +1.9Â°C] | Learned pre-heat: Pre-heating: predicted drop 2.2Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.15; Deferred: Critical debt (DM -421) | GE-Spot Q85: NORMAL (day) | Too warm: 1.9Â°C over[0m
[32m2025-10-27 21:15:32.966 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 1.40Â°C, reasoning: MODERATE RECOVERY: DM -421 beyond expected for 8.2Â°C (threshold: -316) [severe overshoot +1.9Â°C] | Learned pre-heat: Pre-heating: predicted drop 2.2Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.15; Deferred: Critical debt (DM -421) | GE-Spot Q85: NORMAL (day) | Too warm: 1.9Â°C over[0m
[36m2025-10-27 21:15:32.966 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Skipping offset write, too soon since last write[0m
[36m2025-10-27 21:15:32.966 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 1.40Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 21:15:32.966 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.589 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 21:15:32.966 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=22.9Â°C, outdoor=8.2Â°C, offset=1.4Â°C, change=-0.02Â°C, Î”t=0.08h[0m
[36m2025-10-27 21:15:32.966 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=22.9Â°C, outdoor=8.2Â°C, offset=1.4Â°C, flow=30.5Â°C, DM=-421[0m
[36m2025-10-27 21:15:32.966 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-27 21:15:32.966 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 21:15:32.969 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 21:15:32.969 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 21:15:32.969 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=37.6[0m
[36m2025-10-27 21:15:32.969 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 21:15:32.971 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 21:15:32.972 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 21:15:32.972 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-27 21:15:32.977 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 21:15:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-27 21:15:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-27 21:15:32.977 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control rate limited: 30.0 min since last change (min 60 min)[0m
[36m2025-10-27 21:15:32.977 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.018 seconds (success: True)[0m
[36m2025-10-27 21:15:32.979 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (6.1 + 0.6 + 1.1)A Ã— 0.95 = 1.78 kW[0m
[36m2025-10-27 21:15:32.979 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 21:20:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 21:20:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 22.9Â°C (median of 9 sensors: 24.1Â°C, 21.5Â°C, 21.9Â°C, 22.8Â°C, 25.2Â°C, 23.3Â°C, 22.7Â°C, 22.9Â°C, 25.0Â°C)[0m
[36m2025-10-27 21:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -414.0[0m
[36m2025-10-27 21:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 37.6Â°C[0m
[36m2025-10-27 21:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 31.5Â°C[0m
[36m2025-10-27 21:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=9.1A, L2=0.6A, L3=1.1A[0m
[36m2025-10-27 21:20:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 22.9Â°C, outdoor 7.7Â°C, flow 31.5Â°C, DM -414[0m
[36m2025-10-27 21:20:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 76 Hz (1h avg: 70, 6h avg: 62, mode: space) - OK: Normal operation (76 Hz, 6h avg: 62 Hz)[0m
[36m2025-10-27 21:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 21:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 21:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 21:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 21:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 21:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 21:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 21:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 21:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 21:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 21:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 106}[0m
[36m2025-10-27 21:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 21:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 21:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 21:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 21:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 21:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 21:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 21:20:32.961 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 21:20:32.961 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q85 = 95.02 Ã¶re/kWh[0m
[36m2025-10-27 21:20:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 21:20:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 21:20:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 21:20:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 21:20:32.963 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 21:20:32.963 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-27 21:20:32.963 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 21:20:32.964 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 21:20:32.968 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 21:20:32.968 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 21:20:32.969 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-27 21:20:32.969 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 7.7Â°C: normal -126 to -326, warning -326[0m
[36m2025-10-27 21:20:32.969 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-27 21:20:32.969 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -326 (base: -326), critical -1500[0m
[32m2025-10-27 21:20:32.969 INFO (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] T1 overshoot damping: severe overshoot +1.9Â°C, offset 4.00Â°C â†’ 3.20Â°C (factor 0.80, min 1.0Â°C)[0m
[36m2025-10-27 21:20:32.969 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=7.7Â°C, indoor_target=21.0Â°C, temp_diff=13.3Â°C, HC=0.180 kW/K -> flow=26.0Â°C[0m
[36m2025-10-27 21:20:32.969 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 21:20:32.969 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 21:20:32.969 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.5Â°C, current=31.5Â°C, error=-5.0Â°C, sensitivity=1.5 -> offset=-3.3[0m
[36m2025-10-27 21:20:32.969 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=7.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 21:20:32.969 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 31.5Â°C â†’ offset: -3.3Â°C; Weight: 0.15; Deferred: Critical debt (DM -414)[0m
[36m2025-10-27 21:20:32.970 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Price classification Q85 (21:20): 95.02 â†’ NORMAL[0m
[32m2025-10-27 21:20:32.970 INFO (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Decision: offset 1.37Â°C - MODERATE RECOVERY: DM -414 beyond expected for 7.7Â°C (threshold: -326) [severe overshoot +1.9Â°C] | Learned pre-heat: Pre-heating: predicted drop 2.2Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 31.5Â°C â†’ offset: -3.3Â°C; Weight: 0.15; Deferred: Critical debt (DM -414) | GE-Spot Q85: NORMAL (day) | Too warm: 1.9Â°C over[0m
[32m2025-10-27 21:20:32.970 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 1.37Â°C, reasoning: MODERATE RECOVERY: DM -414 beyond expected for 7.7Â°C (threshold: -326) [severe overshoot +1.9Â°C] | Learned pre-heat: Pre-heating: predicted drop 2.2Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 31.5Â°C â†’ offset: -3.3Â°C; Weight: 0.15; Deferred: Critical debt (DM -414) | GE-Spot Q85: NORMAL (day) | Too warm: 1.9Â°C over[0m
[36m2025-10-27 21:20:32.970 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=1.37Â°C, integer=1Â°C, fractional=0.37Â°C, accumulator_before=0.69Â°C[0m
[32m2025-10-27 21:20:32.970 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] âœ“ Accumulated fractional offset reached threshold: applying +1Â°C adjustment (accumulator: 1.06Â°C â†’ 0.06Â°C)[0m
[36m2025-10-27 21:20:32.971 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Accumulator triggered: total_accumulated=1.06Â°C, adjustment=+1Â°C, new_integer=2Â°C, remaining=0.06Â°C[0m
[36m2025-10-27 21:20:32.971 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset 1.37Â°C â†’ applying 2Â°C (accumulator: 0.06Â°C, needs 0.94Â°C more to trigger)[0m
[32m2025-10-27 21:20:32.972 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to 2Â°C (calculated: 1.37Â°C, accumulator: 0.06Â°C)[0m
[36m2025-10-27 21:20:32.972 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=2Â°C, original=1.37Â°C, accumulator=0.06Â°C[0m
[32m2025-10-27 21:20:32.972 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset 1.37Â°C to NIBE via MyUplink[0m
[36m2025-10-27 21:20:32.972 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 2.211 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 21:20:32.972 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=22.9Â°C, outdoor=7.7Â°C, offset=1.4Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 21:20:32.972 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=22.9Â°C, outdoor=7.7Â°C, offset=1.4Â°C, flow=31.5Â°C, DM=-414[0m
[36m2025-10-27 21:20:32.978 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.1Â°C/h trend[0m
[36m2025-10-27 21:20:32.978 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 21:20:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 21:20:32.981 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 21:20:32.981 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=37.6[0m
[36m2025-10-27 21:20:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-27 21:20:32.984 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 21:20:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-27 21:20:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.7Â°C (zone: Moderate Cold): block=-326, abort=-406[0m
[36m2025-10-27 21:20:32.986 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 21:20:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-27 21:20:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.7Â°C (zone: Moderate Cold): block=-326, abort=-406[0m
[36m2025-10-27 21:20:32.986 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control rate limited: 35.0 min since last change (min 60 min)[0m
[36m2025-10-27 21:20:32.987 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.028 seconds (success: True)[0m
[36m2025-10-27 21:20:32.988 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (9.1 + 0.6 + 1.1)A Ã— 0.95 = 2.46 kW[0m
[36m2025-10-27 21:20:32.989 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 21:25:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 21:25:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 22.9Â°C (median of 9 sensors: 24.1Â°C, 21.5Â°C, 21.9Â°C, 22.7Â°C, 25.2Â°C, 23.3Â°C, 22.7Â°C, 22.9Â°C, 25.0Â°C)[0m
[36m2025-10-27 21:25:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -410.0[0m
[36m2025-10-27 21:25:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 37.6Â°C[0m
[36m2025-10-27 21:25:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 31.5Â°C[0m
[36m2025-10-27 21:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=9.1A, L2=0.6A, L3=1.1A[0m
[36m2025-10-27 21:25:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 22.9Â°C, outdoor 7.7Â°C, flow 31.5Â°C, DM -410[0m
[36m2025-10-27 21:25:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 75 Hz (1h avg: 69, 6h avg: 63, mode: space) - OK: Normal operation (75 Hz, 6h avg: 63 Hz)[0m
[36m2025-10-27 21:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 21:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 21:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 21:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 21:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 21:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 21:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 21:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 21:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 21:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 21:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 106}[0m
[36m2025-10-27 21:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 21:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 21:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 21:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 21:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 21:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 21:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 21:25:32.962 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 21:25:32.962 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q85 = 95.02 Ã¶re/kWh[0m
[36m2025-10-27 21:25:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 21:25:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 21:25:32.963 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 21:25:32.963 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 21:25:32.963 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 21:25:32.963 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-27 21:25:32.963 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 21:25:32.964 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 21:25:32.965 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 21:25:32.965 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 21:25:32.965 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-27 21:25:32.965 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 7.7Â°C: normal -126 to -326, warning -326[0m
[36m2025-10-27 21:25:32.965 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-27 21:25:32.965 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -326 (base: -326), critical -1500[0m
[32m2025-10-27 21:25:32.965 INFO (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] T1 overshoot damping: severe overshoot +1.9Â°C, offset 4.00Â°C â†’ 3.20Â°C (factor 0.80, min 1.0Â°C)[0m
[36m2025-10-27 21:25:32.965 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=7.7Â°C, indoor_target=21.0Â°C, temp_diff=13.3Â°C, HC=0.180 kW/K -> flow=26.0Â°C[0m
[36m2025-10-27 21:25:32.965 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 21:25:32.966 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 21:25:32.966 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.5Â°C, current=31.5Â°C, error=-5.0Â°C, sensitivity=1.5 -> offset=-3.3[0m
[36m2025-10-27 21:25:32.966 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=7.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 21:25:32.966 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 31.5Â°C â†’ offset: -3.3Â°C; Weight: 0.15; Deferred: Critical debt (DM -410)[0m
[36m2025-10-27 21:25:32.966 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Price classification Q85 (21:25): 95.02 â†’ NORMAL[0m
[32m2025-10-27 21:25:32.966 INFO (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Decision: offset 1.37Â°C - MODERATE RECOVERY: DM -410 beyond expected for 7.7Â°C (threshold: -326) [severe overshoot +1.9Â°C] | Learned pre-heat: Pre-heating: predicted drop 2.2Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 31.5Â°C â†’ offset: -3.3Â°C; Weight: 0.15; Deferred: Critical debt (DM -410) | GE-Spot Q85: NORMAL (day) | Too warm: 1.9Â°C over[0m
[32m2025-10-27 21:25:32.966 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 1.37Â°C, reasoning: MODERATE RECOVERY: DM -410 beyond expected for 7.7Â°C (threshold: -326) [severe overshoot +1.9Â°C] | Learned pre-heat: Pre-heating: predicted drop 2.2Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 31.5Â°C â†’ offset: -3.3Â°C; Weight: 0.15; Deferred: Critical debt (DM -410) | GE-Spot Q85: NORMAL (day) | Too warm: 1.9Â°C over[0m
[36m2025-10-27 21:25:32.966 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 1.37Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-27 21:25:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 2.233 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 21:25:32.967 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=22.9Â°C, outdoor=7.7Â°C, offset=1.4Â°C, change=0.02Â°C, Î”t=0.08h[0m
[36m2025-10-27 21:25:32.967 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=22.9Â°C, outdoor=7.7Â°C, offset=1.4Â°C, flow=31.5Â°C, DM=-410[0m
[36m2025-10-27 21:25:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-27 21:25:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 21:25:32.969 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 21:25:32.969 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 21:25:32.969 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=37.6[0m
[36m2025-10-27 21:25:32.969 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-27 21:25:32.979 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 21:25:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-27 21:25:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.7Â°C (zone: Moderate Cold): block=-326, abort=-406[0m
[36m2025-10-27 21:25:32.983 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 21:25:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-27 21:25:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.7Â°C (zone: Moderate Cold): block=-326, abort=-406[0m
[36m2025-10-27 21:25:32.983 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control rate limited: 40.0 min since last change (min 60 min)[0m
[36m2025-10-27 21:25:32.983 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.024 seconds (success: True)[0m
[36m2025-10-27 21:25:32.985 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (9.1 + 0.6 + 1.1)A Ã— 0.95 = 2.46 kW[0m
[36m2025-10-27 21:25:32.985 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 21:30:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 21:30:32.960 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 22.9Â°C (median of 9 sensors: 24.1Â°C, 21.5Â°C, 21.7Â°C, 22.7Â°C, 25.2Â°C, 23.3Â°C, 22.7Â°C, 22.9Â°C, 25.0Â°C)[0m
[36m2025-10-27 21:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -407.0[0m
[36m2025-10-27 21:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 37.6Â°C[0m
[36m2025-10-27 21:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 32.0Â°C[0m
[36m2025-10-27 21:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=9.1A, L2=0.6A, L3=1.1A[0m
[36m2025-10-27 21:30:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 22.9Â°C, outdoor 7.7Â°C, flow 32.0Â°C, DM -407[0m
[36m2025-10-27 21:30:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 75 Hz (1h avg: 70, 6h avg: 63, mode: space) - OK: Normal operation (75 Hz, 6h avg: 63 Hz)[0m
[36m2025-10-27 21:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 21:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 21:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 21:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 21:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 21:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 21:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 21:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 21:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 21:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 21:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 105}[0m
[36m2025-10-27 21:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 21:30:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 21:30:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 21:30:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 21:30:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 21:30:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 21:30:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 21:30:32.961 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 21:30:32.961 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q86 = 78.45 Ã¶re/kWh[0m
[36m2025-10-27 21:30:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 21:30:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 21:30:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 21:30:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 21:30:32.962 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 21:30:32.962 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-27 21:30:32.963 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 21:30:32.964 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 21:30:32.966 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 21:30:32.966 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 21:30:32.966 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-27 21:30:32.966 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 7.7Â°C: normal -126 to -326, warning -326[0m
[36m2025-10-27 21:30:32.966 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-27 21:30:32.966 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -326 (base: -326), critical -1500[0m
[32m2025-10-27 21:30:32.966 INFO (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] T1 overshoot damping: severe overshoot +1.9Â°C, offset 4.00Â°C â†’ 3.20Â°C (factor 0.80, min 1.0Â°C)[0m
[36m2025-10-27 21:30:32.967 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=7.7Â°C, indoor_target=21.0Â°C, temp_diff=13.3Â°C, HC=0.180 kW/K -> flow=26.0Â°C[0m
[36m2025-10-27 21:30:32.967 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 21:30:32.967 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 21:30:32.967 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.5Â°C, current=32.0Â°C, error=-5.5Â°C, sensitivity=1.5 -> offset=-3.6[0m
[36m2025-10-27 21:30:32.967 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=7.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 21:30:32.967 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 32.0Â°C â†’ offset: -3.6Â°C; Weight: 0.15; Deferred: Critical debt (DM -407)[0m
[36m2025-10-27 21:30:32.967 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Price classification Q86 (21:30): 78.45 â†’ NORMAL[0m
[32m2025-10-27 21:30:32.967 INFO (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Decision: offset 1.35Â°C - MODERATE RECOVERY: DM -407 beyond expected for 7.7Â°C (threshold: -326) [severe overshoot +1.9Â°C] | Learned pre-heat: Pre-heating: predicted drop 2.2Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 32.0Â°C â†’ offset: -3.6Â°C; Weight: 0.15; Deferred: Critical debt (DM -407) | GE-Spot Q86: NORMAL (day) | Too warm: 1.9Â°C over[0m
[32m2025-10-27 21:30:32.968 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 1.35Â°C, reasoning: MODERATE RECOVERY: DM -407 beyond expected for 7.7Â°C (threshold: -326) [severe overshoot +1.9Â°C] | Learned pre-heat: Pre-heating: predicted drop 2.2Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 32.0Â°C â†’ offset: -3.6Â°C; Weight: 0.15; Deferred: Critical debt (DM -407) | GE-Spot Q86: NORMAL (day) | Too warm: 1.9Â°C over[0m
[36m2025-10-27 21:30:32.968 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=1.35Â°C, integer=1Â°C, fractional=0.35Â°C, accumulator_before=0.06Â°C[0m
[36m2025-10-27 21:30:32.968 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset 1.35Â°C â†’ applying 1Â°C (accumulator: 0.41Â°C, needs 0.59Â°C more to trigger)[0m
[32m2025-10-27 21:30:32.971 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to 1Â°C (calculated: 1.35Â°C, accumulator: 0.41Â°C)[0m
[36m2025-10-27 21:30:32.971 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=1Â°C, original=1.35Â°C, accumulator=0.41Â°C[0m
[32m2025-10-27 21:30:32.971 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset 1.35Â°C to NIBE via MyUplink[0m
[36m2025-10-27 21:30:32.971 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 2.253 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 21:30:32.971 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=22.9Â°C, outdoor=7.7Â°C, offset=1.4Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 21:30:32.971 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=22.9Â°C, outdoor=7.7Â°C, offset=1.4Â°C, flow=32.0Â°C, DM=-407[0m
[36m2025-10-27 21:30:32.976 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.0Â°C/h trend[0m
[36m2025-10-27 21:30:32.976 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 21:30:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 21:30:32.978 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 21:30:32.978 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=37.6[0m
[36m2025-10-27 21:30:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-27 21:30:32.986 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 21:30:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-27 21:30:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.7Â°C (zone: Moderate Cold): block=-326, abort=-406[0m
[36m2025-10-27 21:30:32.988 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 21:30:32.988 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-27 21:30:32.988 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.7Â°C (zone: Moderate Cold): block=-326, abort=-406[0m
[36m2025-10-27 21:30:32.988 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control rate limited: 45.0 min since last change (min 60 min)[0m
[36m2025-10-27 21:30:32.988 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.029 seconds (success: True)[0m
[36m2025-10-27 21:30:32.990 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (9.1 + 0.6 + 1.1)A Ã— 0.95 = 2.46 kW[0m
[36m2025-10-27 21:30:32.990 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 21:35:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 21:35:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 22.9Â°C (median of 9 sensors: 24.1Â°C, 21.5Â°C, 21.8Â°C, 22.8Â°C, 25.2Â°C, 23.4Â°C, 22.7Â°C, 22.9Â°C, 25.0Â°C)[0m
[36m2025-10-27 21:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -399.0[0m
[36m2025-10-27 21:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 37.6Â°C[0m
[36m2025-10-27 21:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 32.0Â°C[0m
[36m2025-10-27 21:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=9.1A, L2=0.6A, L3=1.1A[0m
[36m2025-10-27 21:35:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 22.9Â°C, outdoor 7.7Â°C, flow 32.0Â°C, DM -399[0m
[36m2025-10-27 21:35:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 72 Hz (1h avg: 68, 6h avg: 64, mode: space) - OK: Normal operation (72 Hz, 6h avg: 64 Hz)[0m
[36m2025-10-27 21:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 21:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 21:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 21:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 21:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 21:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 21:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 21:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 21:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 21:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 21:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 105}[0m
[36m2025-10-27 21:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 21:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 21:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 21:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 21:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 21:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 21:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 21:35:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 21:35:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q86 = 78.45 Ã¶re/kWh[0m
[36m2025-10-27 21:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 21:35:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 21:35:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 21:35:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 21:35:32.962 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 21:35:32.962 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-27 21:35:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 21:35:32.968 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 21:35:32.968 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 21:35:32.968 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 21:35:32.969 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-27 21:35:32.969 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 7.7Â°C: normal -126 to -326, warning -326[0m
[36m2025-10-27 21:35:32.969 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-27 21:35:32.969 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -326 (base: -326), critical -1500[0m
[32m2025-10-27 21:35:32.969 INFO (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] T1 overshoot damping: severe overshoot +1.9Â°C, offset 4.00Â°C â†’ 3.20Â°C (factor 0.80, min 1.0Â°C)[0m
[36m2025-10-27 21:35:32.969 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=7.7Â°C, indoor_target=21.0Â°C, temp_diff=13.3Â°C, HC=0.180 kW/K -> flow=26.0Â°C[0m
[36m2025-10-27 21:35:32.969 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 21:35:32.969 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 21:35:32.969 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.5Â°C, current=32.0Â°C, error=-5.5Â°C, sensitivity=1.5 -> offset=-3.6[0m
[36m2025-10-27 21:35:32.969 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=7.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 21:35:32.969 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 32.0Â°C â†’ offset: -3.6Â°C; Weight: 0.18; Deferred: Significant debt (DM -399)[0m
[36m2025-10-27 21:35:32.970 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Price classification Q86 (21:35): 78.45 â†’ NORMAL[0m
[32m2025-10-27 21:35:32.970 INFO (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Decision: offset 1.30Â°C - MODERATE RECOVERY: DM -399 beyond expected for 7.7Â°C (threshold: -326) [severe overshoot +1.9Â°C] | Learned pre-heat: Pre-heating: predicted drop 2.1Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 32.0Â°C â†’ offset: -3.6Â°C; Weight: 0.18; Deferred: Significant debt (DM -399) | GE-Spot Q86: NORMAL (day) | Too warm: 1.9Â°C over[0m
[32m2025-10-27 21:35:32.970 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 1.30Â°C, reasoning: MODERATE RECOVERY: DM -399 beyond expected for 7.7Â°C (threshold: -326) [severe overshoot +1.9Â°C] | Learned pre-heat: Pre-heating: predicted drop 2.1Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 32.0Â°C â†’ offset: -3.6Â°C; Weight: 0.18; Deferred: Significant debt (DM -399) | GE-Spot Q86: NORMAL (day) | Too warm: 1.9Â°C over[0m
[36m2025-10-27 21:35:32.970 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=1.30Â°C, integer=1Â°C, fractional=0.30Â°C, accumulator_before=0.41Â°C[0m
[36m2025-10-27 21:35:32.970 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset 1.30Â°C â†’ applying 1Â°C (accumulator: 0.72Â°C, needs 0.28Â°C more to trigger)[0m
[32m2025-10-27 21:35:32.972 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to 1Â°C (calculated: 1.30Â°C, accumulator: 0.72Â°C)[0m
[36m2025-10-27 21:35:32.972 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=1Â°C, original=1.30Â°C, accumulator=0.72Â°C[0m
[32m2025-10-27 21:35:32.972 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset 1.30Â°C to NIBE via MyUplink[0m
[36m2025-10-27 21:35:32.972 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 2.372 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 21:35:32.972 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=22.9Â°C, outdoor=7.7Â°C, offset=1.3Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 21:35:32.972 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=22.9Â°C, outdoor=7.7Â°C, offset=1.3Â°C, flow=32.0Â°C, DM=-399[0m
[36m2025-10-27 21:35:32.980 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.0Â°C/h trend[0m
[36m2025-10-27 21:35:32.980 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 21:35:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 21:35:32.982 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 21:35:32.982 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=37.6[0m
[36m2025-10-27 21:35:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-27 21:35:32.985 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 21:35:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-27 21:35:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.7Â°C (zone: Moderate Cold): block=-326, abort=-406[0m
[36m2025-10-27 21:35:32.988 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 21:35:32.988 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-27 21:35:32.988 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.7Â°C (zone: Moderate Cold): block=-326, abort=-406[0m
[36m2025-10-27 21:35:32.988 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control rate limited: 50.0 min since last change (min 60 min)[0m
[36m2025-10-27 21:35:32.988 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.029 seconds (success: True)[0m
[36m2025-10-27 21:35:32.990 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (9.1 + 0.6 + 1.1)A Ã— 0.95 = 2.46 kW[0m
[36m2025-10-27 21:35:32.990 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 21:40:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 21:40:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 22.9Â°C (median of 9 sensors: 24.1Â°C, 21.5Â°C, 21.9Â°C, 22.7Â°C, 25.2Â°C, 23.4Â°C, 22.7Â°C, 22.9Â°C, 25.0Â°C)[0m
[36m2025-10-27 21:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -390.0[0m
[36m2025-10-27 21:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 37.6Â°C[0m
[36m2025-10-27 21:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 31.5Â°C[0m
[36m2025-10-27 21:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=8.8A, L2=0.6A, L3=1.1A[0m
[36m2025-10-27 21:40:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 22.9Â°C, outdoor 7.2Â°C, flow 31.5Â°C, DM -390[0m
[36m2025-10-27 21:40:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 67 Hz (1h avg: 68, 6h avg: 64, mode: space) - OK: Normal operation (67 Hz, 6h avg: 64 Hz)[0m
[36m2025-10-27 21:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 21:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 21:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 21:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 21:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 21:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 21:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 21:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 21:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 21:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 21:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 105}[0m
[36m2025-10-27 21:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 21:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 21:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 21:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 21:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 21:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 21:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 21:40:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 21:40:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q86 = 78.45 Ã¶re/kWh[0m
[36m2025-10-27 21:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 21:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 21:40:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 21:40:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 21:40:32.961 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 21:40:32.961 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-27 21:40:32.962 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 21:40:32.962 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 21:40:32.966 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 21:40:32.966 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 21:40:32.966 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 21:40:32.966 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 7.2Â°C: normal -136 to -336, warning -336[0m
[36m2025-10-27 21:40:32.966 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 21:40:32.966 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -336 (base: -336), critical -1500[0m
[32m2025-10-27 21:40:32.966 INFO (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] T1 overshoot damping: severe overshoot +1.9Â°C, offset 4.00Â°C â†’ 3.20Â°C (factor 0.80, min 1.0Â°C)[0m
[36m2025-10-27 21:40:32.967 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=7.2Â°C, indoor_target=21.0Â°C, temp_diff=13.8Â°C, HC=0.180 kW/K -> flow=26.2Â°C[0m
[36m2025-10-27 21:40:32.967 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 21:40:32.967 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 21:40:32.967 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.7Â°C, current=31.5Â°C, error=-4.8Â°C, sensitivity=1.5 -> offset=-3.2[0m
[36m2025-10-27 21:40:32.967 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=7.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 21:40:32.967 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 31.5Â°C â†’ offset: -3.2Â°C; Weight: 0.18; Deferred: Significant debt (DM -390)[0m
[36m2025-10-27 21:40:32.967 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Price classification Q86 (21:40): 78.45 â†’ NORMAL[0m
[32m2025-10-27 21:40:32.967 INFO (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Decision: offset 1.33Â°C - MODERATE RECOVERY: DM -390 beyond expected for 7.2Â°C (threshold: -336) [severe overshoot +1.9Â°C] | Learned pre-heat: Pre-heating: predicted drop 2.1Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 31.5Â°C â†’ offset: -3.2Â°C; Weight: 0.18; Deferred: Significant debt (DM -390) | GE-Spot Q86: NORMAL (day) | Too warm: 1.9Â°C over[0m
[32m2025-10-27 21:40:32.968 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 1.33Â°C, reasoning: MODERATE RECOVERY: DM -390 beyond expected for 7.2Â°C (threshold: -336) [severe overshoot +1.9Â°C] | Learned pre-heat: Pre-heating: predicted drop 2.1Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 31.5Â°C â†’ offset: -3.2Â°C; Weight: 0.18; Deferred: Significant debt (DM -390) | GE-Spot Q86: NORMAL (day) | Too warm: 1.9Â°C over[0m
[36m2025-10-27 21:40:32.969 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Skipping offset write, too soon since last write[0m
[36m2025-10-27 21:40:32.969 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 1.33Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 21:40:32.969 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 2.281 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 21:40:32.969 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=22.9Â°C, outdoor=7.2Â°C, offset=1.3Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 21:40:32.969 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=22.9Â°C, outdoor=7.2Â°C, offset=1.3Â°C, flow=31.5Â°C, DM=-390[0m
[36m2025-10-27 21:40:32.969 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-27 21:40:32.969 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 21:40:32.974 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved learned data to storage[0m
[36m2025-10-27 21:40:32.974 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 21:40:32.974 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 21:40:32.974 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=37.6[0m
[36m2025-10-27 21:40:32.974 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 21:40:32.976 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 21:40:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 21:40:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.2Â°C (zone: Moderate Cold): block=-336, abort=-416[0m
[36m2025-10-27 21:40:32.979 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 21:40:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 21:40:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.2Â°C (zone: Moderate Cold): block=-336, abort=-416[0m
[36m2025-10-27 21:40:32.979 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control rate limited: 55.0 min since last change (min 60 min)[0m
[36m2025-10-27 21:40:32.979 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.021 seconds (success: True)[0m
[36m2025-10-27 21:40:32.981 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (8.8 + 0.6 + 1.1)A Ã— 0.95 = 2.39 kW[0m
[36m2025-10-27 21:40:32.981 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 21:45:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 21:45:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 22.9Â°C (median of 9 sensors: 23.6Â°C, 21.5Â°C, 21.8Â°C, 22.7Â°C, 25.2Â°C, 23.4Â°C, 22.7Â°C, 22.9Â°C, 25.0Â°C)[0m
[36m2025-10-27 21:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -381.0[0m
[36m2025-10-27 21:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 37.6Â°C[0m
[36m2025-10-27 21:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 31.5Â°C[0m
[36m2025-10-27 21:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=8.8A, L2=0.6A, L3=1.1A[0m
[36m2025-10-27 21:45:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 22.9Â°C, outdoor 7.2Â°C, flow 31.5Â°C, DM -381[0m
[36m2025-10-27 21:45:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 63 Hz (1h avg: 67, 6h avg: 64, mode: space) - OK: Normal operation (63 Hz, 6h avg: 64 Hz)[0m
[36m2025-10-27 21:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 21:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 21:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 21:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 21:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 21:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 21:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 21:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 21:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 21:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 21:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 104}[0m
[36m2025-10-27 21:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 21:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 21:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 21:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 21:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 21:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 21:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 21:45:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 21:45:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q87 = 67.72 Ã¶re/kWh[0m
[36m2025-10-27 21:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 21:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 21:45:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 21:45:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 21:45:32.961 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 21:45:32.961 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 21:45:32.964 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 21:45:32.964 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 21:45:32.966 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 21:45:32.966 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 21:45:32.966 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 21:45:32.966 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 7.2Â°C: normal -136 to -336, warning -336[0m
[36m2025-10-27 21:45:32.966 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 21:45:32.966 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -336 (base: -336), critical -1500[0m
[32m2025-10-27 21:45:32.966 INFO (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] T1 overshoot damping: severe overshoot +1.9Â°C, offset 4.00Â°C â†’ 3.20Â°C (factor 0.80, min 1.0Â°C)[0m
[36m2025-10-27 21:45:32.967 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=7.2Â°C, indoor_target=21.0Â°C, temp_diff=13.8Â°C, HC=0.180 kW/K -> flow=26.2Â°C[0m
[36m2025-10-27 21:45:32.967 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 21:45:32.967 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 21:45:32.967 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.7Â°C, current=31.5Â°C, error=-4.8Â°C, sensitivity=1.5 -> offset=-3.2[0m
[36m2025-10-27 21:45:32.967 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=7.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 21:45:32.967 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 31.5Â°C â†’ offset: -3.2Â°C; Weight: 0.18; Deferred: Significant debt (DM -381)[0m
[36m2025-10-27 21:45:32.967 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Price classification Q87 (21:45): 67.72 â†’ NORMAL[0m
[32m2025-10-27 21:45:32.967 INFO (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Decision: offset 1.33Â°C - MODERATE RECOVERY: DM -381 beyond expected for 7.2Â°C (threshold: -336) [severe overshoot +1.9Â°C] | Learned pre-heat: Pre-heating: predicted drop 2.0Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 31.5Â°C â†’ offset: -3.2Â°C; Weight: 0.18; Deferred: Significant debt (DM -381) | GE-Spot Q87: NORMAL (day) | Too warm: 1.9Â°C over[0m
[32m2025-10-27 21:45:32.967 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 1.33Â°C, reasoning: MODERATE RECOVERY: DM -381 beyond expected for 7.2Â°C (threshold: -336) [severe overshoot +1.9Â°C] | Learned pre-heat: Pre-heating: predicted drop 2.0Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 31.5Â°C â†’ offset: -3.2Â°C; Weight: 0.18; Deferred: Significant debt (DM -381) | GE-Spot Q87: NORMAL (day) | Too warm: 1.9Â°C over[0m
[36m2025-10-27 21:45:32.968 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=1.33Â°C, integer=1Â°C, fractional=0.33Â°C, accumulator_before=0.72Â°C[0m
[32m2025-10-27 21:45:32.968 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] âœ“ Accumulated fractional offset reached threshold: applying +1Â°C adjustment (accumulator: 1.05Â°C â†’ 0.05Â°C)[0m
[36m2025-10-27 21:45:32.968 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Accumulator triggered: total_accumulated=1.05Â°C, adjustment=+1Â°C, new_integer=2Â°C, remaining=0.05Â°C[0m
[36m2025-10-27 21:45:32.968 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset 1.33Â°C â†’ applying 2Â°C (accumulator: 0.05Â°C, needs 0.95Â°C more to trigger)[0m
[32m2025-10-27 21:45:32.969 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to 2Â°C (calculated: 1.33Â°C, accumulator: 0.05Â°C)[0m
[36m2025-10-27 21:45:32.969 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=2Â°C, original=1.33Â°C, accumulator=0.05Â°C[0m
[32m2025-10-27 21:45:32.969 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset 1.33Â°C to NIBE via MyUplink[0m
[36m2025-10-27 21:45:32.969 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 2.120 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 21:45:32.969 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=22.9Â°C, outdoor=7.2Â°C, offset=1.3Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 21:45:32.969 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=22.9Â°C, outdoor=7.2Â°C, offset=1.3Â°C, flow=31.5Â°C, DM=-381[0m
[36m2025-10-27 21:45:32.977 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.0Â°C/h trend[0m
[36m2025-10-27 21:45:32.977 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 21:45:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 21:45:32.978 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 21:45:32.978 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=37.6[0m
[36m2025-10-27 21:45:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 21:45:32.987 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 21:45:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 21:45:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.2Â°C (zone: Moderate Cold): block=-336, abort=-416[0m
[36m2025-10-27 21:45:32.989 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 21:45:32.989 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 21:45:32.989 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.2Â°C (zone: Moderate Cold): block=-336, abort=-416[0m
[36m2025-10-27 21:45:32.989 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control rate limited: 60.0 min since last change (min 60 min)[0m
[36m2025-10-27 21:45:32.990 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.031 seconds (success: True)[0m
[36m2025-10-27 21:45:32.991 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (8.8 + 0.6 + 1.1)A Ã— 0.95 = 2.39 kW[0m
[36m2025-10-27 21:45:32.991 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 21:50:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 21:50:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 22.9Â°C (median of 9 sensors: 23.6Â°C, 21.5Â°C, 21.7Â°C, 22.8Â°C, 25.2Â°C, 23.4Â°C, 22.7Â°C, 22.9Â°C, 25.0Â°C)[0m
[36m2025-10-27 21:50:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -373.0[0m
[36m2025-10-27 21:50:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 37.6Â°C[0m
[36m2025-10-27 21:50:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 32.0Â°C[0m
[36m2025-10-27 21:50:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=8.8A, L2=0.6A, L3=1.1A[0m
[36m2025-10-27 21:50:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 22.9Â°C, outdoor 7.2Â°C, flow 32.0Â°C, DM -373[0m
[36m2025-10-27 21:50:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 60 Hz (1h avg: 65, 6h avg: 64, mode: space) - OK: Normal operation (60 Hz, 6h avg: 64 Hz)[0m
[36m2025-10-27 21:50:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 21:50:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 21:50:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 21:50:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 21:50:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 21:50:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 21:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 21:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 21:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 21:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 21:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 104}[0m
[36m2025-10-27 21:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 21:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 21:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 21:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 21:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 21:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 21:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 21:50:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 21:50:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q87 = 67.72 Ã¶re/kWh[0m
[36m2025-10-27 21:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 21:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 21:50:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 21:50:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 21:50:32.962 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 21:50:32.962 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 21:50:32.962 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 21:50:32.964 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 21:50:32.964 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 21:50:32.964 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 21:50:32.964 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 21:50:32.964 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 7.2Â°C: normal -136 to -336, warning -336[0m
[36m2025-10-27 21:50:32.964 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 21:50:32.964 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -336 (base: -336), critical -1500[0m
[32m2025-10-27 21:50:32.965 INFO (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] T1 overshoot damping: severe overshoot +1.9Â°C, offset 4.00Â°C â†’ 3.20Â°C (factor 0.80, min 1.0Â°C)[0m
[36m2025-10-27 21:50:32.965 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=7.2Â°C, indoor_target=21.0Â°C, temp_diff=13.8Â°C, HC=0.180 kW/K -> flow=26.2Â°C[0m
[36m2025-10-27 21:50:32.965 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 21:50:32.965 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 21:50:32.965 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.7Â°C, current=32.0Â°C, error=-5.3Â°C, sensitivity=1.5 -> offset=-3.5[0m
[36m2025-10-27 21:50:32.965 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=7.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 21:50:32.965 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 32.0Â°C â†’ offset: -3.5Â°C; Weight: 0.18; Deferred: Significant debt (DM -373)[0m
[36m2025-10-27 21:50:32.965 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Price classification Q87 (21:50): 67.72 â†’ NORMAL[0m
[32m2025-10-27 21:50:32.965 INFO (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Decision: offset 1.31Â°C - MODERATE RECOVERY: DM -373 beyond expected for 7.2Â°C (threshold: -336) [severe overshoot +1.9Â°C] | Learned pre-heat: Pre-heating: predicted drop 2.0Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 32.0Â°C â†’ offset: -3.5Â°C; Weight: 0.18; Deferred: Significant debt (DM -373) | GE-Spot Q87: NORMAL (day) | Too warm: 1.9Â°C over[0m
[32m2025-10-27 21:50:32.966 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 1.31Â°C, reasoning: MODERATE RECOVERY: DM -373 beyond expected for 7.2Â°C (threshold: -336) [severe overshoot +1.9Â°C] | Learned pre-heat: Pre-heating: predicted drop 2.0Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 32.0Â°C â†’ offset: -3.5Â°C; Weight: 0.18; Deferred: Significant debt (DM -373) | GE-Spot Q87: NORMAL (day) | Too warm: 1.9Â°C over[0m
[36m2025-10-27 21:50:32.966 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Skipping offset write, too soon since last write[0m
[36m2025-10-27 21:50:32.966 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 1.31Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 21:50:32.966 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 2.348 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 21:50:32.966 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=22.9Â°C, outdoor=7.2Â°C, offset=1.3Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 21:50:32.966 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=22.9Â°C, outdoor=7.2Â°C, offset=1.3Â°C, flow=32.0Â°C, DM=-373[0m
[36m2025-10-27 21:50:32.966 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-27 21:50:32.966 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 21:50:32.968 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 21:50:32.968 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 21:50:32.968 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=37.6[0m
[36m2025-10-27 21:50:32.968 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 21:50:32.971 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 21:50:32.971 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 21:50:32.971 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.2Â°C (zone: Moderate Cold): block=-336, abort=-416[0m
[36m2025-10-27 21:50:32.980 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 21:50:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 21:50:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.2Â°C (zone: Moderate Cold): block=-336, abort=-416[0m
[36m2025-10-27 21:50:32.980 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=CRITICAL_THERMAL_DEBT)[0m
[36m2025-10-27 21:50:32.980 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.021 seconds (success: True)[0m
[36m2025-10-27 21:50:32.981 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (8.8 + 0.6 + 1.1)A Ã— 0.95 = 2.39 kW[0m
[36m2025-10-27 21:50:32.982 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 21:55:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 21:55:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 22.9Â°C (median of 9 sensors: 23.6Â°C, 21.4Â°C, 21.7Â°C, 22.8Â°C, 25.2Â°C, 23.4Â°C, 22.7Â°C, 22.9Â°C, 25.0Â°C)[0m
[36m2025-10-27 21:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -371.0[0m
[36m2025-10-27 21:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 37.6Â°C[0m
[36m2025-10-27 21:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 32.0Â°C[0m
[36m2025-10-27 21:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=8.6A, L2=0.6A, L3=0.9A[0m
[36m2025-10-27 21:55:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 22.9Â°C, outdoor 7.2Â°C, flow 32.0Â°C, DM -371[0m
[36m2025-10-27 21:55:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 60 Hz (1h avg: 62, 6h avg: 64, mode: space) - OK: Normal operation (60 Hz, 6h avg: 64 Hz)[0m
[36m2025-10-27 21:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 21:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 21:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 21:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 21:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 21:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 21:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 21:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 21:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 21:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 21:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 104}[0m
[36m2025-10-27 21:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 21:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 21:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 21:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 21:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 21:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 21:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 21:55:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 21:55:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q87 = 67.72 Ã¶re/kWh[0m
[36m2025-10-27 21:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 21:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 21:55:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 21:55:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 21:55:32.962 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 21:55:32.963 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 21:55:32.963 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 21:55:32.965 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 21:55:32.966 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 21:55:32.966 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 21:55:32.966 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 21:55:32.966 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 7.2Â°C: normal -136 to -336, warning -336[0m
[36m2025-10-27 21:55:32.966 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 21:55:32.966 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -336 (base: -336), critical -1500[0m
[32m2025-10-27 21:55:32.966 INFO (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] T1 overshoot damping: severe overshoot +1.9Â°C, offset 4.00Â°C â†’ 3.20Â°C (factor 0.80, min 1.0Â°C)[0m
[36m2025-10-27 21:55:32.966 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=7.2Â°C, indoor_target=21.0Â°C, temp_diff=13.8Â°C, HC=0.180 kW/K -> flow=26.2Â°C[0m
[36m2025-10-27 21:55:32.966 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 21:55:32.966 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 21:55:32.967 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.7Â°C, current=32.0Â°C, error=-5.3Â°C, sensitivity=1.5 -> offset=-3.5[0m
[36m2025-10-27 21:55:32.967 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=7.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 21:55:32.967 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 32.0Â°C â†’ offset: -3.5Â°C; Weight: 0.18; Deferred: Significant debt (DM -371)[0m
[36m2025-10-27 21:55:32.967 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Price classification Q87 (21:55): 67.72 â†’ NORMAL[0m
[32m2025-10-27 21:55:32.967 INFO (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Decision: offset 1.31Â°C - MODERATE RECOVERY: DM -371 beyond expected for 7.2Â°C (threshold: -336) [severe overshoot +1.9Â°C] | Learned pre-heat: Pre-heating: predicted drop 2.0Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 32.0Â°C â†’ offset: -3.5Â°C; Weight: 0.18; Deferred: Significant debt (DM -371) | GE-Spot Q87: NORMAL (day) | Too warm: 1.9Â°C over[0m
[32m2025-10-27 21:55:32.968 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 1.31Â°C, reasoning: MODERATE RECOVERY: DM -371 beyond expected for 7.2Â°C (threshold: -336) [severe overshoot +1.9Â°C] | Learned pre-heat: Pre-heating: predicted drop 2.0Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 32.0Â°C â†’ offset: -3.5Â°C; Weight: 0.18; Deferred: Significant debt (DM -371) | GE-Spot Q87: NORMAL (day) | Too warm: 1.9Â°C over[0m
[36m2025-10-27 21:55:32.968 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=1.31Â°C, integer=1Â°C, fractional=0.31Â°C, accumulator_before=0.05Â°C[0m
[36m2025-10-27 21:55:32.968 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset 1.31Â°C â†’ applying 1Â°C (accumulator: 0.36Â°C, needs 0.64Â°C more to trigger)[0m
[32m2025-10-27 21:55:32.969 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to 1Â°C (calculated: 1.31Â°C, accumulator: 0.36Â°C)[0m
[36m2025-10-27 21:55:32.969 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=1Â°C, original=1.31Â°C, accumulator=0.36Â°C[0m
[32m2025-10-27 21:55:32.970 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset 1.31Â°C to NIBE via MyUplink[0m
[36m2025-10-27 21:55:32.970 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 2.218 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 21:55:32.970 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=22.9Â°C, outdoor=7.2Â°C, offset=1.3Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 21:55:32.970 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=22.9Â°C, outdoor=7.2Â°C, offset=1.3Â°C, flow=32.0Â°C, DM=-371[0m
[36m2025-10-27 21:55:32.980 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.0Â°C/h trend[0m
[36m2025-10-27 21:55:32.980 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 21:55:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 21:55:32.982 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 21:55:32.982 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=37.6[0m
[36m2025-10-27 21:55:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 21:55:32.986 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 21:55:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 21:55:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.2Â°C (zone: Moderate Cold): block=-336, abort=-416[0m
[36m2025-10-27 21:55:32.989 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 21:55:32.990 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 21:55:32.990 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.2Â°C (zone: Moderate Cold): block=-336, abort=-416[0m
[36m2025-10-27 21:55:32.990 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=CRITICAL_THERMAL_DEBT)[0m
[36m2025-10-27 21:55:32.990 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.031 seconds (success: True)[0m
[36m2025-10-27 21:55:32.991 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (8.6 + 0.6 + 0.9)A Ã— 0.95 = 2.30 kW[0m
[36m2025-10-27 21:55:32.992 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 22:00:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 22:00:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 22.9Â°C (median of 9 sensors: 23.6Â°C, 21.4Â°C, 21.8Â°C, 22.8Â°C, 25.1Â°C, 23.4Â°C, 22.7Â°C, 22.9Â°C, 25.0Â°C)[0m
[36m2025-10-27 22:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -363.0[0m
[36m2025-10-27 22:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 37.6Â°C[0m
[36m2025-10-27 22:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 32.0Â°C[0m
[36m2025-10-27 22:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=8.6A, L2=0.6A, L3=0.9A[0m
[36m2025-10-27 22:00:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 22.9Â°C, outdoor 7.2Â°C, flow 32.0Â°C, DM -363[0m
[36m2025-10-27 22:00:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 57 Hz (1h avg: 60, 6h avg: 63, mode: space) - OK: Normal operation (57 Hz, 6h avg: 63 Hz)[0m
[36m2025-10-27 22:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 22:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 22:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 22:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 22:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 22:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 22:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 22:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 22:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 22:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 22:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 103}[0m
[36m2025-10-27 22:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 22:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 22:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 22:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 22:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 22:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 22:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 22:00:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 22:00:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q88 = 89.94 Ã¶re/kWh[0m
[36m2025-10-27 22:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 22:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 22:00:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 22:00:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 22:00:32.961 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 22:00:32.961 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 22:00:32.963 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 22:00:32.965 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 22:00:32.965 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 22:00:32.965 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 22:00:32.966 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 22:00:32.966 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 7.2Â°C: normal -136 to -336, warning -336[0m
[36m2025-10-27 22:00:32.966 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 22:00:32.966 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -336 (base: -336), critical -1500[0m
[32m2025-10-27 22:00:32.966 INFO (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] T1 overshoot damping: severe overshoot +1.9Â°C, offset 4.00Â°C â†’ 3.20Â°C (factor 0.80, min 1.0Â°C)[0m
[36m2025-10-27 22:00:32.966 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=7.2Â°C, indoor_target=21.0Â°C, temp_diff=13.8Â°C, HC=0.180 kW/K -> flow=26.2Â°C[0m
[36m2025-10-27 22:00:32.968 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 22:00:32.968 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 22:00:32.968 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.7Â°C, current=32.0Â°C, error=-5.3Â°C, sensitivity=1.5 -> offset=-3.5[0m
[36m2025-10-27 22:00:32.968 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=7.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 22:00:32.968 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 32.0Â°C â†’ offset: -3.5Â°C; Weight: 0.18; Deferred: Significant debt (DM -363)[0m
[36m2025-10-27 22:00:32.968 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Price classification Q88 (22:00): 89.94 â†’ NORMAL[0m
[32m2025-10-27 22:00:32.968 INFO (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Decision: offset 1.31Â°C - MODERATE RECOVERY: DM -363 beyond expected for 7.2Â°C (threshold: -336) [severe overshoot +1.9Â°C] | Learned pre-heat: Pre-heating: predicted drop 2.0Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 32.0Â°C â†’ offset: -3.5Â°C; Weight: 0.18; Deferred: Significant debt (DM -363) | GE-Spot Q88: NORMAL (night) | Too warm: 1.9Â°C over[0m
[32m2025-10-27 22:00:32.970 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 1.31Â°C, reasoning: MODERATE RECOVERY: DM -363 beyond expected for 7.2Â°C (threshold: -336) [severe overshoot +1.9Â°C] | Learned pre-heat: Pre-heating: predicted drop 2.0Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 32.0Â°C â†’ offset: -3.5Â°C; Weight: 0.18; Deferred: Significant debt (DM -363) | GE-Spot Q88: NORMAL (night) | Too warm: 1.9Â°C over[0m
[36m2025-10-27 22:00:32.970 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 1.31Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-27 22:00:32.970 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 2.078 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 22:00:32.970 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=22.9Â°C, outdoor=7.2Â°C, offset=1.3Â°C, change=0.01Â°C, Î”t=0.08h[0m
[36m2025-10-27 22:00:32.970 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=22.9Â°C, outdoor=7.2Â°C, offset=1.3Â°C, flow=32.0Â°C, DM=-363[0m
[36m2025-10-27 22:00:32.978 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.0Â°C/h trend[0m
[36m2025-10-27 22:00:32.978 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 22:00:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 22:00:32.980 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 22:00:32.980 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=37.6[0m
[36m2025-10-27 22:00:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 22:00:32.983 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 22:00:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 22:00:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.2Â°C (zone: Moderate Cold): block=-336, abort=-416[0m
[36m2025-10-27 22:00:32.985 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 22:00:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 22:00:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.2Â°C (zone: Moderate Cold): block=-336, abort=-416[0m
[36m2025-10-27 22:00:32.986 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=CRITICAL_THERMAL_DEBT)[0m
[36m2025-10-27 22:00:32.986 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.027 seconds (success: True)[0m
[36m2025-10-27 22:00:32.987 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (8.6 + 0.6 + 0.9)A Ã— 0.95 = 2.30 kW[0m
[36m2025-10-27 22:00:32.988 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 22:05:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 22:05:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 22.9Â°C (median of 9 sensors: 23.6Â°C, 21.4Â°C, 21.8Â°C, 22.7Â°C, 25.1Â°C, 23.4Â°C, 22.5Â°C, 22.9Â°C, 25.0Â°C)[0m
[36m2025-10-27 22:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -353.0[0m
[36m2025-10-27 22:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 37.6Â°C[0m
[36m2025-10-27 22:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 32.0Â°C[0m
[36m2025-10-27 22:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=7.5A, L2=0.6A, L3=0.9A[0m
[36m2025-10-27 22:05:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 22.9Â°C, outdoor 7.2Â°C, flow 32.0Â°C, DM -353[0m
[36m2025-10-27 22:05:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 52 Hz (1h avg: 60, 6h avg: 63, mode: space) - OK: Normal operation (52 Hz, 6h avg: 63 Hz)[0m
[36m2025-10-27 22:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 22:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 22:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 22:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 22:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 22:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 22:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 22:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 22:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 22:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 22:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 103}[0m
[36m2025-10-27 22:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 22:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 22:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 22:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 22:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 22:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 22:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 22:05:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 22:05:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q88 = 89.94 Ã¶re/kWh[0m
[36m2025-10-27 22:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 22:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 22:05:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 22:05:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 22:05:32.961 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 22:05:32.961 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 22:05:32.963 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 22:05:32.965 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 22:05:32.968 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 22:05:32.968 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 22:05:32.968 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 22:05:32.968 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 7.2Â°C: normal -136 to -336, warning -336[0m
[36m2025-10-27 22:05:32.968 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 22:05:32.968 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -336 (base: -336), critical -1500[0m
[32m2025-10-27 22:05:32.968 INFO (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] T1 overshoot damping: severe overshoot +1.9Â°C, offset 4.00Â°C â†’ 3.20Â°C (factor 0.80, min 1.0Â°C)[0m
[36m2025-10-27 22:05:32.968 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=7.2Â°C, indoor_target=21.0Â°C, temp_diff=13.8Â°C, HC=0.180 kW/K -> flow=26.2Â°C[0m
[36m2025-10-27 22:05:32.968 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 22:05:32.968 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 22:05:32.969 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.7Â°C, current=32.0Â°C, error=-5.3Â°C, sensitivity=1.5 -> offset=-3.5[0m
[36m2025-10-27 22:05:32.969 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=7.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 22:05:32.969 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 32.0Â°C â†’ offset: -3.5Â°C; Weight: 0.18; Deferred: Significant debt (DM -353)[0m
[36m2025-10-27 22:05:32.969 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Price classification Q88 (22:05): 89.94 â†’ NORMAL[0m
[32m2025-10-27 22:05:32.970 INFO (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Decision: offset 1.31Â°C - MODERATE RECOVERY: DM -353 beyond expected for 7.2Â°C (threshold: -336) [severe overshoot +1.9Â°C] | Learned pre-heat: Pre-heating: predicted drop 2.1Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 32.0Â°C â†’ offset: -3.5Â°C; Weight: 0.18; Deferred: Significant debt (DM -353) | GE-Spot Q88: NORMAL (night) | Too warm: 1.9Â°C over[0m
[32m2025-10-27 22:05:32.970 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 1.31Â°C, reasoning: MODERATE RECOVERY: DM -353 beyond expected for 7.2Â°C (threshold: -336) [severe overshoot +1.9Â°C] | Learned pre-heat: Pre-heating: predicted drop 2.1Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 32.0Â°C â†’ offset: -3.5Â°C; Weight: 0.18; Deferred: Significant debt (DM -353) | GE-Spot Q88: NORMAL (night) | Too warm: 1.9Â°C over[0m
[36m2025-10-27 22:05:32.970 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 1.31Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-27 22:05:32.970 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.928 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 22:05:32.970 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=22.9Â°C, outdoor=7.2Â°C, offset=1.3Â°C, change=-0.01Â°C, Î”t=0.08h[0m
[36m2025-10-27 22:05:32.970 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=22.9Â°C, outdoor=7.2Â°C, offset=1.3Â°C, flow=32.0Â°C, DM=-353[0m
[36m2025-10-27 22:05:32.975 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.0Â°C/h trend[0m
[36m2025-10-27 22:05:32.975 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 22:05:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 22:05:32.976 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 22:05:32.976 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=37.6[0m
[36m2025-10-27 22:05:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 22:05:32.978 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 22:05:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 22:05:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.2Â°C (zone: Moderate Cold): block=-336, abort=-416[0m
[36m2025-10-27 22:05:32.983 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 22:05:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 22:05:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.2Â°C (zone: Moderate Cold): block=-336, abort=-416[0m
[36m2025-10-27 22:05:32.983 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=CRITICAL_THERMAL_DEBT)[0m
[36m2025-10-27 22:05:32.983 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.025 seconds (success: True)[0m
[36m2025-10-27 22:05:32.985 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (7.5 + 0.6 + 0.9)A Ã— 0.95 = 2.05 kW[0m
[36m2025-10-27 22:05:32.985 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 22:10:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 22:10:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.0Â°C (median of 9 sensors: 23.6Â°C, 21.4Â°C, 21.7Â°C, 22.8Â°C, 25.1Â°C, 23.4Â°C, 22.5Â°C, 23.0Â°C, 25.0Â°C)[0m
[36m2025-10-27 22:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -352.0[0m
[36m2025-10-27 22:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 37.6Â°C[0m
[36m2025-10-27 22:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 32.0Â°C[0m
[36m2025-10-27 22:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=7.5A, L2=0.6A, L3=0.9A[0m
[36m2025-10-27 22:10:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.0Â°C, outdoor 7.2Â°C, flow 32.0Â°C, DM -352[0m
[36m2025-10-27 22:10:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 51 Hz (1h avg: 62, 6h avg: 62, mode: space) - OK: Normal operation (51 Hz, 6h avg: 62 Hz)[0m
[36m2025-10-27 22:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 22:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 22:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 22:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 22:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 22:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 22:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 22:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 22:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 22:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 22:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 103}[0m
[36m2025-10-27 22:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 22:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 22:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 22:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 22:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 22:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 22:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 22:10:32.962 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 22:10:32.962 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q88 = 89.94 Ã¶re/kWh[0m
[36m2025-10-27 22:10:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 22:10:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 22:10:32.963 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 22:10:32.963 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 22:10:32.963 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 22:10:32.963 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 22:10:32.963 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 22:10:32.965 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 22:10:32.965 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 22:10:32.965 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 22:10:32.965 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 22:10:32.965 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 7.2Â°C: normal -136 to -336, warning -336[0m
[36m2025-10-27 22:10:32.966 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 22:10:32.966 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -336 (base: -336), critical -1500[0m
[32m2025-10-27 22:10:32.966 INFO (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] T1 overshoot damping: severe overshoot +2.0Â°C, offset 4.00Â°C â†’ 3.20Â°C (factor 0.80, min 1.0Â°C)[0m
[36m2025-10-27 22:10:32.966 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=7.2Â°C, indoor_target=21.0Â°C, temp_diff=13.8Â°C, HC=0.180 kW/K -> flow=26.2Â°C[0m
[36m2025-10-27 22:10:32.966 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 22:10:32.966 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 22:10:32.966 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.7Â°C, current=32.0Â°C, error=-5.3Â°C, sensitivity=1.5 -> offset=-3.5[0m
[36m2025-10-27 22:10:32.966 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=7.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 22:10:32.966 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 32.0Â°C â†’ offset: -3.5Â°C; Weight: 0.18; Deferred: Significant debt (DM -352)[0m
[36m2025-10-27 22:10:32.966 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Price classification Q88 (22:10): 89.94 â†’ NORMAL[0m
[32m2025-10-27 22:10:32.967 INFO (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Decision: offset 1.31Â°C - MODERATE RECOVERY: DM -352 beyond expected for 7.2Â°C (threshold: -336) [severe overshoot +2.0Â°C] | Learned pre-heat: Pre-heating: predicted drop 2.1Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 32.0Â°C â†’ offset: -3.5Â°C; Weight: 0.18; Deferred: Significant debt (DM -352) | GE-Spot Q88: NORMAL (night) | Too warm: 2.0Â°C over[0m
[32m2025-10-27 22:10:32.967 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 1.31Â°C, reasoning: MODERATE RECOVERY: DM -352 beyond expected for 7.2Â°C (threshold: -336) [severe overshoot +2.0Â°C] | Learned pre-heat: Pre-heating: predicted drop 2.1Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 32.0Â°C â†’ offset: -3.5Â°C; Weight: 0.18; Deferred: Significant debt (DM -352) | GE-Spot Q88: NORMAL (night) | Too warm: 2.0Â°C over[0m
[36m2025-10-27 22:10:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 1.31Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-27 22:10:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 2.028 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 22:10:32.967 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.0Â°C, outdoor=7.2Â°C, offset=1.3Â°C, change=0.03Â°C, Î”t=0.08h[0m
[36m2025-10-27 22:10:32.967 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.0Â°C, outdoor=7.2Â°C, offset=1.3Â°C, flow=32.0Â°C, DM=-352[0m
[36m2025-10-27 22:10:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-27 22:10:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 22:10:32.968 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 22:10:32.969 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 22:10:32.969 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=37.6[0m
[36m2025-10-27 22:10:32.969 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 22:10:32.977 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 22:10:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 22:10:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.2Â°C (zone: Moderate Cold): block=-336, abort=-416[0m
[36m2025-10-27 22:10:32.982 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 22:10:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 22:10:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.2Â°C (zone: Moderate Cold): block=-336, abort=-416[0m
[36m2025-10-27 22:10:32.982 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=CRITICAL_THERMAL_DEBT)[0m
[36m2025-10-27 22:10:32.982 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.023 seconds (success: True)[0m
[36m2025-10-27 22:10:32.984 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (7.5 + 0.6 + 0.9)A Ã— 0.95 = 2.05 kW[0m
[36m2025-10-27 22:10:32.984 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 22:15:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 22:15:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 22.9Â°C (median of 9 sensors: 23.6Â°C, 21.4Â°C, 21.8Â°C, 22.8Â°C, 25.1Â°C, 23.4Â°C, 22.5Â°C, 22.9Â°C, 25.0Â°C)[0m
[36m2025-10-27 22:15:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -343.0[0m
[36m2025-10-27 22:15:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 37.1Â°C[0m
[36m2025-10-27 22:15:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 32.0Â°C[0m
[36m2025-10-27 22:15:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=7.5A, L2=0.6A, L3=1.9A[0m
[36m2025-10-27 22:15:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 22.9Â°C, outdoor 7.2Â°C, flow 32.0Â°C, DM -343[0m
[36m2025-10-27 22:15:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 46 Hz (1h avg: 63, 6h avg: 62, mode: space) - OK: Normal operation (46 Hz, 6h avg: 62 Hz)[0m
[36m2025-10-27 22:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 22:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 22:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 22:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 22:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 22:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 22:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 22:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 22:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 22:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 22:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 102}[0m
[36m2025-10-27 22:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 22:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 22:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 22:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 22:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 22:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 22:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 22:15:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 22:15:32.961 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q89 = 82.42 Ã¶re/kWh[0m
[36m2025-10-27 22:15:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 22:15:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 22:15:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 22:15:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 22:15:32.962 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 22:15:32.962 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 22:15:32.962 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 22:15:32.963 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 22:15:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 22:15:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 22:15:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 22:15:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 7.2Â°C: normal -136 to -336, warning -336[0m
[36m2025-10-27 22:15:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 22:15:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -336 (base: -336), critical -1500[0m
[32m2025-10-27 22:15:32.965 INFO (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] T1 overshoot damping: severe overshoot +1.9Â°C, offset 4.00Â°C â†’ 3.20Â°C (factor 0.80, min 1.0Â°C)[0m
[36m2025-10-27 22:15:32.965 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=7.2Â°C, indoor_target=21.0Â°C, temp_diff=13.8Â°C, HC=0.180 kW/K -> flow=26.2Â°C[0m
[36m2025-10-27 22:15:32.965 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 22:15:32.965 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 22:15:32.965 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.7Â°C, current=32.0Â°C, error=-5.3Â°C, sensitivity=1.5 -> offset=-3.5[0m
[36m2025-10-27 22:15:32.965 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=7.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 22:15:32.965 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 32.0Â°C â†’ offset: -3.5Â°C; Weight: 0.18; Deferred: Significant debt (DM -343)[0m
[36m2025-10-27 22:15:32.965 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Price classification Q89 (22:15): 82.42 â†’ NORMAL[0m
[32m2025-10-27 22:15:32.965 INFO (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Decision: offset 1.31Â°C - MODERATE RECOVERY: DM -343 beyond expected for 7.2Â°C (threshold: -336) [severe overshoot +1.9Â°C] | Learned pre-heat: Pre-heating: predicted drop 2.1Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 32.0Â°C â†’ offset: -3.5Â°C; Weight: 0.18; Deferred: Significant debt (DM -343) | GE-Spot Q89: NORMAL (night) | Too warm: 1.9Â°C over[0m
[32m2025-10-27 22:15:32.966 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 1.31Â°C, reasoning: MODERATE RECOVERY: DM -343 beyond expected for 7.2Â°C (threshold: -336) [severe overshoot +1.9Â°C] | Learned pre-heat: Pre-heating: predicted drop 2.1Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 32.0Â°C â†’ offset: -3.5Â°C; Weight: 0.18; Deferred: Significant debt (DM -343) | GE-Spot Q89: NORMAL (night) | Too warm: 1.9Â°C over[0m
[36m2025-10-27 22:15:32.966 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 1.31Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-27 22:15:32.966 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.679 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 22:15:32.966 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=22.9Â°C, outdoor=7.2Â°C, offset=1.3Â°C, change=-0.03Â°C, Î”t=0.08h[0m
[36m2025-10-27 22:15:32.966 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=22.9Â°C, outdoor=7.2Â°C, offset=1.3Â°C, flow=32.0Â°C, DM=-343[0m
[36m2025-10-27 22:15:32.976 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.0Â°C/h trend[0m
[36m2025-10-27 22:15:32.976 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 22:15:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 22:15:32.977 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 22:15:32.977 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=37.1[0m
[36m2025-10-27 22:15:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 22:15:32.980 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 22:15:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 22:15:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.2Â°C (zone: Moderate Cold): block=-336, abort=-416[0m
[36m2025-10-27 22:15:32.982 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 22:15:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 22:15:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.2Â°C (zone: Moderate Cold): block=-336, abort=-416[0m
[36m2025-10-27 22:15:32.982 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=CRITICAL_THERMAL_DEBT)[0m
[36m2025-10-27 22:15:32.982 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.023 seconds (success: True)[0m
[36m2025-10-27 22:15:32.984 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (7.5 + 0.6 + 1.9)A Ã— 0.95 = 2.28 kW[0m
[36m2025-10-27 22:15:32.984 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 22:20:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 22:20:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 22.9Â°C (median of 9 sensors: 23.6Â°C, 21.4Â°C, 21.7Â°C, 22.9Â°C, 25.1Â°C, 23.4Â°C, 22.5Â°C, 22.9Â°C, 25.0Â°C)[0m
[36m2025-10-27 22:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -335.0[0m
[36m2025-10-27 22:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 37.1Â°C[0m
[36m2025-10-27 22:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 31.5Â°C[0m
[36m2025-10-27 22:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=6.5A, L2=0.6A, L3=0.9A[0m
[36m2025-10-27 22:20:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 22.9Â°C, outdoor 7.2Â°C, flow 31.5Â°C, DM -335[0m
[36m2025-10-27 22:20:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 42 Hz (1h avg: 60, 6h avg: 61, mode: space) - OK: Normal operation (42 Hz, 6h avg: 61 Hz)[0m
[36m2025-10-27 22:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 22:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 22:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 22:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 22:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 22:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 22:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 22:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 22:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 22:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 22:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 102}[0m
[36m2025-10-27 22:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 22:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 22:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 22:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 22:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 22:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 22:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 22:20:32.961 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 22:20:32.961 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q89 = 82.42 Ã¶re/kWh[0m
[36m2025-10-27 22:20:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 22:20:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 22:20:32.963 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 22:20:32.963 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 22:20:32.963 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 22:20:32.963 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 22:20:32.963 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 22:20:32.965 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 22:20:32.966 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 22:20:32.966 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 22:20:32.966 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 22:20:32.966 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 7.2Â°C: normal -136 to -336, warning -336[0m
[36m2025-10-27 22:20:32.966 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 22:20:32.966 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -336 (base: -336), critical -1500[0m
[36m2025-10-27 22:20:32.967 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=7.2Â°C, indoor_target=21.0Â°C, temp_diff=13.8Â°C, HC=0.180 kW/K -> flow=26.2Â°C[0m
[36m2025-10-27 22:20:32.967 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 22:20:32.967 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 22:20:32.967 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.7Â°C, current=31.5Â°C, error=-4.8Â°C, sensitivity=1.5 -> offset=-3.2[0m
[36m2025-10-27 22:20:32.967 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=7.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 22:20:32.967 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 31.5Â°C â†’ offset: -3.2Â°C; Weight: 0.18; Deferred: Significant debt (DM -335)[0m
[36m2025-10-27 22:20:32.967 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Price classification Q89 (22:20): 82.42 â†’ NORMAL[0m
[32m2025-10-27 22:20:32.967 INFO (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.47Â°C - Learned pre-heat: Pre-heating: predicted drop 2.1Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 31.5Â°C â†’ offset: -3.2Â°C; Weight: 0.18; Deferred: Significant debt (DM -335) | GE-Spot Q89: NORMAL (night) | Too warm: 1.9Â°C over[0m
[32m2025-10-27 22:20:32.969 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.47Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 2.1Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 31.5Â°C â†’ offset: -3.2Â°C; Weight: 0.18; Deferred: Significant debt (DM -335) | GE-Spot Q89: NORMAL (night) | Too warm: 1.9Â°C over[0m
[36m2025-10-27 22:20:32.969 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.47Â°C, integer=0Â°C, fractional=0.47Â°C, accumulator_before=0.36Â°C[0m
[36m2025-10-27 22:20:32.969 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: 0.83Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-27 22:20:32.969 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.47Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 22:20:32.969 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.639 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 22:20:32.969 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=22.9Â°C, outdoor=7.2Â°C, offset=0.5Â°C, change=0.01Â°C, Î”t=0.08h[0m
[36m2025-10-27 22:20:32.969 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=22.9Â°C, outdoor=7.2Â°C, offset=0.5Â°C, flow=31.5Â°C, DM=-335[0m
[36m2025-10-27 22:20:32.978 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.0Â°C/h trend[0m
[36m2025-10-27 22:20:32.978 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 22:20:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 22:20:32.979 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 22:20:32.979 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=37.1[0m
[36m2025-10-27 22:20:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 22:20:32.982 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 22:20:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 22:20:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.2Â°C (zone: Moderate Cold): block=-336, abort=-416[0m
[36m2025-10-27 22:20:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 32 quarters available, need 3 quarters (45 min), lookahead 8.0h[0m
[36m2025-10-27 22:20:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 30 windows evaluated[0m
[36m2025-10-27 22:20:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (5.4h away) â† SELECTED[0m
[36m2025-10-27 22:20:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (5.2h away)[0m
[36m2025-10-27 22:20:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (5.7h away)[0m
[36m2025-10-27 22:20:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (4.9h away)[0m
[36m2025-10-27 22:20:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (4.7h away)[0m
[32m2025-10-27 22:20:32.983 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 5.4h away[0m
[36m2025-10-27 22:20:32.986 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 22:20:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 22:20:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.2Â°C (zone: Moderate Cold): block=-336, abort=-416[0m
[36m2025-10-27 22:20:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 32 quarters available, need 3 quarters (45 min), lookahead 8.0h[0m
[36m2025-10-27 22:20:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 30 windows evaluated[0m
[36m2025-10-27 22:20:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (5.4h away) â† SELECTED[0m
[36m2025-10-27 22:20:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (5.2h away)[0m
[36m2025-10-27 22:20:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (5.7h away)[0m
[36m2025-10-27 22:20:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (4.9h away)[0m
[36m2025-10-27 22:20:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (4.7h away)[0m
[32m2025-10-27 22:20:32.987 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 5.4h away[0m
[36m2025-10-27 22:20:32.987 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-27 22:20:32.987 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.028 seconds (success: True)[0m
[36m2025-10-27 22:20:32.989 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (6.5 + 0.6 + 0.9)A Ã— 0.95 = 1.82 kW[0m
[36m2025-10-27 22:20:32.989 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 22:25:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 22:25:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 22.9Â°C (median of 9 sensors: 23.6Â°C, 21.4Â°C, 21.7Â°C, 22.9Â°C, 25.1Â°C, 23.4Â°C, 22.5Â°C, 22.9Â°C, 25.0Â°C)[0m
[36m2025-10-27 22:25:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -331.0[0m
[36m2025-10-27 22:25:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 37.1Â°C[0m
[36m2025-10-27 22:25:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.5Â°C[0m
[36m2025-10-27 22:25:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=6.5A, L2=0.6A, L3=0.9A[0m
[36m2025-10-27 22:25:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 22.9Â°C, outdoor 7.2Â°C, flow 30.5Â°C, DM -331[0m
[36m2025-10-27 22:25:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 41 Hz (1h avg: 59, 6h avg: 60, mode: space) - OK: Normal operation (41 Hz, 6h avg: 60 Hz)[0m
[36m2025-10-27 22:25:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 22:25:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 22:25:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 22:25:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 22:25:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 22:25:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 22:25:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 22:25:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 22:25:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 22:25:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 22:25:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 102}[0m
[36m2025-10-27 22:25:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 22:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 22:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 22:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 22:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 22:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 22:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 22:25:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 22:25:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q89 = 82.42 Ã¶re/kWh[0m
[36m2025-10-27 22:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 22:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 22:25:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 22:25:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 22:25:32.962 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 22:25:32.962 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 22:25:32.963 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 22:25:32.963 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 22:25:32.966 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 22:25:32.966 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 22:25:32.966 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 22:25:32.966 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 7.2Â°C: normal -136 to -336, warning -336[0m
[36m2025-10-27 22:25:32.966 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 22:25:32.966 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -336 (base: -336), critical -1500[0m
[36m2025-10-27 22:25:32.966 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=7.2Â°C, indoor_target=21.0Â°C, temp_diff=13.8Â°C, HC=0.180 kW/K -> flow=26.2Â°C[0m
[36m2025-10-27 22:25:32.966 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 22:25:32.967 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 22:25:32.967 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.7Â°C, current=30.5Â°C, error=-3.8Â°C, sensitivity=1.5 -> offset=-2.5[0m
[36m2025-10-27 22:25:32.967 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=7.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 22:25:32.967 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 30.5Â°C â†’ offset: -2.5Â°C; Weight: 0.18; Deferred: Significant debt (DM -331)[0m
[36m2025-10-27 22:25:32.967 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Price classification Q89 (22:25): 82.42 â†’ NORMAL[0m
[32m2025-10-27 22:25:32.967 INFO (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.53Â°C - Learned pre-heat: Pre-heating: predicted drop 2.1Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 30.5Â°C â†’ offset: -2.5Â°C; Weight: 0.18; Deferred: Significant debt (DM -331) | GE-Spot Q89: NORMAL (night) | Too warm: 1.9Â°C over[0m
[32m2025-10-27 22:25:32.967 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.53Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 2.1Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 30.5Â°C â†’ offset: -2.5Â°C; Weight: 0.18; Deferred: Significant debt (DM -331) | GE-Spot Q89: NORMAL (night) | Too warm: 1.9Â°C over[0m
[36m2025-10-27 22:25:32.967 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.53Â°C, integer=0Â°C, fractional=0.53Â°C, accumulator_before=0.83Â°C[0m
[32m2025-10-27 22:25:32.968 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] âœ“ Accumulated fractional offset reached threshold: applying +1Â°C adjustment (accumulator: 1.36Â°C â†’ 0.36Â°C)[0m
[36m2025-10-27 22:25:32.968 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Accumulator triggered: total_accumulated=1.36Â°C, adjustment=+1Â°C, new_integer=1Â°C, remaining=0.36Â°C[0m
[36m2025-10-27 22:25:32.968 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset 0.53Â°C â†’ applying 1Â°C (accumulator: 0.36Â°C, needs 0.64Â°C more to trigger)[0m
[32m2025-10-27 22:25:32.968 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to 1Â°C (calculated: 0.53Â°C, accumulator: 0.36Â°C)[0m
[36m2025-10-27 22:25:32.969 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=1Â°C, original=0.53Â°C, accumulator=0.36Â°C[0m
[32m2025-10-27 22:25:32.969 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset 0.53Â°C to NIBE via MyUplink[0m
[36m2025-10-27 22:25:32.969 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.627 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 22:25:32.969 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=22.9Â°C, outdoor=7.2Â°C, offset=0.5Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 22:25:32.969 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=22.9Â°C, outdoor=7.2Â°C, offset=0.5Â°C, flow=30.5Â°C, DM=-331[0m
[36m2025-10-27 22:25:32.969 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-27 22:25:32.969 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 22:25:32.972 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 22:25:32.972 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 22:25:32.973 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=37.1[0m
[36m2025-10-27 22:25:32.973 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 22:25:32.980 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 22:25:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 22:25:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.2Â°C (zone: Moderate Cold): block=-336, abort=-416[0m
[36m2025-10-27 22:25:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 32 quarters available, need 3 quarters (45 min), lookahead 8.0h[0m
[36m2025-10-27 22:25:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 30 windows evaluated[0m
[36m2025-10-27 22:25:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (5.3h away) â† SELECTED[0m
[36m2025-10-27 22:25:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (5.1h away)[0m
[36m2025-10-27 22:25:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (5.6h away)[0m
[36m2025-10-27 22:25:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (4.8h away)[0m
[36m2025-10-27 22:25:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (4.6h away)[0m
[32m2025-10-27 22:25:32.981 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 5.3h away[0m
[36m2025-10-27 22:25:32.984 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 22:25:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 22:25:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.2Â°C (zone: Moderate Cold): block=-336, abort=-416[0m
[36m2025-10-27 22:25:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 32 quarters available, need 3 quarters (45 min), lookahead 8.0h[0m
[36m2025-10-27 22:25:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 30 windows evaluated[0m
[36m2025-10-27 22:25:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (5.3h away) â† SELECTED[0m
[36m2025-10-27 22:25:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (5.1h away)[0m
[36m2025-10-27 22:25:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (5.6h away)[0m
[36m2025-10-27 22:25:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (4.8h away)[0m
[36m2025-10-27 22:25:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (4.6h away)[0m
[32m2025-10-27 22:25:32.984 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 5.3h away[0m
[36m2025-10-27 22:25:32.984 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-27 22:25:32.985 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.026 seconds (success: True)[0m
[36m2025-10-27 22:25:32.986 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (6.5 + 0.6 + 0.9)A Ã— 0.95 = 1.82 kW[0m
[36m2025-10-27 22:25:32.986 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 22:30:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 22:30:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.0Â°C (median of 9 sensors: 23.6Â°C, 21.4Â°C, 21.7Â°C, 22.9Â°C, 25.1Â°C, 23.4Â°C, 22.5Â°C, 23.0Â°C, 25.0Â°C)[0m
[36m2025-10-27 22:30:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -328.0[0m
[36m2025-10-27 22:30:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 37.1Â°C[0m
[36m2025-10-27 22:30:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.5Â°C[0m
[36m2025-10-27 22:30:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=6.9A, L2=0.6A, L3=0.9A[0m
[36m2025-10-27 22:30:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.0Â°C, outdoor 6.7Â°C, flow 30.5Â°C, DM -328[0m
[36m2025-10-27 22:30:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 40 Hz (1h avg: 56, 6h avg: 60, mode: space) - OK: Normal operation (40 Hz, 6h avg: 60 Hz)[0m
[36m2025-10-27 22:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 22:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 22:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 22:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 22:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 22:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 22:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 22:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 22:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 22:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 22:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 101}[0m
[36m2025-10-27 22:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 22:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 22:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 22:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 22:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 22:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 22:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 22:30:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 22:30:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q90 = 81.09 Ã¶re/kWh[0m
[36m2025-10-27 22:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 22:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 22:30:32.963 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 22:30:32.963 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 22:30:32.963 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 22:30:32.963 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 22:30:32.963 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 22:30:32.964 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 22:30:32.965 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 22:30:32.965 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 22:30:32.965 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-27 22:30:32.965 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 6.7Â°C: normal -146 to -346, warning -346[0m
[36m2025-10-27 22:30:32.965 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-27 22:30:32.965 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -346 (base: -346), critical -1500[0m
[36m2025-10-27 22:30:32.966 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=6.7Â°C, indoor_target=21.0Â°C, temp_diff=14.3Â°C, HC=0.180 kW/K -> flow=26.3Â°C[0m
[36m2025-10-27 22:30:32.966 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 22:30:32.966 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 22:30:32.966 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.8Â°C, current=30.5Â°C, error=-3.7Â°C, sensitivity=1.5 -> offset=-2.4[0m
[36m2025-10-27 22:30:32.966 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=6.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 22:30:32.966 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.3Â°C; Safety: +0.5Â°C; Adjusted: 26.8Â°C; Current: 30.5Â°C â†’ offset: -2.4Â°C; Weight: 0.18; Deferred: Significant debt (DM -328)[0m
[36m2025-10-27 22:30:32.966 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Price classification Q90 (22:30): 81.09 â†’ NORMAL[0m
[32m2025-10-27 22:30:32.966 INFO (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.54Â°C - Learned pre-heat: Pre-heating: predicted drop 2.1Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.3Â°C; Safety: +0.5Â°C; Adjusted: 26.8Â°C; Current: 30.5Â°C â†’ offset: -2.4Â°C; Weight: 0.18; Deferred: Significant debt (DM -328) | GE-Spot Q90: NORMAL (night) | Too warm: 2.0Â°C over[0m
[32m2025-10-27 22:30:32.967 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.54Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 2.1Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.3Â°C; Safety: +0.5Â°C; Adjusted: 26.8Â°C; Current: 30.5Â°C â†’ offset: -2.4Â°C; Weight: 0.18; Deferred: Significant debt (DM -328) | GE-Spot Q90: NORMAL (night) | Too warm: 2.0Â°C over[0m
[36m2025-10-27 22:30:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.54Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-27 22:30:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.694 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 22:30:32.968 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.0Â°C, outdoor=6.7Â°C, offset=0.5Â°C, change=0.02Â°C, Î”t=0.08h[0m
[36m2025-10-27 22:30:32.968 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.0Â°C, outdoor=6.7Â°C, offset=0.5Â°C, flow=30.5Â°C, DM=-328[0m
[36m2025-10-27 22:30:32.972 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.1Â°C/h trend[0m
[36m2025-10-27 22:30:32.972 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 22:30:32.974 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 22:30:32.974 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 22:30:32.974 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=37.1[0m
[36m2025-10-27 22:30:32.974 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-27 22:30:32.980 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 22:30:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-27 22:30:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 6.7Â°C (zone: Moderate Cold): block=-346, abort=-426[0m
[36m2025-10-27 22:30:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 32 quarters available, need 3 quarters (45 min), lookahead 8.0h[0m
[36m2025-10-27 22:30:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 30 windows evaluated[0m
[36m2025-10-27 22:30:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (5.2h away) â† SELECTED[0m
[36m2025-10-27 22:30:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (5.0h away)[0m
[36m2025-10-27 22:30:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (5.5h away)[0m
[36m2025-10-27 22:30:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (4.7h away)[0m
[36m2025-10-27 22:30:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (4.5h away)[0m
[32m2025-10-27 22:30:32.981 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 5.2h away[0m
[36m2025-10-27 22:30:32.982 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 22:30:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-27 22:30:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 6.7Â°C (zone: Moderate Cold): block=-346, abort=-426[0m
[36m2025-10-27 22:30:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 32 quarters available, need 3 quarters (45 min), lookahead 8.0h[0m
[36m2025-10-27 22:30:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 30 windows evaluated[0m
[36m2025-10-27 22:30:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (5.2h away) â† SELECTED[0m
[36m2025-10-27 22:30:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (5.0h away)[0m
[36m2025-10-27 22:30:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (5.5h away)[0m
[36m2025-10-27 22:30:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (4.7h away)[0m
[36m2025-10-27 22:30:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (4.5h away)[0m
[32m2025-10-27 22:30:32.983 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 5.2h away[0m
[36m2025-10-27 22:30:32.983 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-27 22:30:32.983 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.024 seconds (success: True)[0m
[36m2025-10-27 22:30:32.985 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (6.9 + 0.6 + 0.9)A Ã— 0.95 = 1.92 kW[0m
[36m2025-10-27 22:30:32.985 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 22:35:32.958 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 22:35:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.0Â°C (median of 9 sensors: 23.6Â°C, 21.4Â°C, 21.6Â°C, 22.9Â°C, 25.1Â°C, 23.5Â°C, 22.5Â°C, 23.0Â°C, 25.0Â°C)[0m
[36m2025-10-27 22:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -325.0[0m
[36m2025-10-27 22:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 37.1Â°C[0m
[36m2025-10-27 22:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.5Â°C[0m
[36m2025-10-27 22:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=6.9A, L2=0.6A, L3=0.9A[0m
[36m2025-10-27 22:35:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.0Â°C, outdoor 6.7Â°C, flow 30.5Â°C, DM -325[0m
[36m2025-10-27 22:35:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 40 Hz (1h avg: 53, 6h avg: 59, mode: space) - OK: Normal operation (40 Hz, 6h avg: 59 Hz)[0m
[36m2025-10-27 22:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 22:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 22:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 22:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 22:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 22:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 22:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 22:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 22:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 22:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 22:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 101}[0m
[36m2025-10-27 22:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 22:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 22:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 22:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 22:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 22:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 22:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 22:35:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 22:35:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q90 = 81.09 Ã¶re/kWh[0m
[36m2025-10-27 22:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 22:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 22:35:32.963 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 22:35:32.963 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 22:35:32.963 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 22:35:32.963 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 22:35:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 22:35:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 22:35:32.966 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 22:35:32.966 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 22:35:32.966 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-27 22:35:32.966 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 6.7Â°C: normal -146 to -346, warning -346[0m
[36m2025-10-27 22:35:32.966 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-27 22:35:32.966 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -346 (base: -346), critical -1500[0m
[36m2025-10-27 22:35:32.966 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=6.7Â°C, indoor_target=21.0Â°C, temp_diff=14.3Â°C, HC=0.180 kW/K -> flow=26.3Â°C[0m
[36m2025-10-27 22:35:32.966 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 22:35:32.967 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 22:35:32.967 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.8Â°C, current=30.5Â°C, error=-3.7Â°C, sensitivity=1.5 -> offset=-2.4[0m
[36m2025-10-27 22:35:32.967 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=6.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 22:35:32.967 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.3Â°C; Safety: +0.5Â°C; Adjusted: 26.8Â°C; Current: 30.5Â°C â†’ offset: -2.4Â°C; Weight: 0.18; Deferred: Significant debt (DM -325)[0m
[36m2025-10-27 22:35:32.967 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Price classification Q90 (22:35): 81.09 â†’ NORMAL[0m
[32m2025-10-27 22:35:32.967 INFO (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.54Â°C - Learned pre-heat: Pre-heating: predicted drop 2.0Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.3Â°C; Safety: +0.5Â°C; Adjusted: 26.8Â°C; Current: 30.5Â°C â†’ offset: -2.4Â°C; Weight: 0.18; Deferred: Significant debt (DM -325) | GE-Spot Q90: NORMAL (night) | Too warm: 2.0Â°C over[0m
[32m2025-10-27 22:35:32.967 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.54Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 2.0Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.3Â°C; Safety: +0.5Â°C; Adjusted: 26.8Â°C; Current: 30.5Â°C â†’ offset: -2.4Â°C; Weight: 0.18; Deferred: Significant debt (DM -325) | GE-Spot Q90: NORMAL (night) | Too warm: 2.0Â°C over[0m
[36m2025-10-27 22:35:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.54Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-27 22:35:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.656 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 22:35:32.967 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.0Â°C, outdoor=6.7Â°C, offset=0.5Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 22:35:32.967 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.0Â°C, outdoor=6.7Â°C, offset=0.5Â°C, flow=30.5Â°C, DM=-325[0m
[36m2025-10-27 22:35:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-27 22:35:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 22:35:32.969 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 22:35:32.969 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 22:35:32.969 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=37.1[0m
[36m2025-10-27 22:35:32.969 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-27 22:35:32.978 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 22:35:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-27 22:35:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 6.7Â°C (zone: Moderate Cold): block=-346, abort=-426[0m
[36m2025-10-27 22:35:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 32 quarters available, need 3 quarters (45 min), lookahead 8.0h[0m
[36m2025-10-27 22:35:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 30 windows evaluated[0m
[36m2025-10-27 22:35:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (5.2h away) â† SELECTED[0m
[36m2025-10-27 22:35:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (4.9h away)[0m
[36m2025-10-27 22:35:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (5.4h away)[0m
[36m2025-10-27 22:35:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (4.7h away)[0m
[36m2025-10-27 22:35:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (4.4h away)[0m
[32m2025-10-27 22:35:32.979 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 5.2h away[0m
[36m2025-10-27 22:35:32.984 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 22:35:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-27 22:35:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 6.7Â°C (zone: Moderate Cold): block=-346, abort=-426[0m
[36m2025-10-27 22:35:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 32 quarters available, need 3 quarters (45 min), lookahead 8.0h[0m
[36m2025-10-27 22:35:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 30 windows evaluated[0m
[36m2025-10-27 22:35:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (5.2h away) â† SELECTED[0m
[36m2025-10-27 22:35:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (4.9h away)[0m
[36m2025-10-27 22:35:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (5.4h away)[0m
[36m2025-10-27 22:35:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (4.7h away)[0m
[36m2025-10-27 22:35:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (4.4h away)[0m
[32m2025-10-27 22:35:32.985 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 5.2h away[0m
[36m2025-10-27 22:35:32.985 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-27 22:35:32.985 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.027 seconds (success: True)[0m
[36m2025-10-27 22:35:32.987 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (6.9 + 0.6 + 0.9)A Ã— 0.95 = 1.92 kW[0m
[36m2025-10-27 22:35:32.987 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 22:40:32.958 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 22:40:32.958 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.0Â°C (median of 9 sensors: 23.6Â°C, 21.4Â°C, 21.7Â°C, 22.9Â°C, 25.1Â°C, 23.5Â°C, 22.5Â°C, 23.0Â°C, 25.0Â°C)[0m
[36m2025-10-27 22:40:32.958 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -324.0[0m
[36m2025-10-27 22:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 37.1Â°C[0m
[36m2025-10-27 22:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.5Â°C[0m
[36m2025-10-27 22:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=6.9A, L2=0.6A, L3=0.9A[0m
[36m2025-10-27 22:40:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.0Â°C, outdoor 6.7Â°C, flow 30.5Â°C, DM -324[0m
[36m2025-10-27 22:40:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 39 Hz (1h avg: 51, 6h avg: 59, mode: space) - OK: Normal operation (39 Hz, 6h avg: 59 Hz)[0m
[36m2025-10-27 22:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 22:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 22:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 22:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 22:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 22:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 22:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 22:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 22:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 22:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 22:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 101}[0m
[36m2025-10-27 22:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 22:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 22:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 22:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 22:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 22:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 22:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 22:40:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 22:40:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q90 = 81.09 Ã¶re/kWh[0m
[36m2025-10-27 22:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 22:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 22:40:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 22:40:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 22:40:32.962 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 22:40:32.962 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-27 22:40:32.963 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 22:40:32.964 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 22:40:32.965 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 22:40:32.965 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 22:40:32.965 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-27 22:40:32.965 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 6.7Â°C: normal -146 to -346, warning -346[0m
[36m2025-10-27 22:40:32.965 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-27 22:40:32.965 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -346 (base: -346), critical -1500[0m
[36m2025-10-27 22:40:32.966 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=6.7Â°C, indoor_target=21.0Â°C, temp_diff=14.3Â°C, HC=0.180 kW/K -> flow=26.3Â°C[0m
[36m2025-10-27 22:40:32.966 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 22:40:32.966 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 22:40:32.966 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.8Â°C, current=30.5Â°C, error=-3.7Â°C, sensitivity=1.5 -> offset=-2.4[0m
[36m2025-10-27 22:40:32.966 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=6.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 22:40:32.966 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.3Â°C; Safety: +0.5Â°C; Adjusted: 26.8Â°C; Current: 30.5Â°C â†’ offset: -2.4Â°C; Weight: 0.18; Deferred: Significant debt (DM -324)[0m
[36m2025-10-27 22:40:32.966 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Price classification Q90 (22:40): 81.09 â†’ NORMAL[0m
[32m2025-10-27 22:40:32.966 INFO (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.54Â°C - Learned pre-heat: Pre-heating: predicted drop 2.0Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.3Â°C; Safety: +0.5Â°C; Adjusted: 26.8Â°C; Current: 30.5Â°C â†’ offset: -2.4Â°C; Weight: 0.18; Deferred: Significant debt (DM -324) | GE-Spot Q90: NORMAL (night) | Too warm: 2.0Â°C over[0m
[32m2025-10-27 22:40:32.966 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.54Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 2.0Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.3Â°C; Safety: +0.5Â°C; Adjusted: 26.8Â°C; Current: 30.5Â°C â†’ offset: -2.4Â°C; Weight: 0.18; Deferred: Significant debt (DM -324) | GE-Spot Q90: NORMAL (night) | Too warm: 2.0Â°C over[0m
[36m2025-10-27 22:40:32.966 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.54Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-27 22:40:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.750 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 22:40:32.967 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.0Â°C, outdoor=6.7Â°C, offset=0.5Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 22:40:32.967 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.0Â°C, outdoor=6.7Â°C, offset=0.5Â°C, flow=30.5Â°C, DM=-324[0m
[36m2025-10-27 22:40:32.975 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.1Â°C/h trend[0m
[36m2025-10-27 22:40:32.975 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 22:40:32.981 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved learned data to storage[0m
[36m2025-10-27 22:40:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 22:40:32.981 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 22:40:32.981 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=37.1[0m
[36m2025-10-27 22:40:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-27 22:40:32.984 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 22:40:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-27 22:40:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 6.7Â°C (zone: Moderate Cold): block=-346, abort=-426[0m
[36m2025-10-27 22:40:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 32 quarters available, need 3 quarters (45 min), lookahead 8.0h[0m
[36m2025-10-27 22:40:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 30 windows evaluated[0m
[36m2025-10-27 22:40:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (5.1h away) â† SELECTED[0m
[36m2025-10-27 22:40:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (4.8h away)[0m
[36m2025-10-27 22:40:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (5.3h away)[0m
[36m2025-10-27 22:40:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (4.6h away)[0m
[36m2025-10-27 22:40:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (4.3h away)[0m
[32m2025-10-27 22:40:32.984 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 5.1h away[0m
[36m2025-10-27 22:40:32.988 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 22:40:32.988 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-27 22:40:32.988 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 6.7Â°C (zone: Moderate Cold): block=-346, abort=-426[0m
[36m2025-10-27 22:40:32.988 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 32 quarters available, need 3 quarters (45 min), lookahead 8.0h[0m
[36m2025-10-27 22:40:32.989 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 30 windows evaluated[0m
[36m2025-10-27 22:40:32.989 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (5.1h away) â† SELECTED[0m
[36m2025-10-27 22:40:32.989 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (4.8h away)[0m
[36m2025-10-27 22:40:32.989 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (5.3h away)[0m
[36m2025-10-27 22:40:32.989 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (4.6h away)[0m
[36m2025-10-27 22:40:32.989 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (4.3h away)[0m
[32m2025-10-27 22:40:32.989 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 5.1h away[0m
[36m2025-10-27 22:40:32.989 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-27 22:40:32.989 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.031 seconds (success: True)[0m
[36m2025-10-27 22:40:32.990 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (6.9 + 0.6 + 0.9)A Ã— 0.95 = 1.92 kW[0m
[36m2025-10-27 22:40:32.991 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 22:45:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 22:45:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.0Â°C (median of 9 sensors: 23.6Â°C, 21.4Â°C, 21.6Â°C, 22.9Â°C, 25.1Â°C, 23.5Â°C, 22.5Â°C, 23.0Â°C, 25.0Â°C)[0m
[36m2025-10-27 22:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -321.0[0m
[36m2025-10-27 22:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 37.1Â°C[0m
[36m2025-10-27 22:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.5Â°C[0m
[36m2025-10-27 22:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=7.0A, L2=0.6A, L3=0.9A[0m
[36m2025-10-27 22:45:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.0Â°C, outdoor 6.7Â°C, flow 30.5Â°C, DM -321[0m
[36m2025-10-27 22:45:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 38 Hz (1h avg: 47, 6h avg: 58, mode: space) - OK: Normal operation (38 Hz, 6h avg: 58 Hz)[0m
[36m2025-10-27 22:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 22:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 22:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 22:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 22:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 22:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 22:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 22:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 22:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 22:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 22:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 100}[0m
[36m2025-10-27 22:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 22:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 22:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 22:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 22:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 22:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 22:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 22:45:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 22:45:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q91 = 64.94 Ã¶re/kWh[0m
[36m2025-10-27 22:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 22:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 22:45:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 22:45:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 22:45:32.961 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 22:45:32.961 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-27 22:45:32.963 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 22:45:32.964 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 22:45:32.964 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 22:45:32.964 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 22:45:32.966 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-27 22:45:32.966 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 6.7Â°C: normal -146 to -346, warning -346[0m
[36m2025-10-27 22:45:32.966 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-27 22:45:32.966 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -346 (base: -346), critical -1500[0m
[36m2025-10-27 22:45:32.966 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=6.7Â°C, indoor_target=21.0Â°C, temp_diff=14.3Â°C, HC=0.180 kW/K -> flow=26.3Â°C[0m
[36m2025-10-27 22:45:32.966 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 22:45:32.966 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 22:45:32.966 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.8Â°C, current=30.5Â°C, error=-3.7Â°C, sensitivity=1.5 -> offset=-2.4[0m
[36m2025-10-27 22:45:32.966 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=6.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 22:45:32.966 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.3Â°C; Safety: +0.5Â°C; Adjusted: 26.8Â°C; Current: 30.5Â°C â†’ offset: -2.4Â°C; Weight: 0.18; Deferred: Significant debt (DM -321)[0m
[36m2025-10-27 22:45:32.966 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Price classification Q91 (22:45): 64.94 â†’ NORMAL[0m
[32m2025-10-27 22:45:32.967 INFO (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.54Â°C - Learned pre-heat: Pre-heating: predicted drop 2.1Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.3Â°C; Safety: +0.5Â°C; Adjusted: 26.8Â°C; Current: 30.5Â°C â†’ offset: -2.4Â°C; Weight: 0.18; Deferred: Significant debt (DM -321) | GE-Spot Q91: NORMAL (night) | Too warm: 2.0Â°C over[0m
[32m2025-10-27 22:45:32.967 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.54Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 2.1Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.3Â°C; Safety: +0.5Â°C; Adjusted: 26.8Â°C; Current: 30.5Â°C â†’ offset: -2.4Â°C; Weight: 0.18; Deferred: Significant debt (DM -321) | GE-Spot Q91: NORMAL (night) | Too warm: 2.0Â°C over[0m
[36m2025-10-27 22:45:32.968 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.54Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-27 22:45:32.968 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.738 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 22:45:32.968 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.0Â°C, outdoor=6.7Â°C, offset=0.5Â°C, change=0.01Â°C, Î”t=0.08h[0m
[36m2025-10-27 22:45:32.968 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.0Â°C, outdoor=6.7Â°C, offset=0.5Â°C, flow=30.5Â°C, DM=-321[0m
[36m2025-10-27 22:45:32.976 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.0Â°C/h trend[0m
[36m2025-10-27 22:45:32.976 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 22:45:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 22:45:32.977 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 22:45:32.977 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=37.1[0m
[36m2025-10-27 22:45:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-27 22:45:32.979 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 22:45:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-27 22:45:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 6.7Â°C (zone: Moderate Cold): block=-346, abort=-426[0m
[36m2025-10-27 22:45:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 32 quarters available, need 3 quarters (45 min), lookahead 8.0h[0m
[36m2025-10-27 22:45:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 30 windows evaluated[0m
[36m2025-10-27 22:45:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (5.0h away) â† SELECTED[0m
[36m2025-10-27 22:45:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (4.7h away)[0m
[36m2025-10-27 22:45:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (5.2h away)[0m
[36m2025-10-27 22:45:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (4.5h away)[0m
[36m2025-10-27 22:45:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (4.2h away)[0m
[32m2025-10-27 22:45:32.980 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 5.0h away[0m
[36m2025-10-27 22:45:32.983 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 22:45:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-27 22:45:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 6.7Â°C (zone: Moderate Cold): block=-346, abort=-426[0m
[36m2025-10-27 22:45:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 32 quarters available, need 3 quarters (45 min), lookahead 8.0h[0m
[36m2025-10-27 22:45:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 30 windows evaluated[0m
[36m2025-10-27 22:45:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (5.0h away) â† SELECTED[0m
[36m2025-10-27 22:45:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (4.7h away)[0m
[36m2025-10-27 22:45:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (5.2h away)[0m
[36m2025-10-27 22:45:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (4.5h away)[0m
[36m2025-10-27 22:45:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (4.2h away)[0m
[32m2025-10-27 22:45:32.984 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 5.0h away[0m
[36m2025-10-27 22:45:32.984 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-27 22:45:32.984 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.026 seconds (success: True)[0m
[36m2025-10-27 22:45:32.985 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (7.0 + 0.6 + 0.9)A Ã— 0.95 = 1.94 kW[0m
[36m2025-10-27 22:45:32.986 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 22:50:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 22:50:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.0Â°C (median of 9 sensors: 23.6Â°C, 21.4Â°C, 21.6Â°C, 22.9Â°C, 25.1Â°C, 23.5Â°C, 22.5Â°C, 23.0Â°C, 25.0Â°C)[0m
[36m2025-10-27 22:50:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -319.0[0m
[36m2025-10-27 22:50:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 37.1Â°C[0m
[36m2025-10-27 22:50:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.5Â°C[0m
[36m2025-10-27 22:50:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=7.0A, L2=0.6A, L3=0.9A[0m
[36m2025-10-27 22:50:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.0Â°C, outdoor 6.7Â°C, flow 30.5Â°C, DM -319[0m
[36m2025-10-27 22:50:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 38 Hz (1h avg: 46, 6h avg: 57, mode: space) - OK: Normal operation (38 Hz, 6h avg: 57 Hz)[0m
[36m2025-10-27 22:50:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 22:50:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 22:50:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 22:50:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 22:50:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 22:50:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 22:50:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 22:50:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 22:50:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 22:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 22:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 100}[0m
[36m2025-10-27 22:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 22:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 22:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 22:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 22:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 22:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 22:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 22:50:32.961 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 22:50:32.961 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q91 = 64.94 Ã¶re/kWh[0m
[36m2025-10-27 22:50:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 22:50:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 22:50:32.963 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 22:50:32.963 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 22:50:32.963 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 22:50:32.963 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-27 22:50:32.963 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 22:50:32.964 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 22:50:32.965 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 22:50:32.965 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 22:50:32.965 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-27 22:50:32.965 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 6.7Â°C: normal -146 to -346, warning -346[0m
[36m2025-10-27 22:50:32.965 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-27 22:50:32.966 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -346 (base: -346), critical -1500[0m
[36m2025-10-27 22:50:32.966 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=6.7Â°C, indoor_target=21.0Â°C, temp_diff=14.3Â°C, HC=0.180 kW/K -> flow=26.3Â°C[0m
[36m2025-10-27 22:50:32.966 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 22:50:32.966 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 22:50:32.966 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.8Â°C, current=30.5Â°C, error=-3.7Â°C, sensitivity=1.5 -> offset=-2.4[0m
[36m2025-10-27 22:50:32.966 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=6.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 22:50:32.966 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.3Â°C; Safety: +0.5Â°C; Adjusted: 26.8Â°C; Current: 30.5Â°C â†’ offset: -2.4Â°C; Weight: 0.18; Deferred: Significant debt (DM -319)[0m
[36m2025-10-27 22:50:32.966 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Price classification Q91 (22:50): 64.94 â†’ NORMAL[0m
[32m2025-10-27 22:50:32.966 INFO (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.54Â°C - Learned pre-heat: Pre-heating: predicted drop 2.1Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.3Â°C; Safety: +0.5Â°C; Adjusted: 26.8Â°C; Current: 30.5Â°C â†’ offset: -2.4Â°C; Weight: 0.18; Deferred: Significant debt (DM -319) | GE-Spot Q91: NORMAL (night) | Too warm: 2.0Â°C over[0m
[32m2025-10-27 22:50:32.967 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.54Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 2.1Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.3Â°C; Safety: +0.5Â°C; Adjusted: 26.8Â°C; Current: 30.5Â°C â†’ offset: -2.4Â°C; Weight: 0.18; Deferred: Significant debt (DM -319) | GE-Spot Q91: NORMAL (night) | Too warm: 2.0Â°C over[0m
[36m2025-10-27 22:50:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.54Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-27 22:50:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.582 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 22:50:32.967 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.0Â°C, outdoor=6.7Â°C, offset=0.5Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 22:50:32.967 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.0Â°C, outdoor=6.7Â°C, offset=0.5Â°C, flow=30.5Â°C, DM=-319[0m
[36m2025-10-27 22:50:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-27 22:50:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 22:50:32.971 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 22:50:32.971 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 22:50:32.971 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=37.1[0m
[36m2025-10-27 22:50:32.971 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-27 22:50:32.975 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 22:50:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-27 22:50:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 6.7Â°C (zone: Moderate Cold): block=-346, abort=-426[0m
[36m2025-10-27 22:50:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 32 quarters available, need 3 quarters (45 min), lookahead 8.0h[0m
[36m2025-10-27 22:50:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 30 windows evaluated[0m
[36m2025-10-27 22:50:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (4.9h away) â† SELECTED[0m
[36m2025-10-27 22:50:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (4.7h away)[0m
[36m2025-10-27 22:50:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (5.2h away)[0m
[36m2025-10-27 22:50:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (4.4h away)[0m
[36m2025-10-27 22:50:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (4.2h away)[0m
[32m2025-10-27 22:50:32.976 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 4.9h away[0m
[36m2025-10-27 22:50:32.979 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 22:50:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-27 22:50:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 6.7Â°C (zone: Moderate Cold): block=-346, abort=-426[0m
[36m2025-10-27 22:50:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 32 quarters available, need 3 quarters (45 min), lookahead 8.0h[0m
[36m2025-10-27 22:50:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 30 windows evaluated[0m
[36m2025-10-27 22:50:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (4.9h away) â† SELECTED[0m
[36m2025-10-27 22:50:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (4.7h away)[0m
[36m2025-10-27 22:50:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (5.2h away)[0m
[36m2025-10-27 22:50:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (4.4h away)[0m
[36m2025-10-27 22:50:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (4.2h away)[0m
[32m2025-10-27 22:50:32.979 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 4.9h away[0m
[36m2025-10-27 22:50:32.979 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-27 22:50:32.980 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.021 seconds (success: True)[0m
[36m2025-10-27 22:50:32.981 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (7.0 + 0.6 + 0.9)A Ã— 0.95 = 1.94 kW[0m
[36m2025-10-27 22:50:32.981 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 22:55:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 22:55:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.0Â°C (median of 9 sensors: 23.6Â°C, 21.4Â°C, 21.7Â°C, 23.0Â°C, 25.1Â°C, 23.6Â°C, 22.5Â°C, 23.0Â°C, 25.0Â°C)[0m
[36m2025-10-27 22:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -316.0[0m
[36m2025-10-27 22:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 37.1Â°C[0m
[36m2025-10-27 22:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.5Â°C[0m
[36m2025-10-27 22:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=7.0A, L2=0.6A, L3=0.9A[0m
[36m2025-10-27 22:55:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.0Â°C, outdoor 6.7Â°C, flow 30.5Â°C, DM -316[0m
[36m2025-10-27 22:55:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 37 Hz (1h avg: 43, 6h avg: 57, mode: space) - OK: Normal operation (37 Hz, 6h avg: 57 Hz)[0m
[36m2025-10-27 22:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 22:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 22:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 22:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 22:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 22:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 22:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 22:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 22:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 22:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 22:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 100}[0m
[36m2025-10-27 22:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 22:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 22:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 22:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 22:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 22:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 22:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 22:55:32.961 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 22:55:32.961 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q91 = 64.94 Ã¶re/kWh[0m
[36m2025-10-27 22:55:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 22:55:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 22:55:32.963 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 22:55:32.963 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 22:55:32.963 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 22:55:32.963 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-27 22:55:32.964 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 22:55:32.966 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 22:55:32.967 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 22:55:32.967 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 22:55:32.967 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-27 22:55:32.967 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 6.7Â°C: normal -146 to -346, warning -346[0m
[36m2025-10-27 22:55:32.967 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-27 22:55:32.967 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -346 (base: -346), critical -1500[0m
[36m2025-10-27 22:55:32.967 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=6.7Â°C, indoor_target=21.0Â°C, temp_diff=14.3Â°C, HC=0.180 kW/K -> flow=26.3Â°C[0m
[36m2025-10-27 22:55:32.967 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 22:55:32.967 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 22:55:32.967 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.8Â°C, current=30.5Â°C, error=-3.7Â°C, sensitivity=1.5 -> offset=-2.4[0m
[36m2025-10-27 22:55:32.967 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=6.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 22:55:32.967 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.3Â°C; Safety: +0.5Â°C; Adjusted: 26.8Â°C; Current: 30.5Â°C â†’ offset: -2.4Â°C; Weight: 0.18; Deferred: Significant debt (DM -316)[0m
[36m2025-10-27 22:55:32.968 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Price classification Q91 (22:55): 64.94 â†’ NORMAL[0m
[32m2025-10-27 22:55:32.968 INFO (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.53Â°C - Learned pre-heat: Pre-heating: predicted drop 2.1Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.3Â°C; Safety: +0.5Â°C; Adjusted: 26.8Â°C; Current: 30.5Â°C â†’ offset: -2.4Â°C; Weight: 0.18; Deferred: Significant debt (DM -316) | GE-Spot Q91: NORMAL (night) | Too warm: 2.0Â°C over[0m
[32m2025-10-27 22:55:32.968 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.53Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 2.1Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.3Â°C; Safety: +0.5Â°C; Adjusted: 26.8Â°C; Current: 30.5Â°C â†’ offset: -2.4Â°C; Weight: 0.18; Deferred: Significant debt (DM -316) | GE-Spot Q91: NORMAL (night) | Too warm: 2.0Â°C over[0m
[36m2025-10-27 22:55:32.968 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.53Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-27 22:55:32.968 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.564 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 22:55:32.968 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.0Â°C, outdoor=6.7Â°C, offset=0.5Â°C, change=0.02Â°C, Î”t=0.08h[0m
[36m2025-10-27 22:55:32.968 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.0Â°C, outdoor=6.7Â°C, offset=0.5Â°C, flow=30.5Â°C, DM=-316[0m
[36m2025-10-27 22:55:32.977 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.1Â°C/h trend[0m
[36m2025-10-27 22:55:32.977 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 22:55:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 22:55:32.978 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 22:55:32.978 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=37.1[0m
[36m2025-10-27 22:55:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-27 22:55:32.981 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 22:55:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-27 22:55:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 6.7Â°C (zone: Moderate Cold): block=-346, abort=-426[0m
[36m2025-10-27 22:55:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 32 quarters available, need 3 quarters (45 min), lookahead 8.0h[0m
[36m2025-10-27 22:55:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 30 windows evaluated[0m
[36m2025-10-27 22:55:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (4.8h away) â† SELECTED[0m
[36m2025-10-27 22:55:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (4.6h away)[0m
[36m2025-10-27 22:55:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (5.1h away)[0m
[36m2025-10-27 22:55:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (4.3h away)[0m
[36m2025-10-27 22:55:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (4.1h away)[0m
[32m2025-10-27 22:55:32.982 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 4.8h away[0m
[36m2025-10-27 22:55:32.985 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 22:55:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-27 22:55:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 6.7Â°C (zone: Moderate Cold): block=-346, abort=-426[0m
[36m2025-10-27 22:55:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 32 quarters available, need 3 quarters (45 min), lookahead 8.0h[0m
[36m2025-10-27 22:55:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 30 windows evaluated[0m
[36m2025-10-27 22:55:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (4.8h away) â† SELECTED[0m
[36m2025-10-27 22:55:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (4.6h away)[0m
[36m2025-10-27 22:55:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (5.1h away)[0m
[36m2025-10-27 22:55:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (4.3h away)[0m
[36m2025-10-27 22:55:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (4.1h away)[0m
[32m2025-10-27 22:55:32.986 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 4.8h away[0m
[36m2025-10-27 22:55:32.986 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-27 22:55:32.986 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.027 seconds (success: True)[0m
[36m2025-10-27 22:55:32.987 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (7.0 + 0.6 + 0.9)A Ã— 0.95 = 1.94 kW[0m
[36m2025-10-27 22:55:32.988 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 23:00:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 23:00:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.0Â°C (median of 9 sensors: 23.6Â°C, 21.4Â°C, 21.7Â°C, 23.0Â°C, 25.1Â°C, 23.6Â°C, 22.5Â°C, 23.0Â°C, 25.0Â°C)[0m
[36m2025-10-27 23:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -313.0[0m
[36m2025-10-27 23:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 37.1Â°C[0m
[36m2025-10-27 23:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.5Â°C[0m
[36m2025-10-27 23:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=7.0A, L2=0.6A, L3=0.9A[0m
[36m2025-10-27 23:00:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.0Â°C, outdoor 7.2Â°C, flow 30.5Â°C, DM -313[0m
[36m2025-10-27 23:00:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 36 Hz (1h avg: 42, 6h avg: 56, mode: space) - OK: Normal operation (36 Hz, 6h avg: 56 Hz)[0m
[36m2025-10-27 23:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 23:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 23:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 23:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 23:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 23:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 23:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 23:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 23:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 23:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 23:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 99}[0m
[36m2025-10-27 23:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 23:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 23:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 23:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 23:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 23:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 23:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 23:00:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 23:00:32.961 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q92 = 85.40 Ã¶re/kWh[0m
[36m2025-10-27 23:00:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 23:00:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 23:00:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 23:00:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 23:00:32.962 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 23:00:32.962 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-27 23:00:32.962 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 23:00:32.963 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 23:00:32.964 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 23:00:32.964 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 23:00:32.964 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 23:00:32.964 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 7.2Â°C: normal -136 to -336, warning -336[0m
[36m2025-10-27 23:00:32.964 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 23:00:32.964 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -336 (base: -336), critical -1500[0m
[36m2025-10-27 23:00:32.965 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=7.2Â°C, indoor_target=21.0Â°C, temp_diff=13.8Â°C, HC=0.180 kW/K -> flow=26.2Â°C[0m
[36m2025-10-27 23:00:32.965 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 23:00:32.965 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 23:00:32.965 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.7Â°C, current=30.5Â°C, error=-3.8Â°C, sensitivity=1.5 -> offset=-2.5[0m
[36m2025-10-27 23:00:32.965 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=7.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 23:00:32.965 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 30.5Â°C â†’ offset: -2.5Â°C; Weight: 0.18; Deferred: Significant debt (DM -313)[0m
[36m2025-10-27 23:00:32.965 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Price classification Q92 (23:00): 85.40 â†’ NORMAL[0m
[32m2025-10-27 23:00:32.965 INFO (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.53Â°C - Learned pre-heat: Pre-heating: predicted drop 2.1Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 30.5Â°C â†’ offset: -2.5Â°C; Weight: 0.18; Deferred: Significant debt (DM -313) | GE-Spot Q92: NORMAL (night) | Too warm: 2.0Â°C over[0m
[32m2025-10-27 23:00:32.966 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.53Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 2.1Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 30.5Â°C â†’ offset: -2.5Â°C; Weight: 0.18; Deferred: Significant debt (DM -313) | GE-Spot Q92: NORMAL (night) | Too warm: 2.0Â°C over[0m
[36m2025-10-27 23:00:32.966 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.53Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-27 23:00:32.966 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.550 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 23:00:32.966 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.0Â°C, outdoor=7.2Â°C, offset=0.5Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 23:00:32.966 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.0Â°C, outdoor=7.2Â°C, offset=0.5Â°C, flow=30.5Â°C, DM=-313[0m
[36m2025-10-27 23:00:32.966 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-27 23:00:32.966 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 23:00:32.967 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 23:00:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 23:00:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=37.1[0m
[36m2025-10-27 23:00:32.967 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 23:00:32.975 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 23:00:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 23:00:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.2Â°C (zone: Moderate Cold): block=-336, abort=-416[0m
[36m2025-10-27 23:00:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 28 quarters available, need 3 quarters (45 min), lookahead 7.0h[0m
[36m2025-10-27 23:00:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 26 windows evaluated[0m
[36m2025-10-27 23:00:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (4.7h away) â† SELECTED[0m
[36m2025-10-27 23:00:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (4.5h away)[0m
[36m2025-10-27 23:00:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (5.0h away)[0m
[36m2025-10-27 23:00:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (4.2h away)[0m
[36m2025-10-27 23:00:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (4.0h away)[0m
[32m2025-10-27 23:00:32.976 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 4.7h away[0m
[36m2025-10-27 23:00:32.980 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 23:00:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 23:00:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.2Â°C (zone: Moderate Cold): block=-336, abort=-416[0m
[36m2025-10-27 23:00:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 28 quarters available, need 3 quarters (45 min), lookahead 7.0h[0m
[36m2025-10-27 23:00:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 26 windows evaluated[0m
[36m2025-10-27 23:00:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (4.7h away) â† SELECTED[0m
[36m2025-10-27 23:00:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (4.5h away)[0m
[36m2025-10-27 23:00:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (5.0h away)[0m
[36m2025-10-27 23:00:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (4.2h away)[0m
[36m2025-10-27 23:00:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (4.0h away)[0m
[32m2025-10-27 23:00:32.981 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 4.7h away[0m
[36m2025-10-27 23:00:32.981 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-27 23:00:32.981 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.022 seconds (success: True)[0m
[36m2025-10-27 23:00:32.982 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (7.0 + 0.6 + 0.9)A Ã— 0.95 = 1.94 kW[0m
[36m2025-10-27 23:00:32.983 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 23:05:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 23:05:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.0Â°C (median of 9 sensors: 23.6Â°C, 21.3Â°C, 21.7Â°C, 22.9Â°C, 25.1Â°C, 23.6Â°C, 22.5Â°C, 23.0Â°C, 25.0Â°C)[0m
[36m2025-10-27 23:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -310.0[0m
[36m2025-10-27 23:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 37.1Â°C[0m
[36m2025-10-27 23:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.5Â°C[0m
[36m2025-10-27 23:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=7.0A, L2=0.6A, L3=0.9A[0m
[36m2025-10-27 23:05:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.0Â°C, outdoor 7.2Â°C, flow 30.5Â°C, DM -310[0m
[36m2025-10-27 23:05:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 35 Hz (1h avg: 40, 6h avg: 56, mode: space) - OK: Normal operation (35 Hz, 6h avg: 56 Hz)[0m
[36m2025-10-27 23:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 23:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 23:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 23:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 23:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 23:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 23:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 23:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 23:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 23:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 23:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 99}[0m
[36m2025-10-27 23:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 23:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 23:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 23:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 23:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 23:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 23:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 23:05:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 23:05:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q92 = 85.40 Ã¶re/kWh[0m
[36m2025-10-27 23:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 23:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 23:05:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 23:05:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 23:05:32.962 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 23:05:32.962 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-27 23:05:32.962 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 23:05:32.963 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 23:05:32.966 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 23:05:32.966 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 23:05:32.966 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 23:05:32.966 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 7.2Â°C: normal -136 to -336, warning -336[0m
[36m2025-10-27 23:05:32.966 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 23:05:32.966 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -336 (base: -336), critical -1500[0m
[36m2025-10-27 23:05:32.967 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=7.2Â°C, indoor_target=21.0Â°C, temp_diff=13.8Â°C, HC=0.180 kW/K -> flow=26.2Â°C[0m
[36m2025-10-27 23:05:32.967 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 23:05:32.967 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 23:05:32.967 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.7Â°C, current=30.5Â°C, error=-3.8Â°C, sensitivity=1.5 -> offset=-2.5[0m
[36m2025-10-27 23:05:32.967 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=7.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 23:05:32.967 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 30.5Â°C â†’ offset: -2.5Â°C; Weight: 0.18; Deferred: Significant debt (DM -310)[0m
[36m2025-10-27 23:05:32.967 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Price classification Q92 (23:05): 85.40 â†’ NORMAL[0m
[32m2025-10-27 23:05:32.967 INFO (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.53Â°C - Learned pre-heat: Pre-heating: predicted drop 2.2Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 30.5Â°C â†’ offset: -2.5Â°C; Weight: 0.18; Deferred: Significant debt (DM -310) | GE-Spot Q92: NORMAL (night) | Too warm: 2.0Â°C over[0m
[32m2025-10-27 23:05:32.968 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.53Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 2.2Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 30.5Â°C â†’ offset: -2.5Â°C; Weight: 0.18; Deferred: Significant debt (DM -310) | GE-Spot Q92: NORMAL (night) | Too warm: 2.0Â°C over[0m
[36m2025-10-27 23:05:32.968 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.53Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-27 23:05:32.968 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.553 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 23:05:32.968 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.0Â°C, outdoor=7.2Â°C, offset=0.5Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 23:05:32.968 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.0Â°C, outdoor=7.2Â°C, offset=0.5Â°C, flow=30.5Â°C, DM=-310[0m
[36m2025-10-27 23:05:32.972 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.1Â°C/h trend[0m
[36m2025-10-27 23:05:32.972 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 23:05:32.974 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 23:05:32.974 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 23:05:32.974 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=37.1[0m
[36m2025-10-27 23:05:32.974 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 23:05:32.980 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 23:05:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 23:05:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.2Â°C (zone: Moderate Cold): block=-336, abort=-416[0m
[36m2025-10-27 23:05:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 28 quarters available, need 3 quarters (45 min), lookahead 7.0h[0m
[36m2025-10-27 23:05:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 26 windows evaluated[0m
[36m2025-10-27 23:05:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (4.7h away) â† SELECTED[0m
[36m2025-10-27 23:05:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (4.4h away)[0m
[36m2025-10-27 23:05:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (4.9h away)[0m
[36m2025-10-27 23:05:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (4.2h away)[0m
[36m2025-10-27 23:05:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (3.9h away)[0m
[32m2025-10-27 23:05:32.981 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 4.7h away[0m
[36m2025-10-27 23:05:32.984 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 23:05:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-27 23:05:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.2Â°C (zone: Moderate Cold): block=-336, abort=-416[0m
[36m2025-10-27 23:05:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 28 quarters available, need 3 quarters (45 min), lookahead 7.0h[0m
[36m2025-10-27 23:05:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 26 windows evaluated[0m
[36m2025-10-27 23:05:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (4.7h away) â† SELECTED[0m
[36m2025-10-27 23:05:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (4.4h away)[0m
[36m2025-10-27 23:05:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (4.9h away)[0m
[36m2025-10-27 23:05:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (4.2h away)[0m
[36m2025-10-27 23:05:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (3.9h away)[0m
[32m2025-10-27 23:05:32.985 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 4.7h away[0m
[36m2025-10-27 23:05:32.985 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-27 23:05:32.985 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.026 seconds (success: True)[0m
[36m2025-10-27 23:05:32.986 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (7.0 + 0.6 + 0.9)A Ã— 0.95 = 1.94 kW[0m
[36m2025-10-27 23:05:32.987 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 23:10:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 23:10:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.0Â°C (median of 9 sensors: 23.6Â°C, 21.3Â°C, 21.6Â°C, 23.0Â°C, 25.1Â°C, 23.6Â°C, 22.5Â°C, 23.0Â°C, 25.0Â°C)[0m
[36m2025-10-27 23:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -311.0[0m
[36m2025-10-27 23:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 37.1Â°C[0m
[36m2025-10-27 23:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.0Â°C[0m
[36m2025-10-27 23:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=7.0A, L2=0.6A, L3=0.9A[0m
[36m2025-10-27 23:10:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.0Â°C, outdoor 6.7Â°C, flow 30.0Â°C, DM -311[0m
[36m2025-10-27 23:10:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 36 Hz (1h avg: 40, 6h avg: 55, mode: space) - OK: Normal operation (36 Hz, 6h avg: 55 Hz)[0m
[36m2025-10-27 23:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 23:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 23:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 23:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 23:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 23:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 23:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 23:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 23:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 23:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 23:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 99}[0m
[36m2025-10-27 23:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 23:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 23:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 23:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 23:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 23:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 23:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 23:10:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 23:10:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q92 = 85.40 Ã¶re/kWh[0m
[36m2025-10-27 23:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 23:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 23:10:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 23:10:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 23:10:32.962 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 23:10:32.962 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-27 23:10:32.962 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 23:10:32.963 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 23:10:32.964 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 23:10:32.964 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 23:10:32.964 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-27 23:10:32.964 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 6.7Â°C: normal -146 to -346, warning -346[0m
[36m2025-10-27 23:10:32.964 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-27 23:10:32.964 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -346 (base: -346), critical -1500[0m
[36m2025-10-27 23:10:32.964 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=6.7Â°C, indoor_target=21.0Â°C, temp_diff=14.3Â°C, HC=0.180 kW/K -> flow=26.3Â°C[0m
[36m2025-10-27 23:10:32.964 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 23:10:32.964 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 23:10:32.965 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.8Â°C, current=30.0Â°C, error=-3.2Â°C, sensitivity=1.5 -> offset=-2.1[0m
[36m2025-10-27 23:10:32.965 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=6.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 23:10:32.965 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.3Â°C; Safety: +0.5Â°C; Adjusted: 26.8Â°C; Current: 30.0Â°C â†’ offset: -2.1Â°C; Weight: 0.18; Deferred: Significant debt (DM -311)[0m
[36m2025-10-27 23:10:32.965 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Price classification Q92 (23:10): 85.40 â†’ NORMAL[0m
[32m2025-10-27 23:10:32.966 INFO (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.56Â°C - Learned pre-heat: Pre-heating: predicted drop 2.2Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.3Â°C; Safety: +0.5Â°C; Adjusted: 26.8Â°C; Current: 30.0Â°C â†’ offset: -2.1Â°C; Weight: 0.18; Deferred: Significant debt (DM -311) | GE-Spot Q92: NORMAL (night) | Too warm: 2.0Â°C over[0m
[32m2025-10-27 23:10:32.968 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.56Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 2.2Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.3Â°C; Safety: +0.5Â°C; Adjusted: 26.8Â°C; Current: 30.0Â°C â†’ offset: -2.1Â°C; Weight: 0.18; Deferred: Significant debt (DM -311) | GE-Spot Q92: NORMAL (night) | Too warm: 2.0Â°C over[0m
[36m2025-10-27 23:10:32.968 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.56Â°C, integer=0Â°C, fractional=0.56Â°C, accumulator_before=0.36Â°C[0m
[36m2025-10-27 23:10:32.968 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: 0.93Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-27 23:10:32.968 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.56Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 23:10:32.968 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.567 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 23:10:32.968 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.0Â°C, outdoor=6.7Â°C, offset=0.6Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 23:10:32.968 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.0Â°C, outdoor=6.7Â°C, offset=0.6Â°C, flow=30.0Â°C, DM=-311[0m
[36m2025-10-27 23:10:32.972 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.1Â°C/h trend[0m
[36m2025-10-27 23:10:32.973 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 23:10:32.973 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 23:10:32.973 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 23:10:32.974 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=37.1[0m
[36m2025-10-27 23:10:32.974 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-27 23:10:32.981 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 23:10:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-27 23:10:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 6.7Â°C (zone: Moderate Cold): block=-346, abort=-426[0m
[36m2025-10-27 23:10:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 28 quarters available, need 3 quarters (45 min), lookahead 7.0h[0m
[36m2025-10-27 23:10:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 26 windows evaluated[0m
[36m2025-10-27 23:10:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (4.6h away) â† SELECTED[0m
[36m2025-10-27 23:10:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (4.3h away)[0m
[36m2025-10-27 23:10:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (4.8h away)[0m
[36m2025-10-27 23:10:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (4.1h away)[0m
[36m2025-10-27 23:10:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (3.8h away)[0m
[32m2025-10-27 23:10:32.981 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 4.6h away[0m
[36m2025-10-27 23:10:32.985 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 23:10:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-27 23:10:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 6.7Â°C (zone: Moderate Cold): block=-346, abort=-426[0m
[36m2025-10-27 23:10:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 28 quarters available, need 3 quarters (45 min), lookahead 7.0h[0m
[36m2025-10-27 23:10:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 26 windows evaluated[0m
[36m2025-10-27 23:10:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (4.6h away) â† SELECTED[0m
[36m2025-10-27 23:10:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (4.3h away)[0m
[36m2025-10-27 23:10:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (4.8h away)[0m
[36m2025-10-27 23:10:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (4.1h away)[0m
[36m2025-10-27 23:10:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (3.8h away)[0m
[32m2025-10-27 23:10:32.986 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 4.6h away[0m
[36m2025-10-27 23:10:32.986 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-27 23:10:32.986 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.027 seconds (success: True)[0m
[36m2025-10-27 23:10:32.987 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (7.0 + 0.6 + 0.9)A Ã— 0.95 = 1.94 kW[0m
[36m2025-10-27 23:10:32.988 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 23:15:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 23:15:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.0Â°C (median of 9 sensors: 23.6Â°C, 21.3Â°C, 21.6Â°C, 22.9Â°C, 25.1Â°C, 23.6Â°C, 22.5Â°C, 23.0Â°C, 25.0Â°C)[0m
[36m2025-10-27 23:15:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -312.0[0m
[36m2025-10-27 23:15:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 37.1Â°C[0m
[36m2025-10-27 23:15:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.0Â°C[0m
[36m2025-10-27 23:15:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=7.0A, L2=0.6A, L3=0.9A[0m
[36m2025-10-27 23:15:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.0Â°C, outdoor 6.2Â°C, flow 30.0Â°C, DM -312[0m
[36m2025-10-27 23:15:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 37 Hz (1h avg: 39, 6h avg: 55, mode: space) - OK: Normal operation (37 Hz, 6h avg: 55 Hz)[0m
[36m2025-10-27 23:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 23:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 23:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 23:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 23:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 23:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 23:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 23:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 23:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 23:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 23:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 98}[0m
[36m2025-10-27 23:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 23:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 23:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 23:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 23:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 23:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 23:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 23:15:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 23:15:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q93 = 70.33 Ã¶re/kWh[0m
[36m2025-10-27 23:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 23:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 23:15:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 23:15:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 23:15:32.962 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 23:15:32.962 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-27 23:15:32.962 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 23:15:32.963 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 23:15:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 23:15:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 23:15:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-27 23:15:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 6.2Â°C: normal -156 to -356, warning -356[0m
[36m2025-10-27 23:15:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-27 23:15:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -356 (base: -356), critical -1500[0m
[36m2025-10-27 23:15:32.965 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=6.2Â°C, indoor_target=21.0Â°C, temp_diff=14.8Â°C, HC=0.180 kW/K -> flow=26.5Â°C[0m
[36m2025-10-27 23:15:32.965 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 23:15:32.965 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 23:15:32.965 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=27.0Â°C, current=30.0Â°C, error=-3.0Â°C, sensitivity=1.5 -> offset=-2.0[0m
[36m2025-10-27 23:15:32.965 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=6.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 23:15:32.965 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.5Â°C; Safety: +0.5Â°C; Adjusted: 27.0Â°C; Current: 30.0Â°C â†’ offset: -2.0Â°C; Weight: 0.18; Deferred: Significant debt (DM -312)[0m
[36m2025-10-27 23:15:32.965 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Price classification Q93 (23:15): 70.33 â†’ NORMAL[0m
[32m2025-10-27 23:15:32.965 INFO (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.57Â°C - Learned pre-heat: Pre-heating: predicted drop 2.2Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.5Â°C; Safety: +0.5Â°C; Adjusted: 27.0Â°C; Current: 30.0Â°C â†’ offset: -2.0Â°C; Weight: 0.18; Deferred: Significant debt (DM -312) | GE-Spot Q93: NORMAL (night) | Too warm: 2.0Â°C over[0m
[32m2025-10-27 23:15:32.965 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.57Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 2.2Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.5Â°C; Safety: +0.5Â°C; Adjusted: 27.0Â°C; Current: 30.0Â°C â†’ offset: -2.0Â°C; Weight: 0.18; Deferred: Significant debt (DM -312) | GE-Spot Q93: NORMAL (night) | Too warm: 2.0Â°C over[0m
[36m2025-10-27 23:15:32.965 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.57Â°C, integer=0Â°C, fractional=0.57Â°C, accumulator_before=0.93Â°C[0m
[32m2025-10-27 23:15:32.965 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] âœ“ Accumulated fractional offset reached threshold: applying +1Â°C adjustment (accumulator: 1.50Â°C â†’ 0.50Â°C)[0m
[36m2025-10-27 23:15:32.965 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Accumulator triggered: total_accumulated=1.50Â°C, adjustment=+1Â°C, new_integer=1Â°C, remaining=0.50Â°C[0m
[36m2025-10-27 23:15:32.965 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset 0.57Â°C â†’ applying 1Â°C (accumulator: 0.50Â°C, needs 0.50Â°C more to trigger)[0m
[32m2025-10-27 23:15:32.967 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to 1Â°C (calculated: 0.57Â°C, accumulator: 0.50Â°C)[0m
[36m2025-10-27 23:15:32.967 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=1Â°C, original=0.57Â°C, accumulator=0.50Â°C[0m
[32m2025-10-27 23:15:32.967 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset 0.57Â°C to NIBE via MyUplink[0m
[36m2025-10-27 23:15:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.565 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 23:15:32.967 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.0Â°C, outdoor=6.2Â°C, offset=0.6Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-27 23:15:32.967 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.0Â°C, outdoor=6.2Â°C, offset=0.6Â°C, flow=30.0Â°C, DM=-312[0m
[36m2025-10-27 23:15:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-27 23:15:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 23:15:32.970 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 23:15:32.970 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 23:15:32.970 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=37.1[0m
[36m2025-10-27 23:15:32.970 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-27 23:15:32.978 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 23:15:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-27 23:15:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 6.2Â°C (zone: Moderate Cold): block=-356, abort=-436[0m
[36m2025-10-27 23:15:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 28 quarters available, need 3 quarters (45 min), lookahead 7.0h[0m
[36m2025-10-27 23:15:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 26 windows evaluated[0m
[36m2025-10-27 23:15:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (4.5h away) â† SELECTED[0m
[36m2025-10-27 23:15:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (4.2h away)[0m
[36m2025-10-27 23:15:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (4.7h away)[0m
[36m2025-10-27 23:15:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (4.0h away)[0m
[36m2025-10-27 23:15:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (3.7h away)[0m
[32m2025-10-27 23:15:32.979 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 4.5h away[0m
[36m2025-10-27 23:15:32.984 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 23:15:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-27 23:15:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 6.2Â°C (zone: Moderate Cold): block=-356, abort=-436[0m
[36m2025-10-27 23:15:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 28 quarters available, need 3 quarters (45 min), lookahead 7.0h[0m
[36m2025-10-27 23:15:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 26 windows evaluated[0m
[36m2025-10-27 23:15:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (4.5h away) â† SELECTED[0m
[36m2025-10-27 23:15:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (4.2h away)[0m
[36m2025-10-27 23:15:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (4.7h away)[0m
[36m2025-10-27 23:15:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (4.0h away)[0m
[36m2025-10-27 23:15:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (3.7h away)[0m
[32m2025-10-27 23:15:32.985 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 4.5h away[0m
[36m2025-10-27 23:15:32.985 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-27 23:15:32.985 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.026 seconds (success: True)[0m
[36m2025-10-27 23:15:32.987 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (7.0 + 0.6 + 0.9)A Ã— 0.95 = 1.94 kW[0m
[36m2025-10-27 23:15:32.987 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 23:20:32.958 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 23:20:32.958 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.0Â°C (median of 9 sensors: 23.6Â°C, 21.3Â°C, 21.6Â°C, 23.0Â°C, 25.0Â°C, 23.7Â°C, 22.5Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-27 23:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -310.0[0m
[36m2025-10-27 23:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 37.1Â°C[0m
[36m2025-10-27 23:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.5Â°C[0m
[36m2025-10-27 23:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=6.5A, L2=0.6A, L3=0.9A[0m
[36m2025-10-27 23:20:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.0Â°C, outdoor 6.2Â°C, flow 30.5Â°C, DM -310[0m
[36m2025-10-27 23:20:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 37 Hz (1h avg: 38, 6h avg: 54, mode: space) - OK: Normal operation (37 Hz, 6h avg: 54 Hz)[0m
[36m2025-10-27 23:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 23:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 23:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 23:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 23:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 23:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 23:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 23:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 23:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 23:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 23:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 98}[0m
[36m2025-10-27 23:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 23:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 23:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 23:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 23:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 23:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 23:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 23:20:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 23:20:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q93 = 70.33 Ã¶re/kWh[0m
[36m2025-10-27 23:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 23:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 23:20:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 23:20:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 23:20:32.961 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 23:20:32.961 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-27 23:20:32.961 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 23:20:32.962 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 23:20:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 23:20:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 23:20:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-27 23:20:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 6.2Â°C: normal -156 to -356, warning -356[0m
[36m2025-10-27 23:20:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-27 23:20:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -356 (base: -356), critical -1500[0m
[36m2025-10-27 23:20:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=6.2Â°C, indoor_target=21.0Â°C, temp_diff=14.8Â°C, HC=0.180 kW/K -> flow=26.5Â°C[0m
[36m2025-10-27 23:20:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 23:20:32.965 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 23:20:32.965 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=27.0Â°C, current=30.5Â°C, error=-3.5Â°C, sensitivity=1.5 -> offset=-2.3[0m
[36m2025-10-27 23:20:32.965 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=6.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 23:20:32.965 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.5Â°C; Safety: +0.5Â°C; Adjusted: 27.0Â°C; Current: 30.5Â°C â†’ offset: -2.3Â°C; Weight: 0.18; Deferred: Significant debt (DM -310)[0m
[36m2025-10-27 23:20:32.965 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Price classification Q93 (23:20): 70.33 â†’ NORMAL[0m
[32m2025-10-27 23:20:32.965 INFO (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.54Â°C - Learned pre-heat: Pre-heating: predicted drop 2.2Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.5Â°C; Safety: +0.5Â°C; Adjusted: 27.0Â°C; Current: 30.5Â°C â†’ offset: -2.3Â°C; Weight: 0.18; Deferred: Significant debt (DM -310) | GE-Spot Q93: NORMAL (night) | Too warm: 2.0Â°C over[0m
[32m2025-10-27 23:20:32.965 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.54Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 2.2Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.5Â°C; Safety: +0.5Â°C; Adjusted: 27.0Â°C; Current: 30.5Â°C â†’ offset: -2.3Â°C; Weight: 0.18; Deferred: Significant debt (DM -310) | GE-Spot Q93: NORMAL (night) | Too warm: 2.0Â°C over[0m
[36m2025-10-27 23:20:32.965 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.54Â°C, integer=0Â°C, fractional=0.54Â°C, accumulator_before=0.50Â°C[0m
[32m2025-10-27 23:20:32.965 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] âœ“ Accumulated fractional offset reached threshold: applying +1Â°C adjustment (accumulator: 1.04Â°C â†’ 0.04Â°C)[0m
[36m2025-10-27 23:20:32.966 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Accumulator triggered: total_accumulated=1.04Â°C, adjustment=+1Â°C, new_integer=1Â°C, remaining=0.04Â°C[0m
[36m2025-10-27 23:20:32.966 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset 0.54Â°C â†’ applying 1Â°C (accumulator: 0.04Â°C, needs 0.96Â°C more to trigger)[0m
[32m2025-10-27 23:20:32.967 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to 1Â°C (calculated: 0.54Â°C, accumulator: 0.04Â°C)[0m
[36m2025-10-27 23:20:32.967 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=1Â°C, original=0.54Â°C, accumulator=0.04Â°C[0m
[32m2025-10-27 23:20:32.967 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset 0.54Â°C to NIBE via MyUplink[0m
[36m2025-10-27 23:20:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.635 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 23:20:32.967 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.0Â°C, outdoor=6.2Â°C, offset=0.5Â°C, change=0.01Â°C, Î”t=0.08h[0m
[36m2025-10-27 23:20:32.967 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.0Â°C, outdoor=6.2Â°C, offset=0.5Â°C, flow=30.5Â°C, DM=-310[0m
[36m2025-10-27 23:20:32.974 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.1Â°C/h trend[0m
[36m2025-10-27 23:20:32.974 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 23:20:32.975 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 23:20:32.976 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 23:20:32.976 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=37.1[0m
[36m2025-10-27 23:20:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-27 23:20:32.981 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 23:20:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-27 23:20:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 6.2Â°C (zone: Moderate Cold): block=-356, abort=-436[0m
[36m2025-10-27 23:20:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 28 quarters available, need 3 quarters (45 min), lookahead 7.0h[0m
[36m2025-10-27 23:20:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 26 windows evaluated[0m
[36m2025-10-27 23:20:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (4.4h away) â† SELECTED[0m
[36m2025-10-27 23:20:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (4.2h away)[0m
[36m2025-10-27 23:20:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (4.7h away)[0m
[36m2025-10-27 23:20:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (3.9h away)[0m
[36m2025-10-27 23:20:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (3.7h away)[0m
[32m2025-10-27 23:20:32.982 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 4.4h away[0m
[36m2025-10-27 23:20:32.985 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 23:20:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-27 23:20:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 6.2Â°C (zone: Moderate Cold): block=-356, abort=-436[0m
[36m2025-10-27 23:20:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 28 quarters available, need 3 quarters (45 min), lookahead 7.0h[0m
[36m2025-10-27 23:20:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 26 windows evaluated[0m
[36m2025-10-27 23:20:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (4.4h away) â† SELECTED[0m
[36m2025-10-27 23:20:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (4.2h away)[0m
[36m2025-10-27 23:20:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (4.7h away)[0m
[36m2025-10-27 23:20:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (3.9h away)[0m
[36m2025-10-27 23:20:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (3.7h away)[0m
[32m2025-10-27 23:20:32.986 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 4.4h away[0m
[36m2025-10-27 23:20:32.986 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-27 23:20:32.986 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.028 seconds (success: True)[0m
[36m2025-10-27 23:20:32.988 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (6.5 + 0.6 + 0.9)A Ã— 0.95 = 1.82 kW[0m
[36m2025-10-27 23:20:32.988 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 23:25:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 23:25:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.0Â°C (median of 9 sensors: 23.6Â°C, 21.3Â°C, 21.6Â°C, 23.0Â°C, 25.0Â°C, 23.7Â°C, 22.5Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-27 23:25:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -307.0[0m
[36m2025-10-27 23:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 37.1Â°C[0m
[36m2025-10-27 23:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.5Â°C[0m
[36m2025-10-27 23:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=6.5A, L2=0.6A, L3=0.9A[0m
[36m2025-10-27 23:25:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.0Â°C, outdoor 6.2Â°C, flow 30.5Â°C, DM -307[0m
[36m2025-10-27 23:25:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 36 Hz (1h avg: 37, 6h avg: 54, mode: space) - OK: Normal operation (36 Hz, 6h avg: 54 Hz)[0m
[36m2025-10-27 23:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 23:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 23:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 23:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 23:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 23:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 23:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 23:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 23:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 23:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 23:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 98}[0m
[36m2025-10-27 23:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 23:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 23:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 23:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 23:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 23:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 23:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 23:25:32.961 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 23:25:32.961 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q93 = 70.33 Ã¶re/kWh[0m
[36m2025-10-27 23:25:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 23:25:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 23:25:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 23:25:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 23:25:32.962 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 23:25:32.962 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-27 23:25:32.962 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 23:25:32.963 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 23:25:32.967 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 23:25:32.967 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 23:25:32.967 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-27 23:25:32.967 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 6.2Â°C: normal -156 to -356, warning -356[0m
[36m2025-10-27 23:25:32.967 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-27 23:25:32.967 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -356 (base: -356), critical -1500[0m
[36m2025-10-27 23:25:32.967 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=6.2Â°C, indoor_target=21.0Â°C, temp_diff=14.8Â°C, HC=0.180 kW/K -> flow=26.5Â°C[0m
[36m2025-10-27 23:25:32.967 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 23:25:32.968 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 23:25:32.968 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=27.0Â°C, current=30.5Â°C, error=-3.5Â°C, sensitivity=1.5 -> offset=-2.3[0m
[36m2025-10-27 23:25:32.968 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=6.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 23:25:32.968 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.5Â°C; Safety: +0.5Â°C; Adjusted: 27.0Â°C; Current: 30.5Â°C â†’ offset: -2.3Â°C; Weight: 0.18; Deferred: Significant debt (DM -307)[0m
[36m2025-10-27 23:25:32.968 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Price classification Q93 (23:25): 70.33 â†’ NORMAL[0m
[32m2025-10-27 23:25:32.968 INFO (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.54Â°C - Learned pre-heat: Pre-heating: predicted drop 2.2Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.5Â°C; Safety: +0.5Â°C; Adjusted: 27.0Â°C; Current: 30.5Â°C â†’ offset: -2.3Â°C; Weight: 0.18; Deferred: Significant debt (DM -307) | GE-Spot Q93: NORMAL (night) | Too warm: 2.0Â°C over[0m
[32m2025-10-27 23:25:32.969 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.54Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 2.2Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.5Â°C; Safety: +0.5Â°C; Adjusted: 27.0Â°C; Current: 30.5Â°C â†’ offset: -2.3Â°C; Weight: 0.18; Deferred: Significant debt (DM -307) | GE-Spot Q93: NORMAL (night) | Too warm: 2.0Â°C over[0m
[36m2025-10-27 23:25:32.970 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.54Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-27 23:25:32.970 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.709 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 23:25:32.970 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.0Â°C, outdoor=6.2Â°C, offset=0.5Â°C, change=0.01Â°C, Î”t=0.08h[0m
[36m2025-10-27 23:25:32.970 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.0Â°C, outdoor=6.2Â°C, offset=0.5Â°C, flow=30.5Â°C, DM=-307[0m
[36m2025-10-27 23:25:32.973 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.1Â°C/h trend[0m
[36m2025-10-27 23:25:32.973 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 23:25:32.975 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 23:25:32.975 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 23:25:32.975 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=37.1[0m
[36m2025-10-27 23:25:32.975 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-27 23:25:32.981 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 23:25:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-27 23:25:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 6.2Â°C (zone: Moderate Cold): block=-356, abort=-436[0m
[36m2025-10-27 23:25:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 28 quarters available, need 3 quarters (45 min), lookahead 7.0h[0m
[36m2025-10-27 23:25:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 26 windows evaluated[0m
[36m2025-10-27 23:25:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (4.3h away) â† SELECTED[0m
[36m2025-10-27 23:25:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (4.1h away)[0m
[36m2025-10-27 23:25:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (4.6h away)[0m
[36m2025-10-27 23:25:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (3.8h away)[0m
[36m2025-10-27 23:25:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (3.6h away)[0m
[32m2025-10-27 23:25:32.982 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 4.3h away[0m
[36m2025-10-27 23:25:32.985 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 23:25:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-27 23:25:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 6.2Â°C (zone: Moderate Cold): block=-356, abort=-436[0m
[36m2025-10-27 23:25:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 28 quarters available, need 3 quarters (45 min), lookahead 7.0h[0m
[36m2025-10-27 23:25:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 26 windows evaluated[0m
[36m2025-10-27 23:25:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (4.3h away) â† SELECTED[0m
[36m2025-10-27 23:25:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (4.1h away)[0m
[36m2025-10-27 23:25:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (4.6h away)[0m
[36m2025-10-27 23:25:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (3.8h away)[0m
[36m2025-10-27 23:25:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (3.6h away)[0m
[32m2025-10-27 23:25:32.986 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 4.3h away[0m
[36m2025-10-27 23:25:32.986 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-27 23:25:32.986 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.027 seconds (success: True)[0m
[36m2025-10-27 23:25:32.987 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (6.5 + 0.6 + 0.9)A Ã— 0.95 = 1.82 kW[0m
[36m2025-10-27 23:25:32.988 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 23:30:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 23:30:32.960 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.0Â°C (median of 9 sensors: 23.6Â°C, 21.3Â°C, 21.6Â°C, 23.0Â°C, 25.0Â°C, 23.7Â°C, 22.5Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-27 23:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -306.0[0m
[36m2025-10-27 23:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 37.1Â°C[0m
[36m2025-10-27 23:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.5Â°C[0m
[36m2025-10-27 23:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=6.8A, L2=0.6A, L3=0.9A[0m
[36m2025-10-27 23:30:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.0Â°C, outdoor 6.2Â°C, flow 30.5Â°C, DM -306[0m
[36m2025-10-27 23:30:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 36 Hz (1h avg: 37, 6h avg: 53, mode: space) - OK: Normal operation (36 Hz, 6h avg: 53 Hz)[0m
[36m2025-10-27 23:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 23:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 23:30:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 23:30:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 23:30:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 23:30:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 23:30:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 23:30:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 23:30:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 23:30:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 23:30:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 97}[0m
[36m2025-10-27 23:30:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 23:30:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 23:30:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 23:30:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 23:30:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 23:30:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 23:30:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 23:30:32.961 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 23:30:32.961 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q94 = 52.79 Ã¶re/kWh[0m
[36m2025-10-27 23:30:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 23:30:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 23:30:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 23:30:32.963 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 23:30:32.963 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 23:30:32.963 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-27 23:30:32.963 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 23:30:32.964 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 23:30:32.964 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 23:30:32.964 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 23:30:32.964 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-27 23:30:32.964 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 6.2Â°C: normal -156 to -356, warning -356[0m
[36m2025-10-27 23:30:32.964 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-27 23:30:32.965 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -356 (base: -356), critical -1500[0m
[36m2025-10-27 23:30:32.965 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=6.2Â°C, indoor_target=21.0Â°C, temp_diff=14.8Â°C, HC=0.180 kW/K -> flow=26.5Â°C[0m
[36m2025-10-27 23:30:32.965 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 23:30:32.965 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 23:30:32.965 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=27.0Â°C, current=30.5Â°C, error=-3.5Â°C, sensitivity=1.5 -> offset=-2.3[0m
[36m2025-10-27 23:30:32.965 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=6.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 23:30:32.965 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.5Â°C; Safety: +0.5Â°C; Adjusted: 27.0Â°C; Current: 30.5Â°C â†’ offset: -2.3Â°C; Weight: 0.18; Deferred: Significant debt (DM -306)[0m
[36m2025-10-27 23:30:32.965 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Price classification Q94 (23:30): 52.79 â†’ NORMAL[0m
[32m2025-10-27 23:30:32.966 INFO (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.54Â°C - Learned pre-heat: Pre-heating: predicted drop 2.2Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.5Â°C; Safety: +0.5Â°C; Adjusted: 27.0Â°C; Current: 30.5Â°C â†’ offset: -2.3Â°C; Weight: 0.18; Deferred: Significant debt (DM -306) | GE-Spot Q94: NORMAL (night) | Too warm: 2.0Â°C over[0m
[32m2025-10-27 23:30:32.966 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.54Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 2.2Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.5Â°C; Safety: +0.5Â°C; Adjusted: 27.0Â°C; Current: 30.5Â°C â†’ offset: -2.3Â°C; Weight: 0.18; Deferred: Significant debt (DM -306) | GE-Spot Q94: NORMAL (night) | Too warm: 2.0Â°C over[0m
[36m2025-10-27 23:30:32.966 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.54Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-27 23:30:32.966 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.693 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 23:30:32.966 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.0Â°C, outdoor=6.2Â°C, offset=0.5Â°C, change=0.03Â°C, Î”t=0.08h[0m
[36m2025-10-27 23:30:32.967 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.0Â°C, outdoor=6.2Â°C, offset=0.5Â°C, flow=30.5Â°C, DM=-306[0m
[36m2025-10-27 23:30:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-27 23:30:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 23:30:32.969 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 23:30:32.969 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 23:30:32.969 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=37.1[0m
[36m2025-10-27 23:30:32.969 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-27 23:30:32.976 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 23:30:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-27 23:30:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 6.2Â°C (zone: Moderate Cold): block=-356, abort=-436[0m
[36m2025-10-27 23:30:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 28 quarters available, need 3 quarters (45 min), lookahead 7.0h[0m
[36m2025-10-27 23:30:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 26 windows evaluated[0m
[36m2025-10-27 23:30:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (4.2h away) â† SELECTED[0m
[36m2025-10-27 23:30:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (4.0h away)[0m
[36m2025-10-27 23:30:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (4.5h away)[0m
[36m2025-10-27 23:30:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (3.7h away)[0m
[36m2025-10-27 23:30:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (3.5h away)[0m
[32m2025-10-27 23:30:32.977 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 4.2h away[0m
[36m2025-10-27 23:30:32.979 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 23:30:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-27 23:30:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 6.2Â°C (zone: Moderate Cold): block=-356, abort=-436[0m
[36m2025-10-27 23:30:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 28 quarters available, need 3 quarters (45 min), lookahead 7.0h[0m
[36m2025-10-27 23:30:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 26 windows evaluated[0m
[36m2025-10-27 23:30:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (4.2h away) â† SELECTED[0m
[36m2025-10-27 23:30:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (4.0h away)[0m
[36m2025-10-27 23:30:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (4.5h away)[0m
[36m2025-10-27 23:30:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (3.7h away)[0m
[36m2025-10-27 23:30:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (3.5h away)[0m
[32m2025-10-27 23:30:32.980 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 4.2h away[0m
[36m2025-10-27 23:30:32.980 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-27 23:30:32.980 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.020 seconds (success: True)[0m
[36m2025-10-27 23:30:32.981 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (6.8 + 0.6 + 0.9)A Ã— 0.95 = 1.89 kW[0m
[36m2025-10-27 23:30:32.982 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 23:35:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 23:35:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.1Â°C (median of 9 sensors: 23.6Â°C, 21.3Â°C, 21.5Â°C, 23.1Â°C, 25.0Â°C, 23.7Â°C, 22.5Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-27 23:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -304.0[0m
[36m2025-10-27 23:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 37.1Â°C[0m
[36m2025-10-27 23:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.5Â°C[0m
[36m2025-10-27 23:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=6.8A, L2=0.6A, L3=0.9A[0m
[36m2025-10-27 23:35:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.1Â°C, outdoor 5.7Â°C, flow 30.5Â°C, DM -304[0m
[36m2025-10-27 23:35:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 35 Hz (1h avg: 37, 6h avg: 53, mode: space) - OK: Normal operation (35 Hz, 6h avg: 53 Hz)[0m
[36m2025-10-27 23:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 23:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 23:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 23:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 23:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 23:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 23:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 23:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 23:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 23:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 23:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 97}[0m
[36m2025-10-27 23:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 23:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 23:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 23:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 23:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 23:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 23:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 23:35:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 23:35:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q94 = 52.79 Ã¶re/kWh[0m
[36m2025-10-27 23:35:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 23:35:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 23:35:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 23:35:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 23:35:32.962 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 23:35:32.962 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-27 23:35:32.963 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 23:35:32.964 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 23:35:32.964 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 23:35:32.964 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 23:35:32.964 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 5.7Â°C (zone avg: -1.0Â°C, delta: 6.7Â°C): normal -166 to -366, warning -366, critical -1500[0m
[36m2025-10-27 23:35:32.965 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 5.7Â°C: normal -166 to -366, warning -366[0m
[36m2025-10-27 23:35:32.965 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 5.7Â°C (zone avg: -1.0Â°C, delta: 6.7Â°C): normal -166 to -366, warning -366, critical -1500[0m
[36m2025-10-27 23:35:32.965 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -366 (base: -366), critical -1500[0m
[36m2025-10-27 23:35:32.965 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=5.7Â°C, indoor_target=21.0Â°C, temp_diff=15.3Â°C, HC=0.180 kW/K -> flow=26.6Â°C[0m
[36m2025-10-27 23:35:32.965 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 23:35:32.965 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 23:35:32.965 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=27.1Â°C, current=30.5Â°C, error=-3.4Â°C, sensitivity=1.5 -> offset=-2.3[0m
[36m2025-10-27 23:35:32.965 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=5.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 23:35:32.965 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.6Â°C; Safety: +0.5Â°C; Adjusted: 27.1Â°C; Current: 30.5Â°C â†’ offset: -2.3Â°C; Weight: 0.18; Deferred: Significant debt (DM -304)[0m
[36m2025-10-27 23:35:32.965 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Price classification Q94 (23:35): 52.79 â†’ NORMAL[0m
[32m2025-10-27 23:35:32.966 INFO (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.54Â°C - Learned pre-heat: Pre-heating: predicted drop 2.1Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.6Â°C; Safety: +0.5Â°C; Adjusted: 27.1Â°C; Current: 30.5Â°C â†’ offset: -2.3Â°C; Weight: 0.18; Deferred: Significant debt (DM -304) | GE-Spot Q94: NORMAL (night) | Too warm: 2.1Â°C over[0m
[32m2025-10-27 23:35:32.967 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.54Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 2.1Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.6Â°C; Safety: +0.5Â°C; Adjusted: 27.1Â°C; Current: 30.5Â°C â†’ offset: -2.3Â°C; Weight: 0.18; Deferred: Significant debt (DM -304) | GE-Spot Q94: NORMAL (night) | Too warm: 2.1Â°C over[0m
[36m2025-10-27 23:35:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.54Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-27 23:35:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.682 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 23:35:32.967 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.1Â°C, outdoor=5.7Â°C, offset=0.5Â°C, change=0.04Â°C, Î”t=0.08h[0m
[36m2025-10-27 23:35:32.967 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.1Â°C, outdoor=5.7Â°C, offset=0.5Â°C, flow=30.5Â°C, DM=-304[0m
[36m2025-10-27 23:35:32.971 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.2Â°C/h trend[0m
[36m2025-10-27 23:35:32.971 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 23:35:32.973 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 23:35:32.973 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 23:35:32.973 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=37.1[0m
[36m2025-10-27 23:35:32.973 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 5.7Â°C (zone avg: -1.0Â°C, delta: 6.7Â°C): normal -166 to -366, warning -366, critical -1500[0m
[36m2025-10-27 23:35:32.979 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 23:35:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 5.7Â°C (zone avg: -1.0Â°C, delta: 6.7Â°C): normal -166 to -366, warning -366, critical -1500[0m
[36m2025-10-27 23:35:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 5.7Â°C (zone: Moderate Cold): block=-366, abort=-446[0m
[36m2025-10-27 23:35:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 28 quarters available, need 3 quarters (45 min), lookahead 7.0h[0m
[36m2025-10-27 23:35:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 26 windows evaluated[0m
[36m2025-10-27 23:35:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (4.2h away) â† SELECTED[0m
[36m2025-10-27 23:35:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (3.9h away)[0m
[36m2025-10-27 23:35:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (4.4h away)[0m
[36m2025-10-27 23:35:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (3.7h away)[0m
[36m2025-10-27 23:35:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (3.4h away)[0m
[32m2025-10-27 23:35:32.980 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 4.2h away[0m
[36m2025-10-27 23:35:32.986 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 23:35:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 5.7Â°C (zone avg: -1.0Â°C, delta: 6.7Â°C): normal -166 to -366, warning -366, critical -1500[0m
[36m2025-10-27 23:35:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 5.7Â°C (zone: Moderate Cold): block=-366, abort=-446[0m
[36m2025-10-27 23:35:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 28 quarters available, need 3 quarters (45 min), lookahead 7.0h[0m
[36m2025-10-27 23:35:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 26 windows evaluated[0m
[36m2025-10-27 23:35:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (4.2h away) â† SELECTED[0m
[36m2025-10-27 23:35:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (3.9h away)[0m
[36m2025-10-27 23:35:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (4.4h away)[0m
[36m2025-10-27 23:35:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (3.7h away)[0m
[36m2025-10-27 23:35:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (3.4h away)[0m
[32m2025-10-27 23:35:32.987 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 4.2h away[0m
[36m2025-10-27 23:35:32.987 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-27 23:35:32.987 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.028 seconds (success: True)[0m
[36m2025-10-27 23:35:32.989 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (6.8 + 0.6 + 0.9)A Ã— 0.95 = 1.89 kW[0m
[36m2025-10-27 23:35:32.989 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 23:40:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 23:40:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.1Â°C (median of 9 sensors: 23.6Â°C, 21.3Â°C, 21.6Â°C, 23.1Â°C, 25.0Â°C, 23.7Â°C, 22.5Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-27 23:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -302.0[0m
[36m2025-10-27 23:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 37.1Â°C[0m
[36m2025-10-27 23:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.5Â°C[0m
[36m2025-10-27 23:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=6.8A, L2=0.6A, L3=0.9A[0m
[36m2025-10-27 23:40:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.1Â°C, outdoor 5.7Â°C, flow 30.5Â°C, DM -302[0m
[36m2025-10-27 23:40:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 35 Hz (1h avg: 36, 6h avg: 53, mode: space) - OK: Normal operation (35 Hz, 6h avg: 53 Hz)[0m
[36m2025-10-27 23:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 23:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 23:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 23:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 23:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 23:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 23:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 23:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 23:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 23:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 23:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 97}[0m
[36m2025-10-27 23:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 23:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 23:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 23:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 23:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 23:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 23:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 23:40:32.961 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 23:40:32.961 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q94 = 52.79 Ã¶re/kWh[0m
[36m2025-10-27 23:40:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 23:40:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 23:40:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 23:40:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 23:40:32.962 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 23:40:32.962 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-27 23:40:32.962 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 23:40:32.963 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 23:40:32.966 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 23:40:32.966 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 23:40:32.966 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.climate_zones] DM range for 5.7Â°C (zone avg: -1.0Â°C, delta: 6.7Â°C): normal -166 to -366, warning -366, critical -1500[0m
[36m2025-10-27 23:40:32.966 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 5.7Â°C: normal -166 to -366, warning -366[0m
[36m2025-10-27 23:40:32.966 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.climate_zones] DM range for 5.7Â°C (zone avg: -1.0Â°C, delta: 6.7Â°C): normal -166 to -366, warning -366, critical -1500[0m
[36m2025-10-27 23:40:32.966 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -366 (base: -366), critical -1500[0m
[36m2025-10-27 23:40:32.966 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=5.7Â°C, indoor_target=21.0Â°C, temp_diff=15.3Â°C, HC=0.180 kW/K -> flow=26.6Â°C[0m
[36m2025-10-27 23:40:32.966 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 23:40:32.966 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 23:40:32.966 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=27.1Â°C, current=30.5Â°C, error=-3.4Â°C, sensitivity=1.5 -> offset=-2.3[0m
[36m2025-10-27 23:40:32.966 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=5.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 23:40:32.966 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.6Â°C; Safety: +0.5Â°C; Adjusted: 27.1Â°C; Current: 30.5Â°C â†’ offset: -2.3Â°C; Weight: 0.18; Deferred: Significant debt (DM -302)[0m
[36m2025-10-27 23:40:32.967 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Price classification Q94 (23:40): 52.79 â†’ NORMAL[0m
[32m2025-10-27 23:40:32.967 INFO (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.54Â°C - Learned pre-heat: Pre-heating: predicted drop 2.0Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.6Â°C; Safety: +0.5Â°C; Adjusted: 27.1Â°C; Current: 30.5Â°C â†’ offset: -2.3Â°C; Weight: 0.18; Deferred: Significant debt (DM -302) | GE-Spot Q94: NORMAL (night) | Too warm: 2.1Â°C over[0m
[32m2025-10-27 23:40:32.967 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.54Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 2.0Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.6Â°C; Safety: +0.5Â°C; Adjusted: 27.1Â°C; Current: 30.5Â°C â†’ offset: -2.3Â°C; Weight: 0.18; Deferred: Significant debt (DM -302) | GE-Spot Q94: NORMAL (night) | Too warm: 2.1Â°C over[0m
[36m2025-10-27 23:40:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.54Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-27 23:40:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.538 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 23:40:32.967 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.1Â°C, outdoor=5.7Â°C, offset=0.5Â°C, change=-0.02Â°C, Î”t=0.08h[0m
[36m2025-10-27 23:40:32.967 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.1Â°C, outdoor=5.7Â°C, offset=0.5Â°C, flow=30.5Â°C, DM=-302[0m
[36m2025-10-27 23:40:32.971 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.1Â°C/h trend[0m
[36m2025-10-27 23:40:32.971 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 23:40:32.973 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 23:40:32.973 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 23:40:32.973 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=37.1[0m
[36m2025-10-27 23:40:32.973 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 5.7Â°C (zone avg: -1.0Â°C, delta: 6.7Â°C): normal -166 to -366, warning -366, critical -1500[0m
[36m2025-10-27 23:40:32.982 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 23:40:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 5.7Â°C (zone avg: -1.0Â°C, delta: 6.7Â°C): normal -166 to -366, warning -366, critical -1500[0m
[36m2025-10-27 23:40:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 5.7Â°C (zone: Moderate Cold): block=-366, abort=-446[0m
[36m2025-10-27 23:40:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 28 quarters available, need 3 quarters (45 min), lookahead 7.0h[0m
[36m2025-10-27 23:40:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 26 windows evaluated[0m
[36m2025-10-27 23:40:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (4.1h away) â† SELECTED[0m
[36m2025-10-27 23:40:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (3.8h away)[0m
[36m2025-10-27 23:40:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (4.3h away)[0m
[36m2025-10-27 23:40:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (3.6h away)[0m
[36m2025-10-27 23:40:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (3.3h away)[0m
[32m2025-10-27 23:40:32.983 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 4.1h away[0m
[36m2025-10-27 23:40:32.985 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 23:40:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 5.7Â°C (zone avg: -1.0Â°C, delta: 6.7Â°C): normal -166 to -366, warning -366, critical -1500[0m
[36m2025-10-27 23:40:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 5.7Â°C (zone: Moderate Cold): block=-366, abort=-446[0m
[36m2025-10-27 23:40:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 28 quarters available, need 3 quarters (45 min), lookahead 7.0h[0m
[36m2025-10-27 23:40:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 26 windows evaluated[0m
[36m2025-10-27 23:40:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (4.1h away) â† SELECTED[0m
[36m2025-10-27 23:40:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (3.8h away)[0m
[36m2025-10-27 23:40:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (4.3h away)[0m
[36m2025-10-27 23:40:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (3.6h away)[0m
[36m2025-10-27 23:40:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (3.3h away)[0m
[32m2025-10-27 23:40:32.986 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 4.1h away[0m
[36m2025-10-27 23:40:32.986 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-27 23:40:32.986 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.027 seconds (success: True)[0m
[36m2025-10-27 23:40:32.987 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (6.8 + 0.6 + 0.9)A Ã— 0.95 = 1.89 kW[0m
[36m2025-10-27 23:40:32.988 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 23:45:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 23:45:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.0Â°C (median of 9 sensors: 23.6Â°C, 21.3Â°C, 21.6Â°C, 23.0Â°C, 25.0Â°C, 23.8Â°C, 22.5Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-27 23:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -300.0[0m
[36m2025-10-27 23:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 37.1Â°C[0m
[36m2025-10-27 23:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.5Â°C[0m
[36m2025-10-27 23:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=6.8A, L2=0.6A, L3=0.9A[0m
[36m2025-10-27 23:45:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.0Â°C, outdoor 5.7Â°C, flow 30.5Â°C, DM -300[0m
[36m2025-10-27 23:45:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 34 Hz (1h avg: 36, 6h avg: 52, mode: space) - OK: Normal operation (34 Hz, 6h avg: 52 Hz)[0m
[36m2025-10-27 23:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 23:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 23:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 23:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 23:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 23:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 23:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 23:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 23:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 23:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 23:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 96}[0m
[36m2025-10-27 23:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 23:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 23:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 23:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 23:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 23:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 23:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 23:45:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 23:45:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q95 = 41.89 Ã¶re/kWh[0m
[36m2025-10-27 23:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 23:45:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 23:45:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 23:45:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 23:45:32.962 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 23:45:32.962 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 7.2Â°C, 48 hours forecast[0m
[36m2025-10-27 23:45:32.962 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 23:45:32.963 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 23:45:32.964 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 23:45:32.964 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 23:45:32.964 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.climate_zones] DM range for 5.7Â°C (zone avg: -1.0Â°C, delta: 6.7Â°C): normal -166 to -366, warning -366, critical -1500[0m
[36m2025-10-27 23:45:32.964 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 5.7Â°C: normal -166 to -366, warning -366[0m
[36m2025-10-27 23:45:32.964 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.climate_zones] DM range for 5.7Â°C (zone avg: -1.0Â°C, delta: 6.7Â°C): normal -166 to -366, warning -366, critical -1500[0m
[36m2025-10-27 23:45:32.964 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -366 (base: -366), critical -1500[0m
[36m2025-10-27 23:45:32.964 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=5.7Â°C, indoor_target=21.0Â°C, temp_diff=15.3Â°C, HC=0.180 kW/K -> flow=26.6Â°C[0m
[36m2025-10-27 23:45:32.964 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 23:45:32.964 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 23:45:32.964 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=27.1Â°C, current=30.5Â°C, error=-3.4Â°C, sensitivity=1.5 -> offset=-2.3[0m
[36m2025-10-27 23:45:32.964 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=5.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 23:45:32.964 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.6Â°C; Safety: +0.5Â°C; Adjusted: 27.1Â°C; Current: 30.5Â°C â†’ offset: -2.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -300)[0m
[36m2025-10-27 23:45:32.965 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Price classification Q95 (23:45): 41.89 â†’ NORMAL[0m
[32m2025-10-27 23:45:32.965 INFO (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.51Â°C - Learned pre-heat: Pre-heating: predicted drop 2.2Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.6Â°C; Safety: +0.5Â°C; Adjusted: 27.1Â°C; Current: 30.5Â°C â†’ offset: -2.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -300) | GE-Spot Q95: NORMAL (night) | Too warm: 2.0Â°C over[0m
[32m2025-10-27 23:45:32.965 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.51Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 2.2Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.6Â°C; Safety: +0.5Â°C; Adjusted: 27.1Â°C; Current: 30.5Â°C â†’ offset: -2.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -300) | GE-Spot Q95: NORMAL (night) | Too warm: 2.0Â°C over[0m
[36m2025-10-27 23:45:32.965 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.51Â°C, integer=0Â°C, fractional=0.51Â°C, accumulator_before=0.04Â°C[0m
[36m2025-10-27 23:45:32.965 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: 0.55Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-27 23:45:32.965 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.51Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-27 23:45:32.965 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.540 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 23:45:32.965 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.0Â°C, outdoor=5.7Â°C, offset=0.5Â°C, change=-0.02Â°C, Î”t=0.08h[0m
[36m2025-10-27 23:45:32.965 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.0Â°C, outdoor=5.7Â°C, offset=0.5Â°C, flow=30.5Â°C, DM=-300[0m
[36m2025-10-27 23:45:32.965 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-27 23:45:32.965 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 23:45:32.973 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved learned data to storage[0m
[36m2025-10-27 23:45:32.973 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 23:45:32.973 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 23:45:32.973 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=37.1[0m
[36m2025-10-27 23:45:32.973 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 5.7Â°C (zone avg: -1.0Â°C, delta: 6.7Â°C): normal -166 to -366, warning -366, critical -1500[0m
[36m2025-10-27 23:45:32.976 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 23:45:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 5.7Â°C (zone avg: -1.0Â°C, delta: 6.7Â°C): normal -166 to -366, warning -366, critical -1500[0m
[36m2025-10-27 23:45:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 5.7Â°C (zone: Moderate Cold): block=-366, abort=-446[0m
[36m2025-10-27 23:45:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 28 quarters available, need 3 quarters (45 min), lookahead 7.0h[0m
[36m2025-10-27 23:45:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 26 windows evaluated[0m
[36m2025-10-27 23:45:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (4.0h away) â† SELECTED[0m
[36m2025-10-27 23:45:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (3.7h away)[0m
[36m2025-10-27 23:45:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (4.2h away)[0m
[36m2025-10-27 23:45:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (3.5h away)[0m
[36m2025-10-27 23:45:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (3.2h away)[0m
[32m2025-10-27 23:45:32.977 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 4.0h away[0m
[36m2025-10-27 23:45:32.980 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 23:45:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 5.7Â°C (zone avg: -1.0Â°C, delta: 6.7Â°C): normal -166 to -366, warning -366, critical -1500[0m
[36m2025-10-27 23:45:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 5.7Â°C (zone: Moderate Cold): block=-366, abort=-446[0m
[36m2025-10-27 23:45:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 28 quarters available, need 3 quarters (45 min), lookahead 7.0h[0m
[36m2025-10-27 23:45:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 26 windows evaluated[0m
[36m2025-10-27 23:45:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (4.0h away) â† SELECTED[0m
[36m2025-10-27 23:45:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (3.7h away)[0m
[36m2025-10-27 23:45:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (4.2h away)[0m
[36m2025-10-27 23:45:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (3.5h away)[0m
[36m2025-10-27 23:45:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (3.2h away)[0m
[32m2025-10-27 23:45:32.981 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 4.0h away[0m
[36m2025-10-27 23:45:32.981 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-27 23:45:32.981 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.022 seconds (success: True)[0m
[36m2025-10-27 23:45:32.983 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (6.8 + 0.6 + 0.9)A Ã— 0.95 = 1.89 kW[0m
[36m2025-10-27 23:45:32.983 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 23:50:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 23:50:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.1Â°C (median of 9 sensors: 23.6Â°C, 21.2Â°C, 21.5Â°C, 23.1Â°C, 25.0Â°C, 23.8Â°C, 22.3Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-27 23:50:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -302.0[0m
[36m2025-10-27 23:50:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 37.1Â°C[0m
[36m2025-10-27 23:50:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.0Â°C[0m
[36m2025-10-27 23:50:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=6.8A, L2=0.6A, L3=0.9A[0m
[36m2025-10-27 23:50:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.1Â°C, outdoor 5.7Â°C, flow 30.0Â°C, DM -302[0m
[36m2025-10-27 23:50:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 36 Hz (1h avg: 36, 6h avg: 52, mode: space) - OK: Normal operation (36 Hz, 6h avg: 52 Hz)[0m
[36m2025-10-27 23:50:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 23:50:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 23:50:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 23:50:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 23:50:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 23:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 23:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 23:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 23:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 23:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 23:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 96}[0m
[36m2025-10-27 23:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 23:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 23:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 23:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 23:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 23:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 23:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 23:50:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 23:50:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q95 = 41.89 Ã¶re/kWh[0m
[36m2025-10-27 23:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 23:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 23:50:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 23:50:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 23:50:32.962 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 23:50:32.962 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 7.2Â°C, 48 hours forecast[0m
[36m2025-10-27 23:50:32.962 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 23:50:32.963 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 23:50:32.964 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 23:50:32.964 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 23:50:32.965 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 5.7Â°C (zone avg: -1.0Â°C, delta: 6.7Â°C): normal -166 to -366, warning -366, critical -1500[0m
[36m2025-10-27 23:50:32.965 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 5.7Â°C: normal -166 to -366, warning -366[0m
[36m2025-10-27 23:50:32.965 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 5.7Â°C (zone avg: -1.0Â°C, delta: 6.7Â°C): normal -166 to -366, warning -366, critical -1500[0m
[36m2025-10-27 23:50:32.965 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -366 (base: -366), critical -1500[0m
[36m2025-10-27 23:50:32.965 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=5.7Â°C, indoor_target=21.0Â°C, temp_diff=15.3Â°C, HC=0.180 kW/K -> flow=26.6Â°C[0m
[36m2025-10-27 23:50:32.965 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 23:50:32.965 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 23:50:32.965 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=27.1Â°C, current=30.0Â°C, error=-2.9Â°C, sensitivity=1.5 -> offset=-1.9[0m
[36m2025-10-27 23:50:32.965 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=5.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 23:50:32.965 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.6Â°C; Safety: +0.5Â°C; Adjusted: 27.1Â°C; Current: 30.0Â°C â†’ offset: -1.9Â°C; Weight: 0.18; Deferred: Significant debt (DM -302)[0m
[36m2025-10-27 23:50:32.965 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Price classification Q95 (23:50): 41.89 â†’ NORMAL[0m
[32m2025-10-27 23:50:32.966 INFO (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.57Â°C - Learned pre-heat: Pre-heating: predicted drop 2.2Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.6Â°C; Safety: +0.5Â°C; Adjusted: 27.1Â°C; Current: 30.0Â°C â†’ offset: -1.9Â°C; Weight: 0.18; Deferred: Significant debt (DM -302) | GE-Spot Q95: NORMAL (night) | Too warm: 2.1Â°C over[0m
[32m2025-10-27 23:50:32.966 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.57Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 2.2Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.6Â°C; Safety: +0.5Â°C; Adjusted: 27.1Â°C; Current: 30.0Â°C â†’ offset: -1.9Â°C; Weight: 0.18; Deferred: Significant debt (DM -302) | GE-Spot Q95: NORMAL (night) | Too warm: 2.1Â°C over[0m
[36m2025-10-27 23:50:32.967 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.57Â°C, integer=0Â°C, fractional=0.57Â°C, accumulator_before=0.55Â°C[0m
[32m2025-10-27 23:50:32.967 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] âœ“ Accumulated fractional offset reached threshold: applying +1Â°C adjustment (accumulator: 1.12Â°C â†’ 0.12Â°C)[0m
[36m2025-10-27 23:50:32.967 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Accumulator triggered: total_accumulated=1.12Â°C, adjustment=+1Â°C, new_integer=1Â°C, remaining=0.12Â°C[0m
[36m2025-10-27 23:50:32.967 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset 0.57Â°C â†’ applying 1Â°C (accumulator: 0.12Â°C, needs 0.88Â°C more to trigger)[0m
[32m2025-10-27 23:50:32.968 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to 1Â°C (calculated: 0.57Â°C, accumulator: 0.12Â°C)[0m
[36m2025-10-27 23:50:32.968 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=1Â°C, original=0.57Â°C, accumulator=0.12Â°C[0m
[32m2025-10-27 23:50:32.968 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset 0.57Â°C to NIBE via MyUplink[0m
[36m2025-10-27 23:50:32.968 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.563 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 23:50:32.968 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.1Â°C, outdoor=5.7Â°C, offset=0.6Â°C, change=0.06Â°C, Î”t=0.08h[0m
[36m2025-10-27 23:50:32.968 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.1Â°C, outdoor=5.7Â°C, offset=0.6Â°C, flow=30.0Â°C, DM=-302[0m
[36m2025-10-27 23:50:32.977 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.2Â°C/h trend[0m
[36m2025-10-27 23:50:32.977 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 23:50:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 23:50:32.978 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 23:50:32.978 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=37.1[0m
[36m2025-10-27 23:50:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 5.7Â°C (zone avg: -1.0Â°C, delta: 6.7Â°C): normal -166 to -366, warning -366, critical -1500[0m
[36m2025-10-27 23:50:32.983 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 23:50:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 5.7Â°C (zone avg: -1.0Â°C, delta: 6.7Â°C): normal -166 to -366, warning -366, critical -1500[0m
[36m2025-10-27 23:50:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 5.7Â°C (zone: Moderate Cold): block=-366, abort=-446[0m
[36m2025-10-27 23:50:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 28 quarters available, need 3 quarters (45 min), lookahead 7.0h[0m
[36m2025-10-27 23:50:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 26 windows evaluated[0m
[36m2025-10-27 23:50:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (3.9h away) â† SELECTED[0m
[36m2025-10-27 23:50:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (3.7h away)[0m
[36m2025-10-27 23:50:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (4.2h away)[0m
[36m2025-10-27 23:50:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (3.4h away)[0m
[36m2025-10-27 23:50:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (3.2h away)[0m
[32m2025-10-27 23:50:32.983 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 3.9h away[0m
[36m2025-10-27 23:50:32.992 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 23:50:32.992 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 5.7Â°C (zone avg: -1.0Â°C, delta: 6.7Â°C): normal -166 to -366, warning -366, critical -1500[0m
[36m2025-10-27 23:50:32.992 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 5.7Â°C (zone: Moderate Cold): block=-366, abort=-446[0m
[36m2025-10-27 23:50:32.992 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 28 quarters available, need 3 quarters (45 min), lookahead 7.0h[0m
[36m2025-10-27 23:50:32.992 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 26 windows evaluated[0m
[36m2025-10-27 23:50:32.992 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (3.9h away) â† SELECTED[0m
[36m2025-10-27 23:50:32.992 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (3.7h away)[0m
[36m2025-10-27 23:50:32.992 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (4.2h away)[0m
[36m2025-10-27 23:50:32.992 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (3.4h away)[0m
[36m2025-10-27 23:50:32.992 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (3.2h away)[0m
[32m2025-10-27 23:50:32.992 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 3.9h away[0m
[36m2025-10-27 23:50:32.993 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-27 23:50:32.993 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.034 seconds (success: True)[0m
[36m2025-10-27 23:50:32.994 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (6.8 + 0.6 + 0.9)A Ã— 0.95 = 1.89 kW[0m
[36m2025-10-27 23:50:32.994 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-27 23:55:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-27 23:55:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.1Â°C (median of 9 sensors: 23.6Â°C, 21.2Â°C, 21.5Â°C, 23.1Â°C, 25.0Â°C, 23.8Â°C, 22.3Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-27 23:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -304.0[0m
[36m2025-10-27 23:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 37.1Â°C[0m
[36m2025-10-27 23:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.0Â°C[0m
[36m2025-10-27 23:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=6.8A, L2=0.6A, L3=0.9A[0m
[36m2025-10-27 23:55:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.1Â°C, outdoor 5.7Â°C, flow 30.0Â°C, DM -304[0m
[36m2025-10-27 23:55:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 38 Hz (1h avg: 36, 6h avg: 52, mode: space) - OK: Normal operation (38 Hz, 6h avg: 52 Hz)[0m
[36m2025-10-27 23:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-27 23:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-27 23:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-27 23:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-27 23:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-27 23:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-27 23:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-27 23:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-27 23:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-27 23:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-27 23:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 192, 'today_intervals': 96, 'tomorrow_intervals': 96, 'has_current_interval': True, 'intervals_remaining': 96}[0m
[36m2025-10-27 23:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-27 23:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 96 items[0m
[36m2025-10-27 23:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: True[0m
[36m2025-10-27 23:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-27 23:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-27 23:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-27 23:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-27 23:55:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today, 96 tomorrow (extended optimization available) in Ã¶re/kWh[0m
[36m2025-10-27 23:55:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q95 = 41.89 Ã¶re/kWh[0m
[36m2025-10-27 23:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-27 23:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-27 23:55:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-27 23:55:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-27 23:55:32.962 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-27 23:55:32.962 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 7.2Â°C, 48 hours forecast[0m
[36m2025-10-27 23:55:32.962 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-27 23:55:32.968 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 23.872, P50: 89.565, P75: 108.528, P90: 125.461[0m
[36m2025-10-27 23:55:32.968 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-27 23:55:32.968 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-27 23:55:32.968 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 5.7Â°C (zone avg: -1.0Â°C, delta: 6.7Â°C): normal -166 to -366, warning -366, critical -1500[0m
[36m2025-10-27 23:55:32.969 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 5.7Â°C: normal -166 to -366, warning -366[0m
[36m2025-10-27 23:55:32.969 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 5.7Â°C (zone avg: -1.0Â°C, delta: 6.7Â°C): normal -166 to -366, warning -366, critical -1500[0m
[36m2025-10-27 23:55:32.969 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -366 (base: -366), critical -1500[0m
[36m2025-10-27 23:55:32.969 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=5.7Â°C, indoor_target=21.0Â°C, temp_diff=15.3Â°C, HC=0.180 kW/K -> flow=26.6Â°C[0m
[36m2025-10-27 23:55:32.969 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-27 23:55:32.969 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-27 23:55:32.969 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=27.1Â°C, current=30.0Â°C, error=-2.9Â°C, sensitivity=1.5 -> offset=-1.9[0m
[36m2025-10-27 23:55:32.969 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=5.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-27 23:55:32.969 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.6Â°C; Safety: +0.5Â°C; Adjusted: 27.1Â°C; Current: 30.0Â°C â†’ offset: -1.9Â°C; Weight: 0.18; Deferred: Significant debt (DM -304)[0m
[36m2025-10-27 23:55:32.969 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Price classification Q95 (23:55): 41.89 â†’ NORMAL[0m
[32m2025-10-27 23:55:32.969 INFO (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.57Â°C - Learned pre-heat: Pre-heating: predicted drop 2.2Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.6Â°C; Safety: +0.5Â°C; Adjusted: 27.1Â°C; Current: 30.0Â°C â†’ offset: -1.9Â°C; Weight: 0.18; Deferred: Significant debt (DM -304) | GE-Spot Q95: NORMAL (night) | Too warm: 2.1Â°C over[0m
[32m2025-10-27 23:55:32.971 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.57Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 2.2Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.6Â°C; Safety: +0.5Â°C; Adjusted: 27.1Â°C; Current: 30.0Â°C â†’ offset: -1.9Â°C; Weight: 0.18; Deferred: Significant debt (DM -304) | GE-Spot Q95: NORMAL (night) | Too warm: 2.1Â°C over[0m
[36m2025-10-27 23:55:32.971 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.57Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-27 23:55:32.971 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.592 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-27 23:55:32.971 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.1Â°C, outdoor=5.7Â°C, offset=0.6Â°C, change=-0.04Â°C, Î”t=0.08h[0m
[36m2025-10-27 23:55:32.971 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.1Â°C, outdoor=5.7Â°C, offset=0.6Â°C, flow=30.0Â°C, DM=-304[0m
[36m2025-10-27 23:55:32.973 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.1Â°C/h trend[0m
[36m2025-10-27 23:55:32.973 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-27 23:55:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-27 23:55:32.976 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-27 23:55:32.976 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=37.1[0m
[36m2025-10-27 23:55:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 5.7Â°C (zone avg: -1.0Â°C, delta: 6.7Â°C): normal -166 to -366, warning -366, critical -1500[0m
[36m2025-10-27 23:55:32.978 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 23:55:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 5.7Â°C (zone avg: -1.0Â°C, delta: 6.7Â°C): normal -166 to -366, warning -366, critical -1500[0m
[36m2025-10-27 23:55:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 5.7Â°C (zone: Moderate Cold): block=-366, abort=-446[0m
[36m2025-10-27 23:55:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 28 quarters available, need 3 quarters (45 min), lookahead 7.0h[0m
[36m2025-10-27 23:55:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 26 windows evaluated[0m
[36m2025-10-27 23:55:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (3.8h away) â† SELECTED[0m
[36m2025-10-27 23:55:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (3.6h away)[0m
[36m2025-10-27 23:55:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (4.1h away)[0m
[36m2025-10-27 23:55:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (3.3h away)[0m
[36m2025-10-27 23:55:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (3.1h away)[0m
[32m2025-10-27 23:55:32.979 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 3.8h away[0m
[36m2025-10-27 23:55:32.981 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-27 23:55:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 5.7Â°C (zone avg: -1.0Â°C, delta: 6.7Â°C): normal -166 to -366, warning -366, critical -1500[0m
[36m2025-10-27 23:55:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 5.7Â°C (zone: Moderate Cold): block=-366, abort=-446[0m
[36m2025-10-27 23:55:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 28 quarters available, need 3 quarters (45 min), lookahead 7.0h[0m
[36m2025-10-27 23:55:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 26 windows evaluated[0m
[36m2025-10-27 23:55:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (3.8h away) â† SELECTED[0m
[36m2025-10-27 23:55:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (3.6h away)[0m
[36m2025-10-27 23:55:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (4.1h away)[0m
[36m2025-10-27 23:55:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (3.3h away)[0m
[36m2025-10-27 23:55:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (3.1h away)[0m
[32m2025-10-27 23:55:32.982 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q111-Q113) @ 7.4Ã¶re/kWh, 3.8h away[0m
[36m2025-10-27 23:55:32.982 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-27 23:55:32.982 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.024 seconds (success: True)[0m
[36m2025-10-27 23:55:32.983 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (6.8 + 0.6 + 0.9)A Ã— 0.95 = 1.89 kW[0m
[36m2025-10-27 23:55:32.984 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 00:00:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 00:00:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.1Â°C (median of 9 sensors: 23.6Â°C, 21.2Â°C, 21.5Â°C, 23.1Â°C, 25.0Â°C, 23.8Â°C, 22.3Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-28 00:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -304.0[0m
[36m2025-10-28 00:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 37.1Â°C[0m
[36m2025-10-28 00:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.5Â°C[0m
[36m2025-10-28 00:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=6.8A, L2=0.6A, L3=0.9A[0m
[36m2025-10-28 00:00:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.1Â°C, outdoor 5.7Â°C, flow 30.5Â°C, DM -304[0m
[36m2025-10-28 00:00:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 39 Hz (1h avg: 36, 6h avg: 51, mode: space) - OK: Normal operation (39 Hz, 6h avg: 51 Hz)[0m
[36m2025-10-28 00:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 00:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 00:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 00:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 00:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 00:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 00:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 00:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 00:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 00:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 00:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 95}[0m
[36m2025-10-28 00:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 00:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 00:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 00:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 00:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 00:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 00:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 00:00:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 00:00:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q0 = 54.33 Ã¶re/kWh[0m
[36m2025-10-28 00:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 00:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 00:00:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 00:00:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 00:00:32.962 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 00:00:32.962 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 7.2Â°C, 48 hours forecast[0m
[36m2025-10-28 00:00:32.962 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 00:00:32.963 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 00:00:32.963 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-28 00:00:32.963 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 5.7Â°C (zone avg: -1.0Â°C, delta: 6.7Â°C): normal -166 to -366, warning -366, critical -1500[0m
[36m2025-10-28 00:00:32.963 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 5.7Â°C: normal -166 to -366, warning -366[0m
[36m2025-10-28 00:00:32.963 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 5.7Â°C (zone avg: -1.0Â°C, delta: 6.7Â°C): normal -166 to -366, warning -366, critical -1500[0m
[36m2025-10-28 00:00:32.963 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -366 (base: -366), critical -1500[0m
[36m2025-10-28 00:00:32.963 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=5.7Â°C, indoor_target=21.0Â°C, temp_diff=15.3Â°C, HC=0.180 kW/K -> flow=26.6Â°C[0m
[36m2025-10-28 00:00:32.963 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 00:00:32.963 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 00:00:32.963 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=27.1Â°C, current=30.5Â°C, error=-3.4Â°C, sensitivity=1.5 -> offset=-2.3[0m
[36m2025-10-28 00:00:32.963 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=5.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 00:00:32.963 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.6Â°C; Safety: +0.5Â°C; Adjusted: 27.1Â°C; Current: 30.5Â°C â†’ offset: -2.3Â°C; Weight: 0.18; Deferred: Significant debt (DM -304)[0m
[36m2025-10-28 00:00:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Price classification Q0 (00:00): 54.33 â†’ CHEAP[0m
[32m2025-10-28 00:00:32.964 INFO (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.76Â°C - Learned pre-heat: Pre-heating: predicted drop 2.2Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.6Â°C; Safety: +0.5Â°C; Adjusted: 27.1Â°C; Current: 30.5Â°C â†’ offset: -2.3Â°C; Weight: 0.18; Deferred: Significant debt (DM -304) | GE-Spot Q0: CHEAP (night) | Too warm: 2.1Â°C over[0m
[32m2025-10-28 00:00:32.964 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.76Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 2.2Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.6Â°C; Safety: +0.5Â°C; Adjusted: 27.1Â°C; Current: 30.5Â°C â†’ offset: -2.3Â°C; Weight: 0.18; Deferred: Significant debt (DM -304) | GE-Spot Q0: CHEAP (night) | Too warm: 2.1Â°C over[0m
[36m2025-10-28 00:00:32.964 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.76Â°C, integer=0Â°C, fractional=0.76Â°C, accumulator_before=0.12Â°C[0m
[36m2025-10-28 00:00:32.964 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: 0.88Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-28 00:00:32.964 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.76Â°C deferred (accumulating fractional changes or rate limited)[0m
[32m2025-10-28 00:00:32.964 INFO (MainThread) [custom_components.effektguard.coordinator] Day change detected: Yesterday's peak was 2.91 kW, resetting daily peak[0m
[36m2025-10-28 00:00:32.964 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.605 kW from sensor.gen24_elnat_import_effekt[0m
[32m2025-10-28 00:00:32.964 INFO (MainThread) [custom_components.effektguard.coordinator] New daily peak: 1.60 kW at 00:00:32 (quarter 0, source: external_meter)[0m
[36m2025-10-28 00:00:32.964 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.1Â°C, outdoor=5.7Â°C, offset=0.8Â°C, change=0.02Â°C, Î”t=0.08h[0m
[36m2025-10-28 00:00:32.964 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.1Â°C, outdoor=5.7Â°C, offset=0.8Â°C, flow=30.5Â°C, DM=-304[0m
[36m2025-10-28 00:00:32.964 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-28 00:00:32.964 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 00:00:32.968 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 00:00:32.968 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 00:00:32.968 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=37.1[0m
[36m2025-10-28 00:00:32.968 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 5.7Â°C (zone avg: -1.0Â°C, delta: 6.7Â°C): normal -166 to -366, warning -366, critical -1500[0m
[36m2025-10-28 00:00:32.978 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 00:00:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 5.7Â°C (zone avg: -1.0Â°C, delta: 6.7Â°C): normal -166 to -366, warning -366, critical -1500[0m
[36m2025-10-28 00:00:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 5.7Â°C (zone: Moderate Cold): block=-366, abort=-446[0m
[36m2025-10-28 00:00:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 5.7Â°C (zone avg: -1.0Â°C, delta: 6.7Â°C): normal -166 to -366, warning -366, critical -1500[0m
[36m2025-10-28 00:00:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-304, warning=-366, threshold=-183, has_capacity=False[0m
[36m2025-10-28 00:00:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 24 quarters available, need 3 quarters (45 min), lookahead 6.0h[0m
[36m2025-10-28 00:00:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 22 windows evaluated[0m
[36m2025-10-28 00:00:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (3.7h away) â† SELECTED[0m
[36m2025-10-28 00:00:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (3.5h away)[0m
[36m2025-10-28 00:00:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (4.0h away)[0m
[36m2025-10-28 00:00:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (3.2h away)[0m
[36m2025-10-28 00:00:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (3.0h away)[0m
[32m2025-10-28 00:00:32.979 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 3.7h away[0m
[36m2025-10-28 00:00:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 5.7Â°C (zone avg: -1.0Â°C, delta: 6.7Â°C): normal -166 to -366, warning -366, critical -1500[0m
[36m2025-10-28 00:00:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-304, warning=-366, threshold=-183, has_capacity=False[0m
[36m2025-10-28 00:00:32.983 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 00:00:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 5.7Â°C (zone avg: -1.0Â°C, delta: 6.7Â°C): normal -166 to -366, warning -366, critical -1500[0m
[36m2025-10-28 00:00:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 5.7Â°C (zone: Moderate Cold): block=-366, abort=-446[0m
[36m2025-10-28 00:00:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 5.7Â°C (zone avg: -1.0Â°C, delta: 6.7Â°C): normal -166 to -366, warning -366, critical -1500[0m
[36m2025-10-28 00:00:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-304, warning=-366, threshold=-183, has_capacity=False[0m
[36m2025-10-28 00:00:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 24 quarters available, need 3 quarters (45 min), lookahead 6.0h[0m
[36m2025-10-28 00:00:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 22 windows evaluated[0m
[36m2025-10-28 00:00:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (3.7h away) â† SELECTED[0m
[36m2025-10-28 00:00:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (3.5h away)[0m
[36m2025-10-28 00:00:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (4.0h away)[0m
[36m2025-10-28 00:00:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (3.2h away)[0m
[36m2025-10-28 00:00:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (3.0h away)[0m
[32m2025-10-28 00:00:32.984 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 3.7h away[0m
[36m2025-10-28 00:00:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 5.7Â°C (zone avg: -1.0Â°C, delta: 6.7Â°C): normal -166 to -366, warning -366, critical -1500[0m
[36m2025-10-28 00:00:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-304, warning=-366, threshold=-183, has_capacity=False[0m
[36m2025-10-28 00:00:32.984 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 00:00:32.984 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.025 seconds (success: True)[0m
[36m2025-10-28 00:00:32.986 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (6.8 + 0.6 + 0.9)A Ã— 0.95 = 1.89 kW[0m
[36m2025-10-28 00:00:32.986 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 00:05:32.958 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 00:05:32.958 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.1Â°C (median of 9 sensors: 23.6Â°C, 21.2Â°C, 21.5Â°C, 23.1Â°C, 24.9Â°C, 23.8Â°C, 22.3Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-28 00:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -303.0[0m
[36m2025-10-28 00:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 37.1Â°C[0m
[36m2025-10-28 00:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.5Â°C[0m
[36m2025-10-28 00:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=6.8A, L2=0.6A, L3=0.9A[0m
[36m2025-10-28 00:05:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.1Â°C, outdoor 5.7Â°C, flow 30.5Â°C, DM -303[0m
[36m2025-10-28 00:05:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 39 Hz (1h avg: 36, 6h avg: 51, mode: space) - OK: Normal operation (39 Hz, 6h avg: 51 Hz)[0m
[36m2025-10-28 00:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 00:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 00:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 00:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 00:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 00:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 00:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 00:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 00:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 00:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 00:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 95}[0m
[36m2025-10-28 00:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 00:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 00:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 00:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 00:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 00:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 00:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 00:05:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 00:05:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q0 = 54.33 Ã¶re/kWh[0m
[36m2025-10-28 00:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 00:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 00:05:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 00:05:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 00:05:32.961 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 00:05:32.961 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 7.2Â°C, 48 hours forecast[0m
[36m2025-10-28 00:05:32.961 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 00:05:32.962 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 00:05:32.962 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-28 00:05:32.962 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.climate_zones] DM range for 5.7Â°C (zone avg: -1.0Â°C, delta: 6.7Â°C): normal -166 to -366, warning -366, critical -1500[0m
[36m2025-10-28 00:05:32.962 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 5.7Â°C: normal -166 to -366, warning -366[0m
[36m2025-10-28 00:05:32.962 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.climate_zones] DM range for 5.7Â°C (zone avg: -1.0Â°C, delta: 6.7Â°C): normal -166 to -366, warning -366, critical -1500[0m
[36m2025-10-28 00:05:32.962 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -366 (base: -366), critical -1500[0m
[36m2025-10-28 00:05:32.963 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=5.7Â°C, indoor_target=21.0Â°C, temp_diff=15.3Â°C, HC=0.180 kW/K -> flow=26.6Â°C[0m
[36m2025-10-28 00:05:32.963 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 00:05:32.963 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 00:05:32.963 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=27.1Â°C, current=30.5Â°C, error=-3.4Â°C, sensitivity=1.5 -> offset=-2.3[0m
[36m2025-10-28 00:05:32.963 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=5.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 00:05:32.963 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.6Â°C; Safety: +0.5Â°C; Adjusted: 27.1Â°C; Current: 30.5Â°C â†’ offset: -2.3Â°C; Weight: 0.18; Deferred: Significant debt (DM -303)[0m
[36m2025-10-28 00:05:32.963 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Price classification Q0 (00:05): 54.33 â†’ CHEAP[0m
[32m2025-10-28 00:05:32.963 INFO (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.75Â°C - Learned pre-heat: Pre-heating: predicted drop 2.2Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.6Â°C; Safety: +0.5Â°C; Adjusted: 27.1Â°C; Current: 30.5Â°C â†’ offset: -2.3Â°C; Weight: 0.18; Deferred: Significant debt (DM -303) | GE-Spot Q0: CHEAP (night) | Too warm: 2.1Â°C over[0m
[32m2025-10-28 00:05:32.964 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.75Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 2.2Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.6Â°C; Safety: +0.5Â°C; Adjusted: 27.1Â°C; Current: 30.5Â°C â†’ offset: -2.3Â°C; Weight: 0.18; Deferred: Significant debt (DM -303) | GE-Spot Q0: CHEAP (night) | Too warm: 2.1Â°C over[0m
[36m2025-10-28 00:05:32.964 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.75Â°C, integer=0Â°C, fractional=0.75Â°C, accumulator_before=0.88Â°C[0m
[32m2025-10-28 00:05:32.964 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] âœ“ Accumulated fractional offset reached threshold: applying +1Â°C adjustment (accumulator: 1.63Â°C â†’ 0.63Â°C)[0m
[36m2025-10-28 00:05:32.964 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Accumulator triggered: total_accumulated=1.63Â°C, adjustment=+1Â°C, new_integer=1Â°C, remaining=0.63Â°C[0m
[36m2025-10-28 00:05:32.964 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset 0.75Â°C â†’ applying 1Â°C (accumulator: 0.63Â°C, needs 0.37Â°C more to trigger)[0m
[32m2025-10-28 00:05:32.965 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to 1Â°C (calculated: 0.75Â°C, accumulator: 0.63Â°C)[0m
[36m2025-10-28 00:05:32.965 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=1Â°C, original=0.75Â°C, accumulator=0.63Â°C[0m
[32m2025-10-28 00:05:32.965 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset 0.75Â°C to NIBE via MyUplink[0m
[36m2025-10-28 00:05:32.965 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.574 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 00:05:32.965 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.1Â°C, outdoor=5.7Â°C, offset=0.8Â°C, change=0.02Â°C, Î”t=0.08h[0m
[36m2025-10-28 00:05:32.965 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.1Â°C, outdoor=5.7Â°C, offset=0.8Â°C, flow=30.5Â°C, DM=-303[0m
[36m2025-10-28 00:05:32.971 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.1Â°C/h trend[0m
[36m2025-10-28 00:05:32.971 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 00:05:32.971 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 00:05:32.971 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 00:05:32.971 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=37.1[0m
[36m2025-10-28 00:05:32.972 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 5.7Â°C (zone avg: -1.0Â°C, delta: 6.7Â°C): normal -166 to -366, warning -366, critical -1500[0m
[36m2025-10-28 00:05:32.975 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 00:05:32.975 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 5.7Â°C (zone avg: -1.0Â°C, delta: 6.7Â°C): normal -166 to -366, warning -366, critical -1500[0m
[36m2025-10-28 00:05:32.975 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 5.7Â°C (zone: Moderate Cold): block=-366, abort=-446[0m
[36m2025-10-28 00:05:32.975 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 5.7Â°C (zone avg: -1.0Â°C, delta: 6.7Â°C): normal -166 to -366, warning -366, critical -1500[0m
[36m2025-10-28 00:05:32.975 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-303, warning=-366, threshold=-183, has_capacity=False[0m
[36m2025-10-28 00:05:32.975 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 24 quarters available, need 3 quarters (45 min), lookahead 6.0h[0m
[36m2025-10-28 00:05:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 22 windows evaluated[0m
[36m2025-10-28 00:05:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (3.7h away) â† SELECTED[0m
[36m2025-10-28 00:05:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (3.4h away)[0m
[36m2025-10-28 00:05:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (3.9h away)[0m
[36m2025-10-28 00:05:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (3.2h away)[0m
[36m2025-10-28 00:05:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (2.9h away)[0m
[32m2025-10-28 00:05:32.976 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 3.7h away[0m
[36m2025-10-28 00:05:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 5.7Â°C (zone avg: -1.0Â°C, delta: 6.7Â°C): normal -166 to -366, warning -366, critical -1500[0m
[36m2025-10-28 00:05:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-303, warning=-366, threshold=-183, has_capacity=False[0m
[36m2025-10-28 00:05:32.978 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 00:05:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 5.7Â°C (zone avg: -1.0Â°C, delta: 6.7Â°C): normal -166 to -366, warning -366, critical -1500[0m
[36m2025-10-28 00:05:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 5.7Â°C (zone: Moderate Cold): block=-366, abort=-446[0m
[36m2025-10-28 00:05:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 5.7Â°C (zone avg: -1.0Â°C, delta: 6.7Â°C): normal -166 to -366, warning -366, critical -1500[0m
[36m2025-10-28 00:05:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-303, warning=-366, threshold=-183, has_capacity=False[0m
[36m2025-10-28 00:05:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 24 quarters available, need 3 quarters (45 min), lookahead 6.0h[0m
[36m2025-10-28 00:05:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 22 windows evaluated[0m
[36m2025-10-28 00:05:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (3.7h away) â† SELECTED[0m
[36m2025-10-28 00:05:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (3.4h away)[0m
[36m2025-10-28 00:05:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (3.9h away)[0m
[36m2025-10-28 00:05:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (3.2h away)[0m
[36m2025-10-28 00:05:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (2.9h away)[0m
[32m2025-10-28 00:05:32.979 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 3.7h away[0m
[36m2025-10-28 00:05:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 5.7Â°C (zone avg: -1.0Â°C, delta: 6.7Â°C): normal -166 to -366, warning -366, critical -1500[0m
[36m2025-10-28 00:05:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-303, warning=-366, threshold=-183, has_capacity=False[0m
[36m2025-10-28 00:05:32.979 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 00:05:32.979 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.021 seconds (success: True)[0m
[36m2025-10-28 00:05:32.980 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (6.8 + 0.6 + 0.9)A Ã— 0.95 = 1.89 kW[0m
[36m2025-10-28 00:05:32.981 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 00:10:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 00:10:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.2Â°C (median of 9 sensors: 23.6Â°C, 21.2Â°C, 21.5Â°C, 23.2Â°C, 25.0Â°C, 23.8Â°C, 22.3Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-28 00:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -300.0[0m
[36m2025-10-28 00:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 37.1Â°C[0m
[36m2025-10-28 00:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 31.0Â°C[0m
[36m2025-10-28 00:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=6.8A, L2=0.6A, L3=0.9A[0m
[36m2025-10-28 00:10:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.2Â°C, outdoor 6.2Â°C, flow 31.0Â°C, DM -300[0m
[36m2025-10-28 00:10:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 38 Hz (1h avg: 37, 6h avg: 51, mode: space) - OK: Normal operation (38 Hz, 6h avg: 51 Hz)[0m
[36m2025-10-28 00:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 00:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 00:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 00:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 00:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 00:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 00:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 00:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 00:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 00:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 00:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 95}[0m
[36m2025-10-28 00:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 00:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 00:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 00:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 00:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 00:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 00:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 00:10:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 00:10:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q0 = 54.33 Ã¶re/kWh[0m
[36m2025-10-28 00:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 00:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 00:10:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 00:10:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 00:10:32.961 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 00:10:32.962 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 7.2Â°C, 48 hours forecast[0m
[36m2025-10-28 00:10:32.962 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 00:10:32.962 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 00:10:32.963 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-28 00:10:32.963 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-28 00:10:32.963 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 6.2Â°C: normal -156 to -356, warning -356[0m
[36m2025-10-28 00:10:32.963 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-28 00:10:32.963 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -356 (base: -356), critical -1500[0m
[36m2025-10-28 00:10:32.963 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=6.2Â°C, indoor_target=21.0Â°C, temp_diff=14.8Â°C, HC=0.180 kW/K -> flow=26.5Â°C[0m
[36m2025-10-28 00:10:32.963 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 00:10:32.963 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 00:10:32.963 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=27.0Â°C, current=31.0Â°C, error=-4.0Â°C, sensitivity=1.5 -> offset=-2.7[0m
[36m2025-10-28 00:10:32.963 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=6.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 00:10:32.963 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.5Â°C; Safety: +0.5Â°C; Adjusted: 27.0Â°C; Current: 31.0Â°C â†’ offset: -2.7Â°C; Weight: 0.20; Deferred: Moderate debt (DM -300)[0m
[36m2025-10-28 00:10:32.963 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Price classification Q0 (00:10): 54.33 â†’ CHEAP[0m
[32m2025-10-28 00:10:32.964 INFO (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.67Â°C - Learned pre-heat: Pre-heating: predicted drop 2.2Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.5Â°C; Safety: +0.5Â°C; Adjusted: 27.0Â°C; Current: 31.0Â°C â†’ offset: -2.7Â°C; Weight: 0.20; Deferred: Moderate debt (DM -300) | GE-Spot Q0: CHEAP (night) | Too warm: 2.2Â°C over[0m
[32m2025-10-28 00:10:32.964 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.67Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 2.2Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.5Â°C; Safety: +0.5Â°C; Adjusted: 27.0Â°C; Current: 31.0Â°C â†’ offset: -2.7Â°C; Weight: 0.20; Deferred: Moderate debt (DM -300) | GE-Spot Q0: CHEAP (night) | Too warm: 2.2Â°C over[0m
[36m2025-10-28 00:10:32.964 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.67Â°C, integer=0Â°C, fractional=0.67Â°C, accumulator_before=0.63Â°C[0m
[32m2025-10-28 00:10:32.964 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] âœ“ Accumulated fractional offset reached threshold: applying +1Â°C adjustment (accumulator: 1.30Â°C â†’ 0.30Â°C)[0m
[36m2025-10-28 00:10:32.964 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Accumulator triggered: total_accumulated=1.30Â°C, adjustment=+1Â°C, new_integer=1Â°C, remaining=0.30Â°C[0m
[36m2025-10-28 00:10:32.964 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset 0.67Â°C â†’ applying 1Â°C (accumulator: 0.30Â°C, needs 0.70Â°C more to trigger)[0m
[32m2025-10-28 00:10:32.965 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to 1Â°C (calculated: 0.67Â°C, accumulator: 0.30Â°C)[0m
[36m2025-10-28 00:10:32.966 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=1Â°C, original=0.67Â°C, accumulator=0.30Â°C[0m
[32m2025-10-28 00:10:32.966 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset 0.67Â°C to NIBE via MyUplink[0m
[36m2025-10-28 00:10:32.966 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.649 kW from sensor.gen24_elnat_import_effekt[0m
[32m2025-10-28 00:10:32.966 INFO (MainThread) [custom_components.effektguard.coordinator] New daily peak: 1.65 kW at 00:10:32 (quarter 0, source: external_meter)[0m
[36m2025-10-28 00:10:32.966 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.2Â°C, outdoor=6.2Â°C, offset=0.7Â°C, change=0.07Â°C, Î”t=0.08h[0m
[36m2025-10-28 00:10:32.966 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.2Â°C, outdoor=6.2Â°C, offset=0.7Â°C, flow=31.0Â°C, DM=-300[0m
[36m2025-10-28 00:10:32.969 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.2Â°C/h trend[0m
[36m2025-10-28 00:10:32.969 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 00:10:32.972 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 00:10:32.972 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 00:10:32.972 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=37.1[0m
[36m2025-10-28 00:10:32.972 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-28 00:10:32.975 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 00:10:32.975 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-28 00:10:32.975 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 6.2Â°C (zone: Moderate Cold): block=-356, abort=-436[0m
[36m2025-10-28 00:10:32.975 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-28 00:10:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-300, warning=-356, threshold=-178, has_capacity=False[0m
[36m2025-10-28 00:10:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 24 quarters available, need 3 quarters (45 min), lookahead 6.0h[0m
[36m2025-10-28 00:10:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 22 windows evaluated[0m
[36m2025-10-28 00:10:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (3.6h away) â† SELECTED[0m
[36m2025-10-28 00:10:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (3.3h away)[0m
[36m2025-10-28 00:10:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (3.8h away)[0m
[36m2025-10-28 00:10:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (3.1h away)[0m
[36m2025-10-28 00:10:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (2.8h away)[0m
[32m2025-10-28 00:10:32.976 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 3.6h away[0m
[36m2025-10-28 00:10:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-28 00:10:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-300, warning=-356, threshold=-178, has_capacity=False[0m
[36m2025-10-28 00:10:32.980 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 00:10:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-28 00:10:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 6.2Â°C (zone: Moderate Cold): block=-356, abort=-436[0m
[36m2025-10-28 00:10:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-28 00:10:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-300, warning=-356, threshold=-178, has_capacity=False[0m
[36m2025-10-28 00:10:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 24 quarters available, need 3 quarters (45 min), lookahead 6.0h[0m
[36m2025-10-28 00:10:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 22 windows evaluated[0m
[36m2025-10-28 00:10:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (3.6h away) â† SELECTED[0m
[36m2025-10-28 00:10:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (3.3h away)[0m
[36m2025-10-28 00:10:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (3.8h away)[0m
[36m2025-10-28 00:10:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (3.1h away)[0m
[36m2025-10-28 00:10:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (2.8h away)[0m
[32m2025-10-28 00:10:32.981 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 3.6h away[0m
[36m2025-10-28 00:10:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-28 00:10:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-300, warning=-356, threshold=-178, has_capacity=False[0m
[36m2025-10-28 00:10:32.981 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 00:10:32.981 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.022 seconds (success: True)[0m
[36m2025-10-28 00:10:32.982 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (6.8 + 0.6 + 0.9)A Ã— 0.95 = 1.89 kW[0m
[36m2025-10-28 00:10:32.983 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 00:15:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 00:15:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.1Â°C (median of 9 sensors: 23.6Â°C, 21.2Â°C, 21.5Â°C, 23.1Â°C, 25.0Â°C, 23.8Â°C, 22.3Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-28 00:15:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -298.0[0m
[36m2025-10-28 00:15:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 37.1Â°C[0m
[36m2025-10-28 00:15:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 31.0Â°C[0m
[36m2025-10-28 00:15:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=7.2A, L2=0.6A, L3=0.9A[0m
[36m2025-10-28 00:15:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.1Â°C, outdoor 6.2Â°C, flow 31.0Â°C, DM -298[0m
[36m2025-10-28 00:15:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 37 Hz (1h avg: 37, 6h avg: 51, mode: space) - OK: Normal operation (37 Hz, 6h avg: 51 Hz)[0m
[36m2025-10-28 00:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 00:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 00:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 00:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 00:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 00:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 00:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 00:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 00:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 00:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 00:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 94}[0m
[36m2025-10-28 00:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 00:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 00:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 00:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 00:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 00:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 00:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 00:15:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 00:15:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q1 = 50.49 Ã¶re/kWh[0m
[36m2025-10-28 00:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 00:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 00:15:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 00:15:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 00:15:32.962 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 00:15:32.962 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-28 00:15:32.962 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 00:15:32.963 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 00:15:32.963 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-28 00:15:32.963 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-28 00:15:32.963 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 6.2Â°C: normal -156 to -356, warning -356[0m
[36m2025-10-28 00:15:32.963 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-28 00:15:32.963 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -356 (base: -356), critical -1500[0m
[36m2025-10-28 00:15:32.963 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=6.2Â°C, indoor_target=21.0Â°C, temp_diff=14.8Â°C, HC=0.180 kW/K -> flow=26.5Â°C[0m
[36m2025-10-28 00:15:32.963 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 00:15:32.963 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 00:15:32.964 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=27.0Â°C, current=31.0Â°C, error=-4.0Â°C, sensitivity=1.5 -> offset=-2.7[0m
[36m2025-10-28 00:15:32.964 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=6.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 00:15:32.964 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.5Â°C; Safety: +0.5Â°C; Adjusted: 27.0Â°C; Current: 31.0Â°C â†’ offset: -2.7Â°C; Weight: 0.20; Deferred: Moderate debt (DM -298)[0m
[36m2025-10-28 00:15:32.964 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Price classification Q1 (00:15): 50.49 â†’ CHEAP[0m
[32m2025-10-28 00:15:32.964 INFO (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.68Â°C - Learned pre-heat: Pre-heating: predicted drop 2.0Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.5Â°C; Safety: +0.5Â°C; Adjusted: 27.0Â°C; Current: 31.0Â°C â†’ offset: -2.7Â°C; Weight: 0.20; Deferred: Moderate debt (DM -298) | GE-Spot Q1: CHEAP (night) | Too warm: 2.1Â°C over[0m
[32m2025-10-28 00:15:32.964 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.68Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 2.0Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.5Â°C; Safety: +0.5Â°C; Adjusted: 27.0Â°C; Current: 31.0Â°C â†’ offset: -2.7Â°C; Weight: 0.20; Deferred: Moderate debt (DM -298) | GE-Spot Q1: CHEAP (night) | Too warm: 2.1Â°C over[0m
[36m2025-10-28 00:15:32.964 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.68Â°C, integer=0Â°C, fractional=0.68Â°C, accumulator_before=0.30Â°C[0m
[36m2025-10-28 00:15:32.964 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: 0.98Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-28 00:15:32.964 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.68Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-28 00:15:32.964 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.698 kW from sensor.gen24_elnat_import_effekt[0m
[32m2025-10-28 00:15:32.964 INFO (MainThread) [custom_components.effektguard.coordinator] New daily peak: 1.70 kW at 00:15:32 (quarter 1, source: external_meter)[0m
[36m2025-10-28 00:15:32.964 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.1Â°C, outdoor=6.2Â°C, offset=0.7Â°C, change=-0.09Â°C, Î”t=0.08h[0m
[36m2025-10-28 00:15:32.964 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.1Â°C, outdoor=6.2Â°C, offset=0.7Â°C, flow=31.0Â°C, DM=-298[0m
[36m2025-10-28 00:15:32.964 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-28 00:15:32.965 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 00:15:32.969 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 00:15:32.969 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 00:15:32.969 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=37.1[0m
[36m2025-10-28 00:15:32.969 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-28 00:15:32.973 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 00:15:32.973 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-28 00:15:32.973 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 6.2Â°C (zone: Moderate Cold): block=-356, abort=-436[0m
[36m2025-10-28 00:15:32.973 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-28 00:15:32.973 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-298, warning=-356, threshold=-178, has_capacity=False[0m
[36m2025-10-28 00:15:32.973 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 24 quarters available, need 3 quarters (45 min), lookahead 6.0h[0m
[36m2025-10-28 00:15:32.973 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 22 windows evaluated[0m
[36m2025-10-28 00:15:32.973 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (3.5h away) â† SELECTED[0m
[36m2025-10-28 00:15:32.973 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (3.2h away)[0m
[36m2025-10-28 00:15:32.973 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (3.7h away)[0m
[36m2025-10-28 00:15:32.973 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (3.0h away)[0m
[36m2025-10-28 00:15:32.973 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (2.7h away)[0m
[32m2025-10-28 00:15:32.973 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 3.5h away[0m
[36m2025-10-28 00:15:32.974 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-28 00:15:32.974 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-298, warning=-356, threshold=-178, has_capacity=False[0m
[36m2025-10-28 00:15:32.981 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 00:15:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-28 00:15:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 6.2Â°C (zone: Moderate Cold): block=-356, abort=-436[0m
[36m2025-10-28 00:15:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-28 00:15:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-298, warning=-356, threshold=-178, has_capacity=False[0m
[36m2025-10-28 00:15:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 24 quarters available, need 3 quarters (45 min), lookahead 6.0h[0m
[36m2025-10-28 00:15:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 22 windows evaluated[0m
[36m2025-10-28 00:15:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (3.5h away) â† SELECTED[0m
[36m2025-10-28 00:15:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (3.2h away)[0m
[36m2025-10-28 00:15:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (3.7h away)[0m
[36m2025-10-28 00:15:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (3.0h away)[0m
[36m2025-10-28 00:15:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (2.7h away)[0m
[32m2025-10-28 00:15:32.982 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 3.5h away[0m
[36m2025-10-28 00:15:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-28 00:15:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-298, warning=-356, threshold=-178, has_capacity=False[0m
[36m2025-10-28 00:15:32.982 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 00:15:32.982 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.023 seconds (success: True)[0m
[36m2025-10-28 00:15:32.983 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (7.2 + 0.6 + 0.9)A Ã— 0.95 = 1.98 kW[0m
[36m2025-10-28 00:15:32.984 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 00:20:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 00:20:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.2Â°C (median of 9 sensors: 23.6Â°C, 21.2Â°C, 21.5Â°C, 23.2Â°C, 24.9Â°C, 23.9Â°C, 22.3Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-28 00:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -296.0[0m
[36m2025-10-28 00:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 37.1Â°C[0m
[36m2025-10-28 00:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 31.0Â°C[0m
[36m2025-10-28 00:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=7.2A, L2=0.6A, L3=0.9A[0m
[36m2025-10-28 00:20:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.2Â°C, outdoor 6.2Â°C, flow 31.0Â°C, DM -296[0m
[36m2025-10-28 00:20:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 37 Hz (1h avg: 37, 6h avg: 50, mode: space) - OK: Normal operation (37 Hz, 6h avg: 50 Hz)[0m
[36m2025-10-28 00:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 00:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 00:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 00:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 00:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 00:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 00:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 00:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 00:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 00:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 00:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 94}[0m
[36m2025-10-28 00:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 00:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 00:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 00:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 00:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 00:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 00:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 00:20:32.961 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 00:20:32.961 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q1 = 50.49 Ã¶re/kWh[0m
[36m2025-10-28 00:20:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 00:20:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 00:20:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 00:20:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 00:20:32.962 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 00:20:32.962 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-28 00:20:32.962 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 00:20:32.963 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 00:20:32.963 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-28 00:20:32.963 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-28 00:20:32.963 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 6.2Â°C: normal -156 to -356, warning -356[0m
[36m2025-10-28 00:20:32.963 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-28 00:20:32.963 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -356 (base: -356), critical -1500[0m
[36m2025-10-28 00:20:32.964 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=6.2Â°C, indoor_target=21.0Â°C, temp_diff=14.8Â°C, HC=0.180 kW/K -> flow=26.5Â°C[0m
[36m2025-10-28 00:20:32.964 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 00:20:32.964 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 00:20:32.964 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=27.0Â°C, current=31.0Â°C, error=-4.0Â°C, sensitivity=1.5 -> offset=-2.7[0m
[36m2025-10-28 00:20:32.964 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=6.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 00:20:32.964 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.5Â°C; Safety: +0.5Â°C; Adjusted: 27.0Â°C; Current: 31.0Â°C â†’ offset: -2.7Â°C; Weight: 0.20; Deferred: Moderate debt (DM -296)[0m
[36m2025-10-28 00:20:32.964 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Price classification Q1 (00:20): 50.49 â†’ CHEAP[0m
[32m2025-10-28 00:20:32.964 INFO (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.67Â°C - Learned pre-heat: Pre-heating: predicted drop 2.1Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.5Â°C; Safety: +0.5Â°C; Adjusted: 27.0Â°C; Current: 31.0Â°C â†’ offset: -2.7Â°C; Weight: 0.20; Deferred: Moderate debt (DM -296) | GE-Spot Q1: CHEAP (night) | Too warm: 2.2Â°C over[0m
[32m2025-10-28 00:20:32.964 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.67Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 2.1Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.5Â°C; Safety: +0.5Â°C; Adjusted: 27.0Â°C; Current: 31.0Â°C â†’ offset: -2.7Â°C; Weight: 0.20; Deferred: Moderate debt (DM -296) | GE-Spot Q1: CHEAP (night) | Too warm: 2.2Â°C over[0m
[36m2025-10-28 00:20:32.965 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.67Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-28 00:20:32.965 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.698 kW from sensor.gen24_elnat_import_effekt[0m
[32m2025-10-28 00:20:32.965 INFO (MainThread) [custom_components.effektguard.coordinator] New daily peak: 1.70 kW at 00:20:32 (quarter 1, source: external_meter)[0m
[36m2025-10-28 00:20:32.965 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.2Â°C, outdoor=6.2Â°C, offset=0.7Â°C, change=0.10Â°C, Î”t=0.08h[0m
[36m2025-10-28 00:20:32.965 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.2Â°C, outdoor=6.2Â°C, offset=0.7Â°C, flow=31.0Â°C, DM=-296[0m
[36m2025-10-28 00:20:32.968 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.2Â°C/h trend[0m
[36m2025-10-28 00:20:32.968 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 00:20:32.969 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 00:20:32.969 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 00:20:32.969 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=37.1[0m
[36m2025-10-28 00:20:32.969 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-28 00:20:32.978 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 00:20:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-28 00:20:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 6.2Â°C (zone: Moderate Cold): block=-356, abort=-436[0m
[36m2025-10-28 00:20:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-28 00:20:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-296, warning=-356, threshold=-178, has_capacity=False[0m
[36m2025-10-28 00:20:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 24 quarters available, need 3 quarters (45 min), lookahead 6.0h[0m
[36m2025-10-28 00:20:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 22 windows evaluated[0m
[36m2025-10-28 00:20:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (3.4h away) â† SELECTED[0m
[36m2025-10-28 00:20:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (3.2h away)[0m
[36m2025-10-28 00:20:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (3.7h away)[0m
[36m2025-10-28 00:20:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (2.9h away)[0m
[36m2025-10-28 00:20:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (2.7h away)[0m
[32m2025-10-28 00:20:32.979 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 3.4h away[0m
[36m2025-10-28 00:20:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-28 00:20:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-296, warning=-356, threshold=-178, has_capacity=False[0m
[36m2025-10-28 00:20:32.984 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 00:20:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-28 00:20:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 6.2Â°C (zone: Moderate Cold): block=-356, abort=-436[0m
[36m2025-10-28 00:20:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-28 00:20:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-296, warning=-356, threshold=-178, has_capacity=False[0m
[36m2025-10-28 00:20:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 24 quarters available, need 3 quarters (45 min), lookahead 6.0h[0m
[36m2025-10-28 00:20:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 22 windows evaluated[0m
[36m2025-10-28 00:20:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (3.4h away) â† SELECTED[0m
[36m2025-10-28 00:20:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (3.2h away)[0m
[36m2025-10-28 00:20:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (3.7h away)[0m
[36m2025-10-28 00:20:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (2.9h away)[0m
[36m2025-10-28 00:20:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (2.7h away)[0m
[32m2025-10-28 00:20:32.985 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 3.4h away[0m
[36m2025-10-28 00:20:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-28 00:20:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-296, warning=-356, threshold=-178, has_capacity=False[0m
[36m2025-10-28 00:20:32.985 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 00:20:32.986 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.027 seconds (success: True)[0m
[36m2025-10-28 00:20:32.987 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (7.2 + 0.6 + 0.9)A Ã— 0.95 = 1.98 kW[0m
[36m2025-10-28 00:20:32.987 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 00:25:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 00:25:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.1Â°C (median of 9 sensors: 23.6Â°C, 21.2Â°C, 21.5Â°C, 23.1Â°C, 24.9Â°C, 23.9Â°C, 22.3Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-28 00:25:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -295.0[0m
[36m2025-10-28 00:25:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 37.1Â°C[0m
[36m2025-10-28 00:25:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 31.0Â°C[0m
[36m2025-10-28 00:25:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=7.2A, L2=0.6A, L3=0.9A[0m
[36m2025-10-28 00:25:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.1Â°C, outdoor 6.2Â°C, flow 31.0Â°C, DM -295[0m
[36m2025-10-28 00:25:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 36 Hz (1h avg: 37, 6h avg: 50, mode: space) - OK: Normal operation (36 Hz, 6h avg: 50 Hz)[0m
[36m2025-10-28 00:25:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 00:25:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 00:25:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 00:25:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 00:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 00:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 00:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 00:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 00:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 00:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 00:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 94}[0m
[36m2025-10-28 00:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 00:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 00:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 00:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 00:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 00:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 00:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 00:25:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 00:25:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q1 = 50.49 Ã¶re/kWh[0m
[36m2025-10-28 00:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 00:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 00:25:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 00:25:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 00:25:32.962 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 00:25:32.962 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-28 00:25:32.962 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 00:25:32.963 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 00:25:32.963 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-28 00:25:32.963 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-28 00:25:32.963 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 6.2Â°C: normal -156 to -356, warning -356[0m
[36m2025-10-28 00:25:32.963 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-28 00:25:32.963 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -356 (base: -356), critical -1500[0m
[36m2025-10-28 00:25:32.963 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=6.2Â°C, indoor_target=21.0Â°C, temp_diff=14.8Â°C, HC=0.180 kW/K -> flow=26.5Â°C[0m
[36m2025-10-28 00:25:32.963 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 00:25:32.963 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 00:25:32.963 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=27.0Â°C, current=31.0Â°C, error=-4.0Â°C, sensitivity=1.5 -> offset=-2.7[0m
[36m2025-10-28 00:25:32.963 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=6.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 00:25:32.964 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.5Â°C; Safety: +0.5Â°C; Adjusted: 27.0Â°C; Current: 31.0Â°C â†’ offset: -2.7Â°C; Weight: 0.20; Deferred: Moderate debt (DM -295)[0m
[36m2025-10-28 00:25:32.964 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Price classification Q1 (00:25): 50.49 â†’ CHEAP[0m
[32m2025-10-28 00:25:32.964 INFO (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.68Â°C - Learned pre-heat: Pre-heating: predicted drop 2.0Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.5Â°C; Safety: +0.5Â°C; Adjusted: 27.0Â°C; Current: 31.0Â°C â†’ offset: -2.7Â°C; Weight: 0.20; Deferred: Moderate debt (DM -295) | GE-Spot Q1: CHEAP (night) | Too warm: 2.1Â°C over[0m
[32m2025-10-28 00:25:32.966 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.68Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 2.0Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.5Â°C; Safety: +0.5Â°C; Adjusted: 27.0Â°C; Current: 31.0Â°C â†’ offset: -2.7Â°C; Weight: 0.20; Deferred: Moderate debt (DM -295) | GE-Spot Q1: CHEAP (night) | Too warm: 2.1Â°C over[0m
[36m2025-10-28 00:25:32.966 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.68Â°C, integer=0Â°C, fractional=0.68Â°C, accumulator_before=0.98Â°C[0m
[32m2025-10-28 00:25:32.966 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] âœ“ Accumulated fractional offset reached threshold: applying +1Â°C adjustment (accumulator: 1.66Â°C â†’ 0.66Â°C)[0m
[36m2025-10-28 00:25:32.966 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Accumulator triggered: total_accumulated=1.66Â°C, adjustment=+1Â°C, new_integer=1Â°C, remaining=0.66Â°C[0m
[36m2025-10-28 00:25:32.966 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset 0.68Â°C â†’ applying 1Â°C (accumulator: 0.66Â°C, needs 0.34Â°C more to trigger)[0m
[32m2025-10-28 00:25:32.968 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to 1Â°C (calculated: 0.68Â°C, accumulator: 0.66Â°C)[0m
[36m2025-10-28 00:25:32.968 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=1Â°C, original=0.68Â°C, accumulator=0.66Â°C[0m
[32m2025-10-28 00:25:32.968 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset 0.68Â°C to NIBE via MyUplink[0m
[36m2025-10-28 00:25:32.968 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.602 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 00:25:32.968 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.1Â°C, outdoor=6.2Â°C, offset=0.7Â°C, change=-0.10Â°C, Î”t=0.08h[0m
[36m2025-10-28 00:25:32.968 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.1Â°C, outdoor=6.2Â°C, offset=0.7Â°C, flow=31.0Â°C, DM=-295[0m
[36m2025-10-28 00:25:32.973 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.0Â°C/h trend[0m
[36m2025-10-28 00:25:32.973 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 00:25:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 00:25:32.977 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 00:25:32.977 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=37.1[0m
[36m2025-10-28 00:25:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-28 00:25:32.980 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 00:25:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-28 00:25:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 6.2Â°C (zone: Moderate Cold): block=-356, abort=-436[0m
[36m2025-10-28 00:25:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-28 00:25:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-295, warning=-356, threshold=-178, has_capacity=False[0m
[36m2025-10-28 00:25:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 24 quarters available, need 3 quarters (45 min), lookahead 6.0h[0m
[36m2025-10-28 00:25:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 22 windows evaluated[0m
[36m2025-10-28 00:25:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (3.3h away) â† SELECTED[0m
[36m2025-10-28 00:25:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (3.1h away)[0m
[36m2025-10-28 00:25:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (3.6h away)[0m
[36m2025-10-28 00:25:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (2.8h away)[0m
[36m2025-10-28 00:25:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (2.6h away)[0m
[32m2025-10-28 00:25:32.980 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 3.3h away[0m
[36m2025-10-28 00:25:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-28 00:25:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-295, warning=-356, threshold=-178, has_capacity=False[0m
[36m2025-10-28 00:25:32.985 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 00:25:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-28 00:25:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 6.2Â°C (zone: Moderate Cold): block=-356, abort=-436[0m
[36m2025-10-28 00:25:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-28 00:25:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-295, warning=-356, threshold=-178, has_capacity=False[0m
[36m2025-10-28 00:25:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 24 quarters available, need 3 quarters (45 min), lookahead 6.0h[0m
[36m2025-10-28 00:25:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 22 windows evaluated[0m
[36m2025-10-28 00:25:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (3.3h away) â† SELECTED[0m
[36m2025-10-28 00:25:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (3.1h away)[0m
[36m2025-10-28 00:25:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (3.6h away)[0m
[36m2025-10-28 00:25:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (2.8h away)[0m
[36m2025-10-28 00:25:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (2.6h away)[0m
[32m2025-10-28 00:25:32.985 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 3.3h away[0m
[36m2025-10-28 00:25:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-28 00:25:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-295, warning=-356, threshold=-178, has_capacity=False[0m
[36m2025-10-28 00:25:32.986 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 00:25:32.986 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.027 seconds (success: True)[0m
[36m2025-10-28 00:25:32.987 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (7.2 + 0.6 + 0.9)A Ã— 0.95 = 1.98 kW[0m
[36m2025-10-28 00:25:32.987 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 00:30:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 00:30:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.1Â°C (median of 9 sensors: 23.6Â°C, 21.2Â°C, 21.4Â°C, 23.1Â°C, 24.9Â°C, 23.9Â°C, 22.3Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-28 00:30:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -294.0[0m
[36m2025-10-28 00:30:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 37.1Â°C[0m
[36m2025-10-28 00:30:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.5Â°C[0m
[36m2025-10-28 00:30:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=6.2A, L2=0.6A, L3=0.9A[0m
[36m2025-10-28 00:30:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.1Â°C, outdoor 6.2Â°C, flow 30.5Â°C, DM -294[0m
[36m2025-10-28 00:30:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 36 Hz (1h avg: 37, 6h avg: 50, mode: space) - OK: Normal operation (36 Hz, 6h avg: 50 Hz)[0m
[36m2025-10-28 00:30:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 00:30:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 00:30:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 00:30:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 00:30:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 00:30:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 00:30:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 00:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 00:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 00:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 00:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 93}[0m
[36m2025-10-28 00:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 00:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 00:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 00:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 00:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 00:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 00:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 00:30:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 00:30:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q2 = 37.16 Ã¶re/kWh[0m
[36m2025-10-28 00:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 00:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 00:30:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 00:30:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 00:30:32.961 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 00:30:32.961 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-28 00:30:32.962 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 00:30:32.962 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 00:30:32.963 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-28 00:30:32.963 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-28 00:30:32.963 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 6.2Â°C: normal -156 to -356, warning -356[0m
[36m2025-10-28 00:30:32.963 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-28 00:30:32.963 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -356 (base: -356), critical -1500[0m
[36m2025-10-28 00:30:32.963 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=6.2Â°C, indoor_target=21.0Â°C, temp_diff=14.8Â°C, HC=0.180 kW/K -> flow=26.5Â°C[0m
[36m2025-10-28 00:30:32.963 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 00:30:32.963 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 00:30:32.963 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=27.0Â°C, current=30.5Â°C, error=-3.5Â°C, sensitivity=1.5 -> offset=-2.3[0m
[36m2025-10-28 00:30:32.963 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=6.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 00:30:32.963 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.5Â°C; Safety: +0.5Â°C; Adjusted: 27.0Â°C; Current: 30.5Â°C â†’ offset: -2.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -294)[0m
[36m2025-10-28 00:30:32.963 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Price classification Q2 (00:30): 37.16 â†’ CHEAP[0m
[32m2025-10-28 00:30:32.964 INFO (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.71Â°C - Learned pre-heat: Pre-heating: predicted drop 2.1Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.5Â°C; Safety: +0.5Â°C; Adjusted: 27.0Â°C; Current: 30.5Â°C â†’ offset: -2.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -294) | GE-Spot Q2: CHEAP (night) | Too warm: 2.1Â°C over[0m
[32m2025-10-28 00:30:32.964 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.71Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 2.1Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.5Â°C; Safety: +0.5Â°C; Adjusted: 27.0Â°C; Current: 30.5Â°C â†’ offset: -2.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -294) | GE-Spot Q2: CHEAP (night) | Too warm: 2.1Â°C over[0m
[36m2025-10-28 00:30:32.964 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Skipping offset write, too soon since last write[0m
[36m2025-10-28 00:30:32.964 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.71Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-28 00:30:32.964 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.550 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 00:30:32.964 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.1Â°C, outdoor=6.2Â°C, offset=0.7Â°C, change=0.02Â°C, Î”t=0.08h[0m
[36m2025-10-28 00:30:32.964 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.1Â°C, outdoor=6.2Â°C, offset=0.7Â°C, flow=30.5Â°C, DM=-294[0m
[36m2025-10-28 00:30:32.964 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-28 00:30:32.964 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 00:30:32.966 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 00:30:32.966 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 00:30:32.966 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=37.1[0m
[36m2025-10-28 00:30:32.967 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-28 00:30:32.975 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 00:30:32.975 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-28 00:30:32.975 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 6.2Â°C (zone: Moderate Cold): block=-356, abort=-436[0m
[36m2025-10-28 00:30:32.975 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-28 00:30:32.975 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-294, warning=-356, threshold=-178, has_capacity=False[0m
[36m2025-10-28 00:30:32.975 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 24 quarters available, need 3 quarters (45 min), lookahead 6.0h[0m
[36m2025-10-28 00:30:32.975 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 22 windows evaluated[0m
[36m2025-10-28 00:30:32.975 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (3.2h away) â† SELECTED[0m
[36m2025-10-28 00:30:32.975 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (3.0h away)[0m
[36m2025-10-28 00:30:32.975 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (3.5h away)[0m
[36m2025-10-28 00:30:32.975 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (2.7h away)[0m
[36m2025-10-28 00:30:32.975 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (2.5h away)[0m
[32m2025-10-28 00:30:32.976 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 3.2h away[0m
[36m2025-10-28 00:30:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-28 00:30:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-294, warning=-356, threshold=-178, has_capacity=False[0m
[36m2025-10-28 00:30:32.977 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 00:30:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-28 00:30:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 6.2Â°C (zone: Moderate Cold): block=-356, abort=-436[0m
[36m2025-10-28 00:30:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-28 00:30:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-294, warning=-356, threshold=-178, has_capacity=False[0m
[36m2025-10-28 00:30:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 24 quarters available, need 3 quarters (45 min), lookahead 6.0h[0m
[36m2025-10-28 00:30:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 22 windows evaluated[0m
[36m2025-10-28 00:30:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (3.2h away) â† SELECTED[0m
[36m2025-10-28 00:30:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (3.0h away)[0m
[36m2025-10-28 00:30:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (3.5h away)[0m
[36m2025-10-28 00:30:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (2.7h away)[0m
[36m2025-10-28 00:30:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (2.5h away)[0m
[32m2025-10-28 00:30:32.978 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 3.2h away[0m
[36m2025-10-28 00:30:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.2Â°C (zone avg: -1.0Â°C, delta: 7.2Â°C): normal -156 to -356, warning -356, critical -1500[0m
[36m2025-10-28 00:30:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-294, warning=-356, threshold=-178, has_capacity=False[0m
[36m2025-10-28 00:30:32.978 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 00:30:32.978 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.019 seconds (success: True)[0m
[36m2025-10-28 00:30:32.979 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (6.2 + 0.6 + 0.9)A Ã— 0.95 = 1.76 kW[0m
[36m2025-10-28 00:30:32.980 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 00:35:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 00:35:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.1Â°C (median of 9 sensors: 23.6Â°C, 21.2Â°C, 21.4Â°C, 23.1Â°C, 24.9Â°C, 23.9Â°C, 22.3Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-28 00:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -295.0[0m
[36m2025-10-28 00:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 37.1Â°C[0m
[36m2025-10-28 00:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.5Â°C[0m
[36m2025-10-28 00:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=6.2A, L2=0.6A, L3=0.9A[0m
[36m2025-10-28 00:35:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.1Â°C, outdoor 6.7Â°C, flow 30.5Â°C, DM -295[0m
[36m2025-10-28 00:35:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 38 Hz (1h avg: 37, 6h avg: 50, mode: space) - OK: Normal operation (38 Hz, 6h avg: 50 Hz)[0m
[36m2025-10-28 00:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 00:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 00:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 00:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 00:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 00:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 00:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 00:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 00:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 00:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 00:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 93}[0m
[36m2025-10-28 00:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 00:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 00:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 00:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 00:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 00:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 00:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 00:35:32.961 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 00:35:32.961 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q2 = 37.16 Ã¶re/kWh[0m
[36m2025-10-28 00:35:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 00:35:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 00:35:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 00:35:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 00:35:32.962 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 00:35:32.962 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-28 00:35:32.962 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 00:35:32.963 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 00:35:32.963 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-28 00:35:32.963 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 00:35:32.963 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 6.7Â°C: normal -146 to -346, warning -346[0m
[36m2025-10-28 00:35:32.963 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 00:35:32.963 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -346 (base: -346), critical -1500[0m
[36m2025-10-28 00:35:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=6.7Â°C, indoor_target=21.0Â°C, temp_diff=14.3Â°C, HC=0.180 kW/K -> flow=26.3Â°C[0m
[36m2025-10-28 00:35:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 00:35:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 00:35:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.8Â°C, current=30.5Â°C, error=-3.7Â°C, sensitivity=1.5 -> offset=-2.4[0m
[36m2025-10-28 00:35:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=6.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 00:35:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.3Â°C; Safety: +0.5Â°C; Adjusted: 26.8Â°C; Current: 30.5Â°C â†’ offset: -2.4Â°C; Weight: 0.20; Deferred: Moderate debt (DM -295)[0m
[36m2025-10-28 00:35:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Price classification Q2 (00:35): 37.16 â†’ CHEAP[0m
[32m2025-10-28 00:35:32.964 INFO (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.70Â°C - Learned pre-heat: Pre-heating: predicted drop 2.0Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.3Â°C; Safety: +0.5Â°C; Adjusted: 26.8Â°C; Current: 30.5Â°C â†’ offset: -2.4Â°C; Weight: 0.20; Deferred: Moderate debt (DM -295) | GE-Spot Q2: CHEAP (night) | Too warm: 2.1Â°C over[0m
[32m2025-10-28 00:35:32.966 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.70Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 2.0Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.3Â°C; Safety: +0.5Â°C; Adjusted: 26.8Â°C; Current: 30.5Â°C â†’ offset: -2.4Â°C; Weight: 0.20; Deferred: Moderate debt (DM -295) | GE-Spot Q2: CHEAP (night) | Too warm: 2.1Â°C over[0m
[36m2025-10-28 00:35:32.966 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.70Â°C, integer=0Â°C, fractional=0.70Â°C, accumulator_before=0.66Â°C[0m
[32m2025-10-28 00:35:32.966 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] âœ“ Accumulated fractional offset reached threshold: applying +1Â°C adjustment (accumulator: 1.36Â°C â†’ 0.36Â°C)[0m
[36m2025-10-28 00:35:32.966 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Accumulator triggered: total_accumulated=1.36Â°C, adjustment=+1Â°C, new_integer=1Â°C, remaining=0.36Â°C[0m
[36m2025-10-28 00:35:32.966 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset 0.70Â°C â†’ applying 1Â°C (accumulator: 0.36Â°C, needs 0.64Â°C more to trigger)[0m
[32m2025-10-28 00:35:32.967 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to 1Â°C (calculated: 0.70Â°C, accumulator: 0.36Â°C)[0m
[36m2025-10-28 00:35:32.967 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=1Â°C, original=0.70Â°C, accumulator=0.36Â°C[0m
[32m2025-10-28 00:35:32.967 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset 0.70Â°C to NIBE via MyUplink[0m
[36m2025-10-28 00:35:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.599 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 00:35:32.967 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.1Â°C, outdoor=6.7Â°C, offset=0.7Â°C, change=0.01Â°C, Î”t=0.08h[0m
[36m2025-10-28 00:35:32.967 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.1Â°C, outdoor=6.7Â°C, offset=0.7Â°C, flow=30.5Â°C, DM=-295[0m
[36m2025-10-28 00:35:32.976 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.1Â°C/h trend[0m
[36m2025-10-28 00:35:32.976 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 00:35:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 00:35:32.978 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 00:35:32.978 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=37.1[0m
[36m2025-10-28 00:35:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 00:35:32.980 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 00:35:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 00:35:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 6.7Â°C (zone: Moderate Cold): block=-346, abort=-426[0m
[36m2025-10-28 00:35:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 00:35:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-295, warning=-346, threshold=-173, has_capacity=False[0m
[36m2025-10-28 00:35:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 24 quarters available, need 3 quarters (45 min), lookahead 6.0h[0m
[36m2025-10-28 00:35:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 22 windows evaluated[0m
[36m2025-10-28 00:35:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (3.2h away) â† SELECTED[0m
[36m2025-10-28 00:35:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (2.9h away)[0m
[36m2025-10-28 00:35:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (3.4h away)[0m
[36m2025-10-28 00:35:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (2.7h away)[0m
[36m2025-10-28 00:35:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (2.4h away)[0m
[32m2025-10-28 00:35:32.981 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 3.2h away[0m
[36m2025-10-28 00:35:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 00:35:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-295, warning=-346, threshold=-173, has_capacity=False[0m
[36m2025-10-28 00:35:32.985 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 00:35:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 00:35:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 6.7Â°C (zone: Moderate Cold): block=-346, abort=-426[0m
[36m2025-10-28 00:35:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 00:35:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-295, warning=-346, threshold=-173, has_capacity=False[0m
[36m2025-10-28 00:35:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 24 quarters available, need 3 quarters (45 min), lookahead 6.0h[0m
[36m2025-10-28 00:35:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 22 windows evaluated[0m
[36m2025-10-28 00:35:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (3.2h away) â† SELECTED[0m
[36m2025-10-28 00:35:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (2.9h away)[0m
[36m2025-10-28 00:35:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (3.4h away)[0m
[36m2025-10-28 00:35:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (2.7h away)[0m
[36m2025-10-28 00:35:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (2.4h away)[0m
[32m2025-10-28 00:35:32.986 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 3.2h away[0m
[36m2025-10-28 00:35:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 00:35:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-295, warning=-346, threshold=-173, has_capacity=False[0m
[36m2025-10-28 00:35:32.986 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 00:35:32.986 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.027 seconds (success: True)[0m
[36m2025-10-28 00:35:32.987 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (6.2 + 0.6 + 0.9)A Ã— 0.95 = 1.76 kW[0m
[36m2025-10-28 00:35:32.988 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 00:40:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 00:40:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.2Â°C (median of 9 sensors: 23.6Â°C, 21.2Â°C, 21.4Â°C, 23.2Â°C, 24.9Â°C, 23.9Â°C, 22.3Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-28 00:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -296.0[0m
[36m2025-10-28 00:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 37.1Â°C[0m
[36m2025-10-28 00:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.5Â°C[0m
[36m2025-10-28 00:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=6.2A, L2=0.6A, L3=0.9A[0m
[36m2025-10-28 00:40:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.2Â°C, outdoor 6.7Â°C, flow 30.5Â°C, DM -296[0m
[36m2025-10-28 00:40:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 39 Hz (1h avg: 37, 6h avg: 49, mode: space) - OK: Normal operation (39 Hz, 6h avg: 49 Hz)[0m
[36m2025-10-28 00:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 00:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 00:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 00:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 00:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 00:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 00:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 00:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 00:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 00:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 00:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 93}[0m
[36m2025-10-28 00:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 00:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 00:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 00:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 00:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 00:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 00:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 00:40:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 00:40:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q2 = 37.16 Ã¶re/kWh[0m
[36m2025-10-28 00:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 00:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 00:40:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 00:40:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 00:40:32.961 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 00:40:32.961 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-28 00:40:32.961 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 00:40:32.962 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 00:40:32.962 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-28 00:40:32.962 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 00:40:32.962 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 6.7Â°C: normal -146 to -346, warning -346[0m
[36m2025-10-28 00:40:32.962 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 00:40:32.963 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -346 (base: -346), critical -1500[0m
[36m2025-10-28 00:40:32.963 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=6.7Â°C, indoor_target=21.0Â°C, temp_diff=14.3Â°C, HC=0.180 kW/K -> flow=26.3Â°C[0m
[36m2025-10-28 00:40:32.963 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 00:40:32.963 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 00:40:32.963 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.8Â°C, current=30.5Â°C, error=-3.7Â°C, sensitivity=1.5 -> offset=-2.4[0m
[36m2025-10-28 00:40:32.963 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=6.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 00:40:32.963 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.3Â°C; Safety: +0.5Â°C; Adjusted: 26.8Â°C; Current: 30.5Â°C â†’ offset: -2.4Â°C; Weight: 0.20; Deferred: Moderate debt (DM -296)[0m
[36m2025-10-28 00:40:32.963 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Price classification Q2 (00:40): 37.16 â†’ CHEAP[0m
[32m2025-10-28 00:40:32.963 INFO (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.69Â°C - Learned pre-heat: Pre-heating: predicted drop 2.0Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.3Â°C; Safety: +0.5Â°C; Adjusted: 26.8Â°C; Current: 30.5Â°C â†’ offset: -2.4Â°C; Weight: 0.20; Deferred: Moderate debt (DM -296) | GE-Spot Q2: CHEAP (night) | Too warm: 2.2Â°C over[0m
[32m2025-10-28 00:40:32.964 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.69Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 2.0Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.3Â°C; Safety: +0.5Â°C; Adjusted: 26.8Â°C; Current: 30.5Â°C â†’ offset: -2.4Â°C; Weight: 0.20; Deferred: Moderate debt (DM -296) | GE-Spot Q2: CHEAP (night) | Too warm: 2.2Â°C over[0m
[36m2025-10-28 00:40:32.964 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.69Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-28 00:40:32.964 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.627 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 00:40:32.964 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.2Â°C, outdoor=6.7Â°C, offset=0.7Â°C, change=0.07Â°C, Î”t=0.08h[0m
[36m2025-10-28 00:40:32.964 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.2Â°C, outdoor=6.7Â°C, offset=0.7Â°C, flow=30.5Â°C, DM=-296[0m
[36m2025-10-28 00:40:32.964 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-28 00:40:32.964 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 00:40:32.967 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 00:40:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 00:40:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=37.1[0m
[36m2025-10-28 00:40:32.967 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 00:40:32.969 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 00:40:32.969 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 00:40:32.969 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 6.7Â°C (zone: Moderate Cold): block=-346, abort=-426[0m
[36m2025-10-28 00:40:32.969 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 00:40:32.969 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-296, warning=-346, threshold=-173, has_capacity=False[0m
[36m2025-10-28 00:40:32.969 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 24 quarters available, need 3 quarters (45 min), lookahead 6.0h[0m
[36m2025-10-28 00:40:32.969 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 22 windows evaluated[0m
[36m2025-10-28 00:40:32.969 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (3.1h away) â† SELECTED[0m
[36m2025-10-28 00:40:32.969 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (2.8h away)[0m
[36m2025-10-28 00:40:32.970 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (3.3h away)[0m
[36m2025-10-28 00:40:32.970 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (2.6h away)[0m
[36m2025-10-28 00:40:32.970 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (2.3h away)[0m
[32m2025-10-28 00:40:32.970 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 3.1h away[0m
[36m2025-10-28 00:40:32.970 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 00:40:32.970 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-296, warning=-346, threshold=-173, has_capacity=False[0m
[36m2025-10-28 00:40:32.974 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 00:40:32.975 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 00:40:32.975 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 6.7Â°C (zone: Moderate Cold): block=-346, abort=-426[0m
[36m2025-10-28 00:40:32.975 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 00:40:32.975 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-296, warning=-346, threshold=-173, has_capacity=False[0m
[36m2025-10-28 00:40:32.975 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 24 quarters available, need 3 quarters (45 min), lookahead 6.0h[0m
[36m2025-10-28 00:40:32.975 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 22 windows evaluated[0m
[36m2025-10-28 00:40:32.975 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (3.1h away) â† SELECTED[0m
[36m2025-10-28 00:40:32.975 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (2.8h away)[0m
[36m2025-10-28 00:40:32.975 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (3.3h away)[0m
[36m2025-10-28 00:40:32.975 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (2.6h away)[0m
[36m2025-10-28 00:40:32.975 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (2.3h away)[0m
[32m2025-10-28 00:40:32.975 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 3.1h away[0m
[36m2025-10-28 00:40:32.975 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 00:40:32.975 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-296, warning=-346, threshold=-173, has_capacity=False[0m
[36m2025-10-28 00:40:32.975 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 00:40:32.976 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.017 seconds (success: True)[0m
[36m2025-10-28 00:40:32.977 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (6.2 + 0.6 + 0.9)A Ã— 0.95 = 1.76 kW[0m
[36m2025-10-28 00:40:32.977 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 00:45:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 00:45:32.960 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.2Â°C (median of 9 sensors: 23.6Â°C, 21.2Â°C, 21.5Â°C, 23.2Â°C, 24.9Â°C, 23.9Â°C, 22.3Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-28 00:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -295.0[0m
[36m2025-10-28 00:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 37.1Â°C[0m
[36m2025-10-28 00:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.5Â°C[0m
[36m2025-10-28 00:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=6.2A, L2=0.6A, L3=0.9A[0m
[36m2025-10-28 00:45:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.2Â°C, outdoor 6.7Â°C, flow 30.5Â°C, DM -295[0m
[36m2025-10-28 00:45:32.961 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 39 Hz (1h avg: 38, 6h avg: 49, mode: space) - OK: Normal operation (39 Hz, 6h avg: 49 Hz)[0m
[36m2025-10-28 00:45:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 00:45:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 00:45:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 00:45:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 00:45:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 00:45:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 00:45:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 00:45:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 00:45:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 00:45:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 00:45:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 92}[0m
[36m2025-10-28 00:45:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 00:45:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 00:45:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 00:45:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 00:45:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 00:45:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 00:45:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 00:45:32.961 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 00:45:32.961 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q3 = 27.38 Ã¶re/kWh[0m
[36m2025-10-28 00:45:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 00:45:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 00:45:32.963 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 00:45:32.963 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 00:45:32.963 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 00:45:32.963 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 7.2Â°C, 48 hours forecast[0m
[36m2025-10-28 00:45:32.963 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 00:45:32.964 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 00:45:32.964 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-28 00:45:32.964 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 00:45:32.964 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 6.7Â°C: normal -146 to -346, warning -346[0m
[36m2025-10-28 00:45:32.964 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 00:45:32.964 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -346 (base: -346), critical -1500[0m
[36m2025-10-28 00:45:32.965 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=6.7Â°C, indoor_target=21.0Â°C, temp_diff=14.3Â°C, HC=0.180 kW/K -> flow=26.3Â°C[0m
[36m2025-10-28 00:45:32.965 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 00:45:32.965 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 00:45:32.965 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.8Â°C, current=30.5Â°C, error=-3.7Â°C, sensitivity=1.5 -> offset=-2.4[0m
[36m2025-10-28 00:45:32.965 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=6.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 00:45:32.965 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.3Â°C; Safety: +0.5Â°C; Adjusted: 26.8Â°C; Current: 30.5Â°C â†’ offset: -2.4Â°C; Weight: 0.20; Deferred: Moderate debt (DM -295)[0m
[36m2025-10-28 00:45:32.965 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Price classification Q3 (00:45): 27.38 â†’ CHEAP[0m
[32m2025-10-28 00:45:32.965 INFO (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.68Â°C - Learned pre-heat: Pre-heating: predicted drop 2.1Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.3Â°C; Safety: +0.5Â°C; Adjusted: 26.8Â°C; Current: 30.5Â°C â†’ offset: -2.4Â°C; Weight: 0.20; Deferred: Moderate debt (DM -295) | GE-Spot Q3: CHEAP (night) | Too warm: 2.2Â°C over[0m
[32m2025-10-28 00:45:32.966 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.68Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 2.1Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.3Â°C; Safety: +0.5Â°C; Adjusted: 26.8Â°C; Current: 30.5Â°C â†’ offset: -2.4Â°C; Weight: 0.20; Deferred: Moderate debt (DM -295) | GE-Spot Q3: CHEAP (night) | Too warm: 2.2Â°C over[0m
[36m2025-10-28 00:45:32.966 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.68Â°C, integer=0Â°C, fractional=0.68Â°C, accumulator_before=0.36Â°C[0m
[32m2025-10-28 00:45:32.966 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] âœ“ Accumulated fractional offset reached threshold: applying +1Â°C adjustment (accumulator: 1.04Â°C â†’ 0.04Â°C)[0m
[36m2025-10-28 00:45:32.966 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Accumulator triggered: total_accumulated=1.04Â°C, adjustment=+1Â°C, new_integer=1Â°C, remaining=0.04Â°C[0m
[36m2025-10-28 00:45:32.966 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset 0.68Â°C â†’ applying 1Â°C (accumulator: 0.04Â°C, needs 0.96Â°C more to trigger)[0m
[32m2025-10-28 00:45:32.967 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to 1Â°C (calculated: 0.68Â°C, accumulator: 0.04Â°C)[0m
[36m2025-10-28 00:45:32.967 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=1Â°C, original=0.68Â°C, accumulator=0.04Â°C[0m
[32m2025-10-28 00:45:32.967 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset 0.68Â°C to NIBE via MyUplink[0m
[36m2025-10-28 00:45:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.623 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 00:45:32.967 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.2Â°C, outdoor=6.7Â°C, offset=0.7Â°C, change=0.07Â°C, Î”t=0.08h[0m
[36m2025-10-28 00:45:32.968 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.2Â°C, outdoor=6.7Â°C, offset=0.7Â°C, flow=30.5Â°C, DM=-295[0m
[36m2025-10-28 00:45:32.972 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.1Â°C/h trend[0m
[36m2025-10-28 00:45:32.972 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 00:45:32.978 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved learned data to storage[0m
[36m2025-10-28 00:45:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 00:45:32.978 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 00:45:32.978 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=37.1[0m
[36m2025-10-28 00:45:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 00:45:32.981 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 00:45:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 00:45:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 6.7Â°C (zone: Moderate Cold): block=-346, abort=-426[0m
[36m2025-10-28 00:45:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 00:45:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-295, warning=-346, threshold=-173, has_capacity=False[0m
[36m2025-10-28 00:45:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 24 quarters available, need 3 quarters (45 min), lookahead 6.0h[0m
[36m2025-10-28 00:45:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 22 windows evaluated[0m
[36m2025-10-28 00:45:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (3.0h away) â† SELECTED[0m
[36m2025-10-28 00:45:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (2.7h away)[0m
[36m2025-10-28 00:45:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (3.2h away)[0m
[36m2025-10-28 00:45:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (2.5h away)[0m
[36m2025-10-28 00:45:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (2.2h away)[0m
[32m2025-10-28 00:45:32.982 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 3.0h away[0m
[36m2025-10-28 00:45:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 00:45:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-295, warning=-346, threshold=-173, has_capacity=False[0m
[36m2025-10-28 00:45:32.989 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 00:45:32.989 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 00:45:32.989 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 6.7Â°C (zone: Moderate Cold): block=-346, abort=-426[0m
[36m2025-10-28 00:45:32.989 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 00:45:32.989 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-295, warning=-346, threshold=-173, has_capacity=False[0m
[36m2025-10-28 00:45:32.989 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 24 quarters available, need 3 quarters (45 min), lookahead 6.0h[0m
[36m2025-10-28 00:45:32.990 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 22 windows evaluated[0m
[36m2025-10-28 00:45:32.990 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (3.0h away) â† SELECTED[0m
[36m2025-10-28 00:45:32.990 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (2.7h away)[0m
[36m2025-10-28 00:45:32.990 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (3.2h away)[0m
[36m2025-10-28 00:45:32.990 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (2.5h away)[0m
[36m2025-10-28 00:45:32.990 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (2.2h away)[0m
[32m2025-10-28 00:45:32.990 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 3.0h away[0m
[36m2025-10-28 00:45:32.990 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 00:45:32.990 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-295, warning=-346, threshold=-173, has_capacity=False[0m
[36m2025-10-28 00:45:32.990 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 00:45:32.990 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.030 seconds (success: True)[0m
[36m2025-10-28 00:45:32.992 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (6.2 + 0.6 + 0.9)A Ã— 0.95 = 1.76 kW[0m
[36m2025-10-28 00:45:32.992 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 00:50:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 00:50:32.960 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.3Â°C (median of 9 sensors: 23.6Â°C, 21.2Â°C, 21.5Â°C, 23.3Â°C, 24.9Â°C, 23.9Â°C, 22.3Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-28 00:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -292.0[0m
[36m2025-10-28 00:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 37.1Â°C[0m
[36m2025-10-28 00:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 31.0Â°C[0m
[36m2025-10-28 00:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=6.2A, L2=0.6A, L3=0.9A[0m
[36m2025-10-28 00:50:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.3Â°C, outdoor 6.7Â°C, flow 31.0Â°C, DM -292[0m
[36m2025-10-28 00:50:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 39 Hz (1h avg: 38, 6h avg: 49, mode: space) - OK: Normal operation (39 Hz, 6h avg: 49 Hz)[0m
[36m2025-10-28 00:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 00:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 00:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 00:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 00:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 00:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 00:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 00:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 00:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 00:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 00:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 92}[0m
[36m2025-10-28 00:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 00:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 00:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 00:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 00:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 00:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 00:50:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 00:50:32.961 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 00:50:32.961 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q3 = 27.38 Ã¶re/kWh[0m
[36m2025-10-28 00:50:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 00:50:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 00:50:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 00:50:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 00:50:32.962 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 00:50:32.962 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 7.2Â°C, 48 hours forecast[0m
[36m2025-10-28 00:50:32.962 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 00:50:32.963 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 00:50:32.963 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-28 00:50:32.963 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 00:50:32.963 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 6.7Â°C: normal -146 to -346, warning -346[0m
[36m2025-10-28 00:50:32.963 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 00:50:32.963 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -346 (base: -346), critical -1500[0m
[36m2025-10-28 00:50:32.964 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=6.7Â°C, indoor_target=21.0Â°C, temp_diff=14.3Â°C, HC=0.180 kW/K -> flow=26.3Â°C[0m
[36m2025-10-28 00:50:32.964 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 00:50:32.964 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 00:50:32.964 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.8Â°C, current=31.0Â°C, error=-4.2Â°C, sensitivity=1.5 -> offset=-2.8[0m
[36m2025-10-28 00:50:32.964 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=6.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 00:50:32.964 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.3Â°C; Safety: +0.5Â°C; Adjusted: 26.8Â°C; Current: 31.0Â°C â†’ offset: -2.8Â°C; Weight: 0.20; Deferred: Moderate debt (DM -292)[0m
[36m2025-10-28 00:50:32.964 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Price classification Q3 (00:50): 27.38 â†’ CHEAP[0m
[32m2025-10-28 00:50:32.964 INFO (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.65Â°C - Learned pre-heat: Pre-heating: predicted drop 2.1Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.3Â°C; Safety: +0.5Â°C; Adjusted: 26.8Â°C; Current: 31.0Â°C â†’ offset: -2.8Â°C; Weight: 0.20; Deferred: Moderate debt (DM -292) | GE-Spot Q3: CHEAP (night) | Too warm: 2.3Â°C over[0m
[32m2025-10-28 00:50:32.965 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.65Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 2.1Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.3Â°C; Safety: +0.5Â°C; Adjusted: 26.8Â°C; Current: 31.0Â°C â†’ offset: -2.8Â°C; Weight: 0.20; Deferred: Moderate debt (DM -292) | GE-Spot Q3: CHEAP (night) | Too warm: 2.3Â°C over[0m
[36m2025-10-28 00:50:32.965 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Skipping offset write, too soon since last write[0m
[36m2025-10-28 00:50:32.965 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.65Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-28 00:50:32.965 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.628 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 00:50:32.965 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.3Â°C, outdoor=6.7Â°C, offset=0.6Â°C, change=0.01Â°C, Î”t=0.08h[0m
[36m2025-10-28 00:50:32.965 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.3Â°C, outdoor=6.7Â°C, offset=0.6Â°C, flow=31.0Â°C, DM=-292[0m
[36m2025-10-28 00:50:32.965 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-28 00:50:32.966 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 00:50:32.967 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 00:50:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 00:50:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=37.1[0m
[36m2025-10-28 00:50:32.968 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 00:50:32.977 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 00:50:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 00:50:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 6.7Â°C (zone: Moderate Cold): block=-346, abort=-426[0m
[36m2025-10-28 00:50:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 00:50:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-292, warning=-346, threshold=-173, has_capacity=False[0m
[36m2025-10-28 00:50:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 24 quarters available, need 3 quarters (45 min), lookahead 6.0h[0m
[36m2025-10-28 00:50:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 22 windows evaluated[0m
[36m2025-10-28 00:50:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (2.9h away) â† SELECTED[0m
[36m2025-10-28 00:50:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (2.7h away)[0m
[36m2025-10-28 00:50:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (3.2h away)[0m
[36m2025-10-28 00:50:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (2.4h away)[0m
[36m2025-10-28 00:50:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (2.2h away)[0m
[32m2025-10-28 00:50:32.977 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 2.9h away[0m
[36m2025-10-28 00:50:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 00:50:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-292, warning=-346, threshold=-173, has_capacity=False[0m
[36m2025-10-28 00:50:32.980 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 00:50:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 00:50:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 6.7Â°C (zone: Moderate Cold): block=-346, abort=-426[0m
[36m2025-10-28 00:50:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 00:50:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-292, warning=-346, threshold=-173, has_capacity=False[0m
[36m2025-10-28 00:50:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 24 quarters available, need 3 quarters (45 min), lookahead 6.0h[0m
[36m2025-10-28 00:50:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 22 windows evaluated[0m
[36m2025-10-28 00:50:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (2.9h away) â† SELECTED[0m
[36m2025-10-28 00:50:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (2.7h away)[0m
[36m2025-10-28 00:50:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (3.2h away)[0m
[36m2025-10-28 00:50:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (2.4h away)[0m
[36m2025-10-28 00:50:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (2.2h away)[0m
[32m2025-10-28 00:50:32.981 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 2.9h away[0m
[36m2025-10-28 00:50:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 00:50:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-292, warning=-346, threshold=-173, has_capacity=False[0m
[36m2025-10-28 00:50:32.981 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 00:50:32.981 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.022 seconds (success: True)[0m
[36m2025-10-28 00:50:32.982 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (6.2 + 0.6 + 0.9)A Ã— 0.95 = 1.76 kW[0m
[36m2025-10-28 00:50:32.983 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 00:55:32.958 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 00:55:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.2Â°C (median of 9 sensors: 23.6Â°C, 21.2Â°C, 21.5Â°C, 23.2Â°C, 24.9Â°C, 24.0Â°C, 22.3Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-28 00:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -290.0[0m
[36m2025-10-28 00:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 36.6Â°C[0m
[36m2025-10-28 00:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 31.0Â°C[0m
[36m2025-10-28 00:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=6.2A, L2=0.6A, L3=0.9A[0m
[36m2025-10-28 00:55:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.2Â°C, outdoor 6.7Â°C, flow 31.0Â°C, DM -290[0m
[36m2025-10-28 00:55:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 37 Hz (1h avg: 38, 6h avg: 49, mode: space) - OK: Normal operation (37 Hz, 6h avg: 49 Hz)[0m
[36m2025-10-28 00:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 00:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 00:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 00:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 00:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 00:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 00:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 00:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 00:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 00:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 00:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 92}[0m
[36m2025-10-28 00:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 00:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 00:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 00:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 00:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 00:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 00:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 00:55:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 00:55:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q3 = 27.38 Ã¶re/kWh[0m
[36m2025-10-28 00:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 00:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 00:55:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 00:55:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 00:55:32.961 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 00:55:32.961 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 7.2Â°C, 48 hours forecast[0m
[36m2025-10-28 00:55:32.961 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 00:55:32.962 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 00:55:32.962 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-28 00:55:32.962 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 00:55:32.962 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 6.7Â°C: normal -146 to -346, warning -346[0m
[36m2025-10-28 00:55:32.962 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 00:55:32.962 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -346 (base: -346), critical -1500[0m
[36m2025-10-28 00:55:32.963 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=6.7Â°C, indoor_target=21.0Â°C, temp_diff=14.3Â°C, HC=0.180 kW/K -> flow=26.3Â°C[0m
[36m2025-10-28 00:55:32.963 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 00:55:32.963 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 00:55:32.963 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.8Â°C, current=31.0Â°C, error=-4.2Â°C, sensitivity=1.5 -> offset=-2.8[0m
[36m2025-10-28 00:55:32.963 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=6.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 00:55:32.963 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.3Â°C; Safety: +0.5Â°C; Adjusted: 26.8Â°C; Current: 31.0Â°C â†’ offset: -2.8Â°C; Weight: 0.20; Deferred: Moderate debt (DM -290)[0m
[36m2025-10-28 00:55:32.963 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Price classification Q3 (00:55): 27.38 â†’ CHEAP[0m
[32m2025-10-28 00:55:32.963 INFO (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.49Â°C - Learned pre-heat: Pre-heating: predicted drop 2.1Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.3Â°C; Safety: +0.5Â°C; Adjusted: 26.8Â°C; Current: 31.0Â°C â†’ offset: -2.8Â°C; Weight: 0.20; Deferred: Moderate debt (DM -290) | GE-Spot Q3: CHEAP (night) | Too warm: 2.2Â°C over (damped 25%: warming 0.31Â°C/h)[0m
[32m2025-10-28 00:55:32.964 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.49Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 2.1Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.3Â°C; Safety: +0.5Â°C; Adjusted: 26.8Â°C; Current: 31.0Â°C â†’ offset: -2.8Â°C; Weight: 0.20; Deferred: Moderate debt (DM -290) | GE-Spot Q3: CHEAP (night) | Too warm: 2.2Â°C over (damped 25%: warming 0.31Â°C/h)[0m
[36m2025-10-28 00:55:32.964 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.49Â°C, integer=0Â°C, fractional=0.49Â°C, accumulator_before=0.04Â°C[0m
[36m2025-10-28 00:55:32.964 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: 0.53Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-28 00:55:32.964 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.49Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-28 00:55:32.964 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.567 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 00:55:32.964 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.2Â°C, outdoor=6.7Â°C, offset=0.5Â°C, change=-0.05Â°C, Î”t=0.08h[0m
[36m2025-10-28 00:55:32.964 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.2Â°C, outdoor=6.7Â°C, offset=0.5Â°C, flow=31.0Â°C, DM=-290[0m
[36m2025-10-28 00:55:32.974 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.1Â°C/h trend[0m
[36m2025-10-28 00:55:32.974 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 00:55:32.975 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 00:55:32.975 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 00:55:32.975 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=36.6[0m
[36m2025-10-28 00:55:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 00:55:32.978 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 00:55:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 00:55:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 6.7Â°C (zone: Moderate Cold): block=-346, abort=-426[0m
[36m2025-10-28 00:55:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 00:55:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-290, warning=-346, threshold=-173, has_capacity=False[0m
[36m2025-10-28 00:55:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 24 quarters available, need 3 quarters (45 min), lookahead 6.0h[0m
[36m2025-10-28 00:55:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 22 windows evaluated[0m
[36m2025-10-28 00:55:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (2.8h away) â† SELECTED[0m
[36m2025-10-28 00:55:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (2.6h away)[0m
[36m2025-10-28 00:55:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (3.1h away)[0m
[36m2025-10-28 00:55:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (2.3h away)[0m
[36m2025-10-28 00:55:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (2.1h away)[0m
[32m2025-10-28 00:55:32.978 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 2.8h away[0m
[36m2025-10-28 00:55:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 00:55:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-290, warning=-346, threshold=-173, has_capacity=False[0m
[36m2025-10-28 00:55:32.982 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 00:55:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 00:55:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 6.7Â°C (zone: Moderate Cold): block=-346, abort=-426[0m
[36m2025-10-28 00:55:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 00:55:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-290, warning=-346, threshold=-173, has_capacity=False[0m
[36m2025-10-28 00:55:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 24 quarters available, need 3 quarters (45 min), lookahead 6.0h[0m
[36m2025-10-28 00:55:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 22 windows evaluated[0m
[36m2025-10-28 00:55:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (2.8h away) â† SELECTED[0m
[36m2025-10-28 00:55:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (2.6h away)[0m
[36m2025-10-28 00:55:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (3.1h away)[0m
[36m2025-10-28 00:55:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (2.3h away)[0m
[36m2025-10-28 00:55:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (2.1h away)[0m
[32m2025-10-28 00:55:32.983 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 2.8h away[0m
[36m2025-10-28 00:55:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 00:55:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-290, warning=-346, threshold=-173, has_capacity=False[0m
[36m2025-10-28 00:55:32.983 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 00:55:32.984 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.025 seconds (success: True)[0m
[36m2025-10-28 00:55:32.985 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (6.2 + 0.6 + 0.9)A Ã— 0.95 = 1.76 kW[0m
[36m2025-10-28 00:55:32.985 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 01:00:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 01:00:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.3Â°C (median of 9 sensors: 23.6Â°C, 21.2Â°C, 21.5Â°C, 23.3Â°C, 24.9Â°C, 23.9Â°C, 22.3Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-28 01:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -289.0[0m
[36m2025-10-28 01:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 36.6Â°C[0m
[36m2025-10-28 01:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 31.0Â°C[0m
[36m2025-10-28 01:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=6.2A, L2=0.6A, L3=0.9A[0m
[36m2025-10-28 01:00:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.3Â°C, outdoor 6.7Â°C, flow 31.0Â°C, DM -289[0m
[36m2025-10-28 01:00:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 36 Hz (1h avg: 38, 6h avg: 49, mode: space) - OK: Normal operation (36 Hz, 6h avg: 49 Hz)[0m
[36m2025-10-28 01:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 01:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 01:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 01:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 01:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 01:00:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 01:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 01:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 01:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 01:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 01:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 91}[0m
[36m2025-10-28 01:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 01:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 01:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 01:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 01:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 01:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 01:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 01:00:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 01:00:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q4 = 38.04 Ã¶re/kWh[0m
[36m2025-10-28 01:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 01:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 01:00:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 01:00:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 01:00:32.962 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 01:00:32.962 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 7.2Â°C, 48 hours forecast[0m
[36m2025-10-28 01:00:32.962 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 01:00:32.963 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 01:00:32.963 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-28 01:00:32.963 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 01:00:32.963 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 6.7Â°C: normal -146 to -346, warning -346[0m
[36m2025-10-28 01:00:32.963 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 01:00:32.963 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -346 (base: -346), critical -1500[0m
[36m2025-10-28 01:00:32.964 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=6.7Â°C, indoor_target=21.0Â°C, temp_diff=14.3Â°C, HC=0.180 kW/K -> flow=26.3Â°C[0m
[36m2025-10-28 01:00:32.964 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 01:00:32.964 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 01:00:32.964 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.8Â°C, current=31.0Â°C, error=-4.2Â°C, sensitivity=1.5 -> offset=-2.8[0m
[36m2025-10-28 01:00:32.964 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=6.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 01:00:32.964 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.3Â°C; Safety: +0.5Â°C; Adjusted: 26.8Â°C; Current: 31.0Â°C â†’ offset: -2.8Â°C; Weight: 0.20; Deferred: Moderate debt (DM -289)[0m
[36m2025-10-28 01:00:32.964 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Price classification Q4 (01:00): 38.04 â†’ CHEAP[0m
[32m2025-10-28 01:00:32.964 INFO (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.65Â°C - Learned pre-heat: Pre-heating: predicted drop 2.1Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.3Â°C; Safety: +0.5Â°C; Adjusted: 26.8Â°C; Current: 31.0Â°C â†’ offset: -2.8Â°C; Weight: 0.20; Deferred: Moderate debt (DM -289) | GE-Spot Q4: CHEAP (night) | Too warm: 2.3Â°C over[0m
[32m2025-10-28 01:00:32.967 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.65Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 2.1Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.3Â°C; Safety: +0.5Â°C; Adjusted: 26.8Â°C; Current: 31.0Â°C â†’ offset: -2.8Â°C; Weight: 0.20; Deferred: Moderate debt (DM -289) | GE-Spot Q4: CHEAP (night) | Too warm: 2.3Â°C over[0m
[36m2025-10-28 01:00:32.967 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.65Â°C, integer=0Â°C, fractional=0.65Â°C, accumulator_before=0.53Â°C[0m
[32m2025-10-28 01:00:32.967 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] âœ“ Accumulated fractional offset reached threshold: applying +1Â°C adjustment (accumulator: 1.18Â°C â†’ 0.18Â°C)[0m
[36m2025-10-28 01:00:32.967 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Accumulator triggered: total_accumulated=1.18Â°C, adjustment=+1Â°C, new_integer=1Â°C, remaining=0.18Â°C[0m
[36m2025-10-28 01:00:32.967 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset 0.65Â°C â†’ applying 1Â°C (accumulator: 0.18Â°C, needs 0.82Â°C more to trigger)[0m
[32m2025-10-28 01:00:32.970 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to 1Â°C (calculated: 0.65Â°C, accumulator: 0.18Â°C)[0m
[36m2025-10-28 01:00:32.970 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=1Â°C, original=0.65Â°C, accumulator=0.18Â°C[0m
[32m2025-10-28 01:00:32.971 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset 0.65Â°C to NIBE via MyUplink[0m
[36m2025-10-28 01:00:32.971 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.632 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 01:00:32.971 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.3Â°C, outdoor=6.7Â°C, offset=0.6Â°C, change=0.07Â°C, Î”t=0.08h[0m
[36m2025-10-28 01:00:32.971 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.3Â°C, outdoor=6.7Â°C, offset=0.6Â°C, flow=31.0Â°C, DM=-289[0m
[36m2025-10-28 01:00:32.976 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.3Â°C/h trend[0m
[36m2025-10-28 01:00:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.weather_learning] Recorded weather pattern 10-4: avg=7.7Â°C, range=4.3Â°C, volatility=1.2[0m
[36m2025-10-28 01:00:32.977 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded weather pattern for 2025-10-28[0m
[36m2025-10-28 01:00:32.977 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 01:00:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 01:00:32.978 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 01:00:32.978 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=36.6[0m
[36m2025-10-28 01:00:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 01:00:32.982 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 01:00:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 01:00:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 6.7Â°C (zone: Moderate Cold): block=-346, abort=-426[0m
[36m2025-10-28 01:00:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 01:00:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-289, warning=-346, threshold=-173, has_capacity=False[0m
[36m2025-10-28 01:00:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 20 quarters available, need 3 quarters (45 min), lookahead 5.0h[0m
[36m2025-10-28 01:00:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 18 windows evaluated[0m
[36m2025-10-28 01:00:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (2.7h away) â† SELECTED[0m
[36m2025-10-28 01:00:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (2.5h away)[0m
[36m2025-10-28 01:00:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (3.0h away)[0m
[36m2025-10-28 01:00:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (2.2h away)[0m
[36m2025-10-28 01:00:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (2.0h away)[0m
[32m2025-10-28 01:00:32.983 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 2.7h away[0m
[36m2025-10-28 01:00:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 01:00:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-289, warning=-346, threshold=-173, has_capacity=False[0m
[36m2025-10-28 01:00:32.990 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 01:00:32.991 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 01:00:32.991 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 6.7Â°C (zone: Moderate Cold): block=-346, abort=-426[0m
[36m2025-10-28 01:00:32.991 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 01:00:32.991 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-289, warning=-346, threshold=-173, has_capacity=False[0m
[36m2025-10-28 01:00:32.991 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 20 quarters available, need 3 quarters (45 min), lookahead 5.0h[0m
[36m2025-10-28 01:00:32.991 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 18 windows evaluated[0m
[36m2025-10-28 01:00:32.991 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (2.7h away) â† SELECTED[0m
[36m2025-10-28 01:00:32.991 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (2.5h away)[0m
[36m2025-10-28 01:00:32.991 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (3.0h away)[0m
[36m2025-10-28 01:00:32.991 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (2.2h away)[0m
[36m2025-10-28 01:00:32.991 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (2.0h away)[0m
[32m2025-10-28 01:00:32.991 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 2.7h away[0m
[36m2025-10-28 01:00:32.991 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 6.7Â°C (zone avg: -1.0Â°C, delta: 7.7Â°C): normal -146 to -346, warning -346, critical -1500[0m
[36m2025-10-28 01:00:32.991 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-289, warning=-346, threshold=-173, has_capacity=False[0m
[36m2025-10-28 01:00:32.991 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 01:00:32.992 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.033 seconds (success: True)[0m
[36m2025-10-28 01:00:32.993 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (6.2 + 0.6 + 0.9)A Ã— 0.95 = 1.76 kW[0m
[36m2025-10-28 01:00:32.993 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 01:05:32.958 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 01:05:32.958 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.3Â°C (median of 9 sensors: 23.6Â°C, 21.2Â°C, 21.4Â°C, 23.3Â°C, 24.9Â°C, 24.0Â°C, 22.3Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-28 01:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -285.0[0m
[36m2025-10-28 01:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 36.6Â°C[0m
[36m2025-10-28 01:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 31.0Â°C[0m
[36m2025-10-28 01:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=7.0A, L2=0.6A, L3=0.9A[0m
[36m2025-10-28 01:05:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.3Â°C, outdoor 7.2Â°C, flow 31.0Â°C, DM -285[0m
[36m2025-10-28 01:05:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 35 Hz (1h avg: 37, 6h avg: 48, mode: space) - OK: Normal operation (35 Hz, 6h avg: 48 Hz)[0m
[36m2025-10-28 01:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 01:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 01:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 01:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 01:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 01:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 01:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 01:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 01:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 01:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 01:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 91}[0m
[36m2025-10-28 01:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 01:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 01:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 01:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 01:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 01:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 01:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 01:05:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 01:05:32.962 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q4 = 38.04 Ã¶re/kWh[0m
[36m2025-10-28 01:05:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 01:05:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 01:05:32.964 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 01:05:32.964 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 01:05:32.964 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 01:05:32.964 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 7.2Â°C, 48 hours forecast[0m
[36m2025-10-28 01:05:32.965 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 01:05:32.966 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 01:05:32.966 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-28 01:05:32.966 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:05:32.966 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 7.2Â°C: normal -136 to -336, warning -336[0m
[36m2025-10-28 01:05:32.966 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:05:32.966 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -336 (base: -336), critical -1500[0m
[36m2025-10-28 01:05:32.966 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=7.2Â°C, indoor_target=21.0Â°C, temp_diff=13.8Â°C, HC=0.180 kW/K -> flow=26.2Â°C[0m
[36m2025-10-28 01:05:32.966 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 01:05:32.966 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 01:05:32.967 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.7Â°C, current=31.0Â°C, error=-4.3Â°C, sensitivity=1.5 -> offset=-2.9[0m
[36m2025-10-28 01:05:32.967 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=7.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 01:05:32.967 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 31.0Â°C â†’ offset: -2.9Â°C; Weight: 0.20; Deferred: Moderate debt (DM -285)[0m
[36m2025-10-28 01:05:32.967 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Price classification Q4 (01:05): 38.04 â†’ CHEAP[0m
[32m2025-10-28 01:05:32.967 INFO (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.48Â°C - Learned pre-heat: Pre-heating: predicted drop 2.0Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 31.0Â°C â†’ offset: -2.9Â°C; Weight: 0.20; Deferred: Moderate debt (DM -285) | GE-Spot Q4: CHEAP (night) | Too warm: 2.3Â°C over (damped 25%: warming 0.34Â°C/h)[0m
[32m2025-10-28 01:05:32.970 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.48Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 2.0Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 31.0Â°C â†’ offset: -2.9Â°C; Weight: 0.20; Deferred: Moderate debt (DM -285) | GE-Spot Q4: CHEAP (night) | Too warm: 2.3Â°C over (damped 25%: warming 0.34Â°C/h)[0m
[36m2025-10-28 01:05:32.970 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.48Â°C, integer=0Â°C, fractional=0.48Â°C, accumulator_before=0.18Â°C[0m
[36m2025-10-28 01:05:32.970 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: 0.65Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-28 01:05:32.970 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.48Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-28 01:05:32.970 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.703 kW from sensor.gen24_elnat_import_effekt[0m
[32m2025-10-28 01:05:32.970 INFO (MainThread) [custom_components.effektguard.coordinator] New daily peak: 1.70 kW at 01:05:32 (quarter 4, source: external_meter)[0m
[36m2025-10-28 01:05:32.970 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.3Â°C, outdoor=7.2Â°C, offset=0.5Â°C, change=0.02Â°C, Î”t=0.08h[0m
[36m2025-10-28 01:05:32.970 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.3Â°C, outdoor=7.2Â°C, offset=0.5Â°C, flow=31.0Â°C, DM=-285[0m
[36m2025-10-28 01:05:32.971 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-28 01:05:32.971 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 01:05:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 01:05:32.979 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 01:05:32.980 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=36.6[0m
[36m2025-10-28 01:05:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:05:32.984 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 01:05:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:05:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.2Â°C (zone: Moderate Cold): block=-336, abort=-416[0m
[36m2025-10-28 01:05:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:05:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-285, warning=-336, threshold=-168, has_capacity=False[0m
[36m2025-10-28 01:05:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 20 quarters available, need 3 quarters (45 min), lookahead 5.0h[0m
[36m2025-10-28 01:05:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 18 windows evaluated[0m
[36m2025-10-28 01:05:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (2.7h away) â† SELECTED[0m
[36m2025-10-28 01:05:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (2.4h away)[0m
[36m2025-10-28 01:05:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (2.9h away)[0m
[36m2025-10-28 01:05:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (2.2h away)[0m
[36m2025-10-28 01:05:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (1.9h away)[0m
[32m2025-10-28 01:05:32.987 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 2.7h away[0m
[36m2025-10-28 01:05:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:05:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-285, warning=-336, threshold=-168, has_capacity=False[0m
[36m2025-10-28 01:05:32.991 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 01:05:32.992 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:05:32.992 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.2Â°C (zone: Moderate Cold): block=-336, abort=-416[0m
[36m2025-10-28 01:05:32.992 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:05:32.992 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-285, warning=-336, threshold=-168, has_capacity=False[0m
[36m2025-10-28 01:05:32.992 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 20 quarters available, need 3 quarters (45 min), lookahead 5.0h[0m
[36m2025-10-28 01:05:32.992 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 18 windows evaluated[0m
[36m2025-10-28 01:05:32.992 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (2.7h away) â† SELECTED[0m
[36m2025-10-28 01:05:32.992 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (2.4h away)[0m
[36m2025-10-28 01:05:32.992 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (2.9h away)[0m
[36m2025-10-28 01:05:32.992 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (2.2h away)[0m
[36m2025-10-28 01:05:32.993 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (1.9h away)[0m
[32m2025-10-28 01:05:32.993 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 2.7h away[0m
[36m2025-10-28 01:05:32.993 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:05:32.993 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-285, warning=-336, threshold=-168, has_capacity=False[0m
[36m2025-10-28 01:05:32.993 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 01:05:32.993 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.035 seconds (success: True)[0m
[36m2025-10-28 01:05:32.995 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (7.0 + 0.6 + 0.9)A Ã— 0.95 = 1.94 kW[0m
[36m2025-10-28 01:05:32.995 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 01:10:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 01:10:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.3Â°C (median of 9 sensors: 23.6Â°C, 21.2Â°C, 21.4Â°C, 23.3Â°C, 24.9Â°C, 24.0Â°C, 22.3Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-28 01:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -282.0[0m
[36m2025-10-28 01:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 36.6Â°C[0m
[36m2025-10-28 01:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.5Â°C[0m
[36m2025-10-28 01:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=7.0A, L2=0.6A, L3=0.9A[0m
[36m2025-10-28 01:10:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.3Â°C, outdoor 7.2Â°C, flow 30.5Â°C, DM -282[0m
[36m2025-10-28 01:10:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 34 Hz (1h avg: 37, 6h avg: 48, mode: space) - OK: Normal operation (34 Hz, 6h avg: 48 Hz)[0m
[36m2025-10-28 01:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 01:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 01:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 01:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 01:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 01:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 01:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 01:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 01:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 01:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 01:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 91}[0m
[36m2025-10-28 01:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 01:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 01:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 01:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 01:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 01:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 01:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 01:10:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 01:10:32.961 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q4 = 38.04 Ã¶re/kWh[0m
[36m2025-10-28 01:10:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 01:10:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 01:10:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 01:10:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 01:10:32.962 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 01:10:32.962 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 7.2Â°C, 48 hours forecast[0m
[36m2025-10-28 01:10:32.962 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 01:10:32.964 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 01:10:32.964 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-28 01:10:32.964 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:10:32.964 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 7.2Â°C: normal -136 to -336, warning -336[0m
[36m2025-10-28 01:10:32.964 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:10:32.964 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -336 (base: -336), critical -1500[0m
[36m2025-10-28 01:10:32.964 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=7.2Â°C, indoor_target=21.0Â°C, temp_diff=13.8Â°C, HC=0.180 kW/K -> flow=26.2Â°C[0m
[36m2025-10-28 01:10:32.964 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 01:10:32.965 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 01:10:32.965 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.7Â°C, current=30.5Â°C, error=-3.8Â°C, sensitivity=1.5 -> offset=-2.5[0m
[36m2025-10-28 01:10:32.965 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=7.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 01:10:32.965 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 30.5Â°C â†’ offset: -2.5Â°C; Weight: 0.20; Deferred: Moderate debt (DM -282)[0m
[36m2025-10-28 01:10:32.965 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Price classification Q4 (01:10): 38.04 â†’ CHEAP[0m
[32m2025-10-28 01:10:32.965 INFO (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.50Â°C - Learned pre-heat: Pre-heating: predicted drop 2.0Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 30.5Â°C â†’ offset: -2.5Â°C; Weight: 0.20; Deferred: Moderate debt (DM -282) | GE-Spot Q4: CHEAP (night) | Too warm: 2.3Â°C over (damped 25%: warming 0.34Â°C/h)[0m
[32m2025-10-28 01:10:32.965 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.50Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 2.0Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 30.5Â°C â†’ offset: -2.5Â°C; Weight: 0.20; Deferred: Moderate debt (DM -282) | GE-Spot Q4: CHEAP (night) | Too warm: 2.3Â°C over (damped 25%: warming 0.34Â°C/h)[0m
[36m2025-10-28 01:10:32.965 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.50Â°C, integer=0Â°C, fractional=0.50Â°C, accumulator_before=0.65Â°C[0m
[32m2025-10-28 01:10:32.965 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] âœ“ Accumulated fractional offset reached threshold: applying +1Â°C adjustment (accumulator: 1.15Â°C â†’ 0.15Â°C)[0m
[36m2025-10-28 01:10:32.965 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Accumulator triggered: total_accumulated=1.15Â°C, adjustment=+1Â°C, new_integer=1Â°C, remaining=0.15Â°C[0m
[36m2025-10-28 01:10:32.965 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset 0.50Â°C â†’ applying 1Â°C (accumulator: 0.15Â°C, needs 0.85Â°C more to trigger)[0m
[32m2025-10-28 01:10:32.967 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to 1Â°C (calculated: 0.50Â°C, accumulator: 0.15Â°C)[0m
[36m2025-10-28 01:10:32.967 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=1Â°C, original=0.50Â°C, accumulator=0.15Â°C[0m
[32m2025-10-28 01:10:32.967 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset 0.50Â°C to NIBE via MyUplink[0m
[36m2025-10-28 01:10:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.655 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 01:10:32.967 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.3Â°C, outdoor=7.2Â°C, offset=0.5Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-28 01:10:32.967 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.3Â°C, outdoor=7.2Â°C, offset=0.5Â°C, flow=30.5Â°C, DM=-282[0m
[36m2025-10-28 01:10:32.971 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.3Â°C/h trend[0m
[36m2025-10-28 01:10:32.971 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 01:10:32.972 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 01:10:32.972 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 01:10:32.972 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=36.6[0m
[36m2025-10-28 01:10:32.972 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:10:32.979 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 01:10:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:10:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.2Â°C (zone: Moderate Cold): block=-336, abort=-416[0m
[36m2025-10-28 01:10:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:10:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-282, warning=-336, threshold=-168, has_capacity=False[0m
[36m2025-10-28 01:10:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 20 quarters available, need 3 quarters (45 min), lookahead 5.0h[0m
[36m2025-10-28 01:10:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 18 windows evaluated[0m
[36m2025-10-28 01:10:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (2.6h away) â† SELECTED[0m
[36m2025-10-28 01:10:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (2.3h away)[0m
[36m2025-10-28 01:10:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (2.8h away)[0m
[36m2025-10-28 01:10:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (2.1h away)[0m
[36m2025-10-28 01:10:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (1.8h away)[0m
[32m2025-10-28 01:10:32.980 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 2.6h away[0m
[36m2025-10-28 01:10:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:10:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-282, warning=-336, threshold=-168, has_capacity=False[0m
[36m2025-10-28 01:10:32.987 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 01:10:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:10:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.2Â°C (zone: Moderate Cold): block=-336, abort=-416[0m
[36m2025-10-28 01:10:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:10:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-282, warning=-336, threshold=-168, has_capacity=False[0m
[36m2025-10-28 01:10:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 20 quarters available, need 3 quarters (45 min), lookahead 5.0h[0m
[36m2025-10-28 01:10:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 18 windows evaluated[0m
[36m2025-10-28 01:10:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (2.6h away) â† SELECTED[0m
[36m2025-10-28 01:10:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (2.3h away)[0m
[36m2025-10-28 01:10:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (2.8h away)[0m
[36m2025-10-28 01:10:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (2.1h away)[0m
[36m2025-10-28 01:10:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (1.8h away)[0m
[32m2025-10-28 01:10:32.987 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 2.6h away[0m
[36m2025-10-28 01:10:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:10:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-282, warning=-336, threshold=-168, has_capacity=False[0m
[36m2025-10-28 01:10:32.987 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 01:10:32.988 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.029 seconds (success: True)[0m
[36m2025-10-28 01:10:32.989 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (7.0 + 0.6 + 0.9)A Ã— 0.95 = 1.94 kW[0m
[36m2025-10-28 01:10:32.989 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 01:15:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 01:15:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.3Â°C (median of 9 sensors: 23.6Â°C, 21.2Â°C, 21.4Â°C, 23.3Â°C, 24.9Â°C, 24.0Â°C, 22.3Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-28 01:15:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -284.0[0m
[36m2025-10-28 01:15:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 36.6Â°C[0m
[36m2025-10-28 01:15:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.0Â°C[0m
[36m2025-10-28 01:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=7.0A, L2=0.6A, L3=0.9A[0m
[36m2025-10-28 01:15:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.3Â°C, outdoor 7.2Â°C, flow 30.0Â°C, DM -284[0m
[36m2025-10-28 01:15:32.961 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 34 Hz (1h avg: 37, 6h avg: 48, mode: space) - OK: Normal operation (34 Hz, 6h avg: 48 Hz)[0m
[36m2025-10-28 01:15:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 01:15:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 01:15:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 01:15:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 01:15:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 01:15:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 01:15:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 01:15:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 01:15:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 01:15:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 01:15:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 90}[0m
[36m2025-10-28 01:15:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 01:15:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 01:15:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 01:15:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 01:15:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 01:15:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 01:15:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 01:15:32.962 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 01:15:32.962 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q5 = 29.42 Ã¶re/kWh[0m
[36m2025-10-28 01:15:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 01:15:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 01:15:32.963 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 01:15:32.963 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 01:15:32.963 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 01:15:32.963 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-28 01:15:32.964 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 01:15:32.965 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 01:15:32.966 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-28 01:15:32.966 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:15:32.966 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 7.2Â°C: normal -136 to -336, warning -336[0m
[36m2025-10-28 01:15:32.966 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:15:32.966 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -336 (base: -336), critical -1500[0m
[36m2025-10-28 01:15:32.966 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=7.2Â°C, indoor_target=21.0Â°C, temp_diff=13.8Â°C, HC=0.180 kW/K -> flow=26.2Â°C[0m
[36m2025-10-28 01:15:32.966 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 01:15:32.966 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 01:15:32.966 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.7Â°C, current=30.0Â°C, error=-3.3Â°C, sensitivity=1.5 -> offset=-2.2[0m
[36m2025-10-28 01:15:32.966 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=7.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 01:15:32.967 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 30.0Â°C â†’ offset: -2.2Â°C; Weight: 0.20; Deferred: Moderate debt (DM -284)[0m
[36m2025-10-28 01:15:32.967 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Price classification Q5 (01:15): 29.42 â†’ CHEAP[0m
[32m2025-10-28 01:15:32.967 INFO (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.52Â°C - Learned pre-heat: Pre-heating: predicted drop 1.9Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 30.0Â°C â†’ offset: -2.2Â°C; Weight: 0.20; Deferred: Moderate debt (DM -284) | GE-Spot Q5: CHEAP (night) | Too warm: 2.3Â°C over (damped 25%: warming 0.33Â°C/h)[0m
[32m2025-10-28 01:15:32.968 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.52Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.9Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 30.0Â°C â†’ offset: -2.2Â°C; Weight: 0.20; Deferred: Moderate debt (DM -284) | GE-Spot Q5: CHEAP (night) | Too warm: 2.3Â°C over (damped 25%: warming 0.33Â°C/h)[0m
[36m2025-10-28 01:15:32.968 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.52Â°C, integer=0Â°C, fractional=0.52Â°C, accumulator_before=0.15Â°C[0m
[36m2025-10-28 01:15:32.969 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: 0.67Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-28 01:15:32.969 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.52Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-28 01:15:32.969 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.590 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 01:15:32.969 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.3Â°C, outdoor=7.2Â°C, offset=0.5Â°C, change=0.03Â°C, Î”t=0.08h[0m
[36m2025-10-28 01:15:32.969 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.3Â°C, outdoor=7.2Â°C, offset=0.5Â°C, flow=30.0Â°C, DM=-284[0m
[36m2025-10-28 01:15:32.978 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.3Â°C/h trend[0m
[36m2025-10-28 01:15:32.978 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 01:15:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 01:15:32.979 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 01:15:32.979 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=36.6[0m
[36m2025-10-28 01:15:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:15:32.985 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 01:15:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:15:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.2Â°C (zone: Moderate Cold): block=-336, abort=-416[0m
[36m2025-10-28 01:15:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:15:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-284, warning=-336, threshold=-168, has_capacity=False[0m
[36m2025-10-28 01:15:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 20 quarters available, need 3 quarters (45 min), lookahead 5.0h[0m
[36m2025-10-28 01:15:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 18 windows evaluated[0m
[36m2025-10-28 01:15:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (2.5h away) â† SELECTED[0m
[36m2025-10-28 01:15:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (2.2h away)[0m
[36m2025-10-28 01:15:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (2.7h away)[0m
[36m2025-10-28 01:15:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (2.0h away)[0m
[36m2025-10-28 01:15:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (1.7h away)[0m
[32m2025-10-28 01:15:32.986 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 2.5h away[0m
[36m2025-10-28 01:15:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:15:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-284, warning=-336, threshold=-168, has_capacity=False[0m
[36m2025-10-28 01:15:32.990 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 01:15:32.990 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:15:32.990 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.2Â°C (zone: Moderate Cold): block=-336, abort=-416[0m
[36m2025-10-28 01:15:32.990 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:15:32.991 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-284, warning=-336, threshold=-168, has_capacity=False[0m
[36m2025-10-28 01:15:32.991 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 20 quarters available, need 3 quarters (45 min), lookahead 5.0h[0m
[36m2025-10-28 01:15:32.991 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 18 windows evaluated[0m
[36m2025-10-28 01:15:32.991 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (2.5h away) â† SELECTED[0m
[36m2025-10-28 01:15:32.991 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (2.2h away)[0m
[36m2025-10-28 01:15:32.991 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (2.7h away)[0m
[36m2025-10-28 01:15:32.991 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (2.0h away)[0m
[36m2025-10-28 01:15:32.991 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (1.7h away)[0m
[32m2025-10-28 01:15:32.991 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 2.5h away[0m
[36m2025-10-28 01:15:32.991 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:15:32.991 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-284, warning=-336, threshold=-168, has_capacity=False[0m
[36m2025-10-28 01:15:32.991 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 01:15:32.991 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.032 seconds (success: True)[0m
[36m2025-10-28 01:15:32.993 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (7.0 + 0.6 + 0.9)A Ã— 0.95 = 1.94 kW[0m
[36m2025-10-28 01:15:32.993 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 01:20:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 01:20:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.3Â°C (median of 9 sensors: 23.6Â°C, 21.2Â°C, 21.5Â°C, 23.3Â°C, 24.9Â°C, 24.0Â°C, 22.3Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-28 01:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -284.0[0m
[36m2025-10-28 01:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 36.6Â°C[0m
[36m2025-10-28 01:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.0Â°C[0m
[36m2025-10-28 01:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=7.0A, L2=0.6A, L3=0.9A[0m
[36m2025-10-28 01:20:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.3Â°C, outdoor 7.2Â°C, flow 30.0Â°C, DM -284[0m
[36m2025-10-28 01:20:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 35 Hz (1h avg: 37, 6h avg: 48, mode: space) - OK: Normal operation (35 Hz, 6h avg: 48 Hz)[0m
[36m2025-10-28 01:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 01:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 01:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 01:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 01:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 01:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 01:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 01:20:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 01:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 01:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 01:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 90}[0m
[36m2025-10-28 01:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 01:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 01:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 01:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 01:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 01:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 01:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 01:20:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 01:20:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q5 = 29.42 Ã¶re/kWh[0m
[36m2025-10-28 01:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 01:20:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 01:20:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 01:20:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 01:20:32.961 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 01:20:32.961 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-28 01:20:32.962 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 01:20:32.964 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 01:20:32.964 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-28 01:20:32.964 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:20:32.964 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 7.2Â°C: normal -136 to -336, warning -336[0m
[36m2025-10-28 01:20:32.964 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:20:32.964 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -336 (base: -336), critical -1500[0m
[36m2025-10-28 01:20:32.965 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=7.2Â°C, indoor_target=21.0Â°C, temp_diff=13.8Â°C, HC=0.180 kW/K -> flow=26.2Â°C[0m
[36m2025-10-28 01:20:32.965 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 01:20:32.965 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 01:20:32.965 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.7Â°C, current=30.0Â°C, error=-3.3Â°C, sensitivity=1.5 -> offset=-2.2[0m
[36m2025-10-28 01:20:32.965 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=7.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 01:20:32.965 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 30.0Â°C â†’ offset: -2.2Â°C; Weight: 0.20; Deferred: Moderate debt (DM -284)[0m
[36m2025-10-28 01:20:32.965 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Price classification Q5 (01:20): 29.42 â†’ CHEAP[0m
[32m2025-10-28 01:20:32.965 INFO (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.70Â°C - Learned pre-heat: Pre-heating: predicted drop 1.8Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 30.0Â°C â†’ offset: -2.2Â°C; Weight: 0.20; Deferred: Moderate debt (DM -284) | GE-Spot Q5: CHEAP (night) | Too warm: 2.3Â°C over[0m
[32m2025-10-28 01:20:32.966 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.70Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.8Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 30.0Â°C â†’ offset: -2.2Â°C; Weight: 0.20; Deferred: Moderate debt (DM -284) | GE-Spot Q5: CHEAP (night) | Too warm: 2.3Â°C over[0m
[36m2025-10-28 01:20:32.966 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.70Â°C, integer=0Â°C, fractional=0.70Â°C, accumulator_before=0.67Â°C[0m
[32m2025-10-28 01:20:32.966 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] âœ“ Accumulated fractional offset reached threshold: applying +1Â°C adjustment (accumulator: 1.37Â°C â†’ 0.37Â°C)[0m
[36m2025-10-28 01:20:32.966 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Accumulator triggered: total_accumulated=1.37Â°C, adjustment=+1Â°C, new_integer=1Â°C, remaining=0.37Â°C[0m
[36m2025-10-28 01:20:32.966 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset 0.70Â°C â†’ applying 1Â°C (accumulator: 0.37Â°C, needs 0.63Â°C more to trigger)[0m
[32m2025-10-28 01:20:32.968 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to 1Â°C (calculated: 0.70Â°C, accumulator: 0.37Â°C)[0m
[36m2025-10-28 01:20:32.968 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=1Â°C, original=0.70Â°C, accumulator=0.37Â°C[0m
[32m2025-10-28 01:20:32.968 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset 0.70Â°C to NIBE via MyUplink[0m
[36m2025-10-28 01:20:32.968 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.555 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 01:20:32.968 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.3Â°C, outdoor=7.2Â°C, offset=0.7Â°C, change=-0.03Â°C, Î”t=0.08h[0m
[36m2025-10-28 01:20:32.968 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.3Â°C, outdoor=7.2Â°C, offset=0.7Â°C, flow=30.0Â°C, DM=-284[0m
[36m2025-10-28 01:20:32.968 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-28 01:20:32.968 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 01:20:32.974 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 01:20:32.974 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 01:20:32.974 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=36.6[0m
[36m2025-10-28 01:20:32.974 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:20:32.977 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 01:20:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:20:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.2Â°C (zone: Moderate Cold): block=-336, abort=-416[0m
[36m2025-10-28 01:20:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:20:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-284, warning=-336, threshold=-168, has_capacity=False[0m
[36m2025-10-28 01:20:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 20 quarters available, need 3 quarters (45 min), lookahead 5.0h[0m
[36m2025-10-28 01:20:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 18 windows evaluated[0m
[36m2025-10-28 01:20:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (2.4h away) â† SELECTED[0m
[36m2025-10-28 01:20:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (2.2h away)[0m
[36m2025-10-28 01:20:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (2.7h away)[0m
[36m2025-10-28 01:20:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (1.9h away)[0m
[36m2025-10-28 01:20:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (1.7h away)[0m
[32m2025-10-28 01:20:32.978 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 2.4h away[0m
[36m2025-10-28 01:20:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:20:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-284, warning=-336, threshold=-168, has_capacity=False[0m
[36m2025-10-28 01:20:32.987 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 01:20:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:20:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.2Â°C (zone: Moderate Cold): block=-336, abort=-416[0m
[36m2025-10-28 01:20:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:20:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-284, warning=-336, threshold=-168, has_capacity=False[0m
[36m2025-10-28 01:20:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 20 quarters available, need 3 quarters (45 min), lookahead 5.0h[0m
[36m2025-10-28 01:20:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 18 windows evaluated[0m
[36m2025-10-28 01:20:32.988 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (2.4h away) â† SELECTED[0m
[36m2025-10-28 01:20:32.988 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (2.2h away)[0m
[36m2025-10-28 01:20:32.988 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (2.7h away)[0m
[36m2025-10-28 01:20:32.988 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (1.9h away)[0m
[36m2025-10-28 01:20:32.988 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (1.7h away)[0m
[32m2025-10-28 01:20:32.988 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 2.4h away[0m
[36m2025-10-28 01:20:32.988 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:20:32.988 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-284, warning=-336, threshold=-168, has_capacity=False[0m
[36m2025-10-28 01:20:32.988 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 01:20:32.988 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.029 seconds (success: True)[0m
[36m2025-10-28 01:20:32.989 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (7.0 + 0.6 + 0.9)A Ã— 0.95 = 1.94 kW[0m
[36m2025-10-28 01:20:32.990 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 01:25:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 01:25:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.3Â°C (median of 9 sensors: 23.6Â°C, 21.2Â°C, 21.5Â°C, 23.3Â°C, 24.9Â°C, 24.0Â°C, 22.3Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-28 01:25:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -284.0[0m
[36m2025-10-28 01:25:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 36.6Â°C[0m
[36m2025-10-28 01:25:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.5Â°C[0m
[36m2025-10-28 01:25:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=7.0A, L2=0.6A, L3=0.9A[0m
[36m2025-10-28 01:25:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.3Â°C, outdoor 7.2Â°C, flow 30.5Â°C, DM -284[0m
[36m2025-10-28 01:25:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 36 Hz (1h avg: 36, 6h avg: 48, mode: space) - OK: Normal operation (36 Hz, 6h avg: 48 Hz)[0m
[36m2025-10-28 01:25:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 01:25:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 01:25:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 01:25:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 01:25:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 01:25:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 01:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 01:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 01:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 01:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 01:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 90}[0m
[36m2025-10-28 01:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 01:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 01:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 01:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 01:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 01:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 01:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 01:25:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 01:25:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q5 = 29.42 Ã¶re/kWh[0m
[36m2025-10-28 01:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 01:25:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 01:25:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 01:25:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 01:25:32.961 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 01:25:32.961 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-28 01:25:32.962 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 01:25:32.962 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 01:25:32.963 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-28 01:25:32.963 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:25:32.963 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 7.2Â°C: normal -136 to -336, warning -336[0m
[36m2025-10-28 01:25:32.963 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:25:32.963 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -336 (base: -336), critical -1500[0m
[36m2025-10-28 01:25:32.963 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=7.2Â°C, indoor_target=21.0Â°C, temp_diff=13.8Â°C, HC=0.180 kW/K -> flow=26.2Â°C[0m
[36m2025-10-28 01:25:32.963 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 01:25:32.963 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 01:25:32.963 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.7Â°C, current=30.5Â°C, error=-3.8Â°C, sensitivity=1.5 -> offset=-2.5[0m
[36m2025-10-28 01:25:32.963 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=7.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 01:25:32.963 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 30.5Â°C â†’ offset: -2.5Â°C; Weight: 0.20; Deferred: Moderate debt (DM -284)[0m
[36m2025-10-28 01:25:32.963 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Price classification Q5 (01:25): 29.42 â†’ CHEAP[0m
[32m2025-10-28 01:25:32.964 INFO (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.67Â°C - Learned pre-heat: Pre-heating: predicted drop 1.9Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 30.5Â°C â†’ offset: -2.5Â°C; Weight: 0.20; Deferred: Moderate debt (DM -284) | GE-Spot Q5: CHEAP (night) | Too warm: 2.3Â°C over[0m
[32m2025-10-28 01:25:32.964 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.67Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.9Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 30.5Â°C â†’ offset: -2.5Â°C; Weight: 0.20; Deferred: Moderate debt (DM -284) | GE-Spot Q5: CHEAP (night) | Too warm: 2.3Â°C over[0m
[36m2025-10-28 01:25:32.964 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Skipping offset write, too soon since last write[0m
[36m2025-10-28 01:25:32.964 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.67Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-28 01:25:32.964 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.556 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 01:25:32.964 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.3Â°C, outdoor=7.2Â°C, offset=0.7Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-28 01:25:32.964 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.3Â°C, outdoor=7.2Â°C, offset=0.7Â°C, flow=30.5Â°C, DM=-284[0m
[36m2025-10-28 01:25:32.969 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.1Â°C/h trend[0m
[36m2025-10-28 01:25:32.969 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 01:25:32.973 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 01:25:32.973 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 01:25:32.973 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=36.6[0m
[36m2025-10-28 01:25:32.973 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:25:32.977 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 01:25:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:25:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.2Â°C (zone: Moderate Cold): block=-336, abort=-416[0m
[36m2025-10-28 01:25:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:25:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-284, warning=-336, threshold=-168, has_capacity=False[0m
[36m2025-10-28 01:25:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 20 quarters available, need 3 quarters (45 min), lookahead 5.0h[0m
[36m2025-10-28 01:25:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 18 windows evaluated[0m
[36m2025-10-28 01:25:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (2.3h away) â† SELECTED[0m
[36m2025-10-28 01:25:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (2.1h away)[0m
[36m2025-10-28 01:25:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (2.6h away)[0m
[36m2025-10-28 01:25:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (1.8h away)[0m
[36m2025-10-28 01:25:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (1.6h away)[0m
[32m2025-10-28 01:25:32.978 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 2.3h away[0m
[36m2025-10-28 01:25:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:25:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-284, warning=-336, threshold=-168, has_capacity=False[0m
[36m2025-10-28 01:25:32.980 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 01:25:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:25:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.2Â°C (zone: Moderate Cold): block=-336, abort=-416[0m
[36m2025-10-28 01:25:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:25:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-284, warning=-336, threshold=-168, has_capacity=False[0m
[36m2025-10-28 01:25:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 20 quarters available, need 3 quarters (45 min), lookahead 5.0h[0m
[36m2025-10-28 01:25:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 18 windows evaluated[0m
[36m2025-10-28 01:25:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (2.3h away) â† SELECTED[0m
[36m2025-10-28 01:25:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (2.1h away)[0m
[36m2025-10-28 01:25:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (2.6h away)[0m
[36m2025-10-28 01:25:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (1.8h away)[0m
[36m2025-10-28 01:25:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (1.6h away)[0m
[32m2025-10-28 01:25:32.981 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 2.3h away[0m
[36m2025-10-28 01:25:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:25:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-284, warning=-336, threshold=-168, has_capacity=False[0m
[36m2025-10-28 01:25:32.981 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 01:25:32.981 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.023 seconds (success: True)[0m
[36m2025-10-28 01:25:32.983 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (7.0 + 0.6 + 0.9)A Ã— 0.95 = 1.94 kW[0m
[36m2025-10-28 01:25:32.983 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 01:30:32.958 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 01:30:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.4Â°C (median of 9 sensors: 23.6Â°C, 21.2Â°C, 21.5Â°C, 23.4Â°C, 24.9Â°C, 24.0Â°C, 22.3Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-28 01:30:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -282.0[0m
[36m2025-10-28 01:30:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 36.6Â°C[0m
[36m2025-10-28 01:30:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.5Â°C[0m
[36m2025-10-28 01:30:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=7.0A, L2=0.6A, L3=0.9A[0m
[36m2025-10-28 01:30:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.4Â°C, outdoor 7.2Â°C, flow 30.5Â°C, DM -282[0m
[36m2025-10-28 01:30:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 34 Hz (1h avg: 36, 6h avg: 47, mode: space) - OK: Normal operation (34 Hz, 6h avg: 47 Hz)[0m
[36m2025-10-28 01:30:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 01:30:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 01:30:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 01:30:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 01:30:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 01:30:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 01:30:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 01:30:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 01:30:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 01:30:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 01:30:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 89}[0m
[36m2025-10-28 01:30:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 01:30:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 01:30:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 01:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 01:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 01:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 01:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 01:30:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 01:30:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q6 = 26.26 Ã¶re/kWh[0m
[36m2025-10-28 01:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 01:30:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 01:30:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 01:30:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 01:30:32.961 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 01:30:32.961 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-28 01:30:32.961 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 01:30:32.962 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 01:30:32.962 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-28 01:30:32.962 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:30:32.962 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 7.2Â°C: normal -136 to -336, warning -336[0m
[36m2025-10-28 01:30:32.962 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:30:32.962 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -336 (base: -336), critical -1500[0m
[36m2025-10-28 01:30:32.963 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=7.2Â°C, indoor_target=21.0Â°C, temp_diff=13.8Â°C, HC=0.180 kW/K -> flow=26.2Â°C[0m
[36m2025-10-28 01:30:32.963 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 01:30:32.963 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 01:30:32.963 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.7Â°C, current=30.5Â°C, error=-3.8Â°C, sensitivity=1.5 -> offset=-2.5[0m
[36m2025-10-28 01:30:32.963 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=7.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 01:30:32.963 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 30.5Â°C â†’ offset: -2.5Â°C; Weight: 0.20; Deferred: Moderate debt (DM -282)[0m
[36m2025-10-28 01:30:32.963 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Price classification Q6 (01:30): 26.26 â†’ CHEAP[0m
[32m2025-10-28 01:30:32.963 INFO (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.66Â°C - Learned pre-heat: Pre-heating: predicted drop 1.9Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 30.5Â°C â†’ offset: -2.5Â°C; Weight: 0.20; Deferred: Moderate debt (DM -282) | GE-Spot Q6: CHEAP (night) | Too warm: 2.4Â°C over[0m
[32m2025-10-28 01:30:32.964 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.66Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.9Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 30.5Â°C â†’ offset: -2.5Â°C; Weight: 0.20; Deferred: Moderate debt (DM -282) | GE-Spot Q6: CHEAP (night) | Too warm: 2.4Â°C over[0m
[36m2025-10-28 01:30:32.964 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.66Â°C, integer=0Â°C, fractional=0.66Â°C, accumulator_before=0.37Â°C[0m
[32m2025-10-28 01:30:32.964 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] âœ“ Accumulated fractional offset reached threshold: applying +1Â°C adjustment (accumulator: 1.03Â°C â†’ 0.03Â°C)[0m
[36m2025-10-28 01:30:32.964 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Accumulator triggered: total_accumulated=1.03Â°C, adjustment=+1Â°C, new_integer=1Â°C, remaining=0.03Â°C[0m
[36m2025-10-28 01:30:32.964 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset 0.66Â°C â†’ applying 1Â°C (accumulator: 0.03Â°C, needs 0.97Â°C more to trigger)[0m
[32m2025-10-28 01:30:32.965 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to 1Â°C (calculated: 0.66Â°C, accumulator: 0.03Â°C)[0m
[36m2025-10-28 01:30:32.965 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=1Â°C, original=0.66Â°C, accumulator=0.03Â°C[0m
[32m2025-10-28 01:30:32.965 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset 0.66Â°C to NIBE via MyUplink[0m
[36m2025-10-28 01:30:32.965 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.544 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 01:30:32.965 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.4Â°C, outdoor=7.2Â°C, offset=0.7Â°C, change=0.05Â°C, Î”t=0.08h[0m
[36m2025-10-28 01:30:32.965 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.4Â°C, outdoor=7.2Â°C, offset=0.7Â°C, flow=30.5Â°C, DM=-282[0m
[36m2025-10-28 01:30:32.977 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.2Â°C/h trend[0m
[36m2025-10-28 01:30:32.978 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 01:30:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 01:30:32.979 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 01:30:32.979 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=36.6[0m
[36m2025-10-28 01:30:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:30:32.981 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 01:30:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:30:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.2Â°C (zone: Moderate Cold): block=-336, abort=-416[0m
[36m2025-10-28 01:30:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:30:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-282, warning=-336, threshold=-168, has_capacity=False[0m
[36m2025-10-28 01:30:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 20 quarters available, need 3 quarters (45 min), lookahead 5.0h[0m
[36m2025-10-28 01:30:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 18 windows evaluated[0m
[36m2025-10-28 01:30:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (2.2h away) â† SELECTED[0m
[36m2025-10-28 01:30:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (2.0h away)[0m
[36m2025-10-28 01:30:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (2.5h away)[0m
[36m2025-10-28 01:30:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (1.7h away)[0m
[36m2025-10-28 01:30:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (1.5h away)[0m
[32m2025-10-28 01:30:32.982 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 2.2h away[0m
[36m2025-10-28 01:30:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:30:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-282, warning=-336, threshold=-168, has_capacity=False[0m
[36m2025-10-28 01:30:32.987 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 01:30:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:30:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.2Â°C (zone: Moderate Cold): block=-336, abort=-416[0m
[36m2025-10-28 01:30:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:30:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-282, warning=-336, threshold=-168, has_capacity=False[0m
[36m2025-10-28 01:30:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 20 quarters available, need 3 quarters (45 min), lookahead 5.0h[0m
[36m2025-10-28 01:30:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 18 windows evaluated[0m
[36m2025-10-28 01:30:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (2.2h away) â† SELECTED[0m
[36m2025-10-28 01:30:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (2.0h away)[0m
[36m2025-10-28 01:30:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (2.5h away)[0m
[36m2025-10-28 01:30:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (1.7h away)[0m
[36m2025-10-28 01:30:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (1.5h away)[0m
[32m2025-10-28 01:30:32.987 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 2.2h away[0m
[36m2025-10-28 01:30:32.987 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:30:32.988 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-282, warning=-336, threshold=-168, has_capacity=False[0m
[36m2025-10-28 01:30:32.988 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 01:30:32.988 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.029 seconds (success: True)[0m
[36m2025-10-28 01:30:32.989 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (7.0 + 0.6 + 0.9)A Ã— 0.95 = 1.94 kW[0m
[36m2025-10-28 01:30:32.989 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 01:35:32.958 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 01:35:32.958 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.3Â°C (median of 9 sensors: 23.6Â°C, 21.2Â°C, 21.5Â°C, 23.3Â°C, 24.9Â°C, 24.0Â°C, 22.3Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-28 01:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -279.0[0m
[36m2025-10-28 01:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 36.6Â°C[0m
[36m2025-10-28 01:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.5Â°C[0m
[36m2025-10-28 01:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=6.0A, L2=0.6A, L3=0.9A[0m
[36m2025-10-28 01:35:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.3Â°C, outdoor 7.2Â°C, flow 30.5Â°C, DM -279[0m
[36m2025-10-28 01:35:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 33 Hz (1h avg: 36, 6h avg: 47, mode: space) - OK: Normal operation (33 Hz, 6h avg: 47 Hz)[0m
[36m2025-10-28 01:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 01:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 01:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 01:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 01:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 01:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 01:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 01:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 01:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 01:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 01:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 89}[0m
[36m2025-10-28 01:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 01:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 01:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 01:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 01:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 01:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 01:35:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 01:35:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 01:35:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q6 = 26.26 Ã¶re/kWh[0m
[36m2025-10-28 01:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 01:35:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 01:35:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 01:35:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 01:35:32.961 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 01:35:32.961 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-28 01:35:32.961 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 01:35:32.962 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 01:35:32.962 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-28 01:35:32.962 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:35:32.962 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 7.2Â°C: normal -136 to -336, warning -336[0m
[36m2025-10-28 01:35:32.962 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:35:32.962 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -336 (base: -336), critical -1500[0m
[36m2025-10-28 01:35:32.963 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=7.2Â°C, indoor_target=21.0Â°C, temp_diff=13.8Â°C, HC=0.180 kW/K -> flow=26.2Â°C[0m
[36m2025-10-28 01:35:32.963 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 01:35:32.963 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 01:35:32.963 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.7Â°C, current=30.5Â°C, error=-3.8Â°C, sensitivity=1.5 -> offset=-2.5[0m
[36m2025-10-28 01:35:32.963 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=7.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 01:35:32.963 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 30.5Â°C â†’ offset: -2.5Â°C; Weight: 0.20; Deferred: Moderate debt (DM -279)[0m
[36m2025-10-28 01:35:32.963 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Price classification Q6 (01:35): 26.26 â†’ CHEAP[0m
[32m2025-10-28 01:35:32.963 INFO (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.67Â°C - Learned pre-heat: Pre-heating: predicted drop 1.8Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 30.5Â°C â†’ offset: -2.5Â°C; Weight: 0.20; Deferred: Moderate debt (DM -279) | GE-Spot Q6: CHEAP (night) | Too warm: 2.3Â°C over[0m
[32m2025-10-28 01:35:32.966 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.67Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.8Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 30.5Â°C â†’ offset: -2.5Â°C; Weight: 0.20; Deferred: Moderate debt (DM -279) | GE-Spot Q6: CHEAP (night) | Too warm: 2.3Â°C over[0m
[36m2025-10-28 01:35:32.966 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.67Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-28 01:35:32.966 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.529 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 01:35:32.966 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.3Â°C, outdoor=7.2Â°C, offset=0.7Â°C, change=-0.05Â°C, Î”t=0.08h[0m
[36m2025-10-28 01:35:32.966 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.3Â°C, outdoor=7.2Â°C, offset=0.7Â°C, flow=30.5Â°C, DM=-279[0m
[36m2025-10-28 01:35:32.971 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.0Â°C/h trend[0m
[36m2025-10-28 01:35:32.971 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 01:35:32.974 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 01:35:32.974 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 01:35:32.974 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=36.6[0m
[36m2025-10-28 01:35:32.974 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:35:32.977 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 01:35:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:35:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.2Â°C (zone: Moderate Cold): block=-336, abort=-416[0m
[36m2025-10-28 01:35:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:35:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-279, warning=-336, threshold=-168, has_capacity=False[0m
[36m2025-10-28 01:35:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 20 quarters available, need 3 quarters (45 min), lookahead 5.0h[0m
[36m2025-10-28 01:35:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 18 windows evaluated[0m
[36m2025-10-28 01:35:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (2.2h away) â† SELECTED[0m
[36m2025-10-28 01:35:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (1.9h away)[0m
[36m2025-10-28 01:35:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (2.4h away)[0m
[36m2025-10-28 01:35:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (1.7h away)[0m
[36m2025-10-28 01:35:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (1.4h away)[0m
[32m2025-10-28 01:35:32.978 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 2.2h away[0m
[36m2025-10-28 01:35:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:35:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-279, warning=-336, threshold=-168, has_capacity=False[0m
[36m2025-10-28 01:35:32.980 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 01:35:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:35:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.2Â°C (zone: Moderate Cold): block=-336, abort=-416[0m
[36m2025-10-28 01:35:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:35:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-279, warning=-336, threshold=-168, has_capacity=False[0m
[36m2025-10-28 01:35:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 20 quarters available, need 3 quarters (45 min), lookahead 5.0h[0m
[36m2025-10-28 01:35:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 18 windows evaluated[0m
[36m2025-10-28 01:35:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (2.2h away) â† SELECTED[0m
[36m2025-10-28 01:35:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (1.9h away)[0m
[36m2025-10-28 01:35:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (2.4h away)[0m
[36m2025-10-28 01:35:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (1.7h away)[0m
[36m2025-10-28 01:35:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (1.4h away)[0m
[32m2025-10-28 01:35:32.981 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 2.2h away[0m
[36m2025-10-28 01:35:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:35:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-279, warning=-336, threshold=-168, has_capacity=False[0m
[36m2025-10-28 01:35:32.981 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 01:35:32.981 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.023 seconds (success: True)[0m
[36m2025-10-28 01:35:32.983 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (6.0 + 0.6 + 0.9)A Ã— 0.95 = 1.71 kW[0m
[36m2025-10-28 01:35:32.983 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 01:40:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 01:40:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.2Â°C (median of 9 sensors: 23.6Â°C, 21.2Â°C, 21.4Â°C, 23.2Â°C, 24.9Â°C, 24.0Â°C, 22.3Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-28 01:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -277.0[0m
[36m2025-10-28 01:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 36.6Â°C[0m
[36m2025-10-28 01:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.5Â°C[0m
[36m2025-10-28 01:40:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=6.0A, L2=0.6A, L3=0.9A[0m
[36m2025-10-28 01:40:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.2Â°C, outdoor 7.2Â°C, flow 30.5Â°C, DM -277[0m
[36m2025-10-28 01:40:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 32 Hz (1h avg: 35, 6h avg: 48, mode: space) - OK: Normal operation (32 Hz, 6h avg: 48 Hz)[0m
[36m2025-10-28 01:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 01:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 01:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 01:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 01:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 01:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 01:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 01:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 01:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 01:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 01:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 89}[0m
[36m2025-10-28 01:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 01:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 01:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 01:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 01:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 01:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 01:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 01:40:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 01:40:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q6 = 26.26 Ã¶re/kWh[0m
[36m2025-10-28 01:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 01:40:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 01:40:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 01:40:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 01:40:32.962 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 01:40:32.962 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-28 01:40:32.962 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 01:40:32.963 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 01:40:32.963 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-28 01:40:32.963 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:40:32.963 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 7.2Â°C: normal -136 to -336, warning -336[0m
[36m2025-10-28 01:40:32.963 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:40:32.963 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -336 (base: -336), critical -1500[0m
[36m2025-10-28 01:40:32.964 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=7.2Â°C, indoor_target=21.0Â°C, temp_diff=13.8Â°C, HC=0.180 kW/K -> flow=26.2Â°C[0m
[36m2025-10-28 01:40:32.964 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 01:40:32.964 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 01:40:32.964 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.7Â°C, current=30.5Â°C, error=-3.8Â°C, sensitivity=1.5 -> offset=-2.5[0m
[36m2025-10-28 01:40:32.964 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=7.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 01:40:32.964 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 30.5Â°C â†’ offset: -2.5Â°C; Weight: 0.20; Deferred: Moderate debt (DM -277)[0m
[36m2025-10-28 01:40:32.964 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Price classification Q6 (01:40): 26.26 â†’ CHEAP[0m
[32m2025-10-28 01:40:32.964 INFO (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.67Â°C - Learned pre-heat: Pre-heating: predicted drop 1.8Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 30.5Â°C â†’ offset: -2.5Â°C; Weight: 0.20; Deferred: Moderate debt (DM -277) | GE-Spot Q6: CHEAP (night) | Too warm: 2.2Â°C over[0m
[32m2025-10-28 01:40:32.965 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.67Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.8Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 30.5Â°C â†’ offset: -2.5Â°C; Weight: 0.20; Deferred: Moderate debt (DM -277) | GE-Spot Q6: CHEAP (night) | Too warm: 2.2Â°C over[0m
[36m2025-10-28 01:40:32.965 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.67Â°C, integer=0Â°C, fractional=0.67Â°C, accumulator_before=0.03Â°C[0m
[36m2025-10-28 01:40:32.965 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: 0.71Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-28 01:40:32.965 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.67Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-28 01:40:32.965 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.520 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 01:40:32.965 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.2Â°C, outdoor=7.2Â°C, offset=0.7Â°C, change=-0.05Â°C, Î”t=0.08h[0m
[36m2025-10-28 01:40:32.965 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.2Â°C, outdoor=7.2Â°C, offset=0.7Â°C, flow=30.5Â°C, DM=-277[0m
[36m2025-10-28 01:40:32.965 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-28 01:40:32.965 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 01:40:32.970 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 01:40:32.971 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 01:40:32.971 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=36.6[0m
[36m2025-10-28 01:40:32.971 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:40:32.977 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 01:40:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:40:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.2Â°C (zone: Moderate Cold): block=-336, abort=-416[0m
[36m2025-10-28 01:40:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:40:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-277, warning=-336, threshold=-168, has_capacity=False[0m
[36m2025-10-28 01:40:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 20 quarters available, need 3 quarters (45 min), lookahead 5.0h[0m
[36m2025-10-28 01:40:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 18 windows evaluated[0m
[36m2025-10-28 01:40:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (2.1h away) â† SELECTED[0m
[36m2025-10-28 01:40:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (1.8h away)[0m
[36m2025-10-28 01:40:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (2.3h away)[0m
[36m2025-10-28 01:40:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (1.6h away)[0m
[36m2025-10-28 01:40:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (1.3h away)[0m
[32m2025-10-28 01:40:32.978 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 2.1h away[0m
[36m2025-10-28 01:40:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:40:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-277, warning=-336, threshold=-168, has_capacity=False[0m
[36m2025-10-28 01:40:32.982 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 01:40:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:40:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.2Â°C (zone: Moderate Cold): block=-336, abort=-416[0m
[36m2025-10-28 01:40:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:40:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-277, warning=-336, threshold=-168, has_capacity=False[0m
[36m2025-10-28 01:40:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 20 quarters available, need 3 quarters (45 min), lookahead 5.0h[0m
[36m2025-10-28 01:40:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 18 windows evaluated[0m
[36m2025-10-28 01:40:32.982 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (2.1h away) â† SELECTED[0m
[36m2025-10-28 01:40:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (1.8h away)[0m
[36m2025-10-28 01:40:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (2.3h away)[0m
[36m2025-10-28 01:40:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (1.6h away)[0m
[36m2025-10-28 01:40:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (1.3h away)[0m
[32m2025-10-28 01:40:32.983 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 2.1h away[0m
[36m2025-10-28 01:40:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:40:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-277, warning=-336, threshold=-168, has_capacity=False[0m
[36m2025-10-28 01:40:32.983 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 01:40:32.983 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.024 seconds (success: True)[0m
[36m2025-10-28 01:40:32.984 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (6.0 + 0.6 + 0.9)A Ã— 0.95 = 1.71 kW[0m
[36m2025-10-28 01:40:32.985 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 01:45:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 01:45:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.3Â°C (median of 9 sensors: 23.6Â°C, 21.2Â°C, 21.5Â°C, 23.3Â°C, 24.9Â°C, 24.1Â°C, 22.3Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-28 01:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -275.0[0m
[36m2025-10-28 01:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 36.6Â°C[0m
[36m2025-10-28 01:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.5Â°C[0m
[36m2025-10-28 01:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=6.0A, L2=0.6A, L3=0.9A[0m
[36m2025-10-28 01:45:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.3Â°C, outdoor 7.2Â°C, flow 30.5Â°C, DM -275[0m
[36m2025-10-28 01:45:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 32 Hz (1h avg: 35, 6h avg: 48, mode: space) - OK: Normal operation (32 Hz, 6h avg: 48 Hz)[0m
[36m2025-10-28 01:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 01:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 01:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 01:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 01:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 01:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 01:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 01:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 01:45:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 01:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 01:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 88}[0m
[36m2025-10-28 01:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 01:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 01:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 01:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 01:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 01:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 01:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 01:45:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 01:45:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q7 = 21.21 Ã¶re/kWh[0m
[36m2025-10-28 01:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 01:45:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 01:45:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 01:45:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 01:45:32.961 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 01:45:32.961 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-28 01:45:32.962 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 01:45:32.963 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 01:45:32.963 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-28 01:45:32.963 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:45:32.964 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 7.2Â°C: normal -136 to -336, warning -336[0m
[36m2025-10-28 01:45:32.964 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:45:32.964 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -336 (base: -336), critical -1500[0m
[36m2025-10-28 01:45:32.964 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=7.2Â°C, indoor_target=21.0Â°C, temp_diff=13.8Â°C, HC=0.180 kW/K -> flow=26.2Â°C[0m
[36m2025-10-28 01:45:32.964 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 01:45:32.964 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 01:45:32.964 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.7Â°C, current=30.5Â°C, error=-3.8Â°C, sensitivity=1.5 -> offset=-2.5[0m
[36m2025-10-28 01:45:32.964 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=7.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 01:45:32.964 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 30.5Â°C â†’ offset: -2.5Â°C; Weight: 0.20; Deferred: Moderate debt (DM -275)[0m
[36m2025-10-28 01:45:32.964 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Price classification Q7 (01:45): 21.21 â†’ CHEAP[0m
[32m2025-10-28 01:45:32.964 INFO (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.66Â°C - Learned pre-heat: Pre-heating: predicted drop 1.9Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 30.5Â°C â†’ offset: -2.5Â°C; Weight: 0.20; Deferred: Moderate debt (DM -275) | GE-Spot Q7: CHEAP (night) | Too warm: 2.3Â°C over[0m
[32m2025-10-28 01:45:32.965 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.66Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.9Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.2Â°C; Safety: +0.5Â°C; Adjusted: 26.7Â°C; Current: 30.5Â°C â†’ offset: -2.5Â°C; Weight: 0.20; Deferred: Moderate debt (DM -275) | GE-Spot Q7: CHEAP (night) | Too warm: 2.3Â°C over[0m
[36m2025-10-28 01:45:32.965 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.66Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-28 01:45:32.965 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.497 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 01:45:32.965 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.3Â°C, outdoor=7.2Â°C, offset=0.7Â°C, change=0.07Â°C, Î”t=0.08h[0m
[36m2025-10-28 01:45:32.965 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.3Â°C, outdoor=7.2Â°C, offset=0.7Â°C, flow=30.5Â°C, DM=-275[0m
[36m2025-10-28 01:45:32.970 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.0Â°C/h trend[0m
[36m2025-10-28 01:45:32.970 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 01:45:32.975 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 01:45:32.975 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 01:45:32.975 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=36.6[0m
[36m2025-10-28 01:45:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:45:32.978 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 01:45:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:45:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.2Â°C (zone: Moderate Cold): block=-336, abort=-416[0m
[36m2025-10-28 01:45:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:45:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-275, warning=-336, threshold=-168, has_capacity=False[0m
[36m2025-10-28 01:45:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 20 quarters available, need 3 quarters (45 min), lookahead 5.0h[0m
[36m2025-10-28 01:45:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 18 windows evaluated[0m
[36m2025-10-28 01:45:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (2.0h away) â† SELECTED[0m
[36m2025-10-28 01:45:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (1.7h away)[0m
[36m2025-10-28 01:45:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (2.2h away)[0m
[36m2025-10-28 01:45:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (1.5h away)[0m
[36m2025-10-28 01:45:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (1.2h away)[0m
[32m2025-10-28 01:45:32.979 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 2.0h away[0m
[36m2025-10-28 01:45:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:45:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-275, warning=-336, threshold=-168, has_capacity=False[0m
[36m2025-10-28 01:45:32.983 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 01:45:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:45:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.2Â°C (zone: Moderate Cold): block=-336, abort=-416[0m
[36m2025-10-28 01:45:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:45:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-275, warning=-336, threshold=-168, has_capacity=False[0m
[36m2025-10-28 01:45:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 20 quarters available, need 3 quarters (45 min), lookahead 5.0h[0m
[36m2025-10-28 01:45:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 18 windows evaluated[0m
[36m2025-10-28 01:45:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (2.0h away) â† SELECTED[0m
[36m2025-10-28 01:45:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (1.7h away)[0m
[36m2025-10-28 01:45:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (2.2h away)[0m
[36m2025-10-28 01:45:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (1.5h away)[0m
[36m2025-10-28 01:45:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (1.2h away)[0m
[32m2025-10-28 01:45:32.984 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 2.0h away[0m
[36m2025-10-28 01:45:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.2Â°C (zone avg: -1.0Â°C, delta: 8.2Â°C): normal -136 to -336, warning -336, critical -1500[0m
[36m2025-10-28 01:45:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-275, warning=-336, threshold=-168, has_capacity=False[0m
[36m2025-10-28 01:45:32.984 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 01:45:32.984 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.026 seconds (success: True)[0m
[36m2025-10-28 01:45:32.986 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (6.0 + 0.6 + 0.9)A Ã— 0.95 = 1.71 kW[0m
[36m2025-10-28 01:45:32.986 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 01:50:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 01:50:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.3Â°C (median of 9 sensors: 23.6Â°C, 21.2Â°C, 21.5Â°C, 23.3Â°C, 24.9Â°C, 24.1Â°C, 22.3Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-28 01:50:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -273.0[0m
[36m2025-10-28 01:50:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 36.6Â°C[0m
[36m2025-10-28 01:50:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.5Â°C[0m
[36m2025-10-28 01:50:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=6.0A, L2=0.6A, L3=0.9A[0m
[36m2025-10-28 01:50:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.3Â°C, outdoor 7.7Â°C, flow 30.5Â°C, DM -273[0m
[36m2025-10-28 01:50:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 30 Hz (1h avg: 34, 6h avg: 47, mode: space) - OK: Normal operation (30 Hz, 6h avg: 47 Hz)[0m
[36m2025-10-28 01:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 01:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 01:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 01:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 01:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 01:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 01:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 01:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 01:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 01:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 01:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 88}[0m
[36m2025-10-28 01:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 01:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 01:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 01:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 01:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 01:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 01:50:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 01:50:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 01:50:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q7 = 21.21 Ã¶re/kWh[0m
[36m2025-10-28 01:50:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 01:50:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 01:50:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 01:50:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 01:50:32.962 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 01:50:32.962 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-28 01:50:32.962 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 01:50:32.963 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 01:50:32.963 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-28 01:50:32.963 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 01:50:32.963 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 7.7Â°C: normal -126 to -326, warning -326[0m
[36m2025-10-28 01:50:32.963 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 01:50:32.963 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -326 (base: -326), critical -1500[0m
[36m2025-10-28 01:50:32.963 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=7.7Â°C, indoor_target=21.0Â°C, temp_diff=13.3Â°C, HC=0.180 kW/K -> flow=26.0Â°C[0m
[36m2025-10-28 01:50:32.963 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 01:50:32.964 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 01:50:32.964 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.5Â°C, current=30.5Â°C, error=-4.0Â°C, sensitivity=1.5 -> offset=-2.6[0m
[36m2025-10-28 01:50:32.964 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=7.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 01:50:32.964 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 30.5Â°C â†’ offset: -2.6Â°C; Weight: 0.20; Deferred: Moderate debt (DM -273)[0m
[36m2025-10-28 01:50:32.964 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Price classification Q7 (01:50): 21.21 â†’ CHEAP[0m
[32m2025-10-28 01:50:32.964 INFO (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.66Â°C - Learned pre-heat: Pre-heating: predicted drop 1.8Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 30.5Â°C â†’ offset: -2.6Â°C; Weight: 0.20; Deferred: Moderate debt (DM -273) | GE-Spot Q7: CHEAP (night) | Too warm: 2.3Â°C over[0m
[32m2025-10-28 01:50:32.964 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.66Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.8Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 30.5Â°C â†’ offset: -2.6Â°C; Weight: 0.20; Deferred: Moderate debt (DM -273) | GE-Spot Q7: CHEAP (night) | Too warm: 2.3Â°C over[0m
[36m2025-10-28 01:50:32.964 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.66Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-28 01:50:32.964 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.591 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 01:50:32.965 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.3Â°C, outdoor=7.7Â°C, offset=0.7Â°C, change=-0.02Â°C, Î”t=0.08h[0m
[36m2025-10-28 01:50:32.965 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.3Â°C, outdoor=7.7Â°C, offset=0.7Â°C, flow=30.5Â°C, DM=-273[0m
[36m2025-10-28 01:50:32.965 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-28 01:50:32.965 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 01:50:32.971 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved learned data to storage[0m
[36m2025-10-28 01:50:32.971 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 01:50:32.971 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 01:50:32.971 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=36.6[0m
[36m2025-10-28 01:50:32.971 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 01:50:32.978 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 01:50:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 01:50:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.7Â°C (zone: Moderate Cold): block=-326, abort=-406[0m
[36m2025-10-28 01:50:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 01:50:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-273, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 01:50:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 20 quarters available, need 3 quarters (45 min), lookahead 5.0h[0m
[36m2025-10-28 01:50:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 18 windows evaluated[0m
[36m2025-10-28 01:50:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (1.9h away) â† SELECTED[0m
[36m2025-10-28 01:50:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (1.7h away)[0m
[36m2025-10-28 01:50:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (2.2h away)[0m
[36m2025-10-28 01:50:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (1.4h away)[0m
[36m2025-10-28 01:50:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (1.2h away)[0m
[32m2025-10-28 01:50:32.979 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 1.9h away[0m
[36m2025-10-28 01:50:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 01:50:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-273, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 01:50:32.983 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 01:50:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 01:50:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.7Â°C (zone: Moderate Cold): block=-326, abort=-406[0m
[36m2025-10-28 01:50:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 01:50:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-273, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 01:50:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 20 quarters available, need 3 quarters (45 min), lookahead 5.0h[0m
[36m2025-10-28 01:50:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 18 windows evaluated[0m
[36m2025-10-28 01:50:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (1.9h away) â† SELECTED[0m
[36m2025-10-28 01:50:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (1.7h away)[0m
[36m2025-10-28 01:50:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (2.2h away)[0m
[36m2025-10-28 01:50:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (1.4h away)[0m
[36m2025-10-28 01:50:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (1.2h away)[0m
[32m2025-10-28 01:50:32.983 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 1.9h away[0m
[36m2025-10-28 01:50:32.983 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 01:50:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-273, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 01:50:32.984 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 01:50:32.984 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.025 seconds (success: True)[0m
[36m2025-10-28 01:50:32.985 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (6.0 + 0.6 + 0.9)A Ã— 0.95 = 1.71 kW[0m
[36m2025-10-28 01:50:32.985 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 01:55:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 01:55:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.3Â°C (median of 9 sensors: 23.6Â°C, 21.2Â°C, 21.4Â°C, 23.3Â°C, 24.9Â°C, 24.1Â°C, 22.3Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-28 01:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -271.0[0m
[36m2025-10-28 01:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 36.6Â°C[0m
[36m2025-10-28 01:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.5Â°C[0m
[36m2025-10-28 01:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=6.5A, L2=0.6A, L3=0.9A[0m
[36m2025-10-28 01:55:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.3Â°C, outdoor 7.7Â°C, flow 30.5Â°C, DM -271[0m
[36m2025-10-28 01:55:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 29 Hz (1h avg: 33, 6h avg: 46, mode: space) - OK: Normal operation (29 Hz, 6h avg: 46 Hz)[0m
[36m2025-10-28 01:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 01:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 01:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 01:55:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 01:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 01:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 01:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 01:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 01:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 01:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 01:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 88}[0m
[36m2025-10-28 01:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 01:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 01:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 01:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 01:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 01:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 01:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 01:55:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 01:55:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q7 = 21.21 Ã¶re/kWh[0m
[36m2025-10-28 01:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 01:55:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 01:55:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 01:55:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 01:55:32.961 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 01:55:32.962 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-28 01:55:32.962 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 01:55:32.962 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 01:55:32.963 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-28 01:55:32.963 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 01:55:32.963 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 7.7Â°C: normal -126 to -326, warning -326[0m
[36m2025-10-28 01:55:32.963 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 01:55:32.963 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -326 (base: -326), critical -1500[0m
[36m2025-10-28 01:55:32.963 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=7.7Â°C, indoor_target=21.0Â°C, temp_diff=13.3Â°C, HC=0.180 kW/K -> flow=26.0Â°C[0m
[36m2025-10-28 01:55:32.963 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 01:55:32.963 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 01:55:32.963 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.5Â°C, current=30.5Â°C, error=-4.0Â°C, sensitivity=1.5 -> offset=-2.6[0m
[36m2025-10-28 01:55:32.963 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=7.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 01:55:32.963 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 30.5Â°C â†’ offset: -2.6Â°C; Weight: 0.20; Deferred: Moderate debt (DM -271)[0m
[36m2025-10-28 01:55:32.963 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Price classification Q7 (01:55): 21.21 â†’ CHEAP[0m
[32m2025-10-28 01:55:32.964 INFO (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.65Â°C - Learned pre-heat: Pre-heating: predicted drop 1.8Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 30.5Â°C â†’ offset: -2.6Â°C; Weight: 0.20; Deferred: Moderate debt (DM -271) | GE-Spot Q7: CHEAP (night) | Too warm: 2.3Â°C over[0m
[32m2025-10-28 01:55:32.964 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.65Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.8Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 30.5Â°C â†’ offset: -2.6Â°C; Weight: 0.20; Deferred: Moderate debt (DM -271) | GE-Spot Q7: CHEAP (night) | Too warm: 2.3Â°C over[0m
[36m2025-10-28 01:55:32.964 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.65Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-28 01:55:32.964 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.602 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 01:55:32.964 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.3Â°C, outdoor=7.7Â°C, offset=0.7Â°C, change=0.03Â°C, Î”t=0.08h[0m
[36m2025-10-28 01:55:32.964 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.3Â°C, outdoor=7.7Â°C, offset=0.7Â°C, flow=30.5Â°C, DM=-271[0m
[36m2025-10-28 01:55:32.971 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.1Â°C/h trend[0m
[36m2025-10-28 01:55:32.972 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 01:55:32.975 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 01:55:32.975 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 01:55:32.975 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=36.6[0m
[36m2025-10-28 01:55:32.975 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 01:55:32.979 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 01:55:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 01:55:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.7Â°C (zone: Moderate Cold): block=-326, abort=-406[0m
[36m2025-10-28 01:55:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 01:55:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-271, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 01:55:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 20 quarters available, need 3 quarters (45 min), lookahead 5.0h[0m
[36m2025-10-28 01:55:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 18 windows evaluated[0m
[36m2025-10-28 01:55:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (1.8h away) â† SELECTED[0m
[36m2025-10-28 01:55:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (1.6h away)[0m
[36m2025-10-28 01:55:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (2.1h away)[0m
[36m2025-10-28 01:55:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (1.3h away)[0m
[36m2025-10-28 01:55:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (1.1h away)[0m
[32m2025-10-28 01:55:32.980 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 1.8h away[0m
[36m2025-10-28 01:55:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 01:55:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-271, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 01:55:32.984 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 01:55:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 01:55:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.7Â°C (zone: Moderate Cold): block=-326, abort=-406[0m
[36m2025-10-28 01:55:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 01:55:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-271, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 01:55:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 20 quarters available, need 3 quarters (45 min), lookahead 5.0h[0m
[36m2025-10-28 01:55:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 18 windows evaluated[0m
[36m2025-10-28 01:55:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (1.8h away) â† SELECTED[0m
[36m2025-10-28 01:55:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (1.6h away)[0m
[36m2025-10-28 01:55:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (2.1h away)[0m
[36m2025-10-28 01:55:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (1.3h away)[0m
[36m2025-10-28 01:55:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (1.1h away)[0m
[32m2025-10-28 01:55:32.984 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 1.8h away[0m
[36m2025-10-28 01:55:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 01:55:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-271, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 01:55:32.984 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 01:55:32.985 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.026 seconds (success: True)[0m
[36m2025-10-28 01:55:32.986 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (6.5 + 0.6 + 0.9)A Ã— 0.95 = 1.82 kW[0m
[36m2025-10-28 01:55:32.986 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 02:00:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 02:00:32.960 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.3Â°C (median of 9 sensors: 23.6Â°C, 21.2Â°C, 21.4Â°C, 23.3Â°C, 24.9Â°C, 24.1Â°C, 22.3Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-28 02:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -272.0[0m
[36m2025-10-28 02:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 36.6Â°C[0m
[36m2025-10-28 02:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.0Â°C[0m
[36m2025-10-28 02:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=6.5A, L2=0.6A, L3=0.9A[0m
[36m2025-10-28 02:00:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.3Â°C, outdoor 7.7Â°C, flow 30.0Â°C, DM -272[0m
[36m2025-10-28 02:00:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 30 Hz (1h avg: 33, 6h avg: 46, mode: space) - OK: Normal operation (30 Hz, 6h avg: 46 Hz)[0m
[36m2025-10-28 02:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 02:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 02:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 02:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 02:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 02:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 02:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 02:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 02:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 02:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 02:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 87}[0m
[36m2025-10-28 02:00:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 02:00:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 02:00:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 02:00:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 02:00:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 02:00:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 02:00:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 02:00:32.961 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 02:00:32.961 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q8 = 23.15 Ã¶re/kWh[0m
[36m2025-10-28 02:00:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 02:00:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 02:00:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 02:00:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 02:00:32.962 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 02:00:32.962 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-28 02:00:32.962 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 02:00:32.963 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 02:00:32.964 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-28 02:00:32.964 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:00:32.964 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 7.7Â°C: normal -126 to -326, warning -326[0m
[36m2025-10-28 02:00:32.964 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:00:32.964 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -326 (base: -326), critical -1500[0m
[36m2025-10-28 02:00:32.964 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=7.7Â°C, indoor_target=21.0Â°C, temp_diff=13.3Â°C, HC=0.180 kW/K -> flow=26.0Â°C[0m
[36m2025-10-28 02:00:32.964 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 02:00:32.964 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 02:00:32.964 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.5Â°C, current=30.0Â°C, error=-3.5Â°C, sensitivity=1.5 -> offset=-2.3[0m
[36m2025-10-28 02:00:32.964 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=7.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 02:00:32.964 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 30.0Â°C â†’ offset: -2.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -272)[0m
[36m2025-10-28 02:00:32.964 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Price classification Q8 (02:00): 23.15 â†’ CHEAP[0m
[32m2025-10-28 02:00:32.965 INFO (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.69Â°C - Learned pre-heat: Pre-heating: predicted drop 1.8Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 30.0Â°C â†’ offset: -2.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -272) | GE-Spot Q8: CHEAP (night) | Too warm: 2.3Â°C over[0m
[32m2025-10-28 02:00:32.965 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.69Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.8Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 30.0Â°C â†’ offset: -2.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -272) | GE-Spot Q8: CHEAP (night) | Too warm: 2.3Â°C over[0m
[36m2025-10-28 02:00:32.965 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.69Â°C, integer=0Â°C, fractional=0.69Â°C, accumulator_before=0.71Â°C[0m
[32m2025-10-28 02:00:32.965 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] âœ“ Accumulated fractional offset reached threshold: applying +1Â°C adjustment (accumulator: 1.40Â°C â†’ 0.40Â°C)[0m
[36m2025-10-28 02:00:32.965 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Accumulator triggered: total_accumulated=1.40Â°C, adjustment=+1Â°C, new_integer=1Â°C, remaining=0.40Â°C[0m
[36m2025-10-28 02:00:32.965 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset 0.69Â°C â†’ applying 1Â°C (accumulator: 0.40Â°C, needs 0.60Â°C more to trigger)[0m
[32m2025-10-28 02:00:32.966 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to 1Â°C (calculated: 0.69Â°C, accumulator: 0.40Â°C)[0m
[36m2025-10-28 02:00:32.966 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=1Â°C, original=0.69Â°C, accumulator=0.40Â°C[0m
[32m2025-10-28 02:00:32.966 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset 0.69Â°C to NIBE via MyUplink[0m
[36m2025-10-28 02:00:32.966 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.538 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 02:00:32.966 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.3Â°C, outdoor=7.7Â°C, offset=0.7Â°C, change=-0.03Â°C, Î”t=0.08h[0m
[36m2025-10-28 02:00:32.966 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.3Â°C, outdoor=7.7Â°C, offset=0.7Â°C, flow=30.0Â°C, DM=-272[0m
[36m2025-10-28 02:00:32.972 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.0Â°C/h trend[0m
[36m2025-10-28 02:00:32.972 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 02:00:32.973 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 02:00:32.973 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 02:00:32.973 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=36.6[0m
[36m2025-10-28 02:00:32.974 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:00:32.977 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 02:00:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:00:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.7Â°C (zone: Moderate Cold): block=-326, abort=-406[0m
[36m2025-10-28 02:00:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:00:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-272, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 02:00:32.977 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 16 quarters available, need 3 quarters (45 min), lookahead 4.0h[0m
[36m2025-10-28 02:00:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 14 windows evaluated[0m
[36m2025-10-28 02:00:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (1.7h away) â† SELECTED[0m
[36m2025-10-28 02:00:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (1.5h away)[0m
[36m2025-10-28 02:00:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (2.0h away)[0m
[36m2025-10-28 02:00:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (1.2h away)[0m
[36m2025-10-28 02:00:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (1.0h away)[0m
[32m2025-10-28 02:00:32.978 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 1.7h away[0m
[36m2025-10-28 02:00:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:00:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-272, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 02:00:32.985 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 02:00:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:00:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.7Â°C (zone: Moderate Cold): block=-326, abort=-406[0m
[36m2025-10-28 02:00:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:00:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-272, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 02:00:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 16 quarters available, need 3 quarters (45 min), lookahead 4.0h[0m
[36m2025-10-28 02:00:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 14 windows evaluated[0m
[36m2025-10-28 02:00:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (1.7h away) â† SELECTED[0m
[36m2025-10-28 02:00:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (1.5h away)[0m
[36m2025-10-28 02:00:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (2.0h away)[0m
[36m2025-10-28 02:00:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (1.2h away)[0m
[36m2025-10-28 02:00:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (1.0h away)[0m
[32m2025-10-28 02:00:32.986 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 1.7h away[0m
[36m2025-10-28 02:00:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:00:32.986 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-272, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 02:00:32.986 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 02:00:32.986 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.027 seconds (success: True)[0m
[36m2025-10-28 02:00:32.988 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (6.5 + 0.6 + 0.9)A Ã— 0.95 = 1.82 kW[0m
[36m2025-10-28 02:00:32.988 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 02:05:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 02:05:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.3Â°C (median of 9 sensors: 23.6Â°C, 21.2Â°C, 21.4Â°C, 23.3Â°C, 24.9Â°C, 24.1Â°C, 22.3Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-28 02:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -273.0[0m
[36m2025-10-28 02:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 36.6Â°C[0m
[36m2025-10-28 02:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.0Â°C[0m
[36m2025-10-28 02:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=6.5A, L2=0.6A, L3=0.9A[0m
[36m2025-10-28 02:05:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.3Â°C, outdoor 7.7Â°C, flow 30.0Â°C, DM -273[0m
[36m2025-10-28 02:05:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 31 Hz (1h avg: 32, 6h avg: 46, mode: space) - OK: Normal operation (31 Hz, 6h avg: 46 Hz)[0m
[36m2025-10-28 02:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 02:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 02:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 02:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 02:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 02:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 02:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 02:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 02:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 02:05:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 02:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 87}[0m
[36m2025-10-28 02:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 02:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 02:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 02:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 02:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 02:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 02:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 02:05:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 02:05:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q8 = 23.15 Ã¶re/kWh[0m
[36m2025-10-28 02:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 02:05:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 02:05:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 02:05:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 02:05:32.961 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 02:05:32.961 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-28 02:05:32.961 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 02:05:32.963 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 02:05:32.963 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-28 02:05:32.963 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:05:32.963 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 7.7Â°C: normal -126 to -326, warning -326[0m
[36m2025-10-28 02:05:32.963 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:05:32.963 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -326 (base: -326), critical -1500[0m
[36m2025-10-28 02:05:32.963 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=7.7Â°C, indoor_target=21.0Â°C, temp_diff=13.3Â°C, HC=0.180 kW/K -> flow=26.0Â°C[0m
[36m2025-10-28 02:05:32.963 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 02:05:32.964 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 02:05:32.964 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.5Â°C, current=30.0Â°C, error=-3.5Â°C, sensitivity=1.5 -> offset=-2.3[0m
[36m2025-10-28 02:05:32.964 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=7.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 02:05:32.964 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 30.0Â°C â†’ offset: -2.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -273)[0m
[36m2025-10-28 02:05:32.964 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Price classification Q8 (02:05): 23.15 â†’ CHEAP[0m
[32m2025-10-28 02:05:32.964 INFO (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.69Â°C - Learned pre-heat: Pre-heating: predicted drop 1.8Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 30.0Â°C â†’ offset: -2.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -273) | GE-Spot Q8: CHEAP (night) | Too warm: 2.3Â°C over[0m
[32m2025-10-28 02:05:32.965 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.69Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.8Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 30.0Â°C â†’ offset: -2.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -273) | GE-Spot Q8: CHEAP (night) | Too warm: 2.3Â°C over[0m
[36m2025-10-28 02:05:32.965 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.69Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-28 02:05:32.965 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.568 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 02:05:32.965 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.3Â°C, outdoor=7.7Â°C, offset=0.7Â°C, change=0.03Â°C, Î”t=0.08h[0m
[36m2025-10-28 02:05:32.965 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.3Â°C, outdoor=7.7Â°C, offset=0.7Â°C, flow=30.0Â°C, DM=-273[0m
[36m2025-10-28 02:05:32.966 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-28 02:05:32.966 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 02:05:32.967 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 02:05:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 02:05:32.967 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=36.6[0m
[36m2025-10-28 02:05:32.968 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:05:32.971 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 02:05:32.971 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:05:32.971 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.7Â°C (zone: Moderate Cold): block=-326, abort=-406[0m
[36m2025-10-28 02:05:32.971 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:05:32.971 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-273, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 02:05:32.971 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 16 quarters available, need 3 quarters (45 min), lookahead 4.0h[0m
[36m2025-10-28 02:05:32.972 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 14 windows evaluated[0m
[36m2025-10-28 02:05:32.972 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (1.7h away) â† SELECTED[0m
[36m2025-10-28 02:05:32.972 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (1.4h away)[0m
[36m2025-10-28 02:05:32.972 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (1.9h away)[0m
[36m2025-10-28 02:05:32.972 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (1.2h away)[0m
[36m2025-10-28 02:05:32.972 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (0.9h away)[0m
[32m2025-10-28 02:05:32.972 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 1.7h away[0m
[36m2025-10-28 02:05:32.972 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:05:32.972 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-273, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 02:05:32.980 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 02:05:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:05:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.7Â°C (zone: Moderate Cold): block=-326, abort=-406[0m
[36m2025-10-28 02:05:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:05:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-273, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 02:05:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 16 quarters available, need 3 quarters (45 min), lookahead 4.0h[0m
[36m2025-10-28 02:05:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 14 windows evaluated[0m
[36m2025-10-28 02:05:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (1.7h away) â† SELECTED[0m
[36m2025-10-28 02:05:32.980 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (1.4h away)[0m
[36m2025-10-28 02:05:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (1.9h away)[0m
[36m2025-10-28 02:05:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (1.2h away)[0m
[36m2025-10-28 02:05:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (0.9h away)[0m
[32m2025-10-28 02:05:32.981 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 1.7h away[0m
[36m2025-10-28 02:05:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:05:32.981 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-273, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 02:05:32.981 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 02:05:32.981 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.022 seconds (success: True)[0m
[36m2025-10-28 02:05:32.982 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (6.5 + 0.6 + 0.9)A Ã— 0.95 = 1.82 kW[0m
[36m2025-10-28 02:05:32.983 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 02:10:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 02:10:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.3Â°C (median of 9 sensors: 23.6Â°C, 21.2Â°C, 21.5Â°C, 23.3Â°C, 24.9Â°C, 24.1Â°C, 22.3Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-28 02:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -272.0[0m
[36m2025-10-28 02:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 36.6Â°C[0m
[36m2025-10-28 02:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.0Â°C[0m
[36m2025-10-28 02:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=6.5A, L2=0.6A, L3=0.9A[0m
[36m2025-10-28 02:10:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.3Â°C, outdoor 7.7Â°C, flow 30.0Â°C, DM -272[0m
[36m2025-10-28 02:10:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 30 Hz (1h avg: 32, 6h avg: 46, mode: space) - OK: Normal operation (30 Hz, 6h avg: 46 Hz)[0m
[36m2025-10-28 02:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 02:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 02:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 02:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 02:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 02:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 02:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 02:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 02:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 02:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 02:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 87}[0m
[36m2025-10-28 02:10:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 02:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 02:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 02:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 02:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 02:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 02:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 02:10:32.960 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 02:10:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q8 = 23.15 Ã¶re/kWh[0m
[36m2025-10-28 02:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 02:10:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 02:10:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 02:10:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 02:10:32.962 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 02:10:32.962 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-28 02:10:32.962 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 02:10:32.963 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 02:10:32.963 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-28 02:10:32.963 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:10:32.963 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 7.7Â°C: normal -126 to -326, warning -326[0m
[36m2025-10-28 02:10:32.963 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:10:32.963 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -326 (base: -326), critical -1500[0m
[36m2025-10-28 02:10:32.964 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=7.7Â°C, indoor_target=21.0Â°C, temp_diff=13.3Â°C, HC=0.180 kW/K -> flow=26.0Â°C[0m
[36m2025-10-28 02:10:32.964 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 02:10:32.964 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 02:10:32.964 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.5Â°C, current=30.0Â°C, error=-3.5Â°C, sensitivity=1.5 -> offset=-2.3[0m
[36m2025-10-28 02:10:32.964 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=7.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 02:10:32.964 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 30.0Â°C â†’ offset: -2.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -272)[0m
[36m2025-10-28 02:10:32.964 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Price classification Q8 (02:10): 23.15 â†’ CHEAP[0m
[32m2025-10-28 02:10:32.964 INFO (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.69Â°C - Learned pre-heat: Pre-heating: predicted drop 1.8Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 30.0Â°C â†’ offset: -2.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -272) | GE-Spot Q8: CHEAP (night) | Too warm: 2.3Â°C over[0m
[32m2025-10-28 02:10:32.965 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.69Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.8Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 30.0Â°C â†’ offset: -2.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -272) | GE-Spot Q8: CHEAP (night) | Too warm: 2.3Â°C over[0m
[36m2025-10-28 02:10:32.965 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.69Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-28 02:10:32.965 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 2.235 kW from sensor.gen24_elnat_import_effekt[0m
[32m2025-10-28 02:10:32.965 INFO (MainThread) [custom_components.effektguard.coordinator] New daily peak: 2.24 kW at 02:10:32 (quarter 8, source: external_meter)[0m
[36m2025-10-28 02:10:32.965 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.3Â°C, outdoor=7.7Â°C, offset=0.7Â°C, change=-0.04Â°C, Î”t=0.08h[0m
[36m2025-10-28 02:10:32.965 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.3Â°C, outdoor=7.7Â°C, offset=0.7Â°C, flow=30.0Â°C, DM=-272[0m
[36m2025-10-28 02:10:32.974 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.0Â°C/h trend[0m
[36m2025-10-28 02:10:32.974 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 02:10:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 02:10:32.976 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 02:10:32.976 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=36.6[0m
[36m2025-10-28 02:10:32.976 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:10:32.984 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 02:10:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:10:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.7Â°C (zone: Moderate Cold): block=-326, abort=-406[0m
[36m2025-10-28 02:10:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:10:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-272, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 02:10:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 16 quarters available, need 3 quarters (45 min), lookahead 4.0h[0m
[36m2025-10-28 02:10:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 14 windows evaluated[0m
[36m2025-10-28 02:10:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (1.6h away) â† SELECTED[0m
[36m2025-10-28 02:10:32.984 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (1.3h away)[0m
[36m2025-10-28 02:10:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (1.8h away)[0m
[36m2025-10-28 02:10:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (1.1h away)[0m
[36m2025-10-28 02:10:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (0.8h away)[0m
[32m2025-10-28 02:10:32.985 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 1.6h away[0m
[36m2025-10-28 02:10:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:10:32.985 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-272, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 02:10:32.989 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 02:10:32.989 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:10:32.989 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.7Â°C (zone: Moderate Cold): block=-326, abort=-406[0m
[36m2025-10-28 02:10:32.989 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:10:32.989 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-272, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 02:10:32.989 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 16 quarters available, need 3 quarters (45 min), lookahead 4.0h[0m
[36m2025-10-28 02:10:32.989 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 14 windows evaluated[0m
[36m2025-10-28 02:10:32.989 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (1.6h away) â† SELECTED[0m
[36m2025-10-28 02:10:32.990 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (1.3h away)[0m
[36m2025-10-28 02:10:32.990 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (1.8h away)[0m
[36m2025-10-28 02:10:32.990 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (1.1h away)[0m
[36m2025-10-28 02:10:32.990 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (0.8h away)[0m
[32m2025-10-28 02:10:32.990 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 1.6h away[0m
[36m2025-10-28 02:10:32.990 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:10:32.990 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-272, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 02:10:32.990 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 02:10:32.990 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.031 seconds (success: True)[0m
[36m2025-10-28 02:10:32.991 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (6.5 + 0.6 + 0.9)A Ã— 0.95 = 1.82 kW[0m
[36m2025-10-28 02:10:32.992 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 02:15:32.959 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 02:15:32.959 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.3Â°C (median of 9 sensors: 23.6Â°C, 21.2Â°C, 21.4Â°C, 23.3Â°C, 24.9Â°C, 24.1Â°C, 22.3Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-28 02:15:32.959 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -271.0[0m
[36m2025-10-28 02:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 36.6Â°C[0m
[36m2025-10-28 02:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.0Â°C[0m
[36m2025-10-28 02:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=6.5A, L2=0.6A, L3=0.9A[0m
[36m2025-10-28 02:15:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.3Â°C, outdoor 7.7Â°C, flow 30.0Â°C, DM -271[0m
[36m2025-10-28 02:15:32.960 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 30 Hz (1h avg: 32, 6h avg: 46, mode: space) - OK: Normal operation (30 Hz, 6h avg: 46 Hz)[0m
[36m2025-10-28 02:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 02:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 02:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 02:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 02:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 02:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 02:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 02:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 02:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 02:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 02:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 86}[0m
[36m2025-10-28 02:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 02:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 02:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 02:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 02:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 02:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 02:15:32.960 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 02:15:32.961 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 02:15:32.961 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q9 = 19.09 Ã¶re/kWh[0m
[36m2025-10-28 02:15:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 02:15:32.961 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 02:15:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 02:15:32.962 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 02:15:32.962 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 02:15:32.962 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-28 02:15:32.962 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 02:15:32.963 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 02:15:32.963 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 96 tomorrow periods[0m
[36m2025-10-28 02:15:32.963 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:15:32.963 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 7.7Â°C: normal -126 to -326, warning -326[0m
[36m2025-10-28 02:15:32.963 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:15:32.963 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -326 (base: -326), critical -1500[0m
[36m2025-10-28 02:15:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=7.7Â°C, indoor_target=21.0Â°C, temp_diff=13.3Â°C, HC=0.180 kW/K -> flow=26.0Â°C[0m
[36m2025-10-28 02:15:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 02:15:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 02:15:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.5Â°C, current=30.0Â°C, error=-3.5Â°C, sensitivity=1.5 -> offset=-2.3[0m
[36m2025-10-28 02:15:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=7.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 02:15:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 30.0Â°C â†’ offset: -2.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -271)[0m
[36m2025-10-28 02:15:32.964 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Price classification Q9 (02:15): 19.09 â†’ CHEAP[0m
[32m2025-10-28 02:15:32.964 INFO (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.69Â°C - Learned pre-heat: Pre-heating: predicted drop 1.8Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 30.0Â°C â†’ offset: -2.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -271) | GE-Spot Q9: CHEAP (night) | Too warm: 2.3Â°C over[0m
[32m2025-10-28 02:15:32.965 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.69Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.8Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 30.0Â°C â†’ offset: -2.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -271) | GE-Spot Q9: CHEAP (night) | Too warm: 2.3Â°C over[0m
[36m2025-10-28 02:15:32.965 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.69Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-28 02:15:32.965 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 4.635 kW from sensor.gen24_elnat_import_effekt[0m
[32m2025-10-28 02:15:32.965 INFO (MainThread) [custom_components.effektguard.coordinator] New daily peak: 4.63 kW at 02:15:32 (quarter 9, source: external_meter)[0m
[36m2025-10-28 02:15:32.965 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.3Â°C, outdoor=7.7Â°C, offset=0.7Â°C, change=0.03Â°C, Î”t=0.08h[0m
[36m2025-10-28 02:15:32.965 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.3Â°C, outdoor=7.7Â°C, offset=0.7Â°C, flow=30.0Â°C, DM=-271[0m
[36m2025-10-28 02:15:32.965 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-28 02:15:32.965 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 02:15:32.969 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 02:15:32.969 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 02:15:32.969 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=36.6[0m
[36m2025-10-28 02:15:32.969 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:15:32.973 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 02:15:32.974 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:15:32.974 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.7Â°C (zone: Moderate Cold): block=-326, abort=-406[0m
[36m2025-10-28 02:15:32.974 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:15:32.974 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-271, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 02:15:32.974 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 16 quarters available, need 3 quarters (45 min), lookahead 4.0h[0m
[36m2025-10-28 02:15:32.974 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 14 windows evaluated[0m
[36m2025-10-28 02:15:32.974 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (1.5h away) â† SELECTED[0m
[36m2025-10-28 02:15:32.974 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (1.2h away)[0m
[36m2025-10-28 02:15:32.974 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (1.7h away)[0m
[36m2025-10-28 02:15:32.974 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (1.0h away)[0m
[36m2025-10-28 02:15:32.974 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (0.7h away)[0m
[32m2025-10-28 02:15:32.974 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 1.5h away[0m
[36m2025-10-28 02:15:32.974 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:15:32.974 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-271, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 02:15:32.978 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 02:15:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:15:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.7Â°C (zone: Moderate Cold): block=-326, abort=-406[0m
[36m2025-10-28 02:15:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:15:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-271, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 02:15:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 16 quarters available, need 3 quarters (45 min), lookahead 4.0h[0m
[36m2025-10-28 02:15:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 14 windows evaluated[0m
[36m2025-10-28 02:15:32.978 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (1.5h away) â† SELECTED[0m
[36m2025-10-28 02:15:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (1.2h away)[0m
[36m2025-10-28 02:15:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (1.7h away)[0m
[36m2025-10-28 02:15:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (1.0h away)[0m
[36m2025-10-28 02:15:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (0.7h away)[0m
[32m2025-10-28 02:15:32.979 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 1.5h away[0m
[36m2025-10-28 02:15:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:15:32.979 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-271, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 02:15:32.979 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 02:15:32.979 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.020 seconds (success: True)[0m
[36m2025-10-28 02:15:32.980 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (6.5 + 0.6 + 0.9)A Ã— 0.95 = 1.82 kW[0m
[36m2025-10-28 02:15:32.981 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[32m2025-10-28 02:20:31.672 INFO (MainThread) [custom_components.effektguard] Unloading EffektGuard integration[0m
[36m2025-10-28 02:20:31.673 DEBUG (MainThread) [custom_components.effektguard.coordinator] Shutting down EffektGuard coordinator[0m
[36m2025-10-28 02:20:31.675 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved learned data to storage[0m
[36m2025-10-28 02:20:31.675 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved learning data[0m
[36m2025-10-28 02:20:31.676 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved effect tracking data[0m
[32m2025-10-28 02:20:31.677 INFO (MainThread) [custom_components.effektguard.coordinator] Coordinator shutdown complete[0m
[36m2025-10-28 02:20:31.677 DEBUG (MainThread) [custom_components.effektguard] Coordinator shutdown complete[0m
[36m2025-10-28 02:20:31.680 DEBUG (MainThread) [custom_components.effektguard] Unregistered service: force_offset[0m
[36m2025-10-28 02:20:31.680 DEBUG (MainThread) [custom_components.effektguard] Unregistered service: reset_peak_tracking[0m
[36m2025-10-28 02:20:31.680 DEBUG (MainThread) [custom_components.effektguard] Unregistered service: boost_heating[0m
[36m2025-10-28 02:20:31.681 DEBUG (MainThread) [custom_components.effektguard] Unregistered service: calculate_optimal_schedule[0m
[32m2025-10-28 02:20:31.681 INFO (MainThread) [custom_components.effektguard] EffektGuard services unregistered successfully[0m
[36m2025-10-28 02:20:31.681 DEBUG (MainThread) [custom_components.effektguard.coordinator] Shutting down EffektGuard coordinator[0m
[36m2025-10-28 02:20:31.686 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved learned data to storage[0m
[36m2025-10-28 02:20:31.687 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved learning data[0m
[36m2025-10-28 02:20:31.692 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved effect tracking data[0m
[32m2025-10-28 02:20:31.692 INFO (MainThread) [custom_components.effektguard.coordinator] Coordinator shutdown complete[0m
[32m2025-10-28 02:20:31.692 INFO (MainThread) [custom_components.effektguard] Setting up EffektGuard integration[0m
[36m2025-10-28 02:20:31.692 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] Latitude 55.60 matches zone 'moderate_cold' (54.5-56.0)[0m
[32m2025-10-28 02:20:31.692 INFO (MainThread) [custom_components.effektguard.optimization.climate_zones] Climate zone detected: Moderate Cold (Moderate winter heating demands) at latitude 55.60Â°N - Winter avg: -1.0Â°C, DM normal range: -300 to -500[0m
[32m2025-10-28 02:20:31.692 INFO (MainThread) [custom_components.effektguard.optimization.weather_compensation] AdaptiveClimateSystem initialized: latitude=55.60Â° -> Moderate Cold zone (winter avg low: -1.0Â°C, base safety margin: 0.5Â°C)[0m
[36m2025-10-28 02:20:31.692 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] Latitude 55.60 matches zone 'moderate_cold' (54.5-56.0)[0m
[32m2025-10-28 02:20:31.693 INFO (MainThread) [custom_components.effektguard.optimization.climate_zones] Climate zone detected: Moderate Cold (Moderate winter heating demands) at latitude 55.60Â°N - Winter avg: -1.0Â°C, DM normal range: -300 to -500[0m
[32m2025-10-28 02:20:31.693 INFO (MainThread) [custom_components.effektguard.optimization.decision_engine] Climate zone: Moderate Cold (moderate_cold) - DM thresholds adapted for Moderate winter heating demands[0m
[36m2025-10-28 02:20:31.693 DEBUG (MainThread) [custom_components.effektguard.optimization.weather_compensation] WeatherCompensationCalculator initialized: HC=180.0 W/Â°C, radiator_output=None W, type=radiator[0m
[32m2025-10-28 02:20:31.693 INFO (MainThread) [custom_components.effektguard.optimization.decision_engine] Weather compensation initialized: HC=180.0 W/Â°C, radiator=not configured W, type=radiator[0m
[32m2025-10-28 02:20:31.694 INFO (MainThread) [custom_components.effektguard.optimization.effect_manager] Loaded 3 monthly peaks[0m
[32m2025-10-28 02:20:31.698 INFO (MainThread) [custom_components.effektguard.coordinator] Loaded heat pump model: F750 (F-series ASHP)[0m
[32m2025-10-28 02:20:31.698 INFO (MainThread) [custom_components.effektguard.coordinator] Detected climate region: Southern Sweden (MalmÃ¶/Gothenburg) (latitude: 55.60Â°N)[0m
[36m2025-10-28 02:20:31.698 DEBUG (MainThread) [custom_components.effektguard.utils.compressor_monitor] CompressorHealthMonitor initialized (max 24 hours, 1440 samples)[0m
[32m2025-10-28 02:20:31.698 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimizer initialized with climate-aware thresholds: Moderate Cold zone[0m
[32m2025-10-28 02:20:31.698 INFO (MainThread) [custom_components.effektguard.coordinator] DHW demand periods configured: ['07:00 (45.0Â°C)', '20:00 (45.0Â°C)'][0m
[36m2025-10-28 02:20:31.698 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW periods configured: ['7:00', '20:00'] (types: ['int', 'int'])[0m
[32m2025-10-28 02:20:31.698 INFO (MainThread) [custom_components.effektguard.coordinator] Restored monthly peak: 11.32 kW (3 peaks loaded)[0m
[36m2025-10-28 02:20:31.698 DEBUG (MainThread) [custom_components.effektguard.coordinator] Initializing learning modules...[0m
[32m2025-10-28 02:20:31.706 INFO (MainThread) [custom_components.effektguard.coordinator] Loaded learned data from storage (version 1, updated 2025-10-28T01:20:31.681149+00:00)[0m
[32m2025-10-28 02:20:31.706 INFO (MainThread) [custom_components.effektguard.coordinator] Restored last offset: 0.7Â°C from 2025-10-28T01:00:32.966559+00:00[0m
[32m2025-10-28 02:20:31.706 INFO (MainThread) [custom_components.effektguard.coordinator] Restored thermal model: mass=2.00, UFH=unknown[0m
[32m2025-10-28 02:20:31.706 INFO (MainThread) [custom_components.effektguard.coordinator] Restored thermal predictor with 96 historical snapshots[0m
[32m2025-10-28 02:20:31.706 INFO (MainThread) [custom_components.effektguard.coordinator] Restored weather patterns: 0 weeks of data[0m
[32m2025-10-28 02:20:31.706 INFO (MainThread) [custom_components.effektguard.coordinator] Restored last Legionella boost: 2025-10-20 00:35:42.242714+00:00[0m
[36m2025-10-28 02:20:31.709 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Found NIBE entity offset: number.f750_cu_3x400v_heating_offset_climate_system_1[0m
[36m2025-10-28 02:20:31.709 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Found NIBE entity outdoor_temp: sensor.f750_cu_3x400v_current_outd_temp_bt1[0m
[36m2025-10-28 02:20:31.709 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Found NIBE entity supply_temp: sensor.f750_cu_3x400v_heating_medium_supply_bt63[0m
[36m2025-10-28 02:20:31.709 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Found NIBE entity dhw_charging_temp: sensor.f750_cu_3x400v_heating_medium_supply_bt63[0m
[36m2025-10-28 02:20:31.709 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Found NIBE entity return_temp: sensor.f750_cu_3x400v_return_line_bt3[0m
[36m2025-10-28 02:20:31.709 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Found NIBE entity hot_water_status: sensor.f750_cu_3x400v_hot_water_top_bt7[0m
[36m2025-10-28 02:20:31.709 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Found NIBE entity dhw_top_temp: sensor.f750_cu_3x400v_hot_water_top_bt7[0m
[36m2025-10-28 02:20:31.710 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Found NIBE entity indoor_temp: sensor.f750_cu_3x400v_room_temperature_bt50[0m
[36m2025-10-28 02:20:31.710 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Found NIBE entity phase3_current: sensor.f750_cu_3x400v_current_be3[0m
[36m2025-10-28 02:20:31.710 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Found NIBE entity phase2_current: sensor.f750_cu_3x400v_current_be2[0m
[36m2025-10-28 02:20:31.710 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Found NIBE entity phase1_current: sensor.f750_cu_3x400v_current_be1[0m
[36m2025-10-28 02:20:31.710 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Found NIBE entity degree_minutes: sensor.f750_cu_3x400v_degree_minutes[0m
[36m2025-10-28 02:20:31.710 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Found NIBE entity compressor_status: sensor.f750_cu_3x400v_current_compressor_frequency[0m
[36m2025-10-28 02:20:31.710 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Found NIBE entity compressor_hz: sensor.f750_cu_3x400v_current_compressor_frequency[0m
[32m2025-10-28 02:20:31.711 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE Entity Discovery: Found 14 entities[0m
[32m2025-10-28 02:20:31.711 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter]   offset: number.f750_cu_3x400v_heating_offset_climate_system_1 = 1.0 [0m
[32m2025-10-28 02:20:31.711 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter]   outdoor_temp: sensor.f750_cu_3x400v_current_outd_temp_bt1 = 7.7 Â°C[0m
[32m2025-10-28 02:20:31.711 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter]   supply_temp: sensor.f750_cu_3x400v_heating_medium_supply_bt63 = 30.5 Â°C[0m
[32m2025-10-28 02:20:31.711 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter]   dhw_charging_temp: sensor.f750_cu_3x400v_heating_medium_supply_bt63 = 30.5 Â°C[0m
[32m2025-10-28 02:20:31.711 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter]   return_temp: sensor.f750_cu_3x400v_return_line_bt3 = 28.4 Â°C[0m
[32m2025-10-28 02:20:31.711 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter]   hot_water_status: sensor.f750_cu_3x400v_hot_water_top_bt7 = 36.6 Â°C[0m
[32m2025-10-28 02:20:31.711 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter]   dhw_top_temp: sensor.f750_cu_3x400v_hot_water_top_bt7 = 36.6 Â°C[0m
[32m2025-10-28 02:20:31.711 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter]   indoor_temp: sensor.f750_cu_3x400v_room_temperature_bt50 = 23.6 Â°C[0m
[32m2025-10-28 02:20:31.716 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter]   phase3_current: sensor.f750_cu_3x400v_current_be3 = 0.9 A[0m
[32m2025-10-28 02:20:31.716 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter]   phase2_current: sensor.f750_cu_3x400v_current_be2 = 0.6 A[0m
[32m2025-10-28 02:20:31.716 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter]   phase1_current: sensor.f750_cu_3x400v_current_be1 = 6.5 A[0m
[32m2025-10-28 02:20:31.716 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter]   degree_minutes: sensor.f750_cu_3x400v_degree_minutes = -268.0 [0m
[32m2025-10-28 02:20:31.716 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter]   compressor_status: sensor.f750_cu_3x400v_current_compressor_frequency = 28.0 Hz[0m
[32m2025-10-28 02:20:31.716 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter]   compressor_hz: sensor.f750_cu_3x400v_current_compressor_frequency = 28.0 Hz[0m
[36m2025-10-28 02:20:31.716 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] Loading BT7 temperature history from 2025-10-14 01:20:31.716338+00:00 to 2025-10-28 01:20:31.716338+00:00 (14 days)[0m
[32m2025-10-28 02:20:31.744 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] Loaded 886 BT7 temperature readings from past 14 days (max: 56.1Â°C at 2025-10-20 00:35:42.242714+00:00)[0m
[32m2025-10-28 02:20:31.744 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] Detected previous Legionella boost from history: 56.1Â°C at 2025-10-20 00:35:42.242714+00:00 (192.7 hours ago)[0m
[32m2025-10-28 02:20:31.745 INFO (MainThread) [custom_components.effektguard.coordinator] Learning modules initialized successfully[0m
[36m2025-10-28 02:20:31.745 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 02:20:31.745 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.3Â°C (median of 9 sensors: 23.6Â°C, 21.2Â°C, 21.4Â°C, 23.3Â°C, 24.9Â°C, 24.1Â°C, 22.3Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-28 02:20:31.745 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -268.0[0m
[36m2025-10-28 02:20:31.745 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 36.6Â°C[0m
[36m2025-10-28 02:20:31.745 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.5Â°C[0m
[36m2025-10-28 02:20:31.745 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=6.5A, L2=0.6A, L3=0.9A[0m
[36m2025-10-28 02:20:31.745 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.3Â°C, outdoor 7.7Â°C, flow 30.5Â°C, DM -268[0m
[32m2025-10-28 02:20:31.745 INFO (MainThread) [custom_components.effektguard.coordinator] EffektGuard fully initialized - NIBE entities available[0m
[36m2025-10-28 02:20:31.745 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 28 Hz (1h avg: 28, 6h avg: 28, mode: space) - OK: Normal operation (28 Hz, 6h avg: 28 Hz)[0m
[36m2025-10-28 02:20:31.745 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 02:20:31.745 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 02:20:31.745 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 02:20:31.745 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 02:20:31.745 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 02:20:31.745 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 02:20:31.745 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 02:20:31.745 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 02:20:31.745 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 02:20:31.745 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 02:20:31.745 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 86}[0m
[36m2025-10-28 02:20:31.745 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 02:20:31.745 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 02:20:31.745 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 02:20:31.746 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 02:20:31.746 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 02:20:31.746 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 02:20:31.746 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 02:20:31.746 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 02:20:31.746 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q9 = 19.09 Ã¶re/kWh[0m
[36m2025-10-28 02:20:31.746 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 02:20:31.746 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 02:20:31.747 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 02:20:31.747 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 02:20:31.747 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 02:20:31.747 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-28 02:20:31.748 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 02:20:31.749 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 02:20:31.749 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 02:20:31.750 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:20:31.750 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 7.7Â°C: normal -126 to -326, warning -326[0m
[36m2025-10-28 02:20:31.750 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:20:31.750 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -326 (base: -326), critical -1500[0m
[36m2025-10-28 02:20:31.750 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=7.7Â°C, indoor_target=21.0Â°C, temp_diff=13.3Â°C, HC=0.180 kW/K -> flow=26.0Â°C[0m
[36m2025-10-28 02:20:31.750 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 02:20:31.750 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 02:20:31.750 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.5Â°C, current=30.5Â°C, error=-4.0Â°C, sensitivity=1.5 -> offset=-2.6[0m
[36m2025-10-28 02:20:31.750 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=7.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 02:20:31.750 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 30.5Â°C â†’ offset: -2.6Â°C; Weight: 0.20; Deferred: Moderate debt (DM -268)[0m
[36m2025-10-28 02:20:31.750 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Price classification Q9 (02:20): 19.09 â†’ CHEAP[0m
[32m2025-10-28 02:20:31.750 INFO (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.66Â°C - Learned pre-heat: Pre-heating: predicted drop 1.8Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 30.5Â°C â†’ offset: -2.6Â°C; Weight: 0.20; Deferred: Moderate debt (DM -268) | GE-Spot Q9: CHEAP (night) | Too warm: 2.3Â°C over[0m
[32m2025-10-28 02:20:31.751 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.66Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.8Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 30.5Â°C â†’ offset: -2.6Â°C; Weight: 0.20; Deferred: Moderate debt (DM -268) | GE-Spot Q9: CHEAP (night) | Too warm: 2.3Â°C over[0m
[36m2025-10-28 02:20:31.751 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.66Â°C, integer=0Â°C, fractional=0.66Â°C, accumulator_before=0.00Â°C[0m
[36m2025-10-28 02:20:31.751 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: 0.66Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-28 02:20:31.751 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.66Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-28 02:20:31.751 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 4.621 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 02:20:31.751 DEBUG (MainThread) [custom_components.effektguard.coordinator] External power sensor marked as available[0m
[32m2025-10-28 02:20:31.751 INFO (MainThread) [custom_components.effektguard.coordinator] New daily peak: 4.62 kW at 02:20:31 (quarter 9, source: external_meter)[0m
[36m2025-10-28 02:20:31.751 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.3Â°C, outdoor=7.7Â°C, offset=0.7Â°C, change=0.00Â°C, Î”t=0.00h[0m
[36m2025-10-28 02:20:31.751 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.3Â°C, outdoor=7.7Â°C, offset=0.7Â°C, flow=30.5Â°C, DM=-268[0m
[36m2025-10-28 02:20:31.757 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.0Â°C/h trend[0m
[36m2025-10-28 02:20:31.757 DEBUG (MainThread) [custom_components.effektguard.optimization.weather_learning] Recorded weather pattern 10-4: avg=7.9Â°C, range=3.8Â°C, volatility=0.9[0m
[36m2025-10-28 02:20:31.757 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded weather pattern for 2025-10-28[0m
[36m2025-10-28 02:20:31.757 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 02:20:31.761 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved learned data to storage[0m
[36m2025-10-28 02:20:31.761 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 02:20:31.761 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 02:20:31.761 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=36.6[0m
[36m2025-10-28 02:20:31.761 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:20:31.763 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 02:20:31.763 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:20:31.763 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.7Â°C (zone: Moderate Cold): block=-326, abort=-406[0m
[36m2025-10-28 02:20:31.763 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:20:31.763 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-268, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 02:20:31.764 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 16 quarters available, need 3 quarters (45 min), lookahead 4.0h[0m
[36m2025-10-28 02:20:31.764 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 14 windows evaluated[0m
[36m2025-10-28 02:20:31.764 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (1.4h away) â† SELECTED[0m
[36m2025-10-28 02:20:31.764 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (1.2h away)[0m
[36m2025-10-28 02:20:31.764 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (1.7h away)[0m
[36m2025-10-28 02:20:31.764 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (0.9h away)[0m
[36m2025-10-28 02:20:31.764 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (0.7h away)[0m
[32m2025-10-28 02:20:31.764 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 1.4h away[0m
[36m2025-10-28 02:20:31.764 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:20:31.764 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-268, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 02:20:31.766 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 02:20:31.766 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:20:31.766 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.7Â°C (zone: Moderate Cold): block=-326, abort=-406[0m
[36m2025-10-28 02:20:31.766 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:20:31.766 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-268, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 02:20:31.766 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 16 quarters available, need 3 quarters (45 min), lookahead 4.0h[0m
[36m2025-10-28 02:20:31.766 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 14 windows evaluated[0m
[36m2025-10-28 02:20:31.766 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (1.4h away) â† SELECTED[0m
[36m2025-10-28 02:20:31.766 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (1.2h away)[0m
[36m2025-10-28 02:20:31.766 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (1.7h away)[0m
[36m2025-10-28 02:20:31.766 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (0.9h away)[0m
[36m2025-10-28 02:20:31.766 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (0.7h away)[0m
[32m2025-10-28 02:20:31.766 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 1.4h away[0m
[36m2025-10-28 02:20:31.766 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:20:31.766 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-268, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 02:20:31.766 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 02:20:31.767 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.022 seconds (success: True)[0m
[32m2025-10-28 02:20:31.767 INFO (MainThread) [custom_components.effektguard.coordinator] External power sensor sensor.gen24_elnat_import_effekt already available at startup[0m
[36m2025-10-28 02:20:31.767 DEBUG (MainThread) [custom_components.effektguard.climate] Restored HVAC mode: heat from previous state[0m
[36m2025-10-28 02:20:31.770 DEBUG (MainThread) [custom_components.effektguard.sensor] Restored peak_today: 4.63[0m
[36m2025-10-28 02:20:31.770 DEBUG (MainThread) [custom_components.effektguard.sensor] Restored peak_this_month: 11.32[0m
[36m2025-10-28 02:20:31.770 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (6.5 + 0.6 + 0.9)A Ã— 0.95 = 1.82 kW[0m
[36m2025-10-28 02:20:31.772 DEBUG (MainThread) [custom_components.effektguard.sensor] Could not restore compressor_health, will use coordinator value[0m
[36m2025-10-28 02:20:31.772 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 02:20:31.774 DEBUG (MainThread) [custom_components.effektguard.sensor] Restored savings_estimate: 100.00[0m
[36m2025-10-28 02:20:31.777 DEBUG (MainThread) [custom_components.effektguard] Registered service: force_offset[0m
[36m2025-10-28 02:20:31.777 DEBUG (MainThread) [custom_components.effektguard] Registered service: reset_peak_tracking[0m
[36m2025-10-28 02:20:31.777 DEBUG (MainThread) [custom_components.effektguard] Registered service: boost_heating[0m
[36m2025-10-28 02:20:31.777 DEBUG (MainThread) [custom_components.effektguard] Registered service: calculate_optimal_schedule[0m
[32m2025-10-28 02:20:31.777 INFO (MainThread) [custom_components.effektguard] EffektGuard services registered successfully[0m
[32m2025-10-28 02:20:31.777 INFO (MainThread) [custom_components.effektguard] EffektGuard setup complete[0m
[36m2025-10-28 02:25:31.319 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 02:25:31.320 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.4Â°C (median of 9 sensors: 23.6Â°C, 21.1Â°C, 21.4Â°C, 23.4Â°C, 24.9Â°C, 24.1Â°C, 22.3Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-28 02:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -266.0[0m
[36m2025-10-28 02:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 36.6Â°C[0m
[36m2025-10-28 02:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.5Â°C[0m
[36m2025-10-28 02:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=6.5A, L2=0.6A, L3=0.9A[0m
[36m2025-10-28 02:25:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.4Â°C, outdoor 7.7Â°C, flow 30.5Â°C, DM -266[0m
[36m2025-10-28 02:25:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 27 Hz (1h avg: 28, 6h avg: 28, mode: space) - OK: Normal operation (27 Hz, 6h avg: 28 Hz)[0m
[36m2025-10-28 02:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 02:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 02:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 02:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 02:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 02:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 02:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 02:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 02:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 02:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 02:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 86}[0m
[36m2025-10-28 02:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 02:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 02:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 02:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 02:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 02:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 02:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 02:25:31.321 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 02:25:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q9 = 19.09 Ã¶re/kWh[0m
[36m2025-10-28 02:25:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 02:25:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 02:25:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 02:25:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 02:25:31.322 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 02:25:31.322 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-28 02:25:31.322 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 02:25:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 02:25:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 02:25:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:25:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 7.7Â°C: normal -126 to -326, warning -326[0m
[36m2025-10-28 02:25:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:25:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -326 (base: -326), critical -1500[0m
[36m2025-10-28 02:25:31.325 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=7.7Â°C, indoor_target=21.0Â°C, temp_diff=13.3Â°C, HC=0.180 kW/K -> flow=26.0Â°C[0m
[36m2025-10-28 02:25:31.325 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 02:25:31.325 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 02:25:31.325 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.5Â°C, current=30.5Â°C, error=-4.0Â°C, sensitivity=1.5 -> offset=-2.6[0m
[36m2025-10-28 02:25:31.325 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=7.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 02:25:31.325 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 30.5Â°C â†’ offset: -2.6Â°C; Weight: 0.20; Deferred: Moderate debt (DM -266)[0m
[36m2025-10-28 02:25:31.325 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Price classification Q9 (02:25): 19.09 â†’ CHEAP[0m
[32m2025-10-28 02:25:31.325 INFO (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.65Â°C - Learned pre-heat: Pre-heating: predicted drop 1.8Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 30.5Â°C â†’ offset: -2.6Â°C; Weight: 0.20; Deferred: Moderate debt (DM -266) | GE-Spot Q9: CHEAP (night) | Too warm: 2.4Â°C over[0m
[32m2025-10-28 02:25:31.325 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.65Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.8Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 30.5Â°C â†’ offset: -2.6Â°C; Weight: 0.20; Deferred: Moderate debt (DM -266) | GE-Spot Q9: CHEAP (night) | Too warm: 2.4Â°C over[0m
[36m2025-10-28 02:25:31.326 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.65Â°C, integer=0Â°C, fractional=0.65Â°C, accumulator_before=0.66Â°C[0m
[32m2025-10-28 02:25:31.326 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] âœ“ Accumulated fractional offset reached threshold: applying +1Â°C adjustment (accumulator: 1.31Â°C â†’ 0.31Â°C)[0m
[36m2025-10-28 02:25:31.326 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Accumulator triggered: total_accumulated=1.31Â°C, adjustment=+1Â°C, new_integer=1Â°C, remaining=0.31Â°C[0m
[36m2025-10-28 02:25:31.326 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset 0.65Â°C â†’ applying 1Â°C (accumulator: 0.31Â°C, needs 0.69Â°C more to trigger)[0m
[32m2025-10-28 02:25:31.326 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to 1Â°C (calculated: 0.65Â°C, accumulator: 0.31Â°C)[0m
[36m2025-10-28 02:25:31.327 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=1Â°C, original=0.65Â°C, accumulator=0.31Â°C[0m
[32m2025-10-28 02:25:31.327 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset 0.65Â°C to NIBE via MyUplink[0m
[36m2025-10-28 02:25:31.327 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 4.602 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 02:25:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.4Â°C, outdoor=7.7Â°C, offset=0.6Â°C, change=0.08Â°C, Î”t=0.08h[0m
[36m2025-10-28 02:25:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.4Â°C, outdoor=7.7Â°C, offset=0.6Â°C, flow=30.5Â°C, DM=-266[0m
[36m2025-10-28 02:25:31.327 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-28 02:25:31.327 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 02:25:31.331 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 02:25:31.331 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 02:25:31.331 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=36.6[0m
[36m2025-10-28 02:25:31.331 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:25:31.336 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 02:25:31.336 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:25:31.336 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.7Â°C (zone: Moderate Cold): block=-326, abort=-406[0m
[36m2025-10-28 02:25:31.336 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:25:31.336 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-266, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 02:25:31.336 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 16 quarters available, need 3 quarters (45 min), lookahead 4.0h[0m
[36m2025-10-28 02:25:31.336 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 14 windows evaluated[0m
[36m2025-10-28 02:25:31.336 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (1.3h away) â† SELECTED[0m
[36m2025-10-28 02:25:31.336 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (1.1h away)[0m
[36m2025-10-28 02:25:31.336 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (1.6h away)[0m
[36m2025-10-28 02:25:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (0.8h away)[0m
[36m2025-10-28 02:25:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (0.6h away)[0m
[32m2025-10-28 02:25:31.337 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 1.3h away[0m
[36m2025-10-28 02:25:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:25:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-266, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 02:25:31.342 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 02:25:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:25:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.7Â°C (zone: Moderate Cold): block=-326, abort=-406[0m
[36m2025-10-28 02:25:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:25:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-266, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 02:25:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 16 quarters available, need 3 quarters (45 min), lookahead 4.0h[0m
[36m2025-10-28 02:25:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 14 windows evaluated[0m
[36m2025-10-28 02:25:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (1.3h away) â† SELECTED[0m
[36m2025-10-28 02:25:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (1.1h away)[0m
[36m2025-10-28 02:25:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (1.6h away)[0m
[36m2025-10-28 02:25:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (0.8h away)[0m
[36m2025-10-28 02:25:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (0.6h away)[0m
[32m2025-10-28 02:25:31.342 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 1.3h away[0m
[36m2025-10-28 02:25:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:25:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-266, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 02:25:31.342 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 02:25:31.343 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.023 seconds (success: True)[0m
[36m2025-10-28 02:25:31.344 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (6.5 + 0.6 + 0.9)A Ã— 0.95 = 1.82 kW[0m
[36m2025-10-28 02:25:31.344 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 02:30:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 02:30:31.320 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.3Â°C (median of 9 sensors: 23.6Â°C, 21.2Â°C, 21.5Â°C, 23.3Â°C, 24.9Â°C, 24.2Â°C, 22.3Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-28 02:30:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -263.0[0m
[36m2025-10-28 02:30:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 36.6Â°C[0m
[36m2025-10-28 02:30:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.5Â°C[0m
[36m2025-10-28 02:30:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=6.5A, L2=0.6A, L3=0.9A[0m
[36m2025-10-28 02:30:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.3Â°C, outdoor 7.7Â°C, flow 30.5Â°C, DM -263[0m
[36m2025-10-28 02:30:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 25 Hz (1h avg: 27, 6h avg: 27, mode: space) - OK: Normal operation (25 Hz, 6h avg: 27 Hz)[0m
[36m2025-10-28 02:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 02:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 02:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 02:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 02:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 02:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 02:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 02:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 02:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 02:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 02:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 85}[0m
[36m2025-10-28 02:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 02:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 02:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 02:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 02:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 02:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 02:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 02:30:31.321 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 02:30:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q10 = 18.25 Ã¶re/kWh[0m
[36m2025-10-28 02:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 02:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 02:30:31.323 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 02:30:31.323 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 02:30:31.323 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 02:30:31.323 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-28 02:30:31.323 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 02:30:31.324 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 02:30:31.324 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 02:30:31.324 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:30:31.324 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 7.7Â°C: normal -126 to -326, warning -326[0m
[36m2025-10-28 02:30:31.324 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:30:31.324 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -326 (base: -326), critical -1500[0m
[36m2025-10-28 02:30:31.324 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=7.7Â°C, indoor_target=21.0Â°C, temp_diff=13.3Â°C, HC=0.180 kW/K -> flow=26.0Â°C[0m
[36m2025-10-28 02:30:31.324 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 02:30:31.325 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 02:30:31.325 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.5Â°C, current=30.5Â°C, error=-4.0Â°C, sensitivity=1.5 -> offset=-2.6[0m
[36m2025-10-28 02:30:31.325 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=7.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 02:30:31.325 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 30.5Â°C â†’ offset: -2.6Â°C; Weight: 0.20; Deferred: Moderate debt (DM -263)[0m
[36m2025-10-28 02:30:31.325 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Price classification Q10 (02:30): 18.25 â†’ CHEAP[0m
[32m2025-10-28 02:30:31.325 INFO (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.65Â°C - Learned pre-heat: Pre-heating: predicted drop 1.7Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 30.5Â°C â†’ offset: -2.6Â°C; Weight: 0.20; Deferred: Moderate debt (DM -263) | GE-Spot Q10: CHEAP (night) | Too warm: 2.3Â°C over[0m
[32m2025-10-28 02:30:31.326 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.65Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.7Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 30.5Â°C â†’ offset: -2.6Â°C; Weight: 0.20; Deferred: Moderate debt (DM -263) | GE-Spot Q10: CHEAP (night) | Too warm: 2.3Â°C over[0m
[36m2025-10-28 02:30:31.326 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.65Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-28 02:30:31.326 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 4.573 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 02:30:31.326 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.3Â°C, outdoor=7.7Â°C, offset=0.7Â°C, change=-0.05Â°C, Î”t=0.08h[0m
[36m2025-10-28 02:30:31.326 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.3Â°C, outdoor=7.7Â°C, offset=0.7Â°C, flow=30.5Â°C, DM=-263[0m
[36m2025-10-28 02:30:31.334 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.0Â°C/h trend[0m
[36m2025-10-28 02:30:31.334 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 02:30:31.335 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 02:30:31.336 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 02:30:31.336 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=36.6[0m
[36m2025-10-28 02:30:31.336 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:30:31.338 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 02:30:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:30:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.7Â°C (zone: Moderate Cold): block=-326, abort=-406[0m
[36m2025-10-28 02:30:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:30:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-263, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 02:30:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 16 quarters available, need 3 quarters (45 min), lookahead 4.0h[0m
[36m2025-10-28 02:30:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 14 windows evaluated[0m
[36m2025-10-28 02:30:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (1.2h away) â† SELECTED[0m
[36m2025-10-28 02:30:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (1.0h away)[0m
[36m2025-10-28 02:30:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (1.5h away)[0m
[36m2025-10-28 02:30:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (0.7h away)[0m
[36m2025-10-28 02:30:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (0.5h away)[0m
[32m2025-10-28 02:30:31.339 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 1.2h away[0m
[36m2025-10-28 02:30:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:30:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-263, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 02:30:31.343 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 02:30:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:30:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.7Â°C (zone: Moderate Cold): block=-326, abort=-406[0m
[36m2025-10-28 02:30:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:30:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-263, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 02:30:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 16 quarters available, need 3 quarters (45 min), lookahead 4.0h[0m
[36m2025-10-28 02:30:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 14 windows evaluated[0m
[36m2025-10-28 02:30:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (1.2h away) â† SELECTED[0m
[36m2025-10-28 02:30:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (1.0h away)[0m
[36m2025-10-28 02:30:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (1.5h away)[0m
[36m2025-10-28 02:30:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (0.7h away)[0m
[36m2025-10-28 02:30:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (0.5h away)[0m
[32m2025-10-28 02:30:31.344 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 1.2h away[0m
[36m2025-10-28 02:30:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:30:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-263, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 02:30:31.344 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 02:30:31.344 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.024 seconds (success: True)[0m
[36m2025-10-28 02:30:31.345 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (6.5 + 0.6 + 0.9)A Ã— 0.95 = 1.82 kW[0m
[36m2025-10-28 02:30:31.346 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 02:35:31.319 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 02:35:31.320 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.3Â°C (median of 9 sensors: 23.6Â°C, 21.1Â°C, 21.4Â°C, 23.3Â°C, 24.9Â°C, 24.2Â°C, 22.3Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-28 02:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -261.0[0m
[36m2025-10-28 02:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 36.6Â°C[0m
[36m2025-10-28 02:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.0Â°C[0m
[36m2025-10-28 02:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=5.5A, L2=0.6A, L3=0.9A[0m
[36m2025-10-28 02:35:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.3Â°C, outdoor 7.7Â°C, flow 30.0Â°C, DM -261[0m
[36m2025-10-28 02:35:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 24 Hz (1h avg: 26, 6h avg: 26, mode: space) - OK: Normal operation (24 Hz, 6h avg: 26 Hz)[0m
[36m2025-10-28 02:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 02:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 02:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 02:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 02:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 02:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 02:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 02:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 02:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 02:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 02:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 85}[0m
[36m2025-10-28 02:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 02:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 02:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 02:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 02:35:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 02:35:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 02:35:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 02:35:31.321 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 02:35:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q10 = 18.25 Ã¶re/kWh[0m
[36m2025-10-28 02:35:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 02:35:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 02:35:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 02:35:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 02:35:31.322 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 02:35:31.322 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-28 02:35:31.322 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 02:35:31.323 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 02:35:31.323 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 02:35:31.323 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:35:31.323 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 7.7Â°C: normal -126 to -326, warning -326[0m
[36m2025-10-28 02:35:31.323 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:35:31.323 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -326 (base: -326), critical -1500[0m
[36m2025-10-28 02:35:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=7.7Â°C, indoor_target=21.0Â°C, temp_diff=13.3Â°C, HC=0.180 kW/K -> flow=26.0Â°C[0m
[36m2025-10-28 02:35:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 02:35:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 02:35:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.5Â°C, current=30.0Â°C, error=-3.5Â°C, sensitivity=1.5 -> offset=-2.3[0m
[36m2025-10-28 02:35:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=7.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 02:35:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 30.0Â°C â†’ offset: -2.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -261)[0m
[36m2025-10-28 02:35:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Price classification Q10 (02:35): 18.25 â†’ CHEAP[0m
[32m2025-10-28 02:35:31.324 INFO (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.69Â°C - Learned pre-heat: Pre-heating: predicted drop 1.8Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 30.0Â°C â†’ offset: -2.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -261) | GE-Spot Q10: CHEAP (night) | Too warm: 2.3Â°C over[0m
[32m2025-10-28 02:35:31.325 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.69Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.8Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 30.0Â°C â†’ offset: -2.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -261) | GE-Spot Q10: CHEAP (night) | Too warm: 2.3Â°C over[0m
[36m2025-10-28 02:35:31.325 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.69Â°C, integer=0Â°C, fractional=0.69Â°C, accumulator_before=0.31Â°C[0m
[36m2025-10-28 02:35:31.325 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: 1.00Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-28 02:35:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.69Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-28 02:35:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 4.547 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 02:35:31.325 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.3Â°C, outdoor=7.7Â°C, offset=0.7Â°C, change=-0.07Â°C, Î”t=0.08h[0m
[36m2025-10-28 02:35:31.325 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.3Â°C, outdoor=7.7Â°C, offset=0.7Â°C, flow=30.0Â°C, DM=-261[0m
[36m2025-10-28 02:35:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-28 02:35:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 02:35:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 02:35:31.327 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 02:35:31.327 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=36.6[0m
[36m2025-10-28 02:35:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:35:31.337 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 02:35:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:35:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.7Â°C (zone: Moderate Cold): block=-326, abort=-406[0m
[36m2025-10-28 02:35:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:35:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-261, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 02:35:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 16 quarters available, need 3 quarters (45 min), lookahead 4.0h[0m
[36m2025-10-28 02:35:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 14 windows evaluated[0m
[36m2025-10-28 02:35:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (1.2h away) â† SELECTED[0m
[36m2025-10-28 02:35:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (0.9h away)[0m
[36m2025-10-28 02:35:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (1.4h away)[0m
[36m2025-10-28 02:35:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (0.7h away)[0m
[36m2025-10-28 02:35:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (0.4h away)[0m
[32m2025-10-28 02:35:31.337 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 1.2h away[0m
[36m2025-10-28 02:35:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:35:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-261, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 02:35:31.341 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 02:35:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:35:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.7Â°C (zone: Moderate Cold): block=-326, abort=-406[0m
[36m2025-10-28 02:35:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:35:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-261, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 02:35:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 16 quarters available, need 3 quarters (45 min), lookahead 4.0h[0m
[36m2025-10-28 02:35:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 14 windows evaluated[0m
[36m2025-10-28 02:35:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (1.2h away) â† SELECTED[0m
[36m2025-10-28 02:35:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (0.9h away)[0m
[36m2025-10-28 02:35:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (1.4h away)[0m
[36m2025-10-28 02:35:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (0.7h away)[0m
[36m2025-10-28 02:35:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (0.4h away)[0m
[32m2025-10-28 02:35:31.341 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 1.2h away[0m
[36m2025-10-28 02:35:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:35:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-261, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 02:35:31.342 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 02:35:31.342 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.022 seconds (success: True)[0m
[36m2025-10-28 02:35:31.343 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (5.5 + 0.6 + 0.9)A Ã— 0.95 = 1.60 kW[0m
[36m2025-10-28 02:35:31.343 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 02:40:31.319 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 02:40:31.319 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.4Â°C (median of 9 sensors: 23.6Â°C, 21.1Â°C, 21.4Â°C, 23.4Â°C, 24.9Â°C, 24.2Â°C, 22.3Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-28 02:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -262.0[0m
[36m2025-10-28 02:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 36.6Â°C[0m
[36m2025-10-28 02:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 29.5Â°C[0m
[36m2025-10-28 02:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=5.5A, L2=0.6A, L3=0.9A[0m
[36m2025-10-28 02:40:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.4Â°C, outdoor 7.7Â°C, flow 29.5Â°C, DM -262[0m
[36m2025-10-28 02:40:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 26 Hz (1h avg: 26, 6h avg: 26, mode: space) - OK: Normal operation (26 Hz, 6h avg: 26 Hz)[0m
[36m2025-10-28 02:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 02:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 02:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 02:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 02:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 02:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 02:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 02:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 02:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 02:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 02:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 85}[0m
[36m2025-10-28 02:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 02:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 02:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 02:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 02:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 02:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 02:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 02:40:31.321 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 02:40:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q10 = 18.25 Ã¶re/kWh[0m
[36m2025-10-28 02:40:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 02:40:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 02:40:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 02:40:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 02:40:31.322 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 02:40:31.322 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 8.2Â°C, 48 hours forecast[0m
[36m2025-10-28 02:40:31.322 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 02:40:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 02:40:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 02:40:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:40:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 7.7Â°C: normal -126 to -326, warning -326[0m
[36m2025-10-28 02:40:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:40:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -326 (base: -326), critical -1500[0m
[36m2025-10-28 02:40:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=7.7Â°C, indoor_target=21.0Â°C, temp_diff=13.3Â°C, HC=0.180 kW/K -> flow=26.0Â°C[0m
[36m2025-10-28 02:40:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 02:40:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 02:40:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.5Â°C, current=29.5Â°C, error=-3.0Â°C, sensitivity=1.5 -> offset=-2.0[0m
[36m2025-10-28 02:40:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=7.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 02:40:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 29.5Â°C â†’ offset: -2.0Â°C; Weight: 0.20; Deferred: Moderate debt (DM -262)[0m
[36m2025-10-28 02:40:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Price classification Q10 (02:40): 18.25 â†’ CHEAP[0m
[32m2025-10-28 02:40:31.324 INFO (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.71Â°C - Learned pre-heat: Pre-heating: predicted drop 1.8Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 29.5Â°C â†’ offset: -2.0Â°C; Weight: 0.20; Deferred: Moderate debt (DM -262) | GE-Spot Q10: CHEAP (night) | Too warm: 2.4Â°C over[0m
[32m2025-10-28 02:40:31.326 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.71Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.8Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 29.5Â°C â†’ offset: -2.0Â°C; Weight: 0.20; Deferred: Moderate debt (DM -262) | GE-Spot Q10: CHEAP (night) | Too warm: 2.4Â°C over[0m
[36m2025-10-28 02:40:31.326 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.71Â°C, integer=0Â°C, fractional=0.71Â°C, accumulator_before=1.00Â°C[0m
[32m2025-10-28 02:40:31.326 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] âœ“ Accumulated fractional offset reached threshold: applying +1Â°C adjustment (accumulator: 1.71Â°C â†’ 0.71Â°C)[0m
[36m2025-10-28 02:40:31.326 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Accumulator triggered: total_accumulated=1.71Â°C, adjustment=+1Â°C, new_integer=1Â°C, remaining=0.71Â°C[0m
[36m2025-10-28 02:40:31.326 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset 0.71Â°C â†’ applying 1Â°C (accumulator: 0.71Â°C, needs 0.29Â°C more to trigger)[0m
[32m2025-10-28 02:40:31.330 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to 1Â°C (calculated: 0.71Â°C, accumulator: 0.71Â°C)[0m
[36m2025-10-28 02:40:31.330 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=1Â°C, original=0.71Â°C, accumulator=0.71Â°C[0m
[32m2025-10-28 02:40:31.330 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset 0.71Â°C to NIBE via MyUplink[0m
[36m2025-10-28 02:40:31.330 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 4.706 kW from sensor.gen24_elnat_import_effekt[0m
[32m2025-10-28 02:40:31.330 INFO (MainThread) [custom_components.effektguard.coordinator] New daily peak: 4.71 kW at 02:40:31 (quarter 10, source: external_meter)[0m
[36m2025-10-28 02:40:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.4Â°C, outdoor=7.7Â°C, offset=0.7Â°C, change=0.12Â°C, Î”t=0.08h[0m
[36m2025-10-28 02:40:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.4Â°C, outdoor=7.7Â°C, offset=0.7Â°C, flow=29.5Â°C, DM=-262[0m
[36m2025-10-28 02:40:31.338 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.1Â°C/h trend[0m
[36m2025-10-28 02:40:31.338 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 02:40:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 02:40:31.339 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 02:40:31.339 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=36.6[0m
[36m2025-10-28 02:40:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:40:31.343 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 02:40:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:40:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.7Â°C (zone: Moderate Cold): block=-326, abort=-406[0m
[36m2025-10-28 02:40:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:40:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-262, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 02:40:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 16 quarters available, need 3 quarters (45 min), lookahead 4.0h[0m
[36m2025-10-28 02:40:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 14 windows evaluated[0m
[36m2025-10-28 02:40:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (1.1h away) â† SELECTED[0m
[36m2025-10-28 02:40:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (0.8h away)[0m
[36m2025-10-28 02:40:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (1.3h away)[0m
[36m2025-10-28 02:40:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (0.6h away)[0m
[36m2025-10-28 02:40:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (0.3h away)[0m
[32m2025-10-28 02:40:31.343 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 1.1h away[0m
[36m2025-10-28 02:40:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:40:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-262, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 02:40:31.350 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 02:40:31.350 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:40:31.350 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.7Â°C (zone: Moderate Cold): block=-326, abort=-406[0m
[36m2025-10-28 02:40:31.350 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:40:31.350 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-262, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 02:40:31.350 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 16 quarters available, need 3 quarters (45 min), lookahead 4.0h[0m
[36m2025-10-28 02:40:31.350 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 14 windows evaluated[0m
[36m2025-10-28 02:40:31.350 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (1.1h away) â† SELECTED[0m
[36m2025-10-28 02:40:31.351 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (0.8h away)[0m
[36m2025-10-28 02:40:31.351 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (1.3h away)[0m
[36m2025-10-28 02:40:31.351 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (0.6h away)[0m
[36m2025-10-28 02:40:31.351 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (0.3h away)[0m
[32m2025-10-28 02:40:31.351 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 1.1h away[0m
[36m2025-10-28 02:40:31.351 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:40:31.351 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-262, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 02:40:31.351 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 02:40:31.351 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.032 seconds (success: True)[0m
[36m2025-10-28 02:40:31.352 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (5.5 + 0.6 + 0.9)A Ã— 0.95 = 1.60 kW[0m
[36m2025-10-28 02:40:31.353 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[33m2025-10-28 02:41:10.827 WARNING (MainThread) [homeassistant.components.automation.led_tak_groventre] LED TAK GROVENTRE: Already running[0m
[33m2025-10-28 02:41:45.583 WARNING (MainThread) [home_connect_async.homeconnect] The appliance (SIEMENS-WM4HVKL9DN-68A40E5223BC) is disconnected when loading for the first time[0m
[33m2025-10-28 02:45:11.304 WARNING (MainThread) [pysignalr.client] No client method with the name 'CommandResponse' found.[0m
[36m2025-10-28 02:45:31.319 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 02:45:31.319 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.4Â°C (median of 9 sensors: 23.6Â°C, 21.1Â°C, 21.4Â°C, 23.4Â°C, 24.9Â°C, 24.2Â°C, 22.3Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-28 02:45:31.319 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -263.0[0m
[36m2025-10-28 02:45:31.319 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 36.6Â°C[0m
[36m2025-10-28 02:45:31.319 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 29.5Â°C[0m
[36m2025-10-28 02:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=7.6A, L2=0.6A, L3=0.9A[0m
[36m2025-10-28 02:45:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.4Â°C, outdoor 7.7Â°C, flow 29.5Â°C, DM -263[0m
[36m2025-10-28 02:45:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 27 Hz (1h avg: 26, 6h avg: 26, mode: space) - OK: Normal operation (27 Hz, 6h avg: 26 Hz)[0m
[36m2025-10-28 02:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 02:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 02:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 02:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 02:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 02:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 02:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 02:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 02:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 02:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 02:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 84}[0m
[36m2025-10-28 02:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 02:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 02:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 02:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 02:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 02:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 02:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 02:45:31.320 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 02:45:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q11 = 17.66 Ã¶re/kWh[0m
[36m2025-10-28 02:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 02:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 02:45:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 02:45:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 02:45:31.322 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 02:45:31.322 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 02:45:31.322 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 02:45:31.323 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 02:45:31.323 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 02:45:31.323 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:45:31.323 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 7.7Â°C: normal -126 to -326, warning -326[0m
[36m2025-10-28 02:45:31.323 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:45:31.323 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -326 (base: -326), critical -1500[0m
[36m2025-10-28 02:45:31.323 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=7.7Â°C, indoor_target=21.0Â°C, temp_diff=13.3Â°C, HC=0.180 kW/K -> flow=26.0Â°C[0m
[36m2025-10-28 02:45:31.323 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 02:45:31.323 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 02:45:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.5Â°C, current=29.5Â°C, error=-3.0Â°C, sensitivity=1.5 -> offset=-2.0[0m
[36m2025-10-28 02:45:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=7.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 02:45:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 29.5Â°C â†’ offset: -2.0Â°C; Weight: 0.20; Deferred: Moderate debt (DM -263)[0m
[36m2025-10-28 02:45:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Price classification Q11 (02:45): 17.66 â†’ CHEAP[0m
[32m2025-10-28 02:45:31.324 INFO (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.71Â°C - Learned pre-heat: Pre-heating: predicted drop 1.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 29.5Â°C â†’ offset: -2.0Â°C; Weight: 0.20; Deferred: Moderate debt (DM -263) | GE-Spot Q11: CHEAP (night) | Too warm: 2.4Â°C over[0m
[32m2025-10-28 02:45:31.324 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.71Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 29.5Â°C â†’ offset: -2.0Â°C; Weight: 0.20; Deferred: Moderate debt (DM -263) | GE-Spot Q11: CHEAP (night) | Too warm: 2.4Â°C over[0m
[36m2025-10-28 02:45:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.71Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-28 02:45:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 5.953 kW from sensor.gen24_elnat_import_effekt[0m
[32m2025-10-28 02:45:31.325 INFO (MainThread) [custom_components.effektguard.coordinator] New daily peak: 5.95 kW at 02:45:31 (quarter 11, source: external_meter)[0m
[36m2025-10-28 02:45:31.325 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.4Â°C, outdoor=7.7Â°C, offset=0.7Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-28 02:45:31.325 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.4Â°C, outdoor=7.7Â°C, offset=0.7Â°C, flow=29.5Â°C, DM=-263[0m
[36m2025-10-28 02:45:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-28 02:45:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 02:45:31.326 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 02:45:31.326 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 02:45:31.326 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=36.6[0m
[36m2025-10-28 02:45:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:45:31.336 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 02:45:31.336 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:45:31.336 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.7Â°C (zone: Moderate Cold): block=-326, abort=-406[0m
[36m2025-10-28 02:45:31.336 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:45:31.336 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-263, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 02:45:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 16 quarters available, need 3 quarters (45 min), lookahead 4.0h[0m
[36m2025-10-28 02:45:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 14 windows evaluated[0m
[36m2025-10-28 02:45:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (1.0h away) â† SELECTED[0m
[36m2025-10-28 02:45:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (0.7h away)[0m
[36m2025-10-28 02:45:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (1.2h away)[0m
[36m2025-10-28 02:45:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (0.5h away)[0m
[36m2025-10-28 02:45:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (0.2h away)[0m
[32m2025-10-28 02:45:31.337 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 1.0h away[0m
[36m2025-10-28 02:45:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:45:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-263, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 02:45:31.341 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 02:45:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:45:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.7Â°C (zone: Moderate Cold): block=-326, abort=-406[0m
[36m2025-10-28 02:45:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:45:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-263, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 02:45:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 16 quarters available, need 3 quarters (45 min), lookahead 4.0h[0m
[36m2025-10-28 02:45:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 14 windows evaluated[0m
[36m2025-10-28 02:45:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (1.0h away) â† SELECTED[0m
[36m2025-10-28 02:45:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (0.7h away)[0m
[36m2025-10-28 02:45:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (1.2h away)[0m
[36m2025-10-28 02:45:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (0.5h away)[0m
[36m2025-10-28 02:45:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (0.2h away)[0m
[32m2025-10-28 02:45:31.342 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 1.0h away[0m
[36m2025-10-28 02:45:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:45:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-263, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 02:45:31.342 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 02:45:31.342 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.023 seconds (success: True)[0m
[36m2025-10-28 02:45:31.344 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (7.6 + 0.6 + 0.9)A Ã— 0.95 = 2.07 kW[0m
[36m2025-10-28 02:45:31.344 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 02:50:31.319 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 02:50:31.319 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.4Â°C (median of 9 sensors: 23.6Â°C, 21.2Â°C, 21.5Â°C, 23.4Â°C, 25.0Â°C, 24.3Â°C, 22.3Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-28 02:50:31.319 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -264.0[0m
[36m2025-10-28 02:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 36.6Â°C[0m
[36m2025-10-28 02:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.0Â°C[0m
[36m2025-10-28 02:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=17.0A, L2=6.6A, L3=12.8A[0m
[36m2025-10-28 02:50:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.4Â°C, outdoor 7.7Â°C, flow 30.0Â°C, DM -264[0m
[36m2025-10-28 02:50:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 27 Hz (1h avg: 26, 6h avg: 26, mode: space) - OK: Normal operation (27 Hz, 6h avg: 26 Hz)[0m
[36m2025-10-28 02:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 02:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 02:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 02:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 02:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 02:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 02:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 02:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 02:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 02:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 02:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 84}[0m
[36m2025-10-28 02:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 02:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 02:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 02:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 02:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 02:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 02:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 02:50:31.321 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 02:50:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q11 = 17.66 Ã¶re/kWh[0m
[36m2025-10-28 02:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 02:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 02:50:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 02:50:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 02:50:31.322 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 02:50:31.322 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 02:50:31.322 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 02:50:31.323 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 02:50:31.323 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 02:50:31.323 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:50:31.323 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 7.7Â°C: normal -126 to -326, warning -326[0m
[36m2025-10-28 02:50:31.323 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:50:31.323 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -326 (base: -326), critical -1500[0m
[36m2025-10-28 02:50:31.323 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=7.7Â°C, indoor_target=21.0Â°C, temp_diff=13.3Â°C, HC=0.180 kW/K -> flow=26.0Â°C[0m
[36m2025-10-28 02:50:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 02:50:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 02:50:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.5Â°C, current=30.0Â°C, error=-3.5Â°C, sensitivity=1.5 -> offset=-2.3[0m
[36m2025-10-28 02:50:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=7.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 02:50:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 30.0Â°C â†’ offset: -2.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -264)[0m
[36m2025-10-28 02:50:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Price classification Q11 (02:50): 17.66 â†’ CHEAP[0m
[32m2025-10-28 02:50:31.324 INFO (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.68Â°C - Learned pre-heat: Pre-heating: predicted drop 1.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 30.0Â°C â†’ offset: -2.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -264) | GE-Spot Q11: CHEAP (night) | Too warm: 2.4Â°C over[0m
[32m2025-10-28 02:50:31.324 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.68Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 30.0Â°C â†’ offset: -2.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -264) | GE-Spot Q11: CHEAP (night) | Too warm: 2.4Â°C over[0m
[36m2025-10-28 02:50:31.325 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.68Â°C, integer=0Â°C, fractional=0.68Â°C, accumulator_before=0.71Â°C[0m
[32m2025-10-28 02:50:31.325 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] âœ“ Accumulated fractional offset reached threshold: applying +1Â°C adjustment (accumulator: 1.39Â°C â†’ 0.39Â°C)[0m
[36m2025-10-28 02:50:31.325 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Accumulator triggered: total_accumulated=1.39Â°C, adjustment=+1Â°C, new_integer=1Â°C, remaining=0.39Â°C[0m
[36m2025-10-28 02:50:31.325 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset 0.68Â°C â†’ applying 1Â°C (accumulator: 0.39Â°C, needs 0.61Â°C more to trigger)[0m
[32m2025-10-28 02:50:31.326 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to 1Â°C (calculated: 0.68Â°C, accumulator: 0.39Â°C)[0m
[36m2025-10-28 02:50:31.326 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=1Â°C, original=0.68Â°C, accumulator=0.39Â°C[0m
[32m2025-10-28 02:50:31.326 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset 0.68Â°C to NIBE via MyUplink[0m
[36m2025-10-28 02:50:31.326 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 10.301 kW from sensor.gen24_elnat_import_effekt[0m
[32m2025-10-28 02:50:31.326 INFO (MainThread) [custom_components.effektguard.coordinator] New daily peak: 10.30 kW at 02:50:31 (quarter 11, source: external_meter)[0m
[36m2025-10-28 02:50:31.326 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.4Â°C, outdoor=7.7Â°C, offset=0.7Â°C, change=0.03Â°C, Î”t=0.08h[0m
[36m2025-10-28 02:50:31.326 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.4Â°C, outdoor=7.7Â°C, offset=0.7Â°C, flow=30.0Â°C, DM=-264[0m
[36m2025-10-28 02:50:31.332 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.2Â°C/h trend[0m
[36m2025-10-28 02:50:31.332 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 02:50:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 02:50:31.334 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 02:50:31.334 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=36.6[0m
[36m2025-10-28 02:50:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:50:31.339 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 02:50:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:50:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.7Â°C (zone: Moderate Cold): block=-326, abort=-406[0m
[36m2025-10-28 02:50:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:50:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-264, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 02:50:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 16 quarters available, need 3 quarters (45 min), lookahead 4.0h[0m
[36m2025-10-28 02:50:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 14 windows evaluated[0m
[36m2025-10-28 02:50:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (0.9h away) â† SELECTED[0m
[36m2025-10-28 02:50:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (0.7h away)[0m
[36m2025-10-28 02:50:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (1.2h away)[0m
[36m2025-10-28 02:50:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (0.4h away)[0m
[36m2025-10-28 02:50:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (0.2h away)[0m
[32m2025-10-28 02:50:31.340 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 0.9h away[0m
[36m2025-10-28 02:50:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:50:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-264, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 02:50:31.348 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 02:50:31.349 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:50:31.349 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.7Â°C (zone: Moderate Cold): block=-326, abort=-406[0m
[36m2025-10-28 02:50:31.349 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:50:31.349 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-264, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 02:50:31.349 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 16 quarters available, need 3 quarters (45 min), lookahead 4.0h[0m
[36m2025-10-28 02:50:31.349 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 14 windows evaluated[0m
[36m2025-10-28 02:50:31.349 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (0.9h away) â† SELECTED[0m
[36m2025-10-28 02:50:31.349 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (0.7h away)[0m
[36m2025-10-28 02:50:31.349 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (1.2h away)[0m
[36m2025-10-28 02:50:31.349 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (0.4h away)[0m
[36m2025-10-28 02:50:31.349 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (0.2h away)[0m
[32m2025-10-28 02:50:31.349 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 0.9h away[0m
[36m2025-10-28 02:50:31.349 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:50:31.349 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-264, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 02:50:31.349 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 02:50:31.350 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.030 seconds (success: True)[0m
[36m2025-10-28 02:50:31.351 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (17.0 + 6.6 + 12.8)A Ã— 0.95 = 8.30 kW[0m
[36m2025-10-28 02:50:31.351 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 02:55:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 02:55:31.320 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.4Â°C (median of 9 sensors: 23.6Â°C, 21.1Â°C, 21.5Â°C, 23.4Â°C, 25.1Â°C, 24.3Â°C, 22.3Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-28 02:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -262.0[0m
[36m2025-10-28 02:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 36.6Â°C[0m
[36m2025-10-28 02:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.0Â°C[0m
[36m2025-10-28 02:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=17.0A, L2=6.6A, L3=10.6A[0m
[36m2025-10-28 02:55:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.4Â°C, outdoor 7.7Â°C, flow 30.0Â°C, DM -262[0m
[36m2025-10-28 02:55:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 26 Hz (1h avg: 26, 6h avg: 26, mode: space) - OK: Normal operation (26 Hz, 6h avg: 26 Hz)[0m
[36m2025-10-28 02:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 02:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 02:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 02:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 02:55:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 02:55:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 02:55:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 02:55:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 02:55:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 02:55:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 02:55:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 84}[0m
[36m2025-10-28 02:55:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 02:55:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 02:55:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 02:55:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 02:55:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 02:55:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 02:55:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 02:55:31.321 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 02:55:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q11 = 17.66 Ã¶re/kWh[0m
[36m2025-10-28 02:55:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 02:55:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 02:55:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 02:55:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 02:55:31.322 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 02:55:31.323 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 02:55:31.323 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 02:55:31.323 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 02:55:31.324 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 02:55:31.324 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:55:31.324 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 7.7Â°C: normal -126 to -326, warning -326[0m
[36m2025-10-28 02:55:31.324 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:55:31.324 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -326 (base: -326), critical -1500[0m
[36m2025-10-28 02:55:31.324 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=7.7Â°C, indoor_target=21.0Â°C, temp_diff=13.3Â°C, HC=0.180 kW/K -> flow=26.0Â°C[0m
[36m2025-10-28 02:55:31.324 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 02:55:31.324 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 02:55:31.324 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.5Â°C, current=30.0Â°C, error=-3.5Â°C, sensitivity=1.5 -> offset=-2.3[0m
[36m2025-10-28 02:55:31.324 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=7.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 02:55:31.324 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 30.0Â°C â†’ offset: -2.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -262)[0m
[36m2025-10-28 02:55:31.324 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Price classification Q11 (02:55): 17.66 â†’ CHEAP[0m
[32m2025-10-28 02:55:31.325 INFO (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.67Â°C - Learned pre-heat: Pre-heating: predicted drop 1.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 30.0Â°C â†’ offset: -2.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -262) | GE-Spot Q11: CHEAP (night) | Too warm: 2.4Â°C over[0m
[32m2025-10-28 02:55:31.325 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.67Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 30.0Â°C â†’ offset: -2.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -262) | GE-Spot Q11: CHEAP (night) | Too warm: 2.4Â°C over[0m
[36m2025-10-28 02:55:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.67Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-28 02:55:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 11.232 kW from sensor.gen24_elnat_import_effekt[0m
[32m2025-10-28 02:55:31.325 INFO (MainThread) [custom_components.effektguard.coordinator] New daily peak: 11.23 kW at 02:55:31 (quarter 11, source: external_meter)[0m
[36m2025-10-28 02:55:31.325 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.4Â°C, outdoor=7.7Â°C, offset=0.7Â°C, change=0.03Â°C, Î”t=0.08h[0m
[36m2025-10-28 02:55:31.325 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.4Â°C, outdoor=7.7Â°C, offset=0.7Â°C, flow=30.0Â°C, DM=-262[0m
[36m2025-10-28 02:55:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-28 02:55:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 02:55:31.328 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 02:55:31.328 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 02:55:31.328 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=36.6[0m
[36m2025-10-28 02:55:31.328 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:55:31.330 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 02:55:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:55:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.7Â°C (zone: Moderate Cold): block=-326, abort=-406[0m
[36m2025-10-28 02:55:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:55:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-262, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 02:55:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 16 quarters available, need 3 quarters (45 min), lookahead 4.0h[0m
[36m2025-10-28 02:55:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 14 windows evaluated[0m
[36m2025-10-28 02:55:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (0.8h away) â† SELECTED[0m
[36m2025-10-28 02:55:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (0.6h away)[0m
[36m2025-10-28 02:55:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (1.1h away)[0m
[36m2025-10-28 02:55:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (0.3h away)[0m
[36m2025-10-28 02:55:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (0.1h away)[0m
[32m2025-10-28 02:55:31.330 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 0.8h away[0m
[36m2025-10-28 02:55:31.331 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:55:31.331 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-262, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 02:55:31.340 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 02:55:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:55:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.7Â°C (zone: Moderate Cold): block=-326, abort=-406[0m
[36m2025-10-28 02:55:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:55:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-262, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 02:55:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 16 quarters available, need 3 quarters (45 min), lookahead 4.0h[0m
[36m2025-10-28 02:55:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 14 windows evaluated[0m
[36m2025-10-28 02:55:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (0.8h away) â† SELECTED[0m
[36m2025-10-28 02:55:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (0.6h away)[0m
[36m2025-10-28 02:55:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (1.1h away)[0m
[36m2025-10-28 02:55:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (0.3h away)[0m
[36m2025-10-28 02:55:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 11.6Ã¶re/kWh at 03:00 (0.1h away)[0m
[32m2025-10-28 02:55:31.340 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 0.8h away[0m
[36m2025-10-28 02:55:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 02:55:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-262, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 02:55:31.340 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 02:55:31.341 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.021 seconds (success: True)[0m
[36m2025-10-28 02:55:31.342 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (17.0 + 6.6 + 10.6)A Ã— 0.95 = 7.80 kW[0m
[36m2025-10-28 02:55:31.342 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 03:00:31.319 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 03:00:31.319 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.4Â°C (median of 9 sensors: 23.6Â°C, 21.1Â°C, 21.5Â°C, 23.4Â°C, 25.2Â°C, 24.2Â°C, 22.3Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-28 03:00:31.319 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -260.0[0m
[36m2025-10-28 03:00:31.319 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 36.1Â°C[0m
[36m2025-10-28 03:00:31.319 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.0Â°C[0m
[36m2025-10-28 03:00:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=8.1A, L2=6.6A, L3=6.8A[0m
[36m2025-10-28 03:00:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.4Â°C, outdoor 7.7Â°C, flow 30.0Â°C, DM -260[0m
[36m2025-10-28 03:00:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 24 Hz (1h avg: 26, 6h avg: 26, mode: space) - OK: Normal operation (24 Hz, 6h avg: 26 Hz)[0m
[36m2025-10-28 03:00:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 03:00:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 03:00:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 03:00:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 03:00:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 03:00:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 03:00:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 03:00:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 03:00:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 03:00:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 03:00:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 83}[0m
[36m2025-10-28 03:00:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 03:00:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 03:00:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 03:00:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 03:00:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 03:00:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 03:00:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 03:00:31.320 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 03:00:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q12 = 14.37 Ã¶re/kWh[0m
[36m2025-10-28 03:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 03:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 03:00:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 03:00:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 03:00:31.322 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 03:00:31.322 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 03:00:31.322 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 03:00:31.323 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 03:00:31.323 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 03:00:31.323 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 03:00:31.323 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 7.7Â°C: normal -126 to -326, warning -326[0m
[36m2025-10-28 03:00:31.323 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 03:00:31.323 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -326 (base: -326), critical -1500[0m
[36m2025-10-28 03:00:31.323 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=7.7Â°C, indoor_target=21.0Â°C, temp_diff=13.3Â°C, HC=0.180 kW/K -> flow=26.0Â°C[0m
[36m2025-10-28 03:00:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 03:00:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 03:00:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.5Â°C, current=30.0Â°C, error=-3.5Â°C, sensitivity=1.5 -> offset=-2.3[0m
[36m2025-10-28 03:00:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=7.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 03:00:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 30.0Â°C â†’ offset: -2.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -260)[0m
[36m2025-10-28 03:00:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Price classification Q12 (03:00): 14.37 â†’ CHEAP[0m
[32m2025-10-28 03:00:31.324 INFO (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.68Â°C - Learned pre-heat: Pre-heating: predicted drop 1.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 30.0Â°C â†’ offset: -2.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -260) | GE-Spot Q12: CHEAP (night) | Too warm: 2.4Â°C over[0m
[32m2025-10-28 03:00:31.324 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.68Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 30.0Â°C â†’ offset: -2.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -260) | GE-Spot Q12: CHEAP (night) | Too warm: 2.4Â°C over[0m
[36m2025-10-28 03:00:31.324 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.68Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-28 03:00:31.324 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 8.497 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 03:00:31.324 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.4Â°C, outdoor=7.7Â°C, offset=0.7Â°C, change=-0.08Â°C, Î”t=0.08h[0m
[36m2025-10-28 03:00:31.325 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.4Â°C, outdoor=7.7Â°C, offset=0.7Â°C, flow=30.0Â°C, DM=-260[0m
[36m2025-10-28 03:00:31.330 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.0Â°C/h trend[0m
[36m2025-10-28 03:00:31.330 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 03:00:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 03:00:31.332 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 03:00:31.332 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=36.1[0m
[36m2025-10-28 03:00:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 03:00:31.335 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 03:00:31.335 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 03:00:31.335 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.7Â°C (zone: Moderate Cold): block=-326, abort=-406[0m
[36m2025-10-28 03:00:31.335 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 03:00:31.335 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-260, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 03:00:31.335 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 12 quarters available, need 3 quarters (45 min), lookahead 3.0h[0m
[36m2025-10-28 03:00:31.335 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 10 windows evaluated[0m
[36m2025-10-28 03:00:31.336 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (0.7h away) â† SELECTED[0m
[36m2025-10-28 03:00:31.336 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (0.5h away)[0m
[36m2025-10-28 03:00:31.336 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (1.0h away)[0m
[36m2025-10-28 03:00:31.336 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (0.2h away)[0m
[36m2025-10-28 03:00:31.336 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 14.2Ã¶re/kWh at 04:15 (1.2h away)[0m
[32m2025-10-28 03:00:31.336 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 0.7h away[0m
[36m2025-10-28 03:00:31.336 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 03:00:31.336 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-260, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 03:00:31.343 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 03:00:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 03:00:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.7Â°C (zone: Moderate Cold): block=-326, abort=-406[0m
[36m2025-10-28 03:00:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 03:00:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-260, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 03:00:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 12 quarters available, need 3 quarters (45 min), lookahead 3.0h[0m
[36m2025-10-28 03:00:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 10 windows evaluated[0m
[36m2025-10-28 03:00:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (0.7h away) â† SELECTED[0m
[36m2025-10-28 03:00:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (0.5h away)[0m
[36m2025-10-28 03:00:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (1.0h away)[0m
[36m2025-10-28 03:00:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (0.2h away)[0m
[36m2025-10-28 03:00:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 14.2Ã¶re/kWh at 04:15 (1.2h away)[0m
[32m2025-10-28 03:00:31.344 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 0.7h away[0m
[36m2025-10-28 03:00:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 03:00:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-260, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 03:00:31.344 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 03:00:31.345 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.026 seconds (success: True)[0m
[36m2025-10-28 03:00:31.346 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (8.1 + 6.6 + 6.8)A Ã— 0.95 = 4.90 kW[0m
[36m2025-10-28 03:00:31.346 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 03:05:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 03:05:31.320 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.4Â°C (median of 9 sensors: 23.6Â°C, 21.1Â°C, 21.4Â°C, 23.4Â°C, 25.3Â°C, 24.3Â°C, 22.3Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-28 03:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -258.0[0m
[36m2025-10-28 03:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 36.1Â°C[0m
[36m2025-10-28 03:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.0Â°C[0m
[36m2025-10-28 03:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=8.1A, L2=6.6A, L3=8.8A[0m
[36m2025-10-28 03:05:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.4Â°C, outdoor 7.7Â°C, flow 30.0Â°C, DM -258[0m
[36m2025-10-28 03:05:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 24 Hz (1h avg: 26, 6h avg: 26, mode: space) - OK: Normal operation (24 Hz, 6h avg: 26 Hz)[0m
[36m2025-10-28 03:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 03:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 03:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 03:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 03:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 03:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 03:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 03:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 03:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 03:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 03:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 83}[0m
[36m2025-10-28 03:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 03:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 03:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 03:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 03:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 03:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 03:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 03:05:31.322 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 03:05:31.322 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q12 = 14.37 Ã¶re/kWh[0m
[36m2025-10-28 03:05:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 03:05:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 03:05:31.323 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 03:05:31.323 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 03:05:31.323 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 03:05:31.323 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 03:05:31.323 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 03:05:31.324 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 03:05:31.324 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 03:05:31.325 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 03:05:31.325 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 7.7Â°C: normal -126 to -326, warning -326[0m
[36m2025-10-28 03:05:31.325 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 03:05:31.325 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -326 (base: -326), critical -1500[0m
[36m2025-10-28 03:05:31.325 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=7.7Â°C, indoor_target=21.0Â°C, temp_diff=13.3Â°C, HC=0.180 kW/K -> flow=26.0Â°C[0m
[36m2025-10-28 03:05:31.325 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 03:05:31.325 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 03:05:31.325 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.5Â°C, current=30.0Â°C, error=-3.5Â°C, sensitivity=1.5 -> offset=-2.3[0m
[36m2025-10-28 03:05:31.325 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=7.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 03:05:31.325 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 30.0Â°C â†’ offset: -2.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -258)[0m
[36m2025-10-28 03:05:31.325 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Price classification Q12 (03:05): 14.37 â†’ CHEAP[0m
[32m2025-10-28 03:05:31.326 INFO (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.68Â°C - Learned pre-heat: Pre-heating: predicted drop 1.6Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 30.0Â°C â†’ offset: -2.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -258) | GE-Spot Q12: CHEAP (night) | Too warm: 2.4Â°C over[0m
[32m2025-10-28 03:05:31.326 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.68Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.6Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 30.0Â°C â†’ offset: -2.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -258) | GE-Spot Q12: CHEAP (night) | Too warm: 2.4Â°C over[0m
[36m2025-10-28 03:05:31.326 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.68Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-28 03:05:31.326 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 8.317 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 03:05:31.326 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.4Â°C, outdoor=7.7Â°C, offset=0.7Â°C, change=-0.01Â°C, Î”t=0.08h[0m
[36m2025-10-28 03:05:31.326 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.4Â°C, outdoor=7.7Â°C, offset=0.7Â°C, flow=30.0Â°C, DM=-258[0m
[36m2025-10-28 03:05:31.333 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.0Â°C/h trend[0m
[36m2025-10-28 03:05:31.333 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 03:05:31.335 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 03:05:31.335 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 03:05:31.335 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=36.1[0m
[36m2025-10-28 03:05:31.335 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 03:05:31.337 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 03:05:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 03:05:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.7Â°C (zone: Moderate Cold): block=-326, abort=-406[0m
[36m2025-10-28 03:05:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 03:05:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-258, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 03:05:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 12 quarters available, need 3 quarters (45 min), lookahead 3.0h[0m
[36m2025-10-28 03:05:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 10 windows evaluated[0m
[36m2025-10-28 03:05:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (0.7h away) â† SELECTED[0m
[36m2025-10-28 03:05:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (0.4h away)[0m
[36m2025-10-28 03:05:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (0.9h away)[0m
[36m2025-10-28 03:05:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (0.2h away)[0m
[36m2025-10-28 03:05:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 14.2Ã¶re/kWh at 04:15 (1.2h away)[0m
[32m2025-10-28 03:05:31.338 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 0.7h away[0m
[36m2025-10-28 03:05:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 03:05:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-258, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 03:05:31.342 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 03:05:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 03:05:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.7Â°C (zone: Moderate Cold): block=-326, abort=-406[0m
[36m2025-10-28 03:05:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 03:05:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-258, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 03:05:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 12 quarters available, need 3 quarters (45 min), lookahead 3.0h[0m
[36m2025-10-28 03:05:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 10 windows evaluated[0m
[36m2025-10-28 03:05:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (0.7h away) â† SELECTED[0m
[36m2025-10-28 03:05:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (0.4h away)[0m
[36m2025-10-28 03:05:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (0.9h away)[0m
[36m2025-10-28 03:05:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (0.2h away)[0m
[36m2025-10-28 03:05:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 14.2Ã¶re/kWh at 04:15 (1.2h away)[0m
[32m2025-10-28 03:05:31.342 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 0.7h away[0m
[36m2025-10-28 03:05:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 03:05:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-258, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 03:05:31.343 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 03:05:31.343 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.023 seconds (success: True)[0m
[36m2025-10-28 03:05:31.344 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (8.1 + 6.6 + 8.8)A Ã— 0.95 = 5.36 kW[0m
[36m2025-10-28 03:05:31.344 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 03:10:31.319 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 03:10:31.319 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.3Â°C (median of 9 sensors: 23.6Â°C, 21.1Â°C, 21.5Â°C, 23.3Â°C, 25.3Â°C, 24.2Â°C, 22.3Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-28 03:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -256.0[0m
[36m2025-10-28 03:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 36.1Â°C[0m
[36m2025-10-28 03:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.0Â°C[0m
[36m2025-10-28 03:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=8.1A, L2=0.5A, L3=12.7A[0m
[36m2025-10-28 03:10:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.3Â°C, outdoor 7.7Â°C, flow 30.0Â°C, DM -256[0m
[36m2025-10-28 03:10:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 22 Hz (1h avg: 25, 6h avg: 25, mode: space) - OK: Normal operation (22 Hz, 6h avg: 25 Hz)[0m
[36m2025-10-28 03:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 03:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 03:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 03:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 03:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 03:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 03:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 03:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 03:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 03:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 03:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 83}[0m
[36m2025-10-28 03:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 03:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 03:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 03:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 03:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 03:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 03:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 03:10:31.321 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 03:10:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q12 = 14.37 Ã¶re/kWh[0m
[36m2025-10-28 03:10:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 03:10:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 03:10:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 03:10:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 03:10:31.322 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 03:10:31.322 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 03:10:31.322 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 03:10:31.323 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 03:10:31.323 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 03:10:31.323 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 03:10:31.323 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 7.7Â°C: normal -126 to -326, warning -326[0m
[36m2025-10-28 03:10:31.323 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 03:10:31.323 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -326 (base: -326), critical -1500[0m
[36m2025-10-28 03:10:31.323 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=7.7Â°C, indoor_target=21.0Â°C, temp_diff=13.3Â°C, HC=0.180 kW/K -> flow=26.0Â°C[0m
[36m2025-10-28 03:10:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 03:10:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 03:10:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.5Â°C, current=30.0Â°C, error=-3.5Â°C, sensitivity=1.5 -> offset=-2.3[0m
[36m2025-10-28 03:10:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=7.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 03:10:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 30.0Â°C â†’ offset: -2.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -256)[0m
[36m2025-10-28 03:10:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Price classification Q12 (03:10): 14.37 â†’ CHEAP[0m
[32m2025-10-28 03:10:31.324 INFO (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.69Â°C - Learned pre-heat: Pre-heating: predicted drop 1.6Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 30.0Â°C â†’ offset: -2.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -256) | GE-Spot Q12: CHEAP (night) | Too warm: 2.3Â°C over[0m
[32m2025-10-28 03:10:31.326 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.69Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.6Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 30.0Â°C â†’ offset: -2.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -256) | GE-Spot Q12: CHEAP (night) | Too warm: 2.3Â°C over[0m
[36m2025-10-28 03:10:31.326 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.69Â°C, integer=0Â°C, fractional=0.69Â°C, accumulator_before=0.39Â°C[0m
[32m2025-10-28 03:10:31.326 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] âœ“ Accumulated fractional offset reached threshold: applying +1Â°C adjustment (accumulator: 1.08Â°C â†’ 0.08Â°C)[0m
[36m2025-10-28 03:10:31.326 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Accumulator triggered: total_accumulated=1.08Â°C, adjustment=+1Â°C, new_integer=1Â°C, remaining=0.08Â°C[0m
[36m2025-10-28 03:10:31.326 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset 0.69Â°C â†’ applying 1Â°C (accumulator: 0.08Â°C, needs 0.92Â°C more to trigger)[0m
[32m2025-10-28 03:10:31.327 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to 1Â°C (calculated: 0.69Â°C, accumulator: 0.08Â°C)[0m
[36m2025-10-28 03:10:31.327 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=1Â°C, original=0.69Â°C, accumulator=0.08Â°C[0m
[32m2025-10-28 03:10:31.327 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset 0.69Â°C to NIBE via MyUplink[0m
[36m2025-10-28 03:10:31.327 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 9.881 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 03:10:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.3Â°C, outdoor=7.7Â°C, offset=0.7Â°C, change=-0.05Â°C, Î”t=0.08h[0m
[36m2025-10-28 03:10:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.3Â°C, outdoor=7.7Â°C, offset=0.7Â°C, flow=30.0Â°C, DM=-256[0m
[36m2025-10-28 03:10:31.337 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.1Â°C/h trend[0m
[36m2025-10-28 03:10:31.337 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 03:10:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 03:10:31.340 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 03:10:31.340 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=36.1[0m
[36m2025-10-28 03:10:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 03:10:31.342 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 03:10:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 03:10:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.7Â°C (zone: Moderate Cold): block=-326, abort=-406[0m
[36m2025-10-28 03:10:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 03:10:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-256, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 03:10:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 12 quarters available, need 3 quarters (45 min), lookahead 3.0h[0m
[36m2025-10-28 03:10:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 10 windows evaluated[0m
[36m2025-10-28 03:10:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (0.6h away) â† SELECTED[0m
[36m2025-10-28 03:10:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (0.3h away)[0m
[36m2025-10-28 03:10:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (0.8h away)[0m
[36m2025-10-28 03:10:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (0.1h away)[0m
[36m2025-10-28 03:10:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 14.2Ã¶re/kWh at 04:15 (1.1h away)[0m
[32m2025-10-28 03:10:31.343 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 0.6h away[0m
[36m2025-10-28 03:10:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 03:10:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-256, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 03:10:31.346 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 03:10:31.347 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 03:10:31.347 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.7Â°C (zone: Moderate Cold): block=-326, abort=-406[0m
[36m2025-10-28 03:10:31.347 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 03:10:31.347 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-256, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 03:10:31.347 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 12 quarters available, need 3 quarters (45 min), lookahead 3.0h[0m
[36m2025-10-28 03:10:31.347 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 10 windows evaluated[0m
[36m2025-10-28 03:10:31.347 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (0.6h away) â† SELECTED[0m
[36m2025-10-28 03:10:31.347 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (0.3h away)[0m
[36m2025-10-28 03:10:31.347 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (0.8h away)[0m
[36m2025-10-28 03:10:31.347 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 10.1Ã¶re/kWh at 03:15 (0.1h away)[0m
[36m2025-10-28 03:10:31.347 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 14.2Ã¶re/kWh at 04:15 (1.1h away)[0m
[32m2025-10-28 03:10:31.347 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 0.6h away[0m
[36m2025-10-28 03:10:31.347 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 03:10:31.347 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-256, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 03:10:31.347 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 03:10:31.348 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.028 seconds (success: True)[0m
[36m2025-10-28 03:10:31.349 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (8.1 + 0.5 + 12.7)A Ã— 0.95 = 4.86 kW[0m
[36m2025-10-28 03:10:31.349 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 03:15:31.319 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 03:15:31.319 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.4Â°C (median of 9 sensors: 23.6Â°C, 21.1Â°C, 21.4Â°C, 23.4Â°C, 25.4Â°C, 24.2Â°C, 22.3Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-28 03:15:31.319 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -254.0[0m
[36m2025-10-28 03:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 36.1Â°C[0m
[36m2025-10-28 03:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.0Â°C[0m
[36m2025-10-28 03:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=6.1A, L2=6.8A, L3=12.7A[0m
[36m2025-10-28 03:15:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.4Â°C, outdoor 7.7Â°C, flow 30.0Â°C, DM -254[0m
[36m2025-10-28 03:15:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 22 Hz (1h avg: 25, 6h avg: 25, mode: space) - OK: Normal operation (22 Hz, 6h avg: 25 Hz)[0m
[36m2025-10-28 03:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 03:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 03:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 03:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 03:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 03:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 03:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 03:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 03:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 03:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 03:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 82}[0m
[36m2025-10-28 03:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 03:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 03:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 03:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 03:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 03:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 03:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 03:15:31.321 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 03:15:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q13 = 10.93 Ã¶re/kWh[0m
[36m2025-10-28 03:15:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 03:15:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 03:15:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 03:15:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 03:15:31.322 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 03:15:31.322 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 03:15:31.322 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 03:15:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 03:15:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 03:15:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 03:15:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 7.7Â°C: normal -126 to -326, warning -326[0m
[36m2025-10-28 03:15:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 03:15:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -326 (base: -326), critical -1500[0m
[36m2025-10-28 03:15:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=7.7Â°C, indoor_target=21.0Â°C, temp_diff=13.3Â°C, HC=0.180 kW/K -> flow=26.0Â°C[0m
[36m2025-10-28 03:15:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 03:15:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 03:15:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.5Â°C, current=30.0Â°C, error=-3.5Â°C, sensitivity=1.5 -> offset=-2.3[0m
[36m2025-10-28 03:15:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=7.7Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 03:15:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 30.0Â°C â†’ offset: -2.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -254)[0m
[36m2025-10-28 03:15:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Price classification Q13 (03:15): 10.93 â†’ CHEAP[0m
[32m2025-10-28 03:15:31.324 INFO (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.68Â°C - Learned pre-heat: Pre-heating: predicted drop 1.6Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 30.0Â°C â†’ offset: -2.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -254) | GE-Spot Q13: CHEAP (night) | Too warm: 2.4Â°C over[0m
[32m2025-10-28 03:15:31.325 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.68Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.6Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 26.0Â°C; Safety: +0.5Â°C; Adjusted: 26.5Â°C; Current: 30.0Â°C â†’ offset: -2.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -254) | GE-Spot Q13: CHEAP (night) | Too warm: 2.4Â°C over[0m
[36m2025-10-28 03:15:31.325 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Skipping offset write, too soon since last write[0m
[36m2025-10-28 03:15:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.68Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-28 03:15:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 9.831 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 03:15:31.325 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.4Â°C, outdoor=7.7Â°C, offset=0.7Â°C, change=0.10Â°C, Î”t=0.08h[0m
[36m2025-10-28 03:15:31.325 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.4Â°C, outdoor=7.7Â°C, offset=0.7Â°C, flow=30.0Â°C, DM=-254[0m
[36m2025-10-28 03:15:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-28 03:15:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 03:15:31.328 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 03:15:31.328 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 03:15:31.328 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=36.1[0m
[36m2025-10-28 03:15:31.328 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 03:15:31.338 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 03:15:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 03:15:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.7Â°C (zone: Moderate Cold): block=-326, abort=-406[0m
[36m2025-10-28 03:15:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 03:15:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-254, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 03:15:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 12 quarters available, need 3 quarters (45 min), lookahead 3.0h[0m
[36m2025-10-28 03:15:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 10 windows evaluated[0m
[36m2025-10-28 03:15:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (0.5h away) â† SELECTED[0m
[36m2025-10-28 03:15:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (0.2h away)[0m
[36m2025-10-28 03:15:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (0.7h away)[0m
[36m2025-10-28 03:15:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 14.2Ã¶re/kWh at 04:15 (1.0h away)[0m
[36m2025-10-28 03:15:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 16.4Ã¶re/kWh at 04:30 (1.2h away)[0m
[32m2025-10-28 03:15:31.339 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 0.5h away[0m
[36m2025-10-28 03:15:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 03:15:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-254, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 03:15:31.341 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 03:15:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 03:15:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 7.7Â°C (zone: Moderate Cold): block=-326, abort=-406[0m
[36m2025-10-28 03:15:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 03:15:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-254, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 03:15:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 12 quarters available, need 3 quarters (45 min), lookahead 3.0h[0m
[36m2025-10-28 03:15:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 10 windows evaluated[0m
[36m2025-10-28 03:15:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (0.5h away) â† SELECTED[0m
[36m2025-10-28 03:15:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (0.2h away)[0m
[36m2025-10-28 03:15:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (0.7h away)[0m
[36m2025-10-28 03:15:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 14.2Ã¶re/kWh at 04:15 (1.0h away)[0m
[36m2025-10-28 03:15:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 16.4Ã¶re/kWh at 04:30 (1.2h away)[0m
[32m2025-10-28 03:15:31.342 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 0.5h away[0m
[36m2025-10-28 03:15:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 7.7Â°C (zone avg: -1.0Â°C, delta: 8.7Â°C): normal -126 to -326, warning -326, critical -1500[0m
[36m2025-10-28 03:15:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-254, warning=-326, threshold=-163, has_capacity=False[0m
[36m2025-10-28 03:15:31.342 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 03:15:31.343 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.023 seconds (success: True)[0m
[36m2025-10-28 03:15:31.344 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (6.1 + 6.8 + 12.7)A Ã— 0.95 = 5.84 kW[0m
[36m2025-10-28 03:15:31.344 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 03:20:31.319 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 03:20:31.319 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.4Â°C (median of 9 sensors: 23.6Â°C, 21.1Â°C, 21.4Â°C, 23.4Â°C, 25.5Â°C, 24.2Â°C, 22.3Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-28 03:20:31.319 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -255.0[0m
[36m2025-10-28 03:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 36.1Â°C[0m
[36m2025-10-28 03:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 29.5Â°C[0m
[36m2025-10-28 03:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=8.2A, L2=6.8A, L3=12.7A[0m
[36m2025-10-28 03:20:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.4Â°C, outdoor 8.2Â°C, flow 29.5Â°C, DM -255[0m
[36m2025-10-28 03:20:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 22 Hz (1h avg: 25, 6h avg: 25, mode: space) - OK: Normal operation (22 Hz, 6h avg: 25 Hz)[0m
[36m2025-10-28 03:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 03:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 03:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 03:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 03:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 03:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 03:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 03:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 03:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 03:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 03:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 82}[0m
[36m2025-10-28 03:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 03:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 03:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 03:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 03:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 03:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 03:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 03:20:31.320 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 03:20:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q13 = 10.93 Ã¶re/kWh[0m
[36m2025-10-28 03:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 03:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 03:20:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 03:20:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 03:20:31.322 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 03:20:31.322 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 03:20:31.322 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 03:20:31.323 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 03:20:31.323 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 03:20:31.323 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:20:31.323 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 03:20:31.323 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:20:31.323 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 03:20:31.323 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 03:20:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 03:20:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 03:20:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=29.5Â°C, error=-3.1Â°C, sensitivity=1.5 -> offset=-2.1[0m
[36m2025-10-28 03:20:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 03:20:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 29.5Â°C â†’ offset: -2.1Â°C; Weight: 0.20; Deferred: Moderate debt (DM -255)[0m
[36m2025-10-28 03:20:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Price classification Q13 (03:20): 10.93 â†’ CHEAP[0m
[32m2025-10-28 03:20:31.324 INFO (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.70Â°C - Learned pre-heat: Pre-heating: predicted drop 1.6Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 29.5Â°C â†’ offset: -2.1Â°C; Weight: 0.20; Deferred: Moderate debt (DM -255) | GE-Spot Q13: CHEAP (night) | Too warm: 2.4Â°C over[0m
[32m2025-10-28 03:20:31.324 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.70Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.6Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 29.5Â°C â†’ offset: -2.1Â°C; Weight: 0.20; Deferred: Moderate debt (DM -255) | GE-Spot Q13: CHEAP (night) | Too warm: 2.4Â°C over[0m
[36m2025-10-28 03:20:31.324 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.70Â°C, integer=0Â°C, fractional=0.70Â°C, accumulator_before=0.08Â°C[0m
[36m2025-10-28 03:20:31.324 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: 0.78Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-28 03:20:31.324 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.70Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-28 03:20:31.324 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 9.278 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 03:20:31.325 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.4Â°C, outdoor=8.2Â°C, offset=0.7Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-28 03:20:31.325 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.4Â°C, outdoor=8.2Â°C, offset=0.7Â°C, flow=29.5Â°C, DM=-255[0m
[36m2025-10-28 03:20:31.328 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.0Â°C/h trend[0m
[36m2025-10-28 03:20:31.328 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 03:20:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 03:20:31.330 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 03:20:31.330 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=36.1[0m
[36m2025-10-28 03:20:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:20:31.338 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 03:20:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:20:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 03:20:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:20:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-255, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 03:20:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 12 quarters available, need 3 quarters (45 min), lookahead 3.0h[0m
[36m2025-10-28 03:20:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 10 windows evaluated[0m
[36m2025-10-28 03:20:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (0.4h away) â† SELECTED[0m
[36m2025-10-28 03:20:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (0.2h away)[0m
[36m2025-10-28 03:20:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (0.7h away)[0m
[36m2025-10-28 03:20:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 14.2Ã¶re/kWh at 04:15 (0.9h away)[0m
[36m2025-10-28 03:20:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 16.4Ã¶re/kWh at 04:30 (1.2h away)[0m
[32m2025-10-28 03:20:31.339 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 0.4h away[0m
[36m2025-10-28 03:20:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:20:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-255, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 03:20:31.343 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 03:20:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:20:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 03:20:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:20:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-255, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 03:20:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 12 quarters available, need 3 quarters (45 min), lookahead 3.0h[0m
[36m2025-10-28 03:20:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 10 windows evaluated[0m
[36m2025-10-28 03:20:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (0.4h away) â† SELECTED[0m
[36m2025-10-28 03:20:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (0.2h away)[0m
[36m2025-10-28 03:20:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (0.7h away)[0m
[36m2025-10-28 03:20:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 14.2Ã¶re/kWh at 04:15 (0.9h away)[0m
[36m2025-10-28 03:20:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 16.4Ã¶re/kWh at 04:30 (1.2h away)[0m
[32m2025-10-28 03:20:31.344 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 0.4h away[0m
[36m2025-10-28 03:20:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:20:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-255, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 03:20:31.344 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 03:20:31.344 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.025 seconds (success: True)[0m
[36m2025-10-28 03:20:31.345 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (8.2 + 6.8 + 12.7)A Ã— 0.95 = 6.32 kW[0m
[36m2025-10-28 03:20:31.346 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 03:25:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 03:25:31.320 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.4Â°C (median of 9 sensors: 23.6Â°C, 21.1Â°C, 21.5Â°C, 23.4Â°C, 25.6Â°C, 24.2Â°C, 22.3Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-28 03:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -256.0[0m
[36m2025-10-28 03:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 36.1Â°C[0m
[36m2025-10-28 03:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 29.5Â°C[0m
[36m2025-10-28 03:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=6.3A, L2=0.7A, L3=12.7A[0m
[36m2025-10-28 03:25:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.4Â°C, outdoor 8.2Â°C, flow 29.5Â°C, DM -256[0m
[36m2025-10-28 03:25:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 22 Hz (1h avg: 24, 6h avg: 25, mode: space) - OK: Normal operation (22 Hz, 6h avg: 25 Hz)[0m
[36m2025-10-28 03:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 03:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 03:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 03:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 03:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 03:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 03:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 03:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 03:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 03:25:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 03:25:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 82}[0m
[36m2025-10-28 03:25:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 03:25:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 03:25:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 03:25:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 03:25:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 03:25:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 03:25:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 03:25:31.321 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 03:25:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q13 = 10.93 Ã¶re/kWh[0m
[36m2025-10-28 03:25:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 03:25:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 03:25:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 03:25:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 03:25:31.322 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 03:25:31.322 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 03:25:31.323 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 03:25:31.324 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 03:25:31.324 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 03:25:31.324 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:25:31.324 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 03:25:31.324 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:25:31.324 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 03:25:31.324 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 03:25:31.324 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 03:25:31.324 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 03:25:31.325 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=29.5Â°C, error=-3.1Â°C, sensitivity=1.5 -> offset=-2.1[0m
[36m2025-10-28 03:25:31.325 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 03:25:31.325 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 29.5Â°C â†’ offset: -2.1Â°C; Weight: 0.20; Deferred: Moderate debt (DM -256)[0m
[36m2025-10-28 03:25:31.325 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Price classification Q13 (03:25): 10.93 â†’ CHEAP[0m
[32m2025-10-28 03:25:31.325 INFO (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.71Â°C - Learned pre-heat: Pre-heating: predicted drop 1.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 29.5Â°C â†’ offset: -2.1Â°C; Weight: 0.20; Deferred: Moderate debt (DM -256) | GE-Spot Q13: CHEAP (night) | Too warm: 2.4Â°C over[0m
[32m2025-10-28 03:25:31.325 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.71Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 29.5Â°C â†’ offset: -2.1Â°C; Weight: 0.20; Deferred: Moderate debt (DM -256) | GE-Spot Q13: CHEAP (night) | Too warm: 2.4Â°C over[0m
[36m2025-10-28 03:25:31.326 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.71Â°C, integer=0Â°C, fractional=0.71Â°C, accumulator_before=0.78Â°C[0m
[32m2025-10-28 03:25:31.326 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] âœ“ Accumulated fractional offset reached threshold: applying +1Â°C adjustment (accumulator: 1.49Â°C â†’ 0.49Â°C)[0m
[36m2025-10-28 03:25:31.326 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Accumulator triggered: total_accumulated=1.49Â°C, adjustment=+1Â°C, new_integer=1Â°C, remaining=0.49Â°C[0m
[36m2025-10-28 03:25:31.326 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset 0.71Â°C â†’ applying 1Â°C (accumulator: 0.49Â°C, needs 0.51Â°C more to trigger)[0m
[32m2025-10-28 03:25:31.327 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to 1Â°C (calculated: 0.71Â°C, accumulator: 0.49Â°C)[0m
[36m2025-10-28 03:25:31.327 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=1Â°C, original=0.71Â°C, accumulator=0.49Â°C[0m
[32m2025-10-28 03:25:31.327 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset 0.71Â°C to NIBE via MyUplink[0m
[36m2025-10-28 03:25:31.327 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 8.366 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 03:25:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.4Â°C, outdoor=8.2Â°C, offset=0.7Â°C, change=-0.05Â°C, Î”t=0.08h[0m
[36m2025-10-28 03:25:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.4Â°C, outdoor=8.2Â°C, offset=0.7Â°C, flow=29.5Â°C, DM=-256[0m
[36m2025-10-28 03:25:31.338 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.1Â°C/h trend[0m
[36m2025-10-28 03:25:31.338 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 03:25:31.343 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved learned data to storage[0m
[36m2025-10-28 03:25:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 03:25:31.343 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 03:25:31.343 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=36.1[0m
[36m2025-10-28 03:25:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:25:31.348 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 03:25:31.348 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:25:31.348 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 03:25:31.348 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:25:31.348 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-256, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 03:25:31.349 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 12 quarters available, need 3 quarters (45 min), lookahead 3.0h[0m
[36m2025-10-28 03:25:31.349 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 10 windows evaluated[0m
[36m2025-10-28 03:25:31.349 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (0.3h away) â† SELECTED[0m
[36m2025-10-28 03:25:31.349 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (0.1h away)[0m
[36m2025-10-28 03:25:31.349 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (0.6h away)[0m
[36m2025-10-28 03:25:31.349 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 14.2Ã¶re/kWh at 04:15 (0.8h away)[0m
[36m2025-10-28 03:25:31.349 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 16.4Ã¶re/kWh at 04:30 (1.1h away)[0m
[32m2025-10-28 03:25:31.349 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 0.3h away[0m
[36m2025-10-28 03:25:31.349 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:25:31.349 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-256, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 03:25:31.351 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 03:25:31.351 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:25:31.351 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 03:25:31.351 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:25:31.351 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-256, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 03:25:31.351 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 12 quarters available, need 3 quarters (45 min), lookahead 3.0h[0m
[36m2025-10-28 03:25:31.351 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 10 windows evaluated[0m
[36m2025-10-28 03:25:31.351 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (0.3h away) â† SELECTED[0m
[36m2025-10-28 03:25:31.351 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.2Ã¶re/kWh at 03:30 (0.1h away)[0m
[36m2025-10-28 03:25:31.351 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 8.6Ã¶re/kWh at 04:00 (0.6h away)[0m
[36m2025-10-28 03:25:31.351 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 14.2Ã¶re/kWh at 04:15 (0.8h away)[0m
[36m2025-10-28 03:25:31.351 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 16.4Ã¶re/kWh at 04:30 (1.1h away)[0m
[32m2025-10-28 03:25:31.351 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 0.3h away[0m
[36m2025-10-28 03:25:31.351 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:25:31.351 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-256, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 03:25:31.351 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 03:25:31.352 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.032 seconds (success: True)[0m
[36m2025-10-28 03:25:31.353 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (6.3 + 0.7 + 12.7)A Ã— 0.95 = 4.49 kW[0m
[36m2025-10-28 03:25:31.353 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 03:30:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 03:30:31.320 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.4Â°C (median of 9 sensors: 23.6Â°C, 21.1Â°C, 21.4Â°C, 23.4Â°C, 25.8Â°C, 24.2Â°C, 22.3Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-28 03:30:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -257.0[0m
[36m2025-10-28 03:30:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 36.1Â°C[0m
[36m2025-10-28 03:30:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 29.5Â°C[0m
[36m2025-10-28 03:30:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=6.5A, L2=0.7A, L3=12.7A[0m
[36m2025-10-28 03:30:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.4Â°C, outdoor 8.2Â°C, flow 29.5Â°C, DM -257[0m
[36m2025-10-28 03:30:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 24 Hz (1h avg: 24, 6h avg: 25, mode: space) - OK: Normal operation (24 Hz, 6h avg: 25 Hz)[0m
[36m2025-10-28 03:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 03:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 03:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 03:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 03:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 03:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 03:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 03:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 03:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 03:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 03:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 81}[0m
[36m2025-10-28 03:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 03:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 03:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 03:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 03:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 03:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 03:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 03:30:31.321 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 03:30:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q14 = 9.64 Ã¶re/kWh[0m
[36m2025-10-28 03:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 03:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 03:30:31.323 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 03:30:31.323 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 03:30:31.323 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 03:30:31.323 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 03:30:31.323 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 03:30:31.326 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 03:30:31.326 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 03:30:31.327 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:30:31.327 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 03:30:31.327 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:30:31.327 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 03:30:31.327 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 03:30:31.327 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 03:30:31.327 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 03:30:31.327 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=29.5Â°C, error=-3.1Â°C, sensitivity=1.5 -> offset=-2.1[0m
[36m2025-10-28 03:30:31.327 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 03:30:31.327 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 29.5Â°C â†’ offset: -2.1Â°C; Weight: 0.20; Deferred: Moderate debt (DM -257)[0m
[36m2025-10-28 03:30:31.328 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Price classification Q14 (03:30): 9.64 â†’ CHEAP[0m
[32m2025-10-28 03:30:31.328 INFO (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.71Â°C - Learned pre-heat: Pre-heating: predicted drop 1.6Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 29.5Â°C â†’ offset: -2.1Â°C; Weight: 0.20; Deferred: Moderate debt (DM -257) | GE-Spot Q14: CHEAP (night) | Too warm: 2.4Â°C over[0m
[32m2025-10-28 03:30:31.329 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.71Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.6Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 29.5Â°C â†’ offset: -2.1Â°C; Weight: 0.20; Deferred: Moderate debt (DM -257) | GE-Spot Q14: CHEAP (night) | Too warm: 2.4Â°C over[0m
[36m2025-10-28 03:30:31.329 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.71Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-28 03:30:31.329 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 9.970 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 03:30:31.329 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.4Â°C, outdoor=8.2Â°C, offset=0.7Â°C, change=0.01Â°C, Î”t=0.08h[0m
[36m2025-10-28 03:30:31.329 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.4Â°C, outdoor=8.2Â°C, offset=0.7Â°C, flow=29.5Â°C, DM=-257[0m
[36m2025-10-28 03:30:31.336 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.1Â°C/h trend[0m
[36m2025-10-28 03:30:31.336 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 03:30:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 03:30:31.338 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 03:30:31.338 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=36.1[0m
[36m2025-10-28 03:30:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:30:31.340 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 03:30:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:30:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 03:30:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:30:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-257, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 03:30:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 12 quarters available, need 3 quarters (45 min), lookahead 3.0h[0m
[36m2025-10-28 03:30:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 10 windows evaluated[0m
[36m2025-10-28 03:30:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (0.2h away) â† SELECTED[0m
[36m2025-10-28 03:30:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.6Ã¶re/kWh at 04:00 (0.5h away)[0m
[36m2025-10-28 03:30:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 14.2Ã¶re/kWh at 04:15 (0.7h away)[0m
[36m2025-10-28 03:30:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 16.4Ã¶re/kWh at 04:30 (1.0h away)[0m
[36m2025-10-28 03:30:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 17.6Ã¶re/kWh at 04:45 (1.2h away)[0m
[32m2025-10-28 03:30:31.341 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 0.2h away[0m
[36m2025-10-28 03:30:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:30:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-257, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 03:30:31.343 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 03:30:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:30:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 03:30:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:30:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-257, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 03:30:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 12 quarters available, need 3 quarters (45 min), lookahead 3.0h[0m
[36m2025-10-28 03:30:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 10 windows evaluated[0m
[36m2025-10-28 03:30:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (0.2h away) â† SELECTED[0m
[36m2025-10-28 03:30:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.6Ã¶re/kWh at 04:00 (0.5h away)[0m
[36m2025-10-28 03:30:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 14.2Ã¶re/kWh at 04:15 (0.7h away)[0m
[36m2025-10-28 03:30:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 16.4Ã¶re/kWh at 04:30 (1.0h away)[0m
[36m2025-10-28 03:30:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 17.6Ã¶re/kWh at 04:45 (1.2h away)[0m
[32m2025-10-28 03:30:31.344 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 0.2h away[0m
[36m2025-10-28 03:30:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:30:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-257, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 03:30:31.344 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 03:30:31.344 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.024 seconds (success: True)[0m
[36m2025-10-28 03:30:31.346 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (6.5 + 0.7 + 12.7)A Ã— 0.95 = 4.54 kW[0m
[36m2025-10-28 03:30:31.346 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 03:35:31.319 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 03:35:31.320 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.4Â°C (median of 9 sensors: 23.6Â°C, 21.1Â°C, 21.4Â°C, 23.4Â°C, 25.9Â°C, 24.2Â°C, 22.3Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-28 03:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -258.0[0m
[36m2025-10-28 03:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 36.1Â°C[0m
[36m2025-10-28 03:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 29.5Â°C[0m
[36m2025-10-28 03:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=8.0A, L2=9.2A, L3=12.7A[0m
[36m2025-10-28 03:35:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.4Â°C, outdoor 8.2Â°C, flow 29.5Â°C, DM -258[0m
[36m2025-10-28 03:35:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 24 Hz (1h avg: 24, 6h avg: 25, mode: space) - OK: Normal operation (24 Hz, 6h avg: 25 Hz)[0m
[36m2025-10-28 03:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 03:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 03:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 03:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 03:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 03:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 03:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 03:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 03:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 03:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 03:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 81}[0m
[36m2025-10-28 03:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 03:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 03:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 03:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 03:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 03:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 03:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 03:35:31.321 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 03:35:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q14 = 9.64 Ã¶re/kWh[0m
[36m2025-10-28 03:35:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 03:35:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 03:35:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 03:35:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 03:35:31.322 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 03:35:31.322 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 03:35:31.322 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 03:35:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 03:35:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 03:35:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:35:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 03:35:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:35:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 03:35:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 03:35:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 03:35:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 03:35:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=29.5Â°C, error=-3.1Â°C, sensitivity=1.5 -> offset=-2.1[0m
[36m2025-10-28 03:35:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 03:35:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 29.5Â°C â†’ offset: -2.1Â°C; Weight: 0.20; Deferred: Moderate debt (DM -258)[0m
[36m2025-10-28 03:35:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Price classification Q14 (03:35): 9.64 â†’ CHEAP[0m
[32m2025-10-28 03:35:31.324 INFO (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.71Â°C - Learned pre-heat: Pre-heating: predicted drop 1.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 29.5Â°C â†’ offset: -2.1Â°C; Weight: 0.20; Deferred: Moderate debt (DM -258) | GE-Spot Q14: CHEAP (night) | Too warm: 2.4Â°C over[0m
[32m2025-10-28 03:35:31.325 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.71Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 29.5Â°C â†’ offset: -2.1Â°C; Weight: 0.20; Deferred: Moderate debt (DM -258) | GE-Spot Q14: CHEAP (night) | Too warm: 2.4Â°C over[0m
[36m2025-10-28 03:35:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.71Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-28 03:35:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 7.917 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 03:35:31.325 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.4Â°C, outdoor=8.2Â°C, offset=0.7Â°C, change=-0.01Â°C, Î”t=0.08h[0m
[36m2025-10-28 03:35:31.325 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.4Â°C, outdoor=8.2Â°C, offset=0.7Â°C, flow=29.5Â°C, DM=-258[0m
[36m2025-10-28 03:35:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-28 03:35:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 03:35:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 03:35:31.327 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 03:35:31.327 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=36.1[0m
[36m2025-10-28 03:35:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:35:31.336 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 03:35:31.336 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:35:31.336 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 03:35:31.336 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:35:31.336 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-258, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 03:35:31.336 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 12 quarters available, need 3 quarters (45 min), lookahead 3.0h[0m
[36m2025-10-28 03:35:31.336 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 10 windows evaluated[0m
[36m2025-10-28 03:35:31.336 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (0.2h away) â† SELECTED[0m
[36m2025-10-28 03:35:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.6Ã¶re/kWh at 04:00 (0.4h away)[0m
[36m2025-10-28 03:35:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 14.2Ã¶re/kWh at 04:15 (0.7h away)[0m
[36m2025-10-28 03:35:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 16.4Ã¶re/kWh at 04:30 (0.9h away)[0m
[36m2025-10-28 03:35:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 17.6Ã¶re/kWh at 04:45 (1.2h away)[0m
[32m2025-10-28 03:35:31.337 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 0.2h away[0m
[36m2025-10-28 03:35:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:35:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-258, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 03:35:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:35:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-258, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 03:35:31.341 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 03:35:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:35:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 03:35:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:35:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-258, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 03:35:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 12 quarters available, need 3 quarters (45 min), lookahead 3.0h[0m
[36m2025-10-28 03:35:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 10 windows evaluated[0m
[36m2025-10-28 03:35:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (0.2h away) â† SELECTED[0m
[36m2025-10-28 03:35:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.6Ã¶re/kWh at 04:00 (0.4h away)[0m
[36m2025-10-28 03:35:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 14.2Ã¶re/kWh at 04:15 (0.7h away)[0m
[36m2025-10-28 03:35:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 16.4Ã¶re/kWh at 04:30 (0.9h away)[0m
[36m2025-10-28 03:35:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 17.6Ã¶re/kWh at 04:45 (1.2h away)[0m
[32m2025-10-28 03:35:31.342 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 0.2h away[0m
[36m2025-10-28 03:35:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:35:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-258, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 03:35:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:35:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-258, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 03:35:31.342 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 03:35:31.343 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.023 seconds (success: True)[0m
[36m2025-10-28 03:35:31.344 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (8.0 + 9.2 + 12.7)A Ã— 0.95 = 6.82 kW[0m
[36m2025-10-28 03:35:31.344 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 03:40:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 03:40:31.320 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.4Â°C (median of 9 sensors: 23.6Â°C, 21.1Â°C, 21.4Â°C, 23.4Â°C, 26.0Â°C, 24.2Â°C, 22.3Â°C, 23.0Â°C, 25.0Â°C)[0m
[36m2025-10-28 03:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -258.0[0m
[36m2025-10-28 03:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 36.1Â°C[0m
[36m2025-10-28 03:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.0Â°C[0m
[36m2025-10-28 03:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=6.7A, L2=1.2A, L3=12.7A[0m
[36m2025-10-28 03:40:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.4Â°C, outdoor 8.2Â°C, flow 30.0Â°C, DM -258[0m
[36m2025-10-28 03:40:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 23 Hz (1h avg: 24, 6h avg: 25, mode: space) - OK: Normal operation (23 Hz, 6h avg: 25 Hz)[0m
[36m2025-10-28 03:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 03:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 03:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 03:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 03:40:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 03:40:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 03:40:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 03:40:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 03:40:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 03:40:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 03:40:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 81}[0m
[36m2025-10-28 03:40:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 03:40:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 03:40:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 03:40:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 03:40:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 03:40:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 03:40:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 03:40:31.321 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 03:40:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q14 = 9.64 Ã¶re/kWh[0m
[36m2025-10-28 03:40:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 03:40:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 03:40:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 03:40:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 03:40:31.323 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 03:40:31.323 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 03:40:31.323 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 03:40:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 03:40:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 03:40:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:40:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 03:40:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:40:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 03:40:31.325 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 03:40:31.325 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 03:40:31.325 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 03:40:31.325 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=30.0Â°C, error=-3.6Â°C, sensitivity=1.5 -> offset=-2.4[0m
[36m2025-10-28 03:40:31.325 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 03:40:31.325 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.0Â°C â†’ offset: -2.4Â°C; Weight: 0.20; Deferred: Moderate debt (DM -258)[0m
[36m2025-10-28 03:40:31.325 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Price classification Q14 (03:40): 9.64 â†’ CHEAP[0m
[32m2025-10-28 03:40:31.325 INFO (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.67Â°C - Learned pre-heat: Pre-heating: predicted drop 1.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.0Â°C â†’ offset: -2.4Â°C; Weight: 0.20; Deferred: Moderate debt (DM -258) | GE-Spot Q14: CHEAP (night) | Too warm: 2.4Â°C over[0m
[32m2025-10-28 03:40:31.325 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.67Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.0Â°C â†’ offset: -2.4Â°C; Weight: 0.20; Deferred: Moderate debt (DM -258) | GE-Spot Q14: CHEAP (night) | Too warm: 2.4Â°C over[0m
[36m2025-10-28 03:40:31.325 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.67Â°C, integer=0Â°C, fractional=0.67Â°C, accumulator_before=0.49Â°C[0m
[32m2025-10-28 03:40:31.325 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] âœ“ Accumulated fractional offset reached threshold: applying +1Â°C adjustment (accumulator: 1.16Â°C â†’ 0.16Â°C)[0m
[36m2025-10-28 03:40:31.325 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Accumulator triggered: total_accumulated=1.16Â°C, adjustment=+1Â°C, new_integer=1Â°C, remaining=0.16Â°C[0m
[36m2025-10-28 03:40:31.326 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset 0.67Â°C â†’ applying 1Â°C (accumulator: 0.16Â°C, needs 0.84Â°C more to trigger)[0m
[32m2025-10-28 03:40:31.326 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to 1Â°C (calculated: 0.67Â°C, accumulator: 0.16Â°C)[0m
[36m2025-10-28 03:40:31.327 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=1Â°C, original=0.67Â°C, accumulator=0.16Â°C[0m
[32m2025-10-28 03:40:31.327 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset 0.67Â°C to NIBE via MyUplink[0m
[36m2025-10-28 03:40:31.327 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 10.452 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 03:40:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.4Â°C, outdoor=8.2Â°C, offset=0.7Â°C, change=0.03Â°C, Î”t=0.08h[0m
[36m2025-10-28 03:40:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.4Â°C, outdoor=8.2Â°C, offset=0.7Â°C, flow=30.0Â°C, DM=-258[0m
[36m2025-10-28 03:40:31.331 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.1Â°C/h trend[0m
[36m2025-10-28 03:40:31.331 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 03:40:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 03:40:31.332 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 03:40:31.332 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=36.1[0m
[36m2025-10-28 03:40:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:40:31.339 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 03:40:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:40:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 03:40:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:40:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-258, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 03:40:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 12 quarters available, need 3 quarters (45 min), lookahead 3.0h[0m
[36m2025-10-28 03:40:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 10 windows evaluated[0m
[36m2025-10-28 03:40:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (0.1h away) â† SELECTED[0m
[36m2025-10-28 03:40:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.6Ã¶re/kWh at 04:00 (0.3h away)[0m
[36m2025-10-28 03:40:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 14.2Ã¶re/kWh at 04:15 (0.6h away)[0m
[36m2025-10-28 03:40:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 16.4Ã¶re/kWh at 04:30 (0.8h away)[0m
[36m2025-10-28 03:40:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 17.6Ã¶re/kWh at 04:45 (1.1h away)[0m
[32m2025-10-28 03:40:31.340 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 0.1h away[0m
[36m2025-10-28 03:40:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:40:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-258, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 03:40:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:40:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-258, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 03:40:31.344 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 03:40:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:40:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 03:40:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:40:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-258, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 03:40:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 12 quarters available, need 3 quarters (45 min), lookahead 3.0h[0m
[36m2025-10-28 03:40:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 10 windows evaluated[0m
[36m2025-10-28 03:40:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 7.4Ã¶re/kWh at 03:45 (0.1h away) â† SELECTED[0m
[36m2025-10-28 03:40:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 8.6Ã¶re/kWh at 04:00 (0.3h away)[0m
[36m2025-10-28 03:40:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 14.2Ã¶re/kWh at 04:15 (0.6h away)[0m
[36m2025-10-28 03:40:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 16.4Ã¶re/kWh at 04:30 (0.8h away)[0m
[36m2025-10-28 03:40:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 17.6Ã¶re/kWh at 04:45 (1.1h away)[0m
[32m2025-10-28 03:40:31.344 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 03:45 (Q15-Q17) @ 7.4Ã¶re/kWh, 0.1h away[0m
[36m2025-10-28 03:40:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:40:31.345 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-258, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 03:40:31.345 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:40:31.345 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-258, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 03:40:31.345 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 03:40:31.345 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.025 seconds (success: True)[0m
[36m2025-10-28 03:40:31.346 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (6.7 + 1.2 + 12.7)A Ã— 0.95 = 4.70 kW[0m
[36m2025-10-28 03:40:31.347 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 03:45:31.319 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 03:45:31.319 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.4Â°C (median of 9 sensors: 23.6Â°C, 21.1Â°C, 21.4Â°C, 23.4Â°C, 26.1Â°C, 24.2Â°C, 22.3Â°C, 23.0Â°C, 25.0Â°C)[0m
[36m2025-10-28 03:45:31.319 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -254.0[0m
[36m2025-10-28 03:45:31.319 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 36.1Â°C[0m
[36m2025-10-28 03:45:31.319 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.0Â°C[0m
[36m2025-10-28 03:45:31.319 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=6.3A, L2=1.2A, L3=12.7A[0m
[36m2025-10-28 03:45:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.4Â°C, outdoor 8.2Â°C, flow 30.0Â°C, DM -254[0m
[36m2025-10-28 03:45:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 22 Hz (1h avg: 24, 6h avg: 24, mode: space) - OK: Normal operation (22 Hz, 6h avg: 24 Hz)[0m
[36m2025-10-28 03:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 03:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 03:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 03:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 03:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 03:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 03:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 03:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 03:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 03:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 03:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 80}[0m
[36m2025-10-28 03:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 03:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 03:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 03:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 03:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 03:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 03:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 03:45:31.320 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 03:45:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q15 = 9.63 Ã¶re/kWh[0m
[36m2025-10-28 03:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 03:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 03:45:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 03:45:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 03:45:31.322 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 03:45:31.322 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 03:45:31.322 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 03:45:31.323 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 03:45:31.323 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 03:45:31.323 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:45:31.323 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 03:45:31.323 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:45:31.323 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 03:45:31.323 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 03:45:31.323 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 03:45:31.323 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 03:45:31.324 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=30.0Â°C, error=-3.6Â°C, sensitivity=1.5 -> offset=-2.4[0m
[36m2025-10-28 03:45:31.324 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 03:45:31.324 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.0Â°C â†’ offset: -2.4Â°C; Weight: 0.20; Deferred: Moderate debt (DM -254)[0m
[36m2025-10-28 03:45:31.324 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Price classification Q15 (03:45): 9.63 â†’ CHEAP[0m
[32m2025-10-28 03:45:31.324 INFO (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.66Â°C - Learned pre-heat: Pre-heating: predicted drop 1.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.0Â°C â†’ offset: -2.4Â°C; Weight: 0.20; Deferred: Moderate debt (DM -254) | GE-Spot Q15: CHEAP (night) | Too warm: 2.4Â°C over[0m
[32m2025-10-28 03:45:31.326 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.66Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.0Â°C â†’ offset: -2.4Â°C; Weight: 0.20; Deferred: Moderate debt (DM -254) | GE-Spot Q15: CHEAP (night) | Too warm: 2.4Â°C over[0m
[36m2025-10-28 03:45:31.326 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.66Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-28 03:45:31.326 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 7.794 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 03:45:31.326 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.4Â°C, outdoor=8.2Â°C, offset=0.7Â°C, change=0.06Â°C, Î”t=0.08h[0m
[36m2025-10-28 03:45:31.326 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.4Â°C, outdoor=8.2Â°C, offset=0.7Â°C, flow=30.0Â°C, DM=-254[0m
[36m2025-10-28 03:45:31.326 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-28 03:45:31.326 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 03:45:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 03:45:31.327 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 03:45:31.327 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=36.1[0m
[36m2025-10-28 03:45:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:45:31.333 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 03:45:31.333 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:45:31.333 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 03:45:31.333 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:45:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-254, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 03:45:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 12 quarters available, need 3 quarters (45 min), lookahead 3.0h[0m
[36m2025-10-28 03:45:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 10 windows evaluated[0m
[36m2025-10-28 03:45:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 8.6Ã¶re/kWh at 04:00 (0.2h away) â† SELECTED[0m
[36m2025-10-28 03:45:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 14.2Ã¶re/kWh at 04:15 (0.5h away)[0m
[36m2025-10-28 03:45:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 16.4Ã¶re/kWh at 04:30 (0.7h away)[0m
[36m2025-10-28 03:45:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 17.6Ã¶re/kWh at 04:45 (1.0h away)[0m
[36m2025-10-28 03:45:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 24.6Ã¶re/kWh at 05:00 (1.2h away)[0m
[32m2025-10-28 03:45:31.334 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 04:00 (Q16-Q18) @ 8.6Ã¶re/kWh, 0.2h away[0m
[36m2025-10-28 03:45:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:45:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-254, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 03:45:31.337 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 03:45:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:45:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 03:45:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:45:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-254, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 03:45:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 12 quarters available, need 3 quarters (45 min), lookahead 3.0h[0m
[36m2025-10-28 03:45:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 10 windows evaluated[0m
[36m2025-10-28 03:45:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 8.6Ã¶re/kWh at 04:00 (0.2h away) â† SELECTED[0m
[36m2025-10-28 03:45:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 14.2Ã¶re/kWh at 04:15 (0.5h away)[0m
[36m2025-10-28 03:45:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 16.4Ã¶re/kWh at 04:30 (0.7h away)[0m
[36m2025-10-28 03:45:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 17.6Ã¶re/kWh at 04:45 (1.0h away)[0m
[36m2025-10-28 03:45:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 24.6Ã¶re/kWh at 05:00 (1.2h away)[0m
[32m2025-10-28 03:45:31.338 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 04:00 (Q16-Q18) @ 8.6Ã¶re/kWh, 0.2h away[0m
[36m2025-10-28 03:45:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:45:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-254, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 03:45:31.338 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 03:45:31.338 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.019 seconds (success: True)[0m
[36m2025-10-28 03:45:31.340 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (6.3 + 1.2 + 12.7)A Ã— 0.95 = 4.61 kW[0m
[36m2025-10-28 03:45:31.340 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 03:50:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 03:50:31.320 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.4Â°C (median of 9 sensors: 23.6Â°C, 21.1Â°C, 21.4Â°C, 23.4Â°C, 26.2Â°C, 24.2Â°C, 22.1Â°C, 23.0Â°C, 25.0Â°C)[0m
[36m2025-10-28 03:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -252.0[0m
[36m2025-10-28 03:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 36.1Â°C[0m
[36m2025-10-28 03:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.0Â°C[0m
[36m2025-10-28 03:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=7.5A, L2=1.2A, L3=12.7A[0m
[36m2025-10-28 03:50:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.4Â°C, outdoor 8.2Â°C, flow 30.0Â°C, DM -252[0m
[36m2025-10-28 03:50:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 20 Hz (1h avg: 23, 6h avg: 24, mode: space) - OK: Normal operation (20 Hz, 6h avg: 24 Hz)[0m
[36m2025-10-28 03:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 03:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 03:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 03:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 03:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 03:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 03:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 03:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 03:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 03:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 03:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 80}[0m
[36m2025-10-28 03:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 03:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 03:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 03:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 03:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 03:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 03:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 03:50:31.321 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 03:50:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q15 = 9.63 Ã¶re/kWh[0m
[36m2025-10-28 03:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 03:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 03:50:31.323 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 03:50:31.323 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 03:50:31.323 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 03:50:31.323 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 03:50:31.323 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 03:50:31.325 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 03:50:31.325 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 03:50:31.325 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:50:31.325 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 03:50:31.325 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:50:31.325 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 03:50:31.325 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 03:50:31.325 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 03:50:31.325 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 03:50:31.326 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=30.0Â°C, error=-3.6Â°C, sensitivity=1.5 -> offset=-2.4[0m
[36m2025-10-28 03:50:31.326 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 03:50:31.326 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.0Â°C â†’ offset: -2.4Â°C; Weight: 0.20; Deferred: Moderate debt (DM -252)[0m
[36m2025-10-28 03:50:31.326 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Price classification Q15 (03:50): 9.63 â†’ CHEAP[0m
[32m2025-10-28 03:50:31.326 INFO (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.65Â°C - Learned pre-heat: Pre-heating: predicted drop 1.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.0Â°C â†’ offset: -2.4Â°C; Weight: 0.20; Deferred: Moderate debt (DM -252) | GE-Spot Q15: CHEAP (night) | Too warm: 2.4Â°C over[0m
[32m2025-10-28 03:50:31.326 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.65Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.0Â°C â†’ offset: -2.4Â°C; Weight: 0.20; Deferred: Moderate debt (DM -252) | GE-Spot Q15: CHEAP (night) | Too warm: 2.4Â°C over[0m
[36m2025-10-28 03:50:31.326 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.65Â°C, integer=0Â°C, fractional=0.65Â°C, accumulator_before=0.16Â°C[0m
[36m2025-10-28 03:50:31.326 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: 0.81Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-28 03:50:31.326 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.65Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-28 03:50:31.327 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 7.716 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 03:50:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.4Â°C, outdoor=8.2Â°C, offset=0.7Â°C, change=-0.08Â°C, Î”t=0.08h[0m
[36m2025-10-28 03:50:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.4Â°C, outdoor=8.2Â°C, offset=0.7Â°C, flow=30.0Â°C, DM=-252[0m
[36m2025-10-28 03:50:31.329 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.1Â°C/h trend[0m
[36m2025-10-28 03:50:31.329 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 03:50:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 03:50:31.330 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 03:50:31.331 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=36.1[0m
[36m2025-10-28 03:50:31.331 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:50:31.333 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 03:50:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:50:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 03:50:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:50:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-252, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 03:50:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 12 quarters available, need 3 quarters (45 min), lookahead 3.0h[0m
[36m2025-10-28 03:50:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 10 windows evaluated[0m
[36m2025-10-28 03:50:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 8.6Ã¶re/kWh at 04:00 (0.2h away) â† SELECTED[0m
[36m2025-10-28 03:50:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 14.2Ã¶re/kWh at 04:15 (0.4h away)[0m
[36m2025-10-28 03:50:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 16.4Ã¶re/kWh at 04:30 (0.7h away)[0m
[36m2025-10-28 03:50:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 17.6Ã¶re/kWh at 04:45 (0.9h away)[0m
[36m2025-10-28 03:50:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 24.6Ã¶re/kWh at 05:00 (1.2h away)[0m
[32m2025-10-28 03:50:31.334 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 04:00 (Q16-Q18) @ 8.6Ã¶re/kWh, 0.2h away[0m
[36m2025-10-28 03:50:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:50:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-252, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 03:50:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:50:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-252, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 03:50:31.338 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 03:50:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:50:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 03:50:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:50:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-252, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 03:50:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 12 quarters available, need 3 quarters (45 min), lookahead 3.0h[0m
[36m2025-10-28 03:50:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 10 windows evaluated[0m
[36m2025-10-28 03:50:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 8.6Ã¶re/kWh at 04:00 (0.2h away) â† SELECTED[0m
[36m2025-10-28 03:50:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 14.2Ã¶re/kWh at 04:15 (0.4h away)[0m
[36m2025-10-28 03:50:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 16.4Ã¶re/kWh at 04:30 (0.7h away)[0m
[36m2025-10-28 03:50:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 17.6Ã¶re/kWh at 04:45 (0.9h away)[0m
[36m2025-10-28 03:50:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 24.6Ã¶re/kWh at 05:00 (1.2h away)[0m
[32m2025-10-28 03:50:31.338 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 04:00 (Q16-Q18) @ 8.6Ã¶re/kWh, 0.2h away[0m
[36m2025-10-28 03:50:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:50:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-252, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 03:50:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:50:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-252, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 03:50:31.339 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 03:50:31.339 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.019 seconds (success: True)[0m
[36m2025-10-28 03:50:31.340 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (7.5 + 1.2 + 12.7)A Ã— 0.95 = 4.88 kW[0m
[36m2025-10-28 03:50:31.340 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 03:55:31.319 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 03:55:31.320 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.4Â°C (median of 9 sensors: 23.6Â°C, 21.1Â°C, 21.4Â°C, 23.4Â°C, 26.3Â°C, 24.2Â°C, 22.1Â°C, 23.0Â°C, 25.0Â°C)[0m
[36m2025-10-28 03:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -251.0[0m
[36m2025-10-28 03:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 35.6Â°C[0m
[36m2025-10-28 03:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.0Â°C[0m
[36m2025-10-28 03:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=5.9A, L2=1.2A, L3=12.7A[0m
[36m2025-10-28 03:55:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.4Â°C, outdoor 8.2Â°C, flow 30.0Â°C, DM -251[0m
[36m2025-10-28 03:55:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 20 Hz (1h avg: 23, 6h avg: 24, mode: space) - OK: Normal operation (20 Hz, 6h avg: 24 Hz)[0m
[36m2025-10-28 03:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 03:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 03:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 03:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 03:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 03:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 03:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 03:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 03:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 03:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 03:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 80}[0m
[36m2025-10-28 03:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 03:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 03:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 03:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 03:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 03:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 03:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 03:55:31.321 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 03:55:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q15 = 9.63 Ã¶re/kWh[0m
[36m2025-10-28 03:55:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 03:55:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 03:55:31.323 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 03:55:31.323 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 03:55:31.323 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 03:55:31.323 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 03:55:31.328 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 03:55:31.329 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 03:55:31.329 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 03:55:31.329 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:55:31.329 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 03:55:31.329 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:55:31.329 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 03:55:31.329 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 03:55:31.330 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 03:55:31.330 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 03:55:31.330 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=30.0Â°C, error=-3.6Â°C, sensitivity=1.5 -> offset=-2.4[0m
[36m2025-10-28 03:55:31.330 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 03:55:31.330 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.0Â°C â†’ offset: -2.4Â°C; Weight: 0.20; Deferred: Moderate debt (DM -251)[0m
[36m2025-10-28 03:55:31.330 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Price classification Q15 (03:55): 9.63 â†’ CHEAP[0m
[32m2025-10-28 03:55:31.330 INFO (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.67Â°C - Learned pre-heat: Pre-heating: predicted drop 1.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.0Â°C â†’ offset: -2.4Â°C; Weight: 0.20; Deferred: Moderate debt (DM -251) | GE-Spot Q15: CHEAP (night) | Too warm: 2.4Â°C over[0m
[32m2025-10-28 03:55:31.331 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.67Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.0Â°C â†’ offset: -2.4Â°C; Weight: 0.20; Deferred: Moderate debt (DM -251) | GE-Spot Q15: CHEAP (night) | Too warm: 2.4Â°C over[0m
[36m2025-10-28 03:55:31.331 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.67Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-28 03:55:31.331 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 8.285 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 03:55:31.331 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.4Â°C, outdoor=8.2Â°C, offset=0.7Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-28 03:55:31.331 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.4Â°C, outdoor=8.2Â°C, offset=0.7Â°C, flow=30.0Â°C, DM=-251[0m
[36m2025-10-28 03:55:31.337 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.1Â°C/h trend[0m
[36m2025-10-28 03:55:31.337 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 03:55:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 03:55:31.338 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 03:55:31.338 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=35.6[0m
[36m2025-10-28 03:55:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:55:31.340 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 03:55:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:55:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 03:55:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:55:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-251, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 03:55:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 12 quarters available, need 3 quarters (45 min), lookahead 3.0h[0m
[36m2025-10-28 03:55:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 10 windows evaluated[0m
[36m2025-10-28 03:55:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 8.6Ã¶re/kWh at 04:00 (0.1h away) â† SELECTED[0m
[36m2025-10-28 03:55:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 14.2Ã¶re/kWh at 04:15 (0.3h away)[0m
[36m2025-10-28 03:55:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 16.4Ã¶re/kWh at 04:30 (0.6h away)[0m
[36m2025-10-28 03:55:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 17.6Ã¶re/kWh at 04:45 (0.8h away)[0m
[36m2025-10-28 03:55:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 24.6Ã¶re/kWh at 05:00 (1.1h away)[0m
[32m2025-10-28 03:55:31.341 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 04:00 (Q16-Q18) @ 8.6Ã¶re/kWh, 0.1h away[0m
[36m2025-10-28 03:55:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:55:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-251, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 03:55:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:55:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-251, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 03:55:31.345 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 03:55:31.345 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:55:31.345 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 03:55:31.345 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:55:31.345 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-251, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 03:55:31.346 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 12 quarters available, need 3 quarters (45 min), lookahead 3.0h[0m
[36m2025-10-28 03:55:31.346 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 10 windows evaluated[0m
[36m2025-10-28 03:55:31.346 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 8.6Ã¶re/kWh at 04:00 (0.1h away) â† SELECTED[0m
[36m2025-10-28 03:55:31.346 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 14.2Ã¶re/kWh at 04:15 (0.3h away)[0m
[36m2025-10-28 03:55:31.346 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 16.4Ã¶re/kWh at 04:30 (0.6h away)[0m
[36m2025-10-28 03:55:31.346 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 17.6Ã¶re/kWh at 04:45 (0.8h away)[0m
[36m2025-10-28 03:55:31.346 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 24.6Ã¶re/kWh at 05:00 (1.1h away)[0m
[32m2025-10-28 03:55:31.346 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 04:00 (Q16-Q18) @ 8.6Ã¶re/kWh, 0.1h away[0m
[36m2025-10-28 03:55:31.346 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:55:31.346 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-251, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 03:55:31.346 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 03:55:31.346 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-251, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 03:55:31.346 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 03:55:31.346 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.027 seconds (success: True)[0m
[36m2025-10-28 03:55:31.348 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (5.9 + 1.2 + 12.7)A Ã— 0.95 = 4.51 kW[0m
[36m2025-10-28 03:55:31.348 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 04:00:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 04:00:31.320 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.4Â°C (median of 9 sensors: 23.6Â°C, 21.1Â°C, 21.5Â°C, 23.4Â°C, 26.4Â°C, 24.2Â°C, 22.1Â°C, 23.0Â°C, 25.0Â°C)[0m
[36m2025-10-28 04:00:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -249.0[0m
[36m2025-10-28 04:00:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 35.6Â°C[0m
[36m2025-10-28 04:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.0Â°C[0m
[36m2025-10-28 04:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=8.1A, L2=1.2A, L3=12.7A[0m
[36m2025-10-28 04:00:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.4Â°C, outdoor 8.2Â°C, flow 30.0Â°C, DM -249[0m
[36m2025-10-28 04:00:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 20 Hz (1h avg: 22, 6h avg: 24, mode: space) - OK: Normal operation (20 Hz, 6h avg: 24 Hz)[0m
[36m2025-10-28 04:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 04:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 04:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 04:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 04:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 04:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 04:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 04:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 04:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 04:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 04:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 79}[0m
[36m2025-10-28 04:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 04:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 04:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 04:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 04:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 04:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 04:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 04:00:31.323 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 04:00:31.323 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q16 = 5.47 Ã¶re/kWh[0m
[36m2025-10-28 04:00:31.323 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 04:00:31.323 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 04:00:31.324 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 04:00:31.324 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 04:00:31.324 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 04:00:31.324 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 04:00:31.324 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 04:00:31.325 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 04:00:31.325 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 04:00:31.325 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:00:31.325 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 04:00:31.325 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:00:31.326 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 04:00:31.326 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 04:00:31.326 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 04:00:31.326 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 04:00:31.326 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=30.0Â°C, error=-3.6Â°C, sensitivity=1.5 -> offset=-2.4[0m
[36m2025-10-28 04:00:31.326 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 04:00:31.326 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.0Â°C â†’ offset: -2.4Â°C; Weight: 0.20; Deferred: Moderate debt (DM -249)[0m
[36m2025-10-28 04:00:31.326 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Price classification Q16 (04:00): 5.47 â†’ CHEAP[0m
[32m2025-10-28 04:00:31.326 INFO (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.67Â°C - Learned pre-heat: Pre-heating: predicted drop 1.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.0Â°C â†’ offset: -2.4Â°C; Weight: 0.20; Deferred: Moderate debt (DM -249) | GE-Spot Q16: CHEAP (night) | Too warm: 2.4Â°C over[0m
[32m2025-10-28 04:00:31.327 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.67Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.0Â°C â†’ offset: -2.4Â°C; Weight: 0.20; Deferred: Moderate debt (DM -249) | GE-Spot Q16: CHEAP (night) | Too warm: 2.4Â°C over[0m
[36m2025-10-28 04:00:31.327 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.67Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-28 04:00:31.327 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 7.736 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 04:00:31.328 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.4Â°C, outdoor=8.2Â°C, offset=0.7Â°C, change=-0.01Â°C, Î”t=0.08h[0m
[36m2025-10-28 04:00:31.328 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.4Â°C, outdoor=8.2Â°C, offset=0.7Â°C, flow=30.0Â°C, DM=-249[0m
[36m2025-10-28 04:00:31.328 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-28 04:00:31.328 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 04:00:31.329 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 04:00:31.329 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 04:00:31.329 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=35.6[0m
[36m2025-10-28 04:00:31.329 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:00:31.336 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 04:00:31.336 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:00:31.336 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 04:00:31.336 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:00:31.336 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-249, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:00:31.336 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 8 quarters available, need 3 quarters (45 min), lookahead 2.0h[0m
[36m2025-10-28 04:00:31.336 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 6 windows evaluated[0m
[36m2025-10-28 04:00:31.336 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 14.2Ã¶re/kWh at 04:15 (0.2h away) â† SELECTED[0m
[36m2025-10-28 04:00:31.336 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 16.4Ã¶re/kWh at 04:30 (0.5h away)[0m
[36m2025-10-28 04:00:31.336 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 17.6Ã¶re/kWh at 04:45 (0.7h away)[0m
[36m2025-10-28 04:00:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 24.6Ã¶re/kWh at 05:00 (1.0h away)[0m
[36m2025-10-28 04:00:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 39.0Ã¶re/kWh at 05:15 (1.2h away)[0m
[32m2025-10-28 04:00:31.337 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 04:15 (Q17-Q19) @ 14.2Ã¶re/kWh, 0.2h away[0m
[36m2025-10-28 04:00:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:00:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-249, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:00:31.340 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 04:00:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:00:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 04:00:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:00:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-249, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:00:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 8 quarters available, need 3 quarters (45 min), lookahead 2.0h[0m
[36m2025-10-28 04:00:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 6 windows evaluated[0m
[36m2025-10-28 04:00:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 14.2Ã¶re/kWh at 04:15 (0.2h away) â† SELECTED[0m
[36m2025-10-28 04:00:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 16.4Ã¶re/kWh at 04:30 (0.5h away)[0m
[36m2025-10-28 04:00:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 17.6Ã¶re/kWh at 04:45 (0.7h away)[0m
[36m2025-10-28 04:00:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 24.6Ã¶re/kWh at 05:00 (1.0h away)[0m
[36m2025-10-28 04:00:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 39.0Ã¶re/kWh at 05:15 (1.2h away)[0m
[32m2025-10-28 04:00:31.340 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 04:15 (Q17-Q19) @ 14.2Ã¶re/kWh, 0.2h away[0m
[36m2025-10-28 04:00:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:00:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-249, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:00:31.341 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 04:00:31.341 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.021 seconds (success: True)[0m
[36m2025-10-28 04:00:31.342 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (8.1 + 1.2 + 12.7)A Ã— 0.95 = 5.02 kW[0m
[36m2025-10-28 04:00:31.343 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 04:05:31.319 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 04:05:31.319 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.3Â°C (median of 9 sensors: 23.6Â°C, 21.1Â°C, 21.4Â°C, 23.3Â°C, 26.5Â°C, 24.1Â°C, 22.1Â°C, 23.0Â°C, 25.0Â°C)[0m
[36m2025-10-28 04:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -249.0[0m
[36m2025-10-28 04:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 35.6Â°C[0m
[36m2025-10-28 04:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 29.5Â°C[0m
[36m2025-10-28 04:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=7.1A, L2=1.2A, L3=12.7A[0m
[36m2025-10-28 04:05:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.3Â°C, outdoor 8.2Â°C, flow 29.5Â°C, DM -249[0m
[36m2025-10-28 04:05:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 20 Hz (1h avg: 22, 6h avg: 24, mode: space) - OK: Normal operation (20 Hz, 6h avg: 24 Hz)[0m
[36m2025-10-28 04:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 04:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 04:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 04:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 04:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 04:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 04:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 04:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 04:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 04:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 04:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 79}[0m
[36m2025-10-28 04:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 04:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 04:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 04:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 04:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 04:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 04:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 04:05:31.321 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 04:05:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q16 = 5.47 Ã¶re/kWh[0m
[36m2025-10-28 04:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 04:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 04:05:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 04:05:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 04:05:31.322 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 04:05:31.322 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 04:05:31.322 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 04:05:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 04:05:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 04:05:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:05:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 04:05:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:05:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 04:05:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 04:05:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 04:05:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 04:05:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=29.5Â°C, error=-3.1Â°C, sensitivity=1.5 -> offset=-2.1[0m
[36m2025-10-28 04:05:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 04:05:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 29.5Â°C â†’ offset: -2.1Â°C; Weight: 0.20; Deferred: Moderate debt (DM -249)[0m
[36m2025-10-28 04:05:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Price classification Q16 (04:05): 5.47 â†’ CHEAP[0m
[32m2025-10-28 04:05:31.324 INFO (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.71Â°C - Learned pre-heat: Pre-heating: predicted drop 1.6Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 29.5Â°C â†’ offset: -2.1Â°C; Weight: 0.20; Deferred: Moderate debt (DM -249) | GE-Spot Q16: CHEAP (night) | Too warm: 2.3Â°C over[0m
[32m2025-10-28 04:05:31.325 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.71Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.6Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 29.5Â°C â†’ offset: -2.1Â°C; Weight: 0.20; Deferred: Moderate debt (DM -249) | GE-Spot Q16: CHEAP (night) | Too warm: 2.3Â°C over[0m
[36m2025-10-28 04:05:31.325 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.71Â°C, integer=0Â°C, fractional=0.71Â°C, accumulator_before=0.81Â°C[0m
[32m2025-10-28 04:05:31.325 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] âœ“ Accumulated fractional offset reached threshold: applying +1Â°C adjustment (accumulator: 1.52Â°C â†’ 0.52Â°C)[0m
[36m2025-10-28 04:05:31.325 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Accumulator triggered: total_accumulated=1.52Â°C, adjustment=+1Â°C, new_integer=1Â°C, remaining=0.52Â°C[0m
[36m2025-10-28 04:05:31.325 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset 0.71Â°C â†’ applying 1Â°C (accumulator: 0.52Â°C, needs 0.48Â°C more to trigger)[0m
[32m2025-10-28 04:05:31.328 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to 1Â°C (calculated: 0.71Â°C, accumulator: 0.52Â°C)[0m
[36m2025-10-28 04:05:31.328 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=1Â°C, original=0.71Â°C, accumulator=0.52Â°C[0m
[32m2025-10-28 04:05:31.328 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset 0.71Â°C to NIBE via MyUplink[0m
[36m2025-10-28 04:05:31.328 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 7.759 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 04:05:31.328 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.3Â°C, outdoor=8.2Â°C, offset=0.7Â°C, change=-0.03Â°C, Î”t=0.08h[0m
[36m2025-10-28 04:05:31.328 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.3Â°C, outdoor=8.2Â°C, offset=0.7Â°C, flow=29.5Â°C, DM=-249[0m
[36m2025-10-28 04:05:31.333 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.1Â°C/h trend[0m
[36m2025-10-28 04:05:31.333 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 04:05:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 04:05:31.334 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 04:05:31.334 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=35.6[0m
[36m2025-10-28 04:05:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:05:31.338 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 04:05:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:05:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 04:05:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:05:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-249, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:05:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 8 quarters available, need 3 quarters (45 min), lookahead 2.0h[0m
[36m2025-10-28 04:05:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 6 windows evaluated[0m
[36m2025-10-28 04:05:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 14.2Ã¶re/kWh at 04:15 (0.2h away) â† SELECTED[0m
[36m2025-10-28 04:05:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 16.4Ã¶re/kWh at 04:30 (0.4h away)[0m
[36m2025-10-28 04:05:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 17.6Ã¶re/kWh at 04:45 (0.7h away)[0m
[36m2025-10-28 04:05:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 24.6Ã¶re/kWh at 05:00 (0.9h away)[0m
[36m2025-10-28 04:05:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 39.0Ã¶re/kWh at 05:15 (1.2h away)[0m
[32m2025-10-28 04:05:31.339 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 04:15 (Q17-Q19) @ 14.2Ã¶re/kWh, 0.2h away[0m
[36m2025-10-28 04:05:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:05:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-249, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:05:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:05:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-249, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:05:31.341 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 04:05:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:05:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 04:05:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:05:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-249, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:05:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 8 quarters available, need 3 quarters (45 min), lookahead 2.0h[0m
[36m2025-10-28 04:05:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 6 windows evaluated[0m
[36m2025-10-28 04:05:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 14.2Ã¶re/kWh at 04:15 (0.2h away) â† SELECTED[0m
[36m2025-10-28 04:05:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 16.4Ã¶re/kWh at 04:30 (0.4h away)[0m
[36m2025-10-28 04:05:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 17.6Ã¶re/kWh at 04:45 (0.7h away)[0m
[36m2025-10-28 04:05:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 24.6Ã¶re/kWh at 05:00 (0.9h away)[0m
[36m2025-10-28 04:05:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 39.0Ã¶re/kWh at 05:15 (1.2h away)[0m
[32m2025-10-28 04:05:31.342 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 04:15 (Q17-Q19) @ 14.2Ã¶re/kWh, 0.2h away[0m
[36m2025-10-28 04:05:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:05:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-249, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:05:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:05:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-249, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:05:31.342 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 04:05:31.342 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.023 seconds (success: True)[0m
[36m2025-10-28 04:05:31.344 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (7.1 + 1.2 + 12.7)A Ã— 0.95 = 4.79 kW[0m
[36m2025-10-28 04:05:31.344 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 04:10:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 04:10:31.320 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.4Â°C (median of 9 sensors: 23.6Â°C, 21.1Â°C, 21.6Â°C, 23.4Â°C, 26.6Â°C, 24.1Â°C, 22.1Â°C, 23.0Â°C, 25.0Â°C)[0m
[36m2025-10-28 04:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -250.0[0m
[36m2025-10-28 04:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 35.6Â°C[0m
[36m2025-10-28 04:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 29.5Â°C[0m
[36m2025-10-28 04:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=7.1A, L2=1.2A, L3=12.7A[0m
[36m2025-10-28 04:10:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.4Â°C, outdoor 8.2Â°C, flow 29.5Â°C, DM -250[0m
[36m2025-10-28 04:10:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 21 Hz (1h avg: 22, 6h avg: 23, mode: space) - OK: Normal operation (21 Hz, 6h avg: 23 Hz)[0m
[36m2025-10-28 04:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 04:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 04:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 04:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 04:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 04:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 04:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 04:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 04:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 04:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 04:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 79}[0m
[36m2025-10-28 04:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 04:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 04:10:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 04:10:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 04:10:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 04:10:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 04:10:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 04:10:31.321 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 04:10:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q16 = 5.47 Ã¶re/kWh[0m
[36m2025-10-28 04:10:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 04:10:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 04:10:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 04:10:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 04:10:31.322 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 04:10:31.322 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 04:10:31.322 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 04:10:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 04:10:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 04:10:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:10:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 04:10:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:10:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 04:10:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 04:10:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 04:10:31.325 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 04:10:31.325 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=29.5Â°C, error=-3.1Â°C, sensitivity=1.5 -> offset=-2.1[0m
[36m2025-10-28 04:10:31.325 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 04:10:31.325 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 29.5Â°C â†’ offset: -2.1Â°C; Weight: 0.20; Deferred: Moderate debt (DM -250)[0m
[36m2025-10-28 04:10:31.325 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Price classification Q16 (04:10): 5.47 â†’ CHEAP[0m
[32m2025-10-28 04:10:31.325 INFO (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.71Â°C - Learned pre-heat: Pre-heating: predicted drop 1.6Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 29.5Â°C â†’ offset: -2.1Â°C; Weight: 0.20; Deferred: Moderate debt (DM -250) | GE-Spot Q16: CHEAP (night) | Too warm: 2.4Â°C over[0m
[32m2025-10-28 04:10:31.325 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.71Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.6Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 29.5Â°C â†’ offset: -2.1Â°C; Weight: 0.20; Deferred: Moderate debt (DM -250) | GE-Spot Q16: CHEAP (night) | Too warm: 2.4Â°C over[0m
[36m2025-10-28 04:10:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.71Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-28 04:10:31.326 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 8.258 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 04:10:31.326 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.4Â°C, outdoor=8.2Â°C, offset=0.7Â°C, change=0.03Â°C, Î”t=0.08h[0m
[36m2025-10-28 04:10:31.326 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.4Â°C, outdoor=8.2Â°C, offset=0.7Â°C, flow=29.5Â°C, DM=-250[0m
[36m2025-10-28 04:10:31.326 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-28 04:10:31.326 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 04:10:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 04:10:31.327 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 04:10:31.327 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=35.6[0m
[36m2025-10-28 04:10:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:10:31.329 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 04:10:31.329 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:10:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 04:10:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:10:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-250, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:10:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 8 quarters available, need 3 quarters (45 min), lookahead 2.0h[0m
[36m2025-10-28 04:10:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 6 windows evaluated[0m
[36m2025-10-28 04:10:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 14.2Ã¶re/kWh at 04:15 (0.1h away) â† SELECTED[0m
[36m2025-10-28 04:10:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 16.4Ã¶re/kWh at 04:30 (0.3h away)[0m
[36m2025-10-28 04:10:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 17.6Ã¶re/kWh at 04:45 (0.6h away)[0m
[36m2025-10-28 04:10:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 24.6Ã¶re/kWh at 05:00 (0.8h away)[0m
[36m2025-10-28 04:10:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 39.0Ã¶re/kWh at 05:15 (1.1h away)[0m
[32m2025-10-28 04:10:31.330 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 04:15 (Q17-Q19) @ 14.2Ã¶re/kWh, 0.1h away[0m
[36m2025-10-28 04:10:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:10:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-250, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:10:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:10:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-250, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:10:31.338 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 04:10:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:10:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 04:10:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:10:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-250, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:10:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 8 quarters available, need 3 quarters (45 min), lookahead 2.0h[0m
[36m2025-10-28 04:10:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 6 windows evaluated[0m
[36m2025-10-28 04:10:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 14.2Ã¶re/kWh at 04:15 (0.1h away) â† SELECTED[0m
[36m2025-10-28 04:10:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 16.4Ã¶re/kWh at 04:30 (0.3h away)[0m
[36m2025-10-28 04:10:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 17.6Ã¶re/kWh at 04:45 (0.6h away)[0m
[36m2025-10-28 04:10:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 24.6Ã¶re/kWh at 05:00 (0.8h away)[0m
[36m2025-10-28 04:10:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 39.0Ã¶re/kWh at 05:15 (1.1h away)[0m
[32m2025-10-28 04:10:31.339 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 04:15 (Q17-Q19) @ 14.2Ã¶re/kWh, 0.1h away[0m
[36m2025-10-28 04:10:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:10:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-250, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:10:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:10:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-250, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:10:31.339 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 04:10:31.340 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.020 seconds (success: True)[0m
[36m2025-10-28 04:10:31.341 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (7.1 + 1.2 + 12.7)A Ã— 0.95 = 4.79 kW[0m
[36m2025-10-28 04:10:31.341 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 04:15:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 04:15:31.320 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.4Â°C (median of 9 sensors: 23.6Â°C, 21.1Â°C, 21.5Â°C, 23.4Â°C, 26.7Â°C, 24.1Â°C, 22.1Â°C, 23.0Â°C, 25.0Â°C)[0m
[36m2025-10-28 04:15:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -251.0[0m
[36m2025-10-28 04:15:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 35.6Â°C[0m
[36m2025-10-28 04:15:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 29.5Â°C[0m
[36m2025-10-28 04:15:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=5.9A, L2=1.2A, L3=12.7A[0m
[36m2025-10-28 04:15:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.4Â°C, outdoor 8.2Â°C, flow 29.5Â°C, DM -251[0m
[36m2025-10-28 04:15:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 21 Hz (1h avg: 22, 6h avg: 23, mode: space) - OK: Normal operation (21 Hz, 6h avg: 23 Hz)[0m
[36m2025-10-28 04:15:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 04:15:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 04:15:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 04:15:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 04:15:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 04:15:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 04:15:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 04:15:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 04:15:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 04:15:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 04:15:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 78}[0m
[36m2025-10-28 04:15:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 04:15:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 04:15:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 04:15:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 04:15:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 04:15:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 04:15:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 04:15:31.322 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 04:15:31.322 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q17 = 7.01 Ã¶re/kWh[0m
[36m2025-10-28 04:15:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 04:15:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 04:15:31.323 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 04:15:31.323 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 04:15:31.323 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 04:15:31.323 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 04:15:31.323 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 04:15:31.324 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 04:15:31.324 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 04:15:31.324 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:15:31.324 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 04:15:31.324 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:15:31.324 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 04:15:31.325 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 04:15:31.325 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 04:15:31.325 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 04:15:31.325 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=29.5Â°C, error=-3.1Â°C, sensitivity=1.5 -> offset=-2.1[0m
[36m2025-10-28 04:15:31.325 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 04:15:31.325 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 29.5Â°C â†’ offset: -2.1Â°C; Weight: 0.20; Deferred: Moderate debt (DM -251)[0m
[36m2025-10-28 04:15:31.325 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Price classification Q17 (04:15): 7.01 â†’ CHEAP[0m
[32m2025-10-28 04:15:31.325 INFO (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.70Â°C - Learned pre-heat: Pre-heating: predicted drop 1.6Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 29.5Â°C â†’ offset: -2.1Â°C; Weight: 0.20; Deferred: Moderate debt (DM -251) | GE-Spot Q17: CHEAP (night) | Too warm: 2.4Â°C over[0m
[32m2025-10-28 04:15:31.325 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.70Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.6Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 29.5Â°C â†’ offset: -2.1Â°C; Weight: 0.20; Deferred: Moderate debt (DM -251) | GE-Spot Q17: CHEAP (night) | Too warm: 2.4Â°C over[0m
[36m2025-10-28 04:15:31.325 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.70Â°C, integer=0Â°C, fractional=0.70Â°C, accumulator_before=0.52Â°C[0m
[32m2025-10-28 04:15:31.325 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] âœ“ Accumulated fractional offset reached threshold: applying +1Â°C adjustment (accumulator: 1.22Â°C â†’ 0.22Â°C)[0m
[36m2025-10-28 04:15:31.325 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Accumulator triggered: total_accumulated=1.22Â°C, adjustment=+1Â°C, new_integer=1Â°C, remaining=0.22Â°C[0m
[36m2025-10-28 04:15:31.326 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset 0.70Â°C â†’ applying 1Â°C (accumulator: 0.22Â°C, needs 0.78Â°C more to trigger)[0m
[32m2025-10-28 04:15:31.329 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to 1Â°C (calculated: 0.70Â°C, accumulator: 0.22Â°C)[0m
[36m2025-10-28 04:15:31.330 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=1Â°C, original=0.70Â°C, accumulator=0.22Â°C[0m
[32m2025-10-28 04:15:31.330 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset 0.70Â°C to NIBE via MyUplink[0m
[36m2025-10-28 04:15:31.330 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 7.785 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 04:15:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.4Â°C, outdoor=8.2Â°C, offset=0.7Â°C, change=0.06Â°C, Î”t=0.08h[0m
[36m2025-10-28 04:15:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.4Â°C, outdoor=8.2Â°C, offset=0.7Â°C, flow=29.5Â°C, DM=-251[0m
[36m2025-10-28 04:15:31.336 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.1Â°C/h trend[0m
[36m2025-10-28 04:15:31.336 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 04:15:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 04:15:31.340 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 04:15:31.340 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=35.6[0m
[36m2025-10-28 04:15:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:15:31.344 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 04:15:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:15:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 04:15:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:15:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-251, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:15:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 8 quarters available, need 3 quarters (45 min), lookahead 2.0h[0m
[36m2025-10-28 04:15:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 6 windows evaluated[0m
[36m2025-10-28 04:15:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 16.4Ã¶re/kWh at 04:30 (0.2h away) â† SELECTED[0m
[36m2025-10-28 04:15:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 17.6Ã¶re/kWh at 04:45 (0.5h away)[0m
[36m2025-10-28 04:15:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 24.6Ã¶re/kWh at 05:00 (0.7h away)[0m
[36m2025-10-28 04:15:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 39.0Ã¶re/kWh at 05:15 (1.0h away)[0m
[36m2025-10-28 04:15:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 42.5Ã¶re/kWh at 05:30 (1.2h away)[0m
[32m2025-10-28 04:15:31.344 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 04:30 (Q18-Q20) @ 16.4Ã¶re/kWh, 0.2h away[0m
[36m2025-10-28 04:15:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:15:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-251, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:15:31.349 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 04:15:31.349 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:15:31.349 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 04:15:31.349 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:15:31.349 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-251, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:15:31.350 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 8 quarters available, need 3 quarters (45 min), lookahead 2.0h[0m
[36m2025-10-28 04:15:31.350 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 6 windows evaluated[0m
[36m2025-10-28 04:15:31.350 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 16.4Ã¶re/kWh at 04:30 (0.2h away) â† SELECTED[0m
[36m2025-10-28 04:15:31.350 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 17.6Ã¶re/kWh at 04:45 (0.5h away)[0m
[36m2025-10-28 04:15:31.350 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 24.6Ã¶re/kWh at 05:00 (0.7h away)[0m
[36m2025-10-28 04:15:31.350 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 39.0Ã¶re/kWh at 05:15 (1.0h away)[0m
[36m2025-10-28 04:15:31.350 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 42.5Ã¶re/kWh at 05:30 (1.2h away)[0m
[32m2025-10-28 04:15:31.350 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 04:30 (Q18-Q20) @ 16.4Ã¶re/kWh, 0.2h away[0m
[36m2025-10-28 04:15:31.350 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:15:31.350 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-251, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:15:31.350 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 04:15:31.350 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.030 seconds (success: True)[0m
[36m2025-10-28 04:15:31.352 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (5.9 + 1.2 + 12.7)A Ã— 0.95 = 4.51 kW[0m
[36m2025-10-28 04:15:31.352 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 04:20:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 04:20:31.320 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.4Â°C (median of 9 sensors: 23.6Â°C, 21.1Â°C, 21.4Â°C, 23.4Â°C, 26.8Â°C, 24.1Â°C, 22.1Â°C, 23.0Â°C, 25.0Â°C)[0m
[36m2025-10-28 04:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -252.0[0m
[36m2025-10-28 04:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 35.6Â°C[0m
[36m2025-10-28 04:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 29.5Â°C[0m
[36m2025-10-28 04:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=7.9A, L2=1.2A, L3=12.7A[0m
[36m2025-10-28 04:20:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.4Â°C, outdoor 8.2Â°C, flow 29.5Â°C, DM -252[0m
[36m2025-10-28 04:20:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 22 Hz (1h avg: 22, 6h avg: 23, mode: space) - OK: Normal operation (22 Hz, 6h avg: 23 Hz)[0m
[36m2025-10-28 04:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 04:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 04:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 04:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 04:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 04:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 04:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 04:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 04:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 04:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 04:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 78}[0m
[36m2025-10-28 04:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 04:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 04:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 04:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 04:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 04:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 04:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 04:20:31.321 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 04:20:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q17 = 7.01 Ã¶re/kWh[0m
[36m2025-10-28 04:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 04:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 04:20:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 04:20:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 04:20:31.322 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 04:20:31.322 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 04:20:31.323 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 04:20:31.323 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 04:20:31.323 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 04:20:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:20:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 04:20:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:20:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 04:20:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 04:20:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 04:20:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 04:20:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=29.5Â°C, error=-3.1Â°C, sensitivity=1.5 -> offset=-2.1[0m
[36m2025-10-28 04:20:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 04:20:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 29.5Â°C â†’ offset: -2.1Â°C; Weight: 0.20; Deferred: Moderate debt (DM -252)[0m
[36m2025-10-28 04:20:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Price classification Q17 (04:20): 7.01 â†’ CHEAP[0m
[32m2025-10-28 04:20:31.325 INFO (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.70Â°C - Learned pre-heat: Pre-heating: predicted drop 1.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 29.5Â°C â†’ offset: -2.1Â°C; Weight: 0.20; Deferred: Moderate debt (DM -252) | GE-Spot Q17: CHEAP (night) | Too warm: 2.4Â°C over[0m
[32m2025-10-28 04:20:31.325 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.70Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 29.5Â°C â†’ offset: -2.1Â°C; Weight: 0.20; Deferred: Moderate debt (DM -252) | GE-Spot Q17: CHEAP (night) | Too warm: 2.4Â°C over[0m
[36m2025-10-28 04:20:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.70Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-28 04:20:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 7.808 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 04:20:31.325 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.4Â°C, outdoor=8.2Â°C, offset=0.7Â°C, change=0.03Â°C, Î”t=0.08h[0m
[36m2025-10-28 04:20:31.325 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.4Â°C, outdoor=8.2Â°C, offset=0.7Â°C, flow=29.5Â°C, DM=-252[0m
[36m2025-10-28 04:20:31.326 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-28 04:20:31.326 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 04:20:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 04:20:31.327 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 04:20:31.327 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=35.6[0m
[36m2025-10-28 04:20:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:20:31.330 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 04:20:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:20:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 04:20:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:20:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-252, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:20:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 8 quarters available, need 3 quarters (45 min), lookahead 2.0h[0m
[36m2025-10-28 04:20:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 6 windows evaluated[0m
[36m2025-10-28 04:20:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 16.4Ã¶re/kWh at 04:30 (0.2h away) â† SELECTED[0m
[36m2025-10-28 04:20:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 17.6Ã¶re/kWh at 04:45 (0.4h away)[0m
[36m2025-10-28 04:20:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 24.6Ã¶re/kWh at 05:00 (0.7h away)[0m
[36m2025-10-28 04:20:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 39.0Ã¶re/kWh at 05:15 (0.9h away)[0m
[36m2025-10-28 04:20:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 42.5Ã¶re/kWh at 05:30 (1.2h away)[0m
[32m2025-10-28 04:20:31.330 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 04:30 (Q18-Q20) @ 16.4Ã¶re/kWh, 0.2h away[0m
[36m2025-10-28 04:20:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:20:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-252, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:20:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:20:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-252, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:20:31.334 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 04:20:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:20:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 04:20:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:20:31.335 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-252, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:20:31.335 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 8 quarters available, need 3 quarters (45 min), lookahead 2.0h[0m
[36m2025-10-28 04:20:31.335 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 6 windows evaluated[0m
[36m2025-10-28 04:20:31.335 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 16.4Ã¶re/kWh at 04:30 (0.2h away) â† SELECTED[0m
[36m2025-10-28 04:20:31.335 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 17.6Ã¶re/kWh at 04:45 (0.4h away)[0m
[36m2025-10-28 04:20:31.335 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 24.6Ã¶re/kWh at 05:00 (0.7h away)[0m
[36m2025-10-28 04:20:31.335 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 39.0Ã¶re/kWh at 05:15 (0.9h away)[0m
[36m2025-10-28 04:20:31.335 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 42.5Ã¶re/kWh at 05:30 (1.2h away)[0m
[32m2025-10-28 04:20:31.335 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 04:30 (Q18-Q20) @ 16.4Ã¶re/kWh, 0.2h away[0m
[36m2025-10-28 04:20:31.335 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:20:31.335 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-252, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:20:31.335 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:20:31.335 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-252, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:20:31.335 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 04:20:31.335 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.016 seconds (success: True)[0m
[36m2025-10-28 04:20:31.337 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (7.9 + 1.2 + 12.7)A Ã— 0.95 = 4.97 kW[0m
[36m2025-10-28 04:20:31.337 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 04:25:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 04:25:31.320 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.4Â°C (median of 9 sensors: 23.6Â°C, 21.1Â°C, 21.6Â°C, 23.4Â°C, 26.9Â°C, 24.1Â°C, 22.1Â°C, 23.0Â°C, 25.0Â°C)[0m
[36m2025-10-28 04:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -250.0[0m
[36m2025-10-28 04:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 35.6Â°C[0m
[36m2025-10-28 04:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.0Â°C[0m
[36m2025-10-28 04:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=7.8A, L2=1.2A, L3=12.7A[0m
[36m2025-10-28 04:25:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.4Â°C, outdoor 8.2Â°C, flow 30.0Â°C, DM -250[0m
[36m2025-10-28 04:25:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 22 Hz (1h avg: 22, 6h avg: 23, mode: space) - OK: Normal operation (22 Hz, 6h avg: 23 Hz)[0m
[36m2025-10-28 04:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 04:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 04:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 04:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 04:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 04:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 04:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 04:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 04:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 04:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 04:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 78}[0m
[36m2025-10-28 04:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 04:25:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 04:25:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 04:25:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 04:25:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 04:25:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 04:25:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 04:25:31.321 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 04:25:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q17 = 7.01 Ã¶re/kWh[0m
[36m2025-10-28 04:25:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 04:25:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 04:25:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 04:25:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 04:25:31.322 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 04:25:31.322 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 04:25:31.322 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 04:25:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 04:25:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 04:25:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:25:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 04:25:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:25:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 04:25:31.325 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 04:25:31.325 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 04:25:31.325 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 04:25:31.325 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=30.0Â°C, error=-3.6Â°C, sensitivity=1.5 -> offset=-2.4[0m
[36m2025-10-28 04:25:31.325 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 04:25:31.325 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.0Â°C â†’ offset: -2.4Â°C; Weight: 0.20; Deferred: Moderate debt (DM -250)[0m
[36m2025-10-28 04:25:31.326 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Price classification Q17 (04:25): 7.01 â†’ CHEAP[0m
[32m2025-10-28 04:25:31.326 INFO (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.65Â°C - Learned pre-heat: Pre-heating: predicted drop 1.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.0Â°C â†’ offset: -2.4Â°C; Weight: 0.20; Deferred: Moderate debt (DM -250) | GE-Spot Q17: CHEAP (night) | Too warm: 2.4Â°C over[0m
[32m2025-10-28 04:25:31.326 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.65Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.0Â°C â†’ offset: -2.4Â°C; Weight: 0.20; Deferred: Moderate debt (DM -250) | GE-Spot Q17: CHEAP (night) | Too warm: 2.4Â°C over[0m
[36m2025-10-28 04:25:31.326 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.65Â°C, integer=0Â°C, fractional=0.65Â°C, accumulator_before=0.22Â°C[0m
[36m2025-10-28 04:25:31.326 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: 0.87Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-28 04:25:31.327 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.65Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-28 04:25:31.327 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 8.346 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 04:25:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.4Â°C, outdoor=8.2Â°C, offset=0.7Â°C, change=-0.01Â°C, Î”t=0.08h[0m
[36m2025-10-28 04:25:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.4Â°C, outdoor=8.2Â°C, offset=0.7Â°C, flow=30.0Â°C, DM=-250[0m
[36m2025-10-28 04:25:31.334 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.1Â°C/h trend[0m
[36m2025-10-28 04:25:31.334 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 04:25:31.336 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 04:25:31.336 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 04:25:31.336 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=35.6[0m
[36m2025-10-28 04:25:31.336 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:25:31.338 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 04:25:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:25:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 04:25:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:25:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-250, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:25:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 8 quarters available, need 3 quarters (45 min), lookahead 2.0h[0m
[36m2025-10-28 04:25:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 6 windows evaluated[0m
[36m2025-10-28 04:25:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 16.4Ã¶re/kWh at 04:30 (0.1h away) â† SELECTED[0m
[36m2025-10-28 04:25:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 17.6Ã¶re/kWh at 04:45 (0.3h away)[0m
[36m2025-10-28 04:25:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 24.6Ã¶re/kWh at 05:00 (0.6h away)[0m
[36m2025-10-28 04:25:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 39.0Ã¶re/kWh at 05:15 (0.8h away)[0m
[36m2025-10-28 04:25:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 42.5Ã¶re/kWh at 05:30 (1.1h away)[0m
[32m2025-10-28 04:25:31.338 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 04:30 (Q18-Q20) @ 16.4Ã¶re/kWh, 0.1h away[0m
[36m2025-10-28 04:25:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:25:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-250, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:25:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:25:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-250, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:25:31.343 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 04:25:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:25:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 04:25:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:25:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-250, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:25:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 8 quarters available, need 3 quarters (45 min), lookahead 2.0h[0m
[36m2025-10-28 04:25:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 6 windows evaluated[0m
[36m2025-10-28 04:25:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 16.4Ã¶re/kWh at 04:30 (0.1h away) â† SELECTED[0m
[36m2025-10-28 04:25:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 17.6Ã¶re/kWh at 04:45 (0.3h away)[0m
[36m2025-10-28 04:25:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 24.6Ã¶re/kWh at 05:00 (0.6h away)[0m
[36m2025-10-28 04:25:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 39.0Ã¶re/kWh at 05:15 (0.8h away)[0m
[36m2025-10-28 04:25:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 42.5Ã¶re/kWh at 05:30 (1.1h away)[0m
[32m2025-10-28 04:25:31.344 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 04:30 (Q18-Q20) @ 16.4Ã¶re/kWh, 0.1h away[0m
[36m2025-10-28 04:25:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:25:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-250, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:25:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:25:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-250, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:25:31.344 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 04:25:31.344 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.025 seconds (success: True)[0m
[36m2025-10-28 04:25:31.346 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (7.8 + 1.2 + 12.7)A Ã— 0.95 = 4.95 kW[0m
[36m2025-10-28 04:25:31.346 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 04:30:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 04:30:31.320 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.5Â°C (median of 9 sensors: 23.6Â°C, 21.1Â°C, 21.6Â°C, 23.5Â°C, 27.0Â°C, 24.1Â°C, 22.1Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-28 04:30:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -249.0[0m
[36m2025-10-28 04:30:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 35.6Â°C[0m
[36m2025-10-28 04:30:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.0Â°C[0m
[36m2025-10-28 04:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=7.8A, L2=1.2A, L3=12.7A[0m
[36m2025-10-28 04:30:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.5Â°C, outdoor 8.2Â°C, flow 30.0Â°C, DM -249[0m
[36m2025-10-28 04:30:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 20 Hz (1h avg: 21, 6h avg: 23, mode: space) - OK: Normal operation (20 Hz, 6h avg: 23 Hz)[0m
[36m2025-10-28 04:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 04:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 04:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 04:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 04:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 04:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 04:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 04:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 04:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 04:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 04:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 77}[0m
[36m2025-10-28 04:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 04:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 04:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 04:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 04:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 04:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 04:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 04:30:31.323 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 04:30:31.323 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q18 = 13.43 Ã¶re/kWh[0m
[36m2025-10-28 04:30:31.323 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 04:30:31.323 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 04:30:31.324 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 04:30:31.324 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 04:30:31.324 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 04:30:31.324 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 04:30:31.326 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 04:30:31.327 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 04:30:31.327 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 04:30:31.327 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:30:31.327 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 04:30:31.327 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:30:31.327 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 04:30:31.327 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 04:30:31.327 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 04:30:31.328 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 04:30:31.328 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=30.0Â°C, error=-3.6Â°C, sensitivity=1.5 -> offset=-2.4[0m
[36m2025-10-28 04:30:31.328 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 04:30:31.328 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.0Â°C â†’ offset: -2.4Â°C; Weight: 0.20; Deferred: Moderate debt (DM -249)[0m
[36m2025-10-28 04:30:31.328 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Price classification Q18 (04:30): 13.43 â†’ CHEAP[0m
[32m2025-10-28 04:30:31.328 INFO (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.65Â°C - Learned pre-heat: Pre-heating: predicted drop 1.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.0Â°C â†’ offset: -2.4Â°C; Weight: 0.20; Deferred: Moderate debt (DM -249) | GE-Spot Q18: CHEAP (night) | Too warm: 2.5Â°C over[0m
[32m2025-10-28 04:30:31.329 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.65Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.5Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.0Â°C â†’ offset: -2.4Â°C; Weight: 0.20; Deferred: Moderate debt (DM -249) | GE-Spot Q18: CHEAP (night) | Too warm: 2.5Â°C over[0m
[36m2025-10-28 04:30:31.329 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.65Â°C, integer=0Â°C, fractional=0.65Â°C, accumulator_before=0.87Â°C[0m
[32m2025-10-28 04:30:31.329 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] âœ“ Accumulated fractional offset reached threshold: applying +1Â°C adjustment (accumulator: 1.52Â°C â†’ 0.52Â°C)[0m
[36m2025-10-28 04:30:31.329 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Accumulator triggered: total_accumulated=1.52Â°C, adjustment=+1Â°C, new_integer=1Â°C, remaining=0.52Â°C[0m
[36m2025-10-28 04:30:31.329 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset 0.65Â°C â†’ applying 1Â°C (accumulator: 0.52Â°C, needs 0.48Â°C more to trigger)[0m
[32m2025-10-28 04:30:31.331 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to 1Â°C (calculated: 0.65Â°C, accumulator: 0.52Â°C)[0m
[36m2025-10-28 04:30:31.331 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=1Â°C, original=0.65Â°C, accumulator=0.52Â°C[0m
[32m2025-10-28 04:30:31.331 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset 0.65Â°C to NIBE via MyUplink[0m
[36m2025-10-28 04:30:31.331 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 7.834 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 04:30:31.331 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.5Â°C, outdoor=8.2Â°C, offset=0.7Â°C, change=0.07Â°C, Î”t=0.08h[0m
[36m2025-10-28 04:30:31.331 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.5Â°C, outdoor=8.2Â°C, offset=0.7Â°C, flow=30.0Â°C, DM=-249[0m
[36m2025-10-28 04:30:31.337 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.2Â°C/h trend[0m
[36m2025-10-28 04:30:31.337 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 04:30:31.343 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved learned data to storage[0m
[36m2025-10-28 04:30:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 04:30:31.343 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 04:30:31.343 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=35.6[0m
[36m2025-10-28 04:30:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:30:31.349 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 04:30:31.349 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:30:31.349 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 04:30:31.349 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:30:31.349 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-249, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:30:31.349 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 8 quarters available, need 3 quarters (45 min), lookahead 2.0h[0m
[36m2025-10-28 04:30:31.349 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 6 windows evaluated[0m
[36m2025-10-28 04:30:31.349 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 17.6Ã¶re/kWh at 04:45 (0.2h away) â† SELECTED[0m
[36m2025-10-28 04:30:31.349 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 24.6Ã¶re/kWh at 05:00 (0.5h away)[0m
[36m2025-10-28 04:30:31.350 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 39.0Ã¶re/kWh at 05:15 (0.7h away)[0m
[36m2025-10-28 04:30:31.350 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 42.5Ã¶re/kWh at 05:30 (1.0h away)[0m
[36m2025-10-28 04:30:31.350 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 48.3Ã¶re/kWh at 05:45 (1.2h away)[0m
[32m2025-10-28 04:30:31.350 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 04:45 (Q19-Q21) @ 17.6Ã¶re/kWh, 0.2h away[0m
[36m2025-10-28 04:30:31.350 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:30:31.350 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-249, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:30:31.353 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-27 19:24:48.410072+00:00[0m
[36m2025-10-28 04:30:31.353 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:30:31.353 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 04:30:31.353 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:30:31.354 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-249, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:30:31.354 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 8 quarters available, need 3 quarters (45 min), lookahead 2.0h[0m
[36m2025-10-28 04:30:31.354 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 6 windows evaluated[0m
[36m2025-10-28 04:30:31.354 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 17.6Ã¶re/kWh at 04:45 (0.2h away) â† SELECTED[0m
[36m2025-10-28 04:30:31.354 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 24.6Ã¶re/kWh at 05:00 (0.5h away)[0m
[36m2025-10-28 04:30:31.354 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 39.0Ã¶re/kWh at 05:15 (0.7h away)[0m
[36m2025-10-28 04:30:31.354 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 42.5Ã¶re/kWh at 05:30 (1.0h away)[0m
[36m2025-10-28 04:30:31.354 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 48.3Ã¶re/kWh at 05:45 (1.2h away)[0m
[32m2025-10-28 04:30:31.354 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 04:45 (Q19-Q21) @ 17.6Ã¶re/kWh, 0.2h away[0m
[36m2025-10-28 04:30:31.354 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:30:31.354 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-249, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:30:31.354 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 04:30:31.354 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.034 seconds (success: True)[0m
[36m2025-10-28 04:30:31.356 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (7.8 + 1.2 + 12.7)A Ã— 0.95 = 4.95 kW[0m
[36m2025-10-28 04:30:31.356 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 04:35:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 04:35:31.320 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.5Â°C (median of 9 sensors: 23.6Â°C, 21.0Â°C, 21.6Â°C, 23.5Â°C, 27.1Â°C, 24.1Â°C, 22.1Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-28 04:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -247.0[0m
[36m2025-10-28 04:35:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 35.6Â°C[0m
[36m2025-10-28 04:35:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 27.8Â°C[0m
[36m2025-10-28 04:35:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=11.4A, L2=1.2A, L3=12.7A[0m
[36m2025-10-28 04:35:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.5Â°C, outdoor 8.2Â°C, flow 27.8Â°C, DM -247[0m
[36m2025-10-28 04:35:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 70 Hz (1h avg: 25, 6h avg: 25, mode: space) - OK: Normal operation (70 Hz, 6h avg: 25 Hz)[0m
[36m2025-10-28 04:35:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 04:35:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 04:35:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 04:35:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 04:35:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 04:35:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 04:35:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 04:35:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 04:35:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 04:35:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 04:35:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 77}[0m
[36m2025-10-28 04:35:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 04:35:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 04:35:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 04:35:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 04:35:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 04:35:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 04:35:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 04:35:31.322 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 04:35:31.322 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q18 = 13.43 Ã¶re/kWh[0m
[36m2025-10-28 04:35:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 04:35:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 04:35:31.323 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 04:35:31.323 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 04:35:31.323 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 04:35:31.323 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 04:35:31.323 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 04:35:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 04:35:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 04:35:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:35:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 04:35:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:35:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 04:35:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 04:35:31.325 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 04:35:31.325 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 04:35:31.325 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=27.8Â°C, error=-1.4Â°C, sensitivity=1.5 -> offset=-0.9[0m
[36m2025-10-28 04:35:31.325 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 04:35:31.325 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 27.8Â°C â†’ offset: -0.9Â°C; Weight: 0.20; Deferred: Moderate debt (DM -247)[0m
[36m2025-10-28 04:35:31.325 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Price classification Q18 (04:35): 13.43 â†’ CHEAP[0m
[32m2025-10-28 04:35:31.325 INFO (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.74Â°C - Learned pre-heat: Pre-heating: predicted drop 1.4Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 27.8Â°C â†’ offset: -0.9Â°C; Weight: 0.20; Deferred: Moderate debt (DM -247) | GE-Spot Q18: CHEAP (night) | Too warm: 2.5Â°C over[0m
[32m2025-10-28 04:35:31.325 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.74Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.4Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 27.8Â°C â†’ offset: -0.9Â°C; Weight: 0.20; Deferred: Moderate debt (DM -247) | GE-Spot Q18: CHEAP (night) | Too warm: 2.5Â°C over[0m
[36m2025-10-28 04:35:31.326 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Skipping offset write, too soon since last write[0m
[36m2025-10-28 04:35:31.326 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.74Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-28 04:35:31.326 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 9.224 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 04:35:31.326 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.5Â°C, outdoor=8.2Â°C, offset=0.7Â°C, change=-0.03Â°C, Î”t=0.08h[0m
[36m2025-10-28 04:35:31.326 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.5Â°C, outdoor=8.2Â°C, offset=0.7Â°C, flow=27.8Â°C, DM=-247[0m
[36m2025-10-28 04:35:31.326 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-28 04:35:31.326 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 04:35:31.331 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 04:35:31.331 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 04:35:31.331 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=35.6[0m
[36m2025-10-28 04:35:31.331 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:35:31.331 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW temp lux currently ON, last_changed: 2025-10-28 03:33:05.210144+00:00[0m
[36m2025-10-28 04:35:31.331 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:35:31.331 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 04:35:31.331 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:35:31.331 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-247, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:35:31.331 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 8 quarters available, need 3 quarters (45 min), lookahead 2.0h[0m
[36m2025-10-28 04:35:31.331 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 6 windows evaluated[0m
[36m2025-10-28 04:35:31.331 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 17.6Ã¶re/kWh at 04:45 (0.2h away) â† SELECTED[0m
[36m2025-10-28 04:35:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 24.6Ã¶re/kWh at 05:00 (0.4h away)[0m
[36m2025-10-28 04:35:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 39.0Ã¶re/kWh at 05:15 (0.7h away)[0m
[36m2025-10-28 04:35:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 42.5Ã¶re/kWh at 05:30 (0.9h away)[0m
[36m2025-10-28 04:35:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 48.3Ã¶re/kWh at 05:45 (1.2h away)[0m
[32m2025-10-28 04:35:31.332 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 04:45 (Q19-Q21) @ 17.6Ã¶re/kWh, 0.2h away[0m
[36m2025-10-28 04:35:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:35:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-247, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:35:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:35:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-247, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:35:31.332 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW temp lux currently ON, last_changed: 2025-10-28 03:33:05.210144+00:00[0m
[36m2025-10-28 04:35:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:35:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 04:35:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:35:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-247, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:35:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 8 quarters available, need 3 quarters (45 min), lookahead 2.0h[0m
[36m2025-10-28 04:35:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 6 windows evaluated[0m
[36m2025-10-28 04:35:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 17.6Ã¶re/kWh at 04:45 (0.2h away) â† SELECTED[0m
[36m2025-10-28 04:35:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 24.6Ã¶re/kWh at 05:00 (0.4h away)[0m
[36m2025-10-28 04:35:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 39.0Ã¶re/kWh at 05:15 (0.7h away)[0m
[36m2025-10-28 04:35:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 42.5Ã¶re/kWh at 05:30 (0.9h away)[0m
[36m2025-10-28 04:35:31.333 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 48.3Ã¶re/kWh at 05:45 (1.2h away)[0m
[32m2025-10-28 04:35:31.333 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 04:45 (Q19-Q21) @ 17.6Ã¶re/kWh, 0.2h away[0m
[36m2025-10-28 04:35:31.333 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:35:31.333 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-247, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:35:31.333 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:35:31.333 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-247, warning=-316, threshold=-158, has_capacity=False[0m
[32m2025-10-28 04:35:31.333 INFO (MainThread) [custom_components.effektguard.coordinator] DHW control: Deactivating temporary lux - DHW_ADEQUATE (DHW: 35.6Â°C, DM: -247)[0m
[36m2025-10-28 04:35:31.335 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.015 seconds (success: True)[0m
[36m2025-10-28 04:35:31.338 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (11.4 + 1.2 + 12.7)A Ã— 0.95 = 5.77 kW[0m
[36m2025-10-28 04:35:31.338 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 04:40:31.319 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 04:40:31.319 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.4Â°C (median of 9 sensors: 23.6Â°C, 21.0Â°C, 21.6Â°C, 23.4Â°C, 27.2Â°C, 24.1Â°C, 22.1Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-28 04:40:31.319 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -246.0[0m
[36m2025-10-28 04:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 35.6Â°C[0m
[36m2025-10-28 04:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 29.8Â°C[0m
[36m2025-10-28 04:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=6.6A, L2=1.2A, L3=12.7A[0m
[36m2025-10-28 04:40:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.4Â°C, outdoor 8.2Â°C, flow 29.8Â°C, DM -246[0m
[36m2025-10-28 04:40:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 20 Hz (1h avg: 25, 6h avg: 25, mode: space) - OK: Normal operation (20 Hz, 6h avg: 25 Hz)[0m
[36m2025-10-28 04:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 04:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 04:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 04:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 04:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 04:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 04:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 04:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 04:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 04:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 04:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 77}[0m
[36m2025-10-28 04:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 04:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 04:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 04:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 04:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 04:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 04:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 04:40:31.321 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 04:40:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q18 = 13.43 Ã¶re/kWh[0m
[36m2025-10-28 04:40:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 04:40:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 04:40:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 04:40:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 04:40:31.322 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 04:40:31.322 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 04:40:31.322 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 04:40:31.323 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 04:40:31.323 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 04:40:31.323 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:40:31.323 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 04:40:31.323 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:40:31.323 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 04:40:31.324 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 04:40:31.324 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 04:40:31.324 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 04:40:31.324 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=29.8Â°C, error=-3.4Â°C, sensitivity=1.5 -> offset=-2.3[0m
[36m2025-10-28 04:40:31.324 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 04:40:31.324 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 29.8Â°C â†’ offset: -2.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -246)[0m
[36m2025-10-28 04:40:31.324 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Price classification Q18 (04:40): 13.43 â†’ CHEAP[0m
[32m2025-10-28 04:40:31.324 INFO (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.63Â°C - Learned pre-heat: Pre-heating: predicted drop 1.4Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 29.8Â°C â†’ offset: -2.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -246) | GE-Spot Q18: CHEAP (night) | Too warm: 2.4Â°C over[0m
[32m2025-10-28 04:40:31.325 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.63Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.4Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 29.8Â°C â†’ offset: -2.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -246) | GE-Spot Q18: CHEAP (night) | Too warm: 2.4Â°C over[0m
[36m2025-10-28 04:40:31.325 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.63Â°C, integer=0Â°C, fractional=0.63Â°C, accumulator_before=0.52Â°C[0m
[32m2025-10-28 04:40:31.325 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] âœ“ Accumulated fractional offset reached threshold: applying +1Â°C adjustment (accumulator: 1.15Â°C â†’ 0.15Â°C)[0m
[36m2025-10-28 04:40:31.325 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Accumulator triggered: total_accumulated=1.15Â°C, adjustment=+1Â°C, new_integer=1Â°C, remaining=0.15Â°C[0m
[36m2025-10-28 04:40:31.325 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset 0.63Â°C â†’ applying 1Â°C (accumulator: 0.15Â°C, needs 0.85Â°C more to trigger)[0m
[32m2025-10-28 04:40:31.326 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to 1Â°C (calculated: 0.63Â°C, accumulator: 0.15Â°C)[0m
[36m2025-10-28 04:40:31.326 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=1Â°C, original=0.63Â°C, accumulator=0.15Â°C[0m
[32m2025-10-28 04:40:31.327 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset 0.63Â°C to NIBE via MyUplink[0m
[36m2025-10-28 04:40:31.327 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 7.713 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 04:40:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.4Â°C, outdoor=8.2Â°C, offset=0.6Â°C, change=-0.04Â°C, Î”t=0.08h[0m
[36m2025-10-28 04:40:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.4Â°C, outdoor=8.2Â°C, offset=0.6Â°C, flow=29.8Â°C, DM=-246[0m
[36m2025-10-28 04:40:31.334 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.2Â°C/h trend[0m
[36m2025-10-28 04:40:31.334 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 04:40:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 04:40:31.339 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 04:40:31.339 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=35.6[0m
[36m2025-10-28 04:40:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:40:31.341 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 03:33:05.210144+00:00[0m
[36m2025-10-28 04:40:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:40:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 04:40:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:40:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-246, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:40:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 8 quarters available, need 3 quarters (45 min), lookahead 2.0h[0m
[36m2025-10-28 04:40:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 6 windows evaluated[0m
[36m2025-10-28 04:40:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 17.6Ã¶re/kWh at 04:45 (0.1h away) â† SELECTED[0m
[36m2025-10-28 04:40:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 24.6Ã¶re/kWh at 05:00 (0.3h away)[0m
[36m2025-10-28 04:40:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 39.0Ã¶re/kWh at 05:15 (0.6h away)[0m
[36m2025-10-28 04:40:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 42.5Ã¶re/kWh at 05:30 (0.8h away)[0m
[36m2025-10-28 04:40:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 48.3Ã¶re/kWh at 05:45 (1.1h away)[0m
[32m2025-10-28 04:40:31.342 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 04:45 (Q19-Q21) @ 17.6Ã¶re/kWh, 0.1h away[0m
[36m2025-10-28 04:40:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:40:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-246, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:40:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:40:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-246, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:40:31.345 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 03:33:05.210144+00:00[0m
[36m2025-10-28 04:40:31.345 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:40:31.345 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 04:40:31.345 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:40:31.345 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-246, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:40:31.345 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 8 quarters available, need 3 quarters (45 min), lookahead 2.0h[0m
[36m2025-10-28 04:40:31.345 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 6 windows evaluated[0m
[36m2025-10-28 04:40:31.345 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 17.6Ã¶re/kWh at 04:45 (0.1h away) â† SELECTED[0m
[36m2025-10-28 04:40:31.346 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 24.6Ã¶re/kWh at 05:00 (0.3h away)[0m
[36m2025-10-28 04:40:31.346 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 39.0Ã¶re/kWh at 05:15 (0.6h away)[0m
[36m2025-10-28 04:40:31.346 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 42.5Ã¶re/kWh at 05:30 (0.8h away)[0m
[36m2025-10-28 04:40:31.346 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 48.3Ã¶re/kWh at 05:45 (1.1h away)[0m
[32m2025-10-28 04:40:31.346 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 04:45 (Q19-Q21) @ 17.6Ã¶re/kWh, 0.1h away[0m
[36m2025-10-28 04:40:31.346 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:40:31.346 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-246, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:40:31.346 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:40:31.346 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-246, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:40:31.346 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control rate limited: 5.0 min since last change (min 60 min)[0m
[36m2025-10-28 04:40:31.346 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.027 seconds (success: True)[0m
[36m2025-10-28 04:40:31.347 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (6.6 + 1.2 + 12.7)A Ã— 0.95 = 4.67 kW[0m
[36m2025-10-28 04:40:31.348 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[33m2025-10-28 04:45:01.307 WARNING (MainThread) [pysignalr.client] No client method with the name 'CommandResponse' found.[0m
[36m2025-10-28 04:45:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 04:45:31.320 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.5Â°C (median of 9 sensors: 23.6Â°C, 21.0Â°C, 21.6Â°C, 23.5Â°C, 27.3Â°C, 24.1Â°C, 22.1Â°C, 22.9Â°C, 26.0Â°C)[0m
[36m2025-10-28 04:45:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -248.0[0m
[36m2025-10-28 04:45:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 35.6Â°C[0m
[36m2025-10-28 04:45:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 29.3Â°C[0m
[36m2025-10-28 04:45:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=6.6A, L2=1.2A, L3=12.7A[0m
[36m2025-10-28 04:45:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.5Â°C, outdoor 8.2Â°C, flow 29.3Â°C, DM -248[0m
[36m2025-10-28 04:45:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 20 Hz (1h avg: 25, 6h avg: 24, mode: space) - OK: Normal operation (20 Hz, 6h avg: 24 Hz)[0m
[36m2025-10-28 04:45:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 04:45:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 04:45:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 04:45:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 04:45:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 04:45:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 04:45:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 04:45:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 04:45:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 04:45:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 04:45:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 76}[0m
[36m2025-10-28 04:45:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 04:45:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 04:45:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 04:45:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 04:45:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 04:45:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 04:45:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 04:45:31.322 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 04:45:31.322 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q19 = 22.15 Ã¶re/kWh[0m
[36m2025-10-28 04:45:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 04:45:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 04:45:31.323 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 04:45:31.323 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 04:45:31.323 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 04:45:31.323 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 04:45:31.324 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 04:45:31.325 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 04:45:31.325 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 04:45:31.325 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:45:31.326 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 04:45:31.326 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:45:31.326 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 04:45:31.326 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 04:45:31.326 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 04:45:31.326 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 04:45:31.326 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=29.3Â°C, error=-2.9Â°C, sensitivity=1.5 -> offset=-1.9[0m
[36m2025-10-28 04:45:31.326 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 04:45:31.326 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 29.3Â°C â†’ offset: -1.9Â°C; Weight: 0.20; Deferred: Moderate debt (DM -248)[0m
[36m2025-10-28 04:45:31.326 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Price classification Q19 (04:45): 22.15 â†’ CHEAP[0m
[32m2025-10-28 04:45:31.326 INFO (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.67Â°C - Learned pre-heat: Pre-heating: predicted drop 1.4Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 29.3Â°C â†’ offset: -1.9Â°C; Weight: 0.20; Deferred: Moderate debt (DM -248) | GE-Spot Q19: CHEAP (night) | Too warm: 2.5Â°C over[0m
[32m2025-10-28 04:45:31.327 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.67Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.4Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 29.3Â°C â†’ offset: -1.9Â°C; Weight: 0.20; Deferred: Moderate debt (DM -248) | GE-Spot Q19: CHEAP (night) | Too warm: 2.5Â°C over[0m
[36m2025-10-28 04:45:31.327 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.67Â°C, integer=0Â°C, fractional=0.67Â°C, accumulator_before=0.15Â°C[0m
[36m2025-10-28 04:45:31.327 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: 0.82Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-28 04:45:31.327 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.67Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-28 04:45:31.327 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.462 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 04:45:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.5Â°C, outdoor=8.2Â°C, offset=0.7Â°C, change=0.08Â°C, Î”t=0.08h[0m
[36m2025-10-28 04:45:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.5Â°C, outdoor=8.2Â°C, offset=0.7Â°C, flow=29.3Â°C, DM=-248[0m
[36m2025-10-28 04:45:31.327 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-28 04:45:31.327 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 04:45:31.329 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 04:45:31.330 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 04:45:31.330 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=35.6[0m
[36m2025-10-28 04:45:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:45:31.331 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 03:33:05.210144+00:00[0m
[36m2025-10-28 04:45:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:45:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 04:45:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:45:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-248, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:45:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 8 quarters available, need 3 quarters (45 min), lookahead 2.0h[0m
[36m2025-10-28 04:45:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 6 windows evaluated[0m
[36m2025-10-28 04:45:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 24.6Ã¶re/kWh at 05:00 (0.2h away) â† SELECTED[0m
[36m2025-10-28 04:45:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 39.0Ã¶re/kWh at 05:15 (0.5h away)[0m
[36m2025-10-28 04:45:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 42.5Ã¶re/kWh at 05:30 (0.7h away)[0m
[36m2025-10-28 04:45:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 48.3Ã¶re/kWh at 05:45 (1.0h away)[0m
[36m2025-10-28 04:45:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 56.5Ã¶re/kWh at 06:00 (1.2h away)[0m
[32m2025-10-28 04:45:31.332 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 05:00 (Q20-Q22) @ 24.6Ã¶re/kWh, 0.2h away[0m
[36m2025-10-28 04:45:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:45:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-248, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:45:31.334 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 03:33:05.210144+00:00[0m
[36m2025-10-28 04:45:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:45:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 04:45:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:45:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-248, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:45:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 8 quarters available, need 3 quarters (45 min), lookahead 2.0h[0m
[36m2025-10-28 04:45:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 6 windows evaluated[0m
[36m2025-10-28 04:45:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 24.6Ã¶re/kWh at 05:00 (0.2h away) â† SELECTED[0m
[36m2025-10-28 04:45:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 39.0Ã¶re/kWh at 05:15 (0.5h away)[0m
[36m2025-10-28 04:45:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 42.5Ã¶re/kWh at 05:30 (0.7h away)[0m
[36m2025-10-28 04:45:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 48.3Ã¶re/kWh at 05:45 (1.0h away)[0m
[36m2025-10-28 04:45:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 56.5Ã¶re/kWh at 06:00 (1.2h away)[0m
[32m2025-10-28 04:45:31.334 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 05:00 (Q20-Q22) @ 24.6Ã¶re/kWh, 0.2h away[0m
[36m2025-10-28 04:45:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:45:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-248, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:45:31.334 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control rate limited: 10.0 min since last change (min 60 min)[0m
[36m2025-10-28 04:45:31.335 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.014 seconds (success: True)[0m
[36m2025-10-28 04:45:31.336 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (6.6 + 1.2 + 12.7)A Ã— 0.95 = 4.67 kW[0m
[36m2025-10-28 04:45:31.337 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 04:50:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 04:50:31.320 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.5Â°C (median of 9 sensors: 23.6Â°C, 21.0Â°C, 21.6Â°C, 23.5Â°C, 27.3Â°C, 24.1Â°C, 22.1Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-28 04:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -249.0[0m
[36m2025-10-28 04:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 35.1Â°C[0m
[36m2025-10-28 04:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 29.3Â°C[0m
[36m2025-10-28 04:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=6.6A, L2=8.4A, L3=0.6A[0m
[36m2025-10-28 04:50:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.5Â°C, outdoor 8.2Â°C, flow 29.3Â°C, DM -249[0m
[36m2025-10-28 04:50:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 21 Hz (1h avg: 24, 6h avg: 24, mode: space) - OK: Normal operation (21 Hz, 6h avg: 24 Hz)[0m
[36m2025-10-28 04:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 04:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 04:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 04:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 04:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 04:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 04:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 04:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 04:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 04:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 04:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 76}[0m
[36m2025-10-28 04:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 04:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 04:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 04:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 04:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 04:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 04:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 04:50:31.321 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 04:50:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q19 = 22.15 Ã¶re/kWh[0m
[36m2025-10-28 04:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 04:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 04:50:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 04:50:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 04:50:31.322 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 04:50:31.322 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 04:50:31.322 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 04:50:31.323 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 04:50:31.323 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 04:50:31.323 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:50:31.323 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 04:50:31.323 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:50:31.323 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 04:50:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 04:50:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 04:50:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 04:50:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=29.3Â°C, error=-2.9Â°C, sensitivity=1.5 -> offset=-1.9[0m
[36m2025-10-28 04:50:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 04:50:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 29.3Â°C â†’ offset: -1.9Â°C; Weight: 0.20; Deferred: Moderate debt (DM -249)[0m
[36m2025-10-28 04:50:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Price classification Q19 (04:50): 22.15 â†’ CHEAP[0m
[32m2025-10-28 04:50:31.324 INFO (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.64Â°C - Learned pre-heat: Pre-heating: predicted drop 1.4Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 29.3Â°C â†’ offset: -1.9Â°C; Weight: 0.20; Deferred: Moderate debt (DM -249) | GE-Spot Q19: CHEAP (night) | Too warm: 2.5Â°C over[0m
[32m2025-10-28 04:50:31.326 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.64Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.4Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 29.3Â°C â†’ offset: -1.9Â°C; Weight: 0.20; Deferred: Moderate debt (DM -249) | GE-Spot Q19: CHEAP (night) | Too warm: 2.5Â°C over[0m
[36m2025-10-28 04:50:31.326 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset 0.64Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-28 04:50:31.326 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 3.530 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 04:50:31.326 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.5Â°C, outdoor=8.2Â°C, offset=0.6Â°C, change=-0.04Â°C, Î”t=0.08h[0m
[36m2025-10-28 04:50:31.326 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.5Â°C, outdoor=8.2Â°C, offset=0.6Â°C, flow=29.3Â°C, DM=-249[0m
[36m2025-10-28 04:50:31.333 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.1Â°C/h trend[0m
[36m2025-10-28 04:50:31.333 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 04:50:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 04:50:31.334 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 04:50:31.334 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=35.1[0m
[36m2025-10-28 04:50:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:50:31.339 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 03:33:05.210144+00:00[0m
[36m2025-10-28 04:50:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:50:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 04:50:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:50:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-249, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:50:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 8 quarters available, need 3 quarters (45 min), lookahead 2.0h[0m
[36m2025-10-28 04:50:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 6 windows evaluated[0m
[36m2025-10-28 04:50:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 24.6Ã¶re/kWh at 05:00 (0.2h away) â† SELECTED[0m
[36m2025-10-28 04:50:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 39.0Ã¶re/kWh at 05:15 (0.4h away)[0m
[36m2025-10-28 04:50:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 42.5Ã¶re/kWh at 05:30 (0.7h away)[0m
[36m2025-10-28 04:50:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 48.3Ã¶re/kWh at 05:45 (0.9h away)[0m
[36m2025-10-28 04:50:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 56.5Ã¶re/kWh at 06:00 (1.2h away)[0m
[32m2025-10-28 04:50:31.340 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 05:00 (Q20-Q22) @ 24.6Ã¶re/kWh, 0.2h away[0m
[36m2025-10-28 04:50:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:50:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-249, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:50:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:50:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-249, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:50:31.344 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 03:33:05.210144+00:00[0m
[36m2025-10-28 04:50:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:50:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 04:50:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:50:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-249, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:50:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 8 quarters available, need 3 quarters (45 min), lookahead 2.0h[0m
[36m2025-10-28 04:50:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 6 windows evaluated[0m
[36m2025-10-28 04:50:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 24.6Ã¶re/kWh at 05:00 (0.2h away) â† SELECTED[0m
[36m2025-10-28 04:50:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 39.0Ã¶re/kWh at 05:15 (0.4h away)[0m
[36m2025-10-28 04:50:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 42.5Ã¶re/kWh at 05:30 (0.7h away)[0m
[36m2025-10-28 04:50:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 48.3Ã¶re/kWh at 05:45 (0.9h away)[0m
[36m2025-10-28 04:50:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 56.5Ã¶re/kWh at 06:00 (1.2h away)[0m
[32m2025-10-28 04:50:31.345 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 05:00 (Q20-Q22) @ 24.6Ã¶re/kWh, 0.2h away[0m
[36m2025-10-28 04:50:31.345 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:50:31.345 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-249, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:50:31.345 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:50:31.345 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-249, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:50:31.345 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control rate limited: 15.0 min since last change (min 60 min)[0m
[36m2025-10-28 04:50:31.345 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.025 seconds (success: True)[0m
[36m2025-10-28 04:50:31.346 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (6.6 + 8.4 + 0.6)A Ã— 0.95 = 3.56 kW[0m
[36m2025-10-28 04:50:31.347 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[36m2025-10-28 04:55:31.319 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 04:55:31.320 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.5Â°C (median of 9 sensors: 23.6Â°C, 21.0Â°C, 21.6Â°C, 23.5Â°C, 27.3Â°C, 24.1Â°C, 22.1Â°C, 23.0Â°C, 26.0Â°C)[0m
[36m2025-10-28 04:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -249.0[0m
[36m2025-10-28 04:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 35.1Â°C[0m
[36m2025-10-28 04:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 29.3Â°C[0m
[36m2025-10-28 04:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=6.6A, L2=8.4A, L3=0.6A[0m
[36m2025-10-28 04:55:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.5Â°C, outdoor 8.2Â°C, flow 29.3Â°C, DM -249[0m
[36m2025-10-28 04:55:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 21 Hz (1h avg: 25, 6h avg: 24, mode: space) - OK: Normal operation (21 Hz, 6h avg: 24 Hz)[0m
[36m2025-10-28 04:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 04:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 04:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 04:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 04:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 04:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 04:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 04:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 04:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 04:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 04:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 76}[0m
[36m2025-10-28 04:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 04:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 04:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 04:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 04:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 04:55:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 04:55:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 04:55:31.321 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 04:55:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q19 = 22.15 Ã¶re/kWh[0m
[36m2025-10-28 04:55:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 04:55:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 04:55:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 04:55:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 04:55:31.322 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 04:55:31.322 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 04:55:31.322 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 04:55:31.323 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 04:55:31.323 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 04:55:31.323 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:55:31.323 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 04:55:31.323 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:55:31.323 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 04:55:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 04:55:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 04:55:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 04:55:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=29.3Â°C, error=-2.9Â°C, sensitivity=1.5 -> offset=-1.9[0m
[36m2025-10-28 04:55:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 04:55:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 29.3Â°C â†’ offset: -1.9Â°C; Weight: 0.20; Deferred: Moderate debt (DM -249)[0m
[36m2025-10-28 04:55:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Price classification Q19 (04:55): 22.15 â†’ CHEAP[0m
[32m2025-10-28 04:55:31.324 INFO (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.65Â°C - Learned pre-heat: Pre-heating: predicted drop 1.4Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 29.3Â°C â†’ offset: -1.9Â°C; Weight: 0.20; Deferred: Moderate debt (DM -249) | GE-Spot Q19: CHEAP (night) | Too warm: 2.5Â°C over[0m
[32m2025-10-28 04:55:31.324 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.65Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.4Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 29.3Â°C â†’ offset: -1.9Â°C; Weight: 0.20; Deferred: Moderate debt (DM -249) | GE-Spot Q19: CHEAP (night) | Too warm: 2.5Â°C over[0m
[36m2025-10-28 04:55:31.325 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.65Â°C, integer=0Â°C, fractional=0.65Â°C, accumulator_before=0.82Â°C[0m
[32m2025-10-28 04:55:31.325 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] âœ“ Accumulated fractional offset reached threshold: applying +1Â°C adjustment (accumulator: 1.48Â°C â†’ 0.48Â°C)[0m
[36m2025-10-28 04:55:31.325 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Accumulator triggered: total_accumulated=1.48Â°C, adjustment=+1Â°C, new_integer=1Â°C, remaining=0.48Â°C[0m
[36m2025-10-28 04:55:31.325 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset 0.65Â°C â†’ applying 1Â°C (accumulator: 0.48Â°C, needs 0.52Â°C more to trigger)[0m
[32m2025-10-28 04:55:31.327 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to 1Â°C (calculated: 0.65Â°C, accumulator: 0.48Â°C)[0m
[36m2025-10-28 04:55:31.327 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=1Â°C, original=0.65Â°C, accumulator=0.48Â°C[0m
[32m2025-10-28 04:55:31.327 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset 0.65Â°C to NIBE via MyUplink[0m
[36m2025-10-28 04:55:31.327 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 3.446 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 04:55:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.5Â°C, outdoor=8.2Â°C, offset=0.7Â°C, change=0.01Â°C, Î”t=0.08h[0m
[36m2025-10-28 04:55:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.5Â°C, outdoor=8.2Â°C, offset=0.7Â°C, flow=29.3Â°C, DM=-249[0m
[36m2025-10-28 04:55:31.333 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.1Â°C/h trend[0m
[36m2025-10-28 04:55:31.333 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 04:55:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 04:55:31.337 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 04:55:31.337 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=35.1[0m
[36m2025-10-28 04:55:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:55:31.339 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 03:33:05.210144+00:00[0m
[36m2025-10-28 04:55:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:55:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 04:55:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:55:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-249, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:55:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 8 quarters available, need 3 quarters (45 min), lookahead 2.0h[0m
[36m2025-10-28 04:55:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 6 windows evaluated[0m
[36m2025-10-28 04:55:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 24.6Ã¶re/kWh at 05:00 (0.1h away) â† SELECTED[0m
[36m2025-10-28 04:55:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 39.0Ã¶re/kWh at 05:15 (0.3h away)[0m
[36m2025-10-28 04:55:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 42.5Ã¶re/kWh at 05:30 (0.6h away)[0m
[36m2025-10-28 04:55:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 48.3Ã¶re/kWh at 05:45 (0.8h away)[0m
[36m2025-10-28 04:55:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 56.5Ã¶re/kWh at 06:00 (1.1h away)[0m
[32m2025-10-28 04:55:31.340 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 05:00 (Q20-Q22) @ 24.6Ã¶re/kWh, 0.1h away[0m
[36m2025-10-28 04:55:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:55:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-249, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:55:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:55:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-249, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:55:31.343 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 03:33:05.210144+00:00[0m
[36m2025-10-28 04:55:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:55:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 04:55:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:55:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-249, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:55:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 8 quarters available, need 3 quarters (45 min), lookahead 2.0h[0m
[36m2025-10-28 04:55:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 6 windows evaluated[0m
[36m2025-10-28 04:55:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 24.6Ã¶re/kWh at 05:00 (0.1h away) â† SELECTED[0m
[36m2025-10-28 04:55:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 39.0Ã¶re/kWh at 05:15 (0.3h away)[0m
[36m2025-10-28 04:55:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #3: 42.5Ã¶re/kWh at 05:30 (0.6h away)[0m
[36m2025-10-28 04:55:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #4: 48.3Ã¶re/kWh at 05:45 (0.8h away)[0m
[36m2025-10-28 04:55:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #5: 56.5Ã¶re/kWh at 06:00 (1.1h away)[0m
[32m2025-10-28 04:55:31.343 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 05:00 (Q20-Q22) @ 24.6Ã¶re/kWh, 0.1h away[0m
[36m2025-10-28 04:55:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:55:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-249, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:55:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 04:55:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-249, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 04:55:31.344 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control rate limited: 20.0 min since last change (min 60 min)[0m
[36m2025-10-28 04:55:31.344 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.025 seconds (success: True)[0m
[36m2025-10-28 04:55:31.345 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (6.6 + 8.4 + 0.6)A Ã— 0.95 = 3.56 kW[0m
[36m2025-10-28 04:55:31.345 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[33m2025-10-28 05:00:11.898 WARNING (MainThread) [pysignalr.client] No client method with the name 'CommandResponse' found.[0m
[36m2025-10-28 05:00:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 05:00:31.320 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.5Â°C (median of 9 sensors: 23.6Â°C, 21.0Â°C, 21.6Â°C, 23.5Â°C, 27.3Â°C, 24.1Â°C, 22.1Â°C, 23.1Â°C, 26.0Â°C)[0m
[36m2025-10-28 05:00:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -250.0[0m
[36m2025-10-28 05:00:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 35.1Â°C[0m
[36m2025-10-28 05:00:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 29.3Â°C[0m
[36m2025-10-28 05:00:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=5.2A, L2=8.4A, L3=0.6A[0m
[36m2025-10-28 05:00:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.5Â°C, outdoor 8.2Â°C, flow 29.3Â°C, DM -250[0m
[36m2025-10-28 05:00:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 22 Hz (1h avg: 25, 6h avg: 24, mode: space) - OK: Normal operation (22 Hz, 6h avg: 24 Hz)[0m
[36m2025-10-28 05:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 05:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 05:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 05:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 05:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 05:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 05:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 05:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 05:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 05:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 05:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 75}[0m
[36m2025-10-28 05:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 05:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 05:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 05:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 05:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 05:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 05:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 05:00:31.321 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 05:00:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q20 = 13.73 Ã¶re/kWh[0m
[36m2025-10-28 05:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 05:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 05:00:31.323 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 05:00:31.323 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 05:00:31.323 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 05:00:31.323 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 05:00:31.323 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 05:00:31.324 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 05:00:31.324 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 05:00:31.324 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:00:31.324 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 05:00:31.324 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:00:31.324 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 05:00:31.324 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 05:00:31.324 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 05:00:31.324 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 05:00:31.324 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=29.3Â°C, error=-2.9Â°C, sensitivity=1.5 -> offset=-1.9[0m
[36m2025-10-28 05:00:31.325 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 05:00:31.325 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 29.3Â°C â†’ offset: -1.9Â°C; Weight: 0.20; Deferred: Moderate debt (DM -250)[0m
[36m2025-10-28 05:00:31.325 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Price classification Q20 (05:00): 13.73 â†’ CHEAP[0m
[32m2025-10-28 05:00:31.325 INFO (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Decision: offset 0.64Â°C - Learned pre-heat: Pre-heating: predicted drop 1.4Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 29.3Â°C â†’ offset: -1.9Â°C; Weight: 0.20; Deferred: Moderate debt (DM -250) | GE-Spot Q20: CHEAP (night) | Too warm: 2.5Â°C over[0m
[32m2025-10-28 05:00:31.327 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset 0.64Â°C, reasoning: Learned pre-heat: Pre-heating: predicted drop 1.4Â°C | Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 29.3Â°C â†’ offset: -1.9Â°C; Weight: 0.20; Deferred: Moderate debt (DM -250) | GE-Spot Q20: CHEAP (night) | Too warm: 2.5Â°C over[0m
[36m2025-10-28 05:00:31.327 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=0.64Â°C, integer=0Â°C, fractional=0.64Â°C, accumulator_before=0.48Â°C[0m
[32m2025-10-28 05:00:31.327 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] âœ“ Accumulated fractional offset reached threshold: applying +1Â°C adjustment (accumulator: 1.12Â°C â†’ 0.12Â°C)[0m
[36m2025-10-28 05:00:31.327 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Accumulator triggered: total_accumulated=1.12Â°C, adjustment=+1Â°C, new_integer=1Â°C, remaining=0.12Â°C[0m
[36m2025-10-28 05:00:31.327 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset 0.64Â°C â†’ applying 1Â°C (accumulator: 0.12Â°C, needs 0.88Â°C more to trigger)[0m
[32m2025-10-28 05:00:31.328 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to 1Â°C (calculated: 0.64Â°C, accumulator: 0.12Â°C)[0m
[36m2025-10-28 05:00:31.328 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=1Â°C, original=0.64Â°C, accumulator=0.12Â°C[0m
[32m2025-10-28 05:00:31.328 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset 0.64Â°C to NIBE via MyUplink[0m
[36m2025-10-28 05:00:31.328 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 7.013 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 05:00:31.328 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.5Â°C, outdoor=8.2Â°C, offset=0.6Â°C, change=0.06Â°C, Î”t=0.08h[0m
[36m2025-10-28 05:00:31.328 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.5Â°C, outdoor=8.2Â°C, offset=0.6Â°C, flow=29.3Â°C, DM=-250[0m
[36m2025-10-28 05:00:31.334 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.2Â°C/h trend[0m
[36m2025-10-28 05:00:31.334 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 05:00:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 05:00:31.340 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 05:00:31.340 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=35.1[0m
[36m2025-10-28 05:00:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:00:31.342 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 03:33:05.210144+00:00[0m
[36m2025-10-28 05:00:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:00:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 05:00:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:00:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-250, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 05:00:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 4 quarters available, need 3 quarters (45 min), lookahead 1.0h[0m
[36m2025-10-28 05:00:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 2 windows evaluated[0m
[36m2025-10-28 05:00:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 39.0Ã¶re/kWh at 05:15 (0.2h away) â† SELECTED[0m
[36m2025-10-28 05:00:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 42.5Ã¶re/kWh at 05:30 (0.5h away)[0m
[32m2025-10-28 05:00:31.343 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 05:15 (Q21-Q23) @ 39.0Ã¶re/kWh, 0.2h away[0m
[36m2025-10-28 05:00:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:00:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-250, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 05:00:31.346 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 03:33:05.210144+00:00[0m
[36m2025-10-28 05:00:31.346 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:00:31.346 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 05:00:31.346 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:00:31.346 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-250, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 05:00:31.346 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 4 quarters available, need 3 quarters (45 min), lookahead 1.0h[0m
[36m2025-10-28 05:00:31.346 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 2 windows evaluated[0m
[36m2025-10-28 05:00:31.346 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 39.0Ã¶re/kWh at 05:15 (0.2h away) â† SELECTED[0m
[36m2025-10-28 05:00:31.346 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 42.5Ã¶re/kWh at 05:30 (0.5h away)[0m
[32m2025-10-28 05:00:31.347 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 05:15 (Q21-Q23) @ 39.0Ã¶re/kWh, 0.2h away[0m
[36m2025-10-28 05:00:31.347 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:00:31.347 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-250, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 05:00:31.347 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control rate limited: 25.0 min since last change (min 60 min)[0m
[36m2025-10-28 05:00:31.347 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.027 seconds (success: True)[0m
[36m2025-10-28 05:00:31.348 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (5.2 + 8.4 + 0.6)A Ã— 0.95 = 3.24 kW[0m
[36m2025-10-28 05:00:31.349 DEBUG (MainThread) [custom_components.effektguard.sensor] Reasoning truncated to 255 chars, full reasoning in attributes[0m
[32m2025-10-28 05:01:48.184 INFO (MainThread) [custom_components.effektguard.switch] Disabling enable_hot_water_optimization[0m
[32m2025-10-28 05:01:48.184 INFO (MainThread) [custom_components.effektguard] Runtime options changed, updating coordinator without reload[0m
[36m2025-10-28 05:01:48.184 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updating configuration: {'optimization_mode': 'balanced', 'tolerance': 1.0, 'thermal_mass': 2.0, 'insulation_quality': 1.5, 'dhw_target_temp': 45.0, 'dhw_morning_hour': 7, 'dhw_evening_hour': 20, 'dhw_morning_enabled': True, 'dhw_evening_enabled': True}[0m
[36m2025-10-28 05:01:48.184 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated tolerance: 1.0 (range: 0.4Â°C)[0m
[36m2025-10-28 05:01:48.184 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated thermal mass: 2.00[0m
[32m2025-10-28 05:01:48.184 INFO (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Insulation quality set to 1.50 (heat loss: 120.0 W/Â°C) - will be refined through learning[0m
[36m2025-10-28 05:01:48.184 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated insulation quality: 1.50[0m
[36m2025-10-28 05:01:48.184 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated optimization mode: balanced[0m
[36m2025-10-28 05:01:48.185 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated DHW demand periods: 2 periods (target: 45.0Â°C)[0m
[32m2025-10-28 05:01:48.185 INFO (MainThread) [custom_components.effektguard.coordinator] Configuration updated without reload - changes apply on next cycle[0m
[32m2025-10-28 05:01:48.862 INFO (MainThread) [custom_components.effektguard.switch] Disabling enable_peak_protection[0m
[32m2025-10-28 05:01:48.862 INFO (MainThread) [custom_components.effektguard] Runtime options changed, updating coordinator without reload[0m
[36m2025-10-28 05:01:48.862 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updating configuration: {'optimization_mode': 'balanced', 'tolerance': 1.0, 'thermal_mass': 2.0, 'insulation_quality': 1.5, 'dhw_target_temp': 45.0, 'dhw_morning_hour': 7, 'dhw_evening_hour': 20, 'dhw_morning_enabled': True, 'dhw_evening_enabled': True}[0m
[36m2025-10-28 05:01:48.862 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated tolerance: 1.0 (range: 0.4Â°C)[0m
[36m2025-10-28 05:01:48.862 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated thermal mass: 2.00[0m
[32m2025-10-28 05:01:48.863 INFO (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Insulation quality set to 1.50 (heat loss: 120.0 W/Â°C) - will be refined through learning[0m
[36m2025-10-28 05:01:48.863 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated insulation quality: 1.50[0m
[36m2025-10-28 05:01:48.863 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated optimization mode: balanced[0m
[36m2025-10-28 05:01:48.863 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated DHW demand periods: 2 periods (target: 45.0Â°C)[0m
[32m2025-10-28 05:01:48.863 INFO (MainThread) [custom_components.effektguard.coordinator] Configuration updated without reload - changes apply on next cycle[0m
[32m2025-10-28 05:01:49.276 INFO (MainThread) [custom_components.effektguard.switch] Disabling enable_price_optimization[0m
[32m2025-10-28 05:01:49.276 INFO (MainThread) [custom_components.effektguard] Runtime options changed, updating coordinator without reload[0m
[36m2025-10-28 05:01:49.276 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updating configuration: {'optimization_mode': 'balanced', 'tolerance': 1.0, 'thermal_mass': 2.0, 'insulation_quality': 1.5, 'dhw_target_temp': 45.0, 'dhw_morning_hour': 7, 'dhw_evening_hour': 20, 'dhw_morning_enabled': True, 'dhw_evening_enabled': True}[0m
[36m2025-10-28 05:01:49.277 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated tolerance: 1.0 (range: 0.4Â°C)[0m
[36m2025-10-28 05:01:49.277 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated thermal mass: 2.00[0m
[32m2025-10-28 05:01:49.277 INFO (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Insulation quality set to 1.50 (heat loss: 120.0 W/Â°C) - will be refined through learning[0m
[36m2025-10-28 05:01:49.277 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated insulation quality: 1.50[0m
[36m2025-10-28 05:01:49.277 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated optimization mode: balanced[0m
[36m2025-10-28 05:01:49.277 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated DHW demand periods: 2 periods (target: 45.0Â°C)[0m
[32m2025-10-28 05:01:49.277 INFO (MainThread) [custom_components.effektguard.coordinator] Configuration updated without reload - changes apply on next cycle[0m
[32m2025-10-28 05:01:49.692 INFO (MainThread) [custom_components.effektguard.switch] Disabling enable_weather_prediction[0m
[32m2025-10-28 05:01:49.692 INFO (MainThread) [custom_components.effektguard] Runtime options changed, updating coordinator without reload[0m
[36m2025-10-28 05:01:49.692 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updating configuration: {'optimization_mode': 'balanced', 'tolerance': 1.0, 'thermal_mass': 2.0, 'insulation_quality': 1.5, 'dhw_target_temp': 45.0, 'dhw_morning_hour': 7, 'dhw_evening_hour': 20, 'dhw_morning_enabled': True, 'dhw_evening_enabled': True}[0m
[36m2025-10-28 05:01:49.692 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated tolerance: 1.0 (range: 0.4Â°C)[0m
[36m2025-10-28 05:01:49.692 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated thermal mass: 2.00[0m
[32m2025-10-28 05:01:49.692 INFO (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Insulation quality set to 1.50 (heat loss: 120.0 W/Â°C) - will be refined through learning[0m
[36m2025-10-28 05:01:49.692 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated insulation quality: 1.50[0m
[36m2025-10-28 05:01:49.692 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated optimization mode: balanced[0m
[36m2025-10-28 05:01:49.692 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated DHW demand periods: 2 periods (target: 45.0Â°C)[0m
[32m2025-10-28 05:01:49.692 INFO (MainThread) [custom_components.effektguard.coordinator] Configuration updated without reload - changes apply on next cycle[0m
[32m2025-10-28 05:01:50.601 INFO (MainThread) [custom_components.effektguard.switch] Disabling enable_optimization[0m
[32m2025-10-28 05:01:50.602 INFO (MainThread) [custom_components.effektguard] Runtime options changed, updating coordinator without reload[0m
[36m2025-10-28 05:01:50.602 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updating configuration: {'optimization_mode': 'balanced', 'tolerance': 1.0, 'thermal_mass': 2.0, 'insulation_quality': 1.5, 'dhw_target_temp': 45.0, 'dhw_morning_hour': 7, 'dhw_evening_hour': 20, 'dhw_morning_enabled': True, 'dhw_evening_enabled': True}[0m
[36m2025-10-28 05:01:50.602 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated tolerance: 1.0 (range: 0.4Â°C)[0m
[36m2025-10-28 05:01:50.602 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated thermal mass: 2.00[0m
[32m2025-10-28 05:01:50.602 INFO (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Insulation quality set to 1.50 (heat loss: 120.0 W/Â°C) - will be refined through learning[0m
[36m2025-10-28 05:01:50.602 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated insulation quality: 1.50[0m
[36m2025-10-28 05:01:50.602 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated optimization mode: balanced[0m
[36m2025-10-28 05:01:50.602 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated DHW demand periods: 2 periods (target: 45.0Â°C)[0m
[32m2025-10-28 05:01:50.602 INFO (MainThread) [custom_components.effektguard.coordinator] Configuration updated without reload - changes apply on next cycle[0m
[36m2025-10-28 05:05:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 05:05:31.320 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.5Â°C (median of 9 sensors: 23.6Â°C, 21.0Â°C, 21.6Â°C, 23.5Â°C, 27.3Â°C, 24.1Â°C, 22.1Â°C, 23.1Â°C, 26.0Â°C)[0m
[36m2025-10-28 05:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -252.0[0m
[36m2025-10-28 05:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 35.1Â°C[0m
[36m2025-10-28 05:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.8Â°C[0m
[36m2025-10-28 05:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=9.2A, L2=1.2A, L3=13.0A[0m
[36m2025-10-28 05:05:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.5Â°C, outdoor 8.2Â°C, flow 30.8Â°C, DM -252[0m
[32m2025-10-28 05:05:31.320 INFO (MainThread) [custom_components.effektguard.utils.compressor_monitor] Compressor entered HIGH zone: 80 Hz for space heating (monitor for sustained operation)[0m
[36m2025-10-28 05:05:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 80 Hz (1h avg: 30, 6h avg: 26, mode: space) - OK: Normal operation (80 Hz, 6h avg: 26 Hz)[0m
[36m2025-10-28 05:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 05:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 05:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 05:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 05:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 05:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 05:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 05:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 05:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 05:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 05:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 75}[0m
[36m2025-10-28 05:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 05:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 05:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 05:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 05:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 05:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 05:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 05:05:31.321 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 05:05:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q20 = 13.73 Ã¶re/kWh[0m
[36m2025-10-28 05:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 05:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 05:05:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 05:05:31.323 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 05:05:31.323 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 05:05:31.323 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 05:05:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 05:05:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 05:05:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 05:05:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:05:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 05:05:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:05:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 05:05:31.325 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 05:05:31.325 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 05:05:31.325 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 05:05:31.325 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=30.8Â°C, error=-4.4Â°C, sensitivity=1.5 -> offset=-2.9[0m
[36m2025-10-28 05:05:31.325 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 05:05:31.325 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.8Â°C â†’ offset: -2.9Â°C; Weight: 0.20; Deferred: Moderate debt (DM -252)[0m
[36m2025-10-28 05:05:31.325 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Price classification Q20 (05:05): 13.73 â†’ CHEAP[0m
[32m2025-10-28 05:05:31.325 INFO (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.46Â°C - Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.8Â°C â†’ offset: -2.9Â°C; Weight: 0.20; Deferred: Moderate debt (DM -252) | GE-Spot Q20: CHEAP (night) | Too warm: 2.5Â°C over[0m
[32m2025-10-28 05:05:31.326 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.46Â°C, reasoning: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.8Â°C â†’ offset: -2.9Â°C; Weight: 0.20; Deferred: Moderate debt (DM -252) | GE-Spot Q20: CHEAP (night) | Too warm: 2.5Â°C over[0m
[36m2025-10-28 05:05:31.326 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Skipping offset write, too soon since last write[0m
[36m2025-10-28 05:05:31.326 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset -0.46Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-28 05:05:31.326 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 8.419 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 05:05:31.326 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.5Â°C, outdoor=8.2Â°C, offset=-0.5Â°C, change=-0.07Â°C, Î”t=0.08h[0m
[36m2025-10-28 05:05:31.326 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.5Â°C, outdoor=8.2Â°C, offset=-0.5Â°C, flow=30.8Â°C, DM=-252[0m
[36m2025-10-28 05:05:31.326 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-28 05:05:31.326 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 05:05:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 05:05:31.327 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 05:05:31.327 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=35.1[0m
[36m2025-10-28 05:05:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:05:31.327 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW temp lux currently ON, last_changed: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 05:05:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:05:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 05:05:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:05:31.328 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-252, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 05:05:31.328 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 4 quarters available, need 3 quarters (45 min), lookahead 1.0h[0m
[36m2025-10-28 05:05:31.328 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 2 windows evaluated[0m
[36m2025-10-28 05:05:31.328 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 39.0Ã¶re/kWh at 05:15 (0.2h away) â† SELECTED[0m
[36m2025-10-28 05:05:31.328 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 42.5Ã¶re/kWh at 05:30 (0.4h away)[0m
[32m2025-10-28 05:05:31.328 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 05:15 (Q21-Q23) @ 39.0Ã¶re/kWh, 0.2h away[0m
[36m2025-10-28 05:05:31.328 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:05:31.328 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-252, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 05:05:31.328 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:05:31.328 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-252, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 05:05:31.328 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.008 seconds (success: True)[0m
[36m2025-10-28 05:05:31.329 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (9.2 + 1.2 + 13.0)A Ã— 0.95 = 5.34 kW[0m
[36m2025-10-28 05:10:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 05:10:31.321 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.5Â°C (median of 9 sensors: 23.6Â°C, 21.0Â°C, 21.6Â°C, 23.5Â°C, 27.3Â°C, 24.1Â°C, 22.1Â°C, 23.2Â°C, 26.0Â°C)[0m
[36m2025-10-28 05:10:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -262.0[0m
[36m2025-10-28 05:10:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 35.1Â°C[0m
[36m2025-10-28 05:10:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 38.8Â°C[0m
[36m2025-10-28 05:10:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=9.7A, L2=1.2A, L3=13.0A[0m
[36m2025-10-28 05:10:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.5Â°C, outdoor 8.2Â°C, flow 38.8Â°C, DM -262[0m
[36m2025-10-28 05:10:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 81 Hz (1h avg: 35, 6h avg: 27, mode: space) - OK: Normal operation (81 Hz, 6h avg: 27 Hz)[0m
[36m2025-10-28 05:10:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 05:10:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 05:10:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 05:10:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 05:10:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 05:10:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 05:10:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 05:10:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 05:10:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 05:10:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 05:10:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 75}[0m
[36m2025-10-28 05:10:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 05:10:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 05:10:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 05:10:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 05:10:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 05:10:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 05:10:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 05:10:31.322 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 05:10:31.322 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q20 = 13.73 Ã¶re/kWh[0m
[36m2025-10-28 05:10:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 05:10:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 05:10:31.323 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 05:10:31.323 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 05:10:31.323 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 05:10:31.323 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 05:10:31.324 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 05:10:31.324 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 05:10:31.324 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 05:10:31.324 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:10:31.325 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 05:10:31.325 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:10:31.325 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 05:10:31.325 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 05:10:31.325 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 05:10:31.325 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 05:10:31.325 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=38.8Â°C, error=-12.4Â°C, sensitivity=1.5 -> offset=-8.3[0m
[36m2025-10-28 05:10:31.325 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 05:10:31.325 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 38.8Â°C â†’ offset: -8.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -262)[0m
[36m2025-10-28 05:10:31.325 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Price classification Q20 (05:10): 13.73 â†’ CHEAP[0m
[32m2025-10-28 05:10:31.325 INFO (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Decision: offset -1.21Â°C - Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 38.8Â°C â†’ offset: -8.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -262) | GE-Spot Q20: CHEAP (night) | Too warm: 2.5Â°C over[0m
[32m2025-10-28 05:10:31.326 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -1.21Â°C, reasoning: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 38.8Â°C â†’ offset: -8.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -262) | GE-Spot Q20: CHEAP (night) | Too warm: 2.5Â°C over[0m
[36m2025-10-28 05:10:31.326 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=-1.21Â°C, integer=-1Â°C, fractional=-0.21Â°C, accumulator_before=0.12Â°C[0m
[36m2025-10-28 05:10:31.326 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset -1.21Â°C â†’ applying -1Â°C (accumulator: -0.09Â°C, needs 0.91Â°C more to trigger)[0m
[32m2025-10-28 05:10:31.327 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to -1Â°C (calculated: -1.21Â°C, accumulator: -0.09Â°C)[0m
[36m2025-10-28 05:10:31.327 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=-1Â°C, original=-1.21Â°C, accumulator=-0.09Â°C[0m
[32m2025-10-28 05:10:31.327 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset -1.21Â°C to NIBE via MyUplink[0m
[36m2025-10-28 05:10:31.327 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 8.614 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 05:10:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.5Â°C, outdoor=8.2Â°C, offset=-1.2Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-28 05:10:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.5Â°C, outdoor=8.2Â°C, offset=-1.2Â°C, flow=38.8Â°C, DM=-262[0m
[36m2025-10-28 05:10:31.330 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.0Â°C/h trend[0m
[36m2025-10-28 05:10:31.330 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 05:10:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 05:10:31.334 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 05:10:31.334 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=35.1[0m
[36m2025-10-28 05:10:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:10:31.334 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW temp lux currently ON, last_changed: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 05:10:31.335 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:10:31.335 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 05:10:31.335 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:10:31.335 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-262, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 05:10:31.335 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 4 quarters available, need 3 quarters (45 min), lookahead 1.0h[0m
[36m2025-10-28 05:10:31.335 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 2 windows evaluated[0m
[36m2025-10-28 05:10:31.335 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 39.0Ã¶re/kWh at 05:15 (0.1h away) â† SELECTED[0m
[36m2025-10-28 05:10:31.335 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 42.5Ã¶re/kWh at 05:30 (0.3h away)[0m
[32m2025-10-28 05:10:31.335 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 05:15 (Q21-Q23) @ 39.0Ã¶re/kWh, 0.1h away[0m
[36m2025-10-28 05:10:31.335 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:10:31.335 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-262, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 05:10:31.335 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:10:31.335 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-262, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 05:10:31.335 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.015 seconds (success: True)[0m
[36m2025-10-28 05:10:31.337 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (9.7 + 1.2 + 13.0)A Ã— 0.95 = 5.45 kW[0m
[33m2025-10-28 05:15:01.730 WARNING (MainThread) [pysignalr.client] No client method with the name 'CommandResponse' found.[0m
[33m2025-10-28 05:15:14.758 WARNING (MainThread) [pysignalr.client] No client method with the name 'CommandResponse' found.[0m
[36m2025-10-28 05:15:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 05:15:31.320 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.5Â°C (median of 9 sensors: 23.6Â°C, 21.0Â°C, 21.7Â°C, 23.5Â°C, 27.3Â°C, 24.1Â°C, 22.1Â°C, 23.2Â°C, 26.0Â°C)[0m
[36m2025-10-28 05:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -266.0[0m
[36m2025-10-28 05:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 36.6Â°C[0m
[36m2025-10-28 05:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 49.8Â°C[0m
[36m2025-10-28 05:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=10.7A, L2=1.2A, L3=13.0A[0m
[36m2025-10-28 05:15:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.5Â°C, outdoor 8.2Â°C, flow 49.8Â°C, DM -266[0m
[36m2025-10-28 05:15:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 81 Hz (1h avg: 39, 6h avg: 29, mode: space) - OK: Normal operation (81 Hz, 6h avg: 29 Hz)[0m
[36m2025-10-28 05:15:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 05:15:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 05:15:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 05:15:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 05:15:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 05:15:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 05:15:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 05:15:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 05:15:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 05:15:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 05:15:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 74}[0m
[36m2025-10-28 05:15:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 05:15:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 05:15:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 05:15:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 05:15:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 05:15:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 05:15:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 05:15:31.321 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 05:15:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q21 = 16.85 Ã¶re/kWh[0m
[36m2025-10-28 05:15:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 05:15:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 05:15:31.323 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 05:15:31.323 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 05:15:31.323 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 05:15:31.323 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 05:15:31.323 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 05:15:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 05:15:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 05:15:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:15:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 05:15:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:15:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 05:15:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 05:15:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 05:15:31.325 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 05:15:31.325 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=49.8Â°C, error=-23.4Â°C, sensitivity=1.5 -> offset=-15.6[0m
[36m2025-10-28 05:15:31.325 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 05:15:31.325 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 49.8Â°C â†’ offset: -15.6Â°C; Weight: 0.20; Deferred: Moderate debt (DM -266)[0m
[36m2025-10-28 05:15:31.325 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Price classification Q21 (05:15): 16.85 â†’ CHEAP[0m
[32m2025-10-28 05:15:31.325 INFO (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Decision: offset -2.25Â°C - Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 49.8Â°C â†’ offset: -15.6Â°C; Weight: 0.20; Deferred: Moderate debt (DM -266) | GE-Spot Q21: CHEAP (night) | Too warm: 2.5Â°C over[0m
[32m2025-10-28 05:15:31.326 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -2.25Â°C, reasoning: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 49.8Â°C â†’ offset: -15.6Â°C; Weight: 0.20; Deferred: Moderate debt (DM -266) | GE-Spot Q21: CHEAP (night) | Too warm: 2.5Â°C over[0m
[36m2025-10-28 05:15:31.326 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=-2.25Â°C, integer=-2Â°C, fractional=-0.25Â°C, accumulator_before=-0.09Â°C[0m
[36m2025-10-28 05:15:31.326 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset -2.25Â°C â†’ applying -2Â°C (accumulator: -0.34Â°C, needs 0.66Â°C more to trigger)[0m
[32m2025-10-28 05:15:31.327 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to -2Â°C (calculated: -2.25Â°C, accumulator: -0.34Â°C)[0m
[36m2025-10-28 05:15:31.327 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=-2Â°C, original=-2.25Â°C, accumulator=-0.34Â°C[0m
[32m2025-10-28 05:15:31.327 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset -2.25Â°C to NIBE via MyUplink[0m
[36m2025-10-28 05:15:31.327 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 3.231 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 05:15:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.5Â°C, outdoor=8.2Â°C, offset=-2.2Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-28 05:15:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.5Â°C, outdoor=8.2Â°C, offset=-2.2Â°C, flow=49.8Â°C, DM=-266[0m
[36m2025-10-28 05:15:31.335 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.1Â°C/h trend[0m
[36m2025-10-28 05:15:31.335 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 05:15:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 05:15:31.338 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 05:15:31.338 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=36.6[0m
[36m2025-10-28 05:15:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:15:31.338 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW temp lux currently ON, last_changed: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 05:15:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:15:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 05:15:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:15:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-266, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 05:15:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 4 quarters available, need 3 quarters (45 min), lookahead 1.0h[0m
[36m2025-10-28 05:15:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 2 windows evaluated[0m
[36m2025-10-28 05:15:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 42.5Ã¶re/kWh at 05:30 (0.2h away) â† SELECTED[0m
[36m2025-10-28 05:15:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 48.3Ã¶re/kWh at 05:45 (0.5h away)[0m
[32m2025-10-28 05:15:31.339 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 05:30 (Q22-Q24) @ 42.5Ã¶re/kWh, 0.2h away[0m
[36m2025-10-28 05:15:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:15:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-266, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 05:15:31.339 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.019 seconds (success: True)[0m
[36m2025-10-28 05:15:31.340 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (10.7 + 1.2 + 13.0)A Ã— 0.95 = 5.68 kW[0m
[33m2025-10-28 05:16:00.718 WARNING (MainThread) [pysignalr.client] No client method with the name 'CommandResponse' found.[0m
[36m2025-10-28 05:20:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 05:20:31.320 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.6Â°C (median of 9 sensors: 23.6Â°C, 21.0Â°C, 21.5Â°C, 23.6Â°C, 27.3Â°C, 24.1Â°C, 22.1Â°C, 23.2Â°C, 26.0Â°C)[0m
[36m2025-10-28 05:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -262.0[0m
[36m2025-10-28 05:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 38.6Â°C[0m
[36m2025-10-28 05:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 54.8Â°C[0m
[36m2025-10-28 05:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=10.7A, L2=1.2A, L3=1.2A[0m
[36m2025-10-28 05:20:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.6Â°C, outdoor 8.2Â°C, flow 54.8Â°C, DM -262[0m
[36m2025-10-28 05:20:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 81 Hz (1h avg: 45, 6h avg: 30, mode: space) - OK: Normal operation (81 Hz, 6h avg: 30 Hz)[0m
[36m2025-10-28 05:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 05:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 05:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 05:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 05:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 05:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 05:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 05:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 05:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 05:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 05:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 74}[0m
[36m2025-10-28 05:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 05:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 05:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 05:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 05:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 05:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 05:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 05:20:31.321 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 05:20:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q21 = 16.85 Ã¶re/kWh[0m
[36m2025-10-28 05:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 05:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 05:20:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 05:20:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 05:20:31.323 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 05:20:31.323 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 05:20:31.323 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 05:20:31.324 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 05:20:31.324 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 05:20:31.324 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:20:31.324 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 05:20:31.324 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:20:31.324 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 05:20:31.324 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 05:20:31.324 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 05:20:31.324 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 05:20:31.324 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=54.8Â°C, error=-28.4Â°C, sensitivity=1.5 -> offset=-18.9[0m
[36m2025-10-28 05:20:31.324 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 05:20:31.325 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 54.8Â°C â†’ offset: -18.9Â°C; Weight: 0.20; Deferred: Moderate debt (DM -262)[0m
[36m2025-10-28 05:20:31.325 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Price classification Q21 (05:20): 16.85 â†’ CHEAP[0m
[32m2025-10-28 05:20:31.325 INFO (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Decision: offset -2.74Â°C - Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 54.8Â°C â†’ offset: -18.9Â°C; Weight: 0.20; Deferred: Moderate debt (DM -262) | GE-Spot Q21: CHEAP (night) | Too warm: 2.6Â°C over[0m
[32m2025-10-28 05:20:31.325 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -2.74Â°C, reasoning: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 54.8Â°C â†’ offset: -18.9Â°C; Weight: 0.20; Deferred: Moderate debt (DM -262) | GE-Spot Q21: CHEAP (night) | Too warm: 2.6Â°C over[0m
[36m2025-10-28 05:20:31.325 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Skipping offset write, too soon since last write[0m
[36m2025-10-28 05:20:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset -2.74Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-28 05:20:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 5.871 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 05:20:31.325 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.6Â°C, outdoor=8.2Â°C, offset=-2.7Â°C, change=0.12Â°C, Î”t=0.08h[0m
[36m2025-10-28 05:20:31.325 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.6Â°C, outdoor=8.2Â°C, offset=-2.7Â°C, flow=54.8Â°C, DM=-262[0m
[36m2025-10-28 05:20:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-28 05:20:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 05:20:31.329 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 05:20:31.329 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 05:20:31.329 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=38.6[0m
[36m2025-10-28 05:20:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:20:31.330 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW temp lux currently ON, last_changed: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 05:20:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:20:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 05:20:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:20:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-262, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 05:20:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 4 quarters available, need 3 quarters (45 min), lookahead 1.0h[0m
[36m2025-10-28 05:20:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 2 windows evaluated[0m
[36m2025-10-28 05:20:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 42.5Ã¶re/kWh at 05:30 (0.2h away) â† SELECTED[0m
[36m2025-10-28 05:20:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 48.3Ã¶re/kWh at 05:45 (0.4h away)[0m
[32m2025-10-28 05:20:31.330 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 05:30 (Q22-Q24) @ 42.5Ã¶re/kWh, 0.2h away[0m
[36m2025-10-28 05:20:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:20:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-262, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 05:20:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:20:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-262, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 05:20:31.331 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.011 seconds (success: True)[0m
[36m2025-10-28 05:20:31.332 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (10.7 + 1.2 + 1.2)A Ã— 0.95 = 2.99 kW[0m
[36m2025-10-28 05:25:31.319 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 05:25:31.319 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.5Â°C (median of 9 sensors: 23.6Â°C, 21.0Â°C, 21.5Â°C, 23.5Â°C, 27.3Â°C, 24.1Â°C, 22.1Â°C, 23.3Â°C, 26.0Â°C)[0m
[36m2025-10-28 05:25:31.319 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -253.0[0m
[36m2025-10-28 05:25:31.319 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 38.6Â°C[0m
[36m2025-10-28 05:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 55.3Â°C[0m
[36m2025-10-28 05:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=10.7A, L2=1.2A, L3=1.2A[0m
[36m2025-10-28 05:25:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.5Â°C, outdoor 8.2Â°C, flow 55.3Â°C, DM -253[0m
[36m2025-10-28 05:25:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 81 Hz (1h avg: 48, 6h avg: 32, mode: space) - OK: Normal operation (81 Hz, 6h avg: 32 Hz)[0m
[36m2025-10-28 05:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 05:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 05:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 05:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 05:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 05:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 05:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 05:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 05:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 05:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 05:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 74}[0m
[36m2025-10-28 05:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 05:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 05:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 05:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 05:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 05:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 05:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 05:25:31.321 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 05:25:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q21 = 16.85 Ã¶re/kWh[0m
[36m2025-10-28 05:25:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 05:25:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 05:25:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 05:25:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 05:25:31.322 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 05:25:31.322 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 05:25:31.322 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 05:25:31.323 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 05:25:31.323 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 05:25:31.323 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:25:31.323 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 05:25:31.323 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:25:31.323 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 05:25:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 05:25:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 05:25:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 05:25:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=55.3Â°C, error=-28.9Â°C, sensitivity=1.5 -> offset=-19.3[0m
[36m2025-10-28 05:25:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 05:25:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 55.3Â°C â†’ offset: -19.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -253)[0m
[36m2025-10-28 05:25:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Price classification Q21 (05:25): 16.85 â†’ CHEAP[0m
[32m2025-10-28 05:25:31.324 INFO (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Decision: offset -2.77Â°C - Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 55.3Â°C â†’ offset: -19.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -253) | GE-Spot Q21: CHEAP (night) | Too warm: 2.5Â°C over[0m
[32m2025-10-28 05:25:31.325 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -2.77Â°C, reasoning: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 55.3Â°C â†’ offset: -19.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -253) | GE-Spot Q21: CHEAP (night) | Too warm: 2.5Â°C over[0m
[36m2025-10-28 05:25:31.325 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=-2.77Â°C, integer=-2Â°C, fractional=-0.77Â°C, accumulator_before=-0.34Â°C[0m
[32m2025-10-28 05:25:31.325 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] âœ“ Accumulated fractional offset reached threshold: applying -1Â°C adjustment (accumulator: -1.11Â°C â†’ -0.11Â°C)[0m
[36m2025-10-28 05:25:31.325 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Accumulator triggered: total_accumulated=-1.11Â°C, adjustment=-1Â°C, new_integer=-3Â°C, remaining=-0.11Â°C[0m
[36m2025-10-28 05:25:31.325 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset -2.77Â°C â†’ applying -3Â°C (accumulator: -0.11Â°C, needs 0.89Â°C more to trigger)[0m
[32m2025-10-28 05:25:31.327 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to -3Â°C (calculated: -2.77Â°C, accumulator: -0.11Â°C)[0m
[36m2025-10-28 05:25:31.327 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=-3Â°C, original=-2.77Â°C, accumulator=-0.11Â°C[0m
[32m2025-10-28 05:25:31.327 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset -2.77Â°C to NIBE via MyUplink[0m
[36m2025-10-28 05:25:31.327 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 5.810 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 05:25:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.5Â°C, outdoor=8.2Â°C, offset=-2.8Â°C, change=-0.06Â°C, Î”t=0.08h[0m
[36m2025-10-28 05:25:31.328 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.5Â°C, outdoor=8.2Â°C, offset=-2.8Â°C, flow=55.3Â°C, DM=-253[0m
[36m2025-10-28 05:25:31.334 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.1Â°C/h trend[0m
[36m2025-10-28 05:25:31.334 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 05:25:31.336 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 05:25:31.337 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 05:25:31.337 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=38.6[0m
[36m2025-10-28 05:25:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:25:31.337 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW temp lux currently ON, last_changed: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 05:25:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:25:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 05:25:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:25:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-253, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 05:25:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 4 quarters available, need 3 quarters (45 min), lookahead 1.0h[0m
[36m2025-10-28 05:25:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 2 windows evaluated[0m
[36m2025-10-28 05:25:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 42.5Ã¶re/kWh at 05:30 (0.1h away) â† SELECTED[0m
[36m2025-10-28 05:25:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 48.3Ã¶re/kWh at 05:45 (0.3h away)[0m
[32m2025-10-28 05:25:31.337 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 05:30 (Q22-Q24) @ 42.5Ã¶re/kWh, 0.1h away[0m
[36m2025-10-28 05:25:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:25:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-253, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 05:25:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:25:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-253, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 05:25:31.338 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.019 seconds (success: True)[0m
[36m2025-10-28 05:25:31.339 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (10.7 + 1.2 + 1.2)A Ã— 0.95 = 2.99 kW[0m
[36m2025-10-28 05:30:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 05:30:31.320 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.5Â°C (median of 9 sensors: 23.6Â°C, 21.0Â°C, 21.7Â°C, 23.5Â°C, 27.3Â°C, 24.1Â°C, 22.1Â°C, 23.3Â°C, 26.0Â°C)[0m
[36m2025-10-28 05:30:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -242.0[0m
[36m2025-10-28 05:30:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 38.1Â°C[0m
[36m2025-10-28 05:30:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 54.8Â°C[0m
[36m2025-10-28 05:30:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=10.7A, L2=1.2A, L3=1.2A[0m
[36m2025-10-28 05:30:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.5Â°C, outdoor 8.2Â°C, flow 54.8Â°C, DM -242[0m
[36m2025-10-28 05:30:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 81 Hz (1h avg: 52, 6h avg: 33, mode: space) - OK: Normal operation (81 Hz, 6h avg: 33 Hz)[0m
[36m2025-10-28 05:30:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 05:30:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 05:30:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 05:30:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 05:30:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 05:30:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 05:30:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 05:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 05:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 05:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 05:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 73}[0m
[36m2025-10-28 05:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 05:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 05:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 05:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 05:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 05:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 05:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 05:30:31.321 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 05:30:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q22 = 43.32 Ã¶re/kWh[0m
[36m2025-10-28 05:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 05:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 05:30:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 05:30:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 05:30:31.323 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 05:30:31.323 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 05:30:31.323 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 05:30:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 05:30:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 05:30:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:30:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 05:30:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:30:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 05:30:31.325 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 05:30:31.325 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 05:30:31.325 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 05:30:31.325 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=54.8Â°C, error=-28.4Â°C, sensitivity=1.5 -> offset=-18.9[0m
[36m2025-10-28 05:30:31.325 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 05:30:31.325 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 54.8Â°C â†’ offset: -18.9Â°C; Weight: 0.20; Deferred: Moderate debt (DM -242)[0m
[36m2025-10-28 05:30:31.325 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Price classification Q22 (05:30): 43.32 â†’ CHEAP[0m
[32m2025-10-28 05:30:31.325 INFO (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Decision: offset -2.72Â°C - Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 54.8Â°C â†’ offset: -18.9Â°C; Weight: 0.20; Deferred: Moderate debt (DM -242) | GE-Spot Q22: CHEAP (night) | Too warm: 2.5Â°C over[0m
[32m2025-10-28 05:30:31.325 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -2.72Â°C, reasoning: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 54.8Â°C â†’ offset: -18.9Â°C; Weight: 0.20; Deferred: Moderate debt (DM -242) | GE-Spot Q22: CHEAP (night) | Too warm: 2.5Â°C over[0m
[36m2025-10-28 05:30:31.325 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=-2.72Â°C, integer=-2Â°C, fractional=-0.72Â°C, accumulator_before=-0.11Â°C[0m
[36m2025-10-28 05:30:31.326 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset -2.72Â°C â†’ applying -2Â°C (accumulator: -0.83Â°C, needs 0.17Â°C more to trigger)[0m
[32m2025-10-28 05:30:31.327 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to -2Â°C (calculated: -2.72Â°C, accumulator: -0.83Â°C)[0m
[36m2025-10-28 05:30:31.327 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=-2Â°C, original=-2.72Â°C, accumulator=-0.83Â°C[0m
[32m2025-10-28 05:30:31.327 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset -2.72Â°C to NIBE via MyUplink[0m
[36m2025-10-28 05:30:31.327 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 5.748 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 05:30:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.5Â°C, outdoor=8.2Â°C, offset=-2.7Â°C, change=-0.05Â°C, Î”t=0.08h[0m
[36m2025-10-28 05:30:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.5Â°C, outdoor=8.2Â°C, offset=-2.7Â°C, flow=54.8Â°C, DM=-242[0m
[36m2025-10-28 05:30:31.327 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-28 05:30:31.327 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 05:30:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 05:30:31.332 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 05:30:31.332 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=38.1[0m
[36m2025-10-28 05:30:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:30:31.332 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW temp lux currently ON, last_changed: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 05:30:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:30:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 05:30:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:30:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-242, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 05:30:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 4 quarters available, need 3 quarters (45 min), lookahead 1.0h[0m
[36m2025-10-28 05:30:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 2 windows evaluated[0m
[36m2025-10-28 05:30:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 48.3Ã¶re/kWh at 05:45 (0.2h away) â† SELECTED[0m
[36m2025-10-28 05:30:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 56.5Ã¶re/kWh at 06:00 (0.5h away)[0m
[32m2025-10-28 05:30:31.332 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 05:45 (Q23-Q25) @ 48.3Ã¶re/kWh, 0.2h away[0m
[36m2025-10-28 05:30:31.333 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:30:31.333 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-242, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 05:30:31.333 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.013 seconds (success: True)[0m
[36m2025-10-28 05:30:31.334 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (10.7 + 1.2 + 1.2)A Ã— 0.95 = 2.99 kW[0m
[36m2025-10-28 05:35:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 05:35:31.320 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.4Â°C (median of 9 sensors: 23.6Â°C, 21.0Â°C, 21.7Â°C, 23.4Â°C, 27.3Â°C, 24.1Â°C, 22.1Â°C, 23.3Â°C, 26.0Â°C)[0m
[36m2025-10-28 05:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -231.0[0m
[36m2025-10-28 05:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 39.6Â°C[0m
[36m2025-10-28 05:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 55.3Â°C[0m
[36m2025-10-28 05:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=10.7A, L2=1.2A, L3=1.2A[0m
[36m2025-10-28 05:35:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.4Â°C, outdoor 8.2Â°C, flow 55.3Â°C, DM -231[0m
[36m2025-10-28 05:35:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 81 Hz (1h avg: 57, 6h avg: 34, mode: space) - OK: Normal operation (81 Hz, 6h avg: 34 Hz)[0m
[36m2025-10-28 05:35:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 05:35:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 05:35:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 05:35:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 05:35:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 05:35:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 05:35:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 05:35:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 05:35:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 05:35:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 05:35:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 73}[0m
[36m2025-10-28 05:35:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 05:35:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 05:35:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 05:35:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 05:35:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 05:35:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 05:35:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 05:35:31.321 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 05:35:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q22 = 43.32 Ã¶re/kWh[0m
[36m2025-10-28 05:35:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 05:35:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 05:35:31.323 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 05:35:31.323 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 05:35:31.323 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 05:35:31.323 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 05:35:31.323 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 05:35:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 05:35:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 05:35:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:35:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 05:35:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:35:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 05:35:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 05:35:31.325 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 05:35:31.325 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 05:35:31.325 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=55.3Â°C, error=-28.9Â°C, sensitivity=1.5 -> offset=-19.3[0m
[36m2025-10-28 05:35:31.325 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 05:35:31.325 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 55.3Â°C â†’ offset: -19.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -231)[0m
[36m2025-10-28 05:35:31.325 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Price classification Q22 (05:35): 43.32 â†’ CHEAP[0m
[32m2025-10-28 05:35:31.325 INFO (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Decision: offset -2.75Â°C - Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 55.3Â°C â†’ offset: -19.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -231) | GE-Spot Q22: CHEAP (night) | Too warm: 2.4Â°C over[0m
[32m2025-10-28 05:35:31.325 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -2.75Â°C, reasoning: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 55.3Â°C â†’ offset: -19.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -231) | GE-Spot Q22: CHEAP (night) | Too warm: 2.4Â°C over[0m
[36m2025-10-28 05:35:31.325 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Skipping offset write, too soon since last write[0m
[36m2025-10-28 05:35:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset -2.75Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-28 05:35:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 5.759 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 05:35:31.326 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.4Â°C, outdoor=8.2Â°C, offset=-2.8Â°C, change=-0.07Â°C, Î”t=0.08h[0m
[36m2025-10-28 05:35:31.326 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.4Â°C, outdoor=8.2Â°C, offset=-2.8Â°C, flow=55.3Â°C, DM=-231[0m
[36m2025-10-28 05:35:31.330 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.2Â°C/h trend[0m
[36m2025-10-28 05:35:31.330 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 05:35:31.338 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved learned data to storage[0m
[36m2025-10-28 05:35:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 05:35:31.338 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 05:35:31.338 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=39.6[0m
[36m2025-10-28 05:35:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:35:31.338 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW temp lux currently ON, last_changed: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 05:35:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:35:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 05:35:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:35:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-231, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 05:35:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 4 quarters available, need 3 quarters (45 min), lookahead 1.0h[0m
[36m2025-10-28 05:35:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 2 windows evaluated[0m
[36m2025-10-28 05:35:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 48.3Ã¶re/kWh at 05:45 (0.2h away) â† SELECTED[0m
[36m2025-10-28 05:35:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 56.5Ã¶re/kWh at 06:00 (0.4h away)[0m
[32m2025-10-28 05:35:31.339 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 05:45 (Q23-Q25) @ 48.3Ã¶re/kWh, 0.2h away[0m
[36m2025-10-28 05:35:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:35:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-231, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 05:35:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:35:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-231, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 05:35:31.339 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.019 seconds (success: True)[0m
[36m2025-10-28 05:35:31.341 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (10.7 + 1.2 + 1.2)A Ã— 0.95 = 2.99 kW[0m
[36m2025-10-28 05:40:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 05:40:31.320 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.4Â°C (median of 9 sensors: 23.6Â°C, 21.0Â°C, 21.7Â°C, 23.4Â°C, 27.3Â°C, 24.1Â°C, 22.1Â°C, 23.3Â°C, 26.0Â°C)[0m
[36m2025-10-28 05:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -223.0[0m
[36m2025-10-28 05:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 40.6Â°C[0m
[36m2025-10-28 05:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 54.8Â°C[0m
[36m2025-10-28 05:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=10.7A, L2=1.2A, L3=1.2A[0m
[36m2025-10-28 05:40:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.4Â°C, outdoor 8.2Â°C, flow 54.8Â°C, DM -223[0m
[36m2025-10-28 05:40:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 81 Hz (1h avg: 61, 6h avg: 35, mode: space) - OK: Normal operation (81 Hz, 6h avg: 35 Hz)[0m
[36m2025-10-28 05:40:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 05:40:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 05:40:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 05:40:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 05:40:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 05:40:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 05:40:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 05:40:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 05:40:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 05:40:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 05:40:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 73}[0m
[36m2025-10-28 05:40:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 05:40:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 05:40:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 05:40:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 05:40:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 05:40:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 05:40:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 05:40:31.321 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 05:40:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q22 = 43.32 Ã¶re/kWh[0m
[36m2025-10-28 05:40:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 05:40:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 05:40:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 05:40:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 05:40:31.323 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 05:40:31.323 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 05:40:31.323 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 05:40:31.324 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 05:40:31.324 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 05:40:31.324 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:40:31.324 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 05:40:31.324 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:40:31.324 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 05:40:31.324 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 05:40:31.324 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 05:40:31.324 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 05:40:31.324 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=54.8Â°C, error=-28.4Â°C, sensitivity=1.5 -> offset=-18.9[0m
[36m2025-10-28 05:40:31.324 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 05:40:31.324 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 54.8Â°C â†’ offset: -18.9Â°C; Weight: 0.20; Deferred: Moderate debt (DM -223)[0m
[36m2025-10-28 05:40:31.325 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Price classification Q22 (05:40): 43.32 â†’ CHEAP[0m
[32m2025-10-28 05:40:31.325 INFO (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Decision: offset -2.71Â°C - Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 54.8Â°C â†’ offset: -18.9Â°C; Weight: 0.20; Deferred: Moderate debt (DM -223) | GE-Spot Q22: CHEAP (night) | Too warm: 2.4Â°C over[0m
[32m2025-10-28 05:40:31.325 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -2.71Â°C, reasoning: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 54.8Â°C â†’ offset: -18.9Â°C; Weight: 0.20; Deferred: Moderate debt (DM -223) | GE-Spot Q22: CHEAP (night) | Too warm: 2.4Â°C over[0m
[36m2025-10-28 05:40:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset -2.71Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-28 05:40:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 5.759 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 05:40:31.325 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.4Â°C, outdoor=8.2Â°C, offset=-2.7Â°C, change=0.03Â°C, Î”t=0.08h[0m
[36m2025-10-28 05:40:31.325 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.4Â°C, outdoor=8.2Â°C, offset=-2.7Â°C, flow=54.8Â°C, DM=-223[0m
[36m2025-10-28 05:40:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-28 05:40:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 05:40:31.333 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 05:40:31.333 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 05:40:31.333 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=40.6[0m
[36m2025-10-28 05:40:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:40:31.334 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW temp lux currently ON, last_changed: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 05:40:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:40:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 05:40:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:40:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-223, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 05:40:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 4 quarters available, need 3 quarters (45 min), lookahead 1.0h[0m
[36m2025-10-28 05:40:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 2 windows evaluated[0m
[36m2025-10-28 05:40:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 48.3Ã¶re/kWh at 05:45 (0.1h away) â† SELECTED[0m
[36m2025-10-28 05:40:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 56.5Ã¶re/kWh at 06:00 (0.3h away)[0m
[32m2025-10-28 05:40:31.334 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 05:45 (Q23-Q25) @ 48.3Ã¶re/kWh, 0.1h away[0m
[36m2025-10-28 05:40:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:40:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-223, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 05:40:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:40:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-223, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 05:40:31.335 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.015 seconds (success: True)[0m
[36m2025-10-28 05:40:31.336 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (10.7 + 1.2 + 1.2)A Ã— 0.95 = 2.99 kW[0m
[36m2025-10-28 05:45:31.319 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 05:45:31.319 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.5Â°C (median of 9 sensors: 23.6Â°C, 20.9Â°C, 21.7Â°C, 23.5Â°C, 27.3Â°C, 24.1Â°C, 22.1Â°C, 23.3Â°C, 26.0Â°C)[0m
[36m2025-10-28 05:45:31.319 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -219.0[0m
[36m2025-10-28 05:45:31.319 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 41.1Â°C[0m
[36m2025-10-28 05:45:31.319 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 55.3Â°C[0m
[36m2025-10-28 05:45:31.319 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=10.7A, L2=1.2A, L3=1.2A[0m
[36m2025-10-28 05:45:31.319 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.5Â°C, outdoor 8.2Â°C, flow 55.3Â°C, DM -219[0m
[36m2025-10-28 05:45:31.319 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 81 Hz (1h avg: 62, 6h avg: 36, mode: space) - OK: Normal operation (81 Hz, 6h avg: 36 Hz)[0m
[36m2025-10-28 05:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 05:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 05:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 05:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 05:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 05:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 05:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 05:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 05:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 05:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 05:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 72}[0m
[36m2025-10-28 05:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 05:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 05:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 05:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 05:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 05:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 05:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 05:45:31.320 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 05:45:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q23 = 56.71 Ã¶re/kWh[0m
[36m2025-10-28 05:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 05:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 05:45:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 05:45:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 05:45:31.322 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 05:45:31.322 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 05:45:31.322 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 05:45:31.323 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 05:45:31.323 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 05:45:31.323 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:45:31.323 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 05:45:31.323 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:45:31.323 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 05:45:31.323 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 05:45:31.323 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 05:45:31.323 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 05:45:31.323 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=55.3Â°C, error=-28.9Â°C, sensitivity=1.5 -> offset=-19.3[0m
[36m2025-10-28 05:45:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 05:45:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 55.3Â°C â†’ offset: -19.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -219)[0m
[36m2025-10-28 05:45:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Price classification Q23 (05:45): 56.71 â†’ NORMAL[0m
[32m2025-10-28 05:45:31.324 INFO (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Decision: offset -3.07Â°C - Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 55.3Â°C â†’ offset: -19.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -219) | GE-Spot Q23: NORMAL (night) | Too warm: 2.5Â°C over[0m
[32m2025-10-28 05:45:31.324 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -3.07Â°C, reasoning: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 55.3Â°C â†’ offset: -19.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -219) | GE-Spot Q23: NORMAL (night) | Too warm: 2.5Â°C over[0m
[36m2025-10-28 05:45:31.325 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=-3.07Â°C, integer=-3Â°C, fractional=-0.07Â°C, accumulator_before=-0.83Â°C[0m
[36m2025-10-28 05:45:31.325 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset -3.07Â°C â†’ applying -3Â°C (accumulator: -0.90Â°C, needs 0.10Â°C more to trigger)[0m
[32m2025-10-28 05:45:31.327 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to -3Â°C (calculated: -3.07Â°C, accumulator: -0.90Â°C)[0m
[36m2025-10-28 05:45:31.327 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=-3Â°C, original=-3.07Â°C, accumulator=-0.90Â°C[0m
[32m2025-10-28 05:45:31.327 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset -3.07Â°C to NIBE via MyUplink[0m
[36m2025-10-28 05:45:31.327 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 5.776 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 05:45:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.5Â°C, outdoor=8.2Â°C, offset=-3.1Â°C, change=0.04Â°C, Î”t=0.08h[0m
[36m2025-10-28 05:45:31.328 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.5Â°C, outdoor=8.2Â°C, offset=-3.1Â°C, flow=55.3Â°C, DM=-219[0m
[36m2025-10-28 05:45:31.332 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.0Â°C/h trend[0m
[36m2025-10-28 05:45:31.333 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 05:45:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 05:45:31.338 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 05:45:31.338 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=41.1[0m
[36m2025-10-28 05:45:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:45:31.338 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW temp lux currently ON, last_changed: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 05:45:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:45:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 05:45:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 4 quarters available, need 3 quarters (45 min), lookahead 1.0h[0m
[36m2025-10-28 05:45:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 2 windows evaluated[0m
[36m2025-10-28 05:45:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 56.5Ã¶re/kWh at 06:00 (0.2h away) â† SELECTED[0m
[36m2025-10-28 05:45:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 78.1Ã¶re/kWh at 06:15 (0.5h away)[0m
[32m2025-10-28 05:45:31.339 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 06:00 (Q24-Q26) @ 56.5Ã¶re/kWh, 0.2h away[0m
[36m2025-10-28 05:45:31.339 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.020 seconds (success: True)[0m
[36m2025-10-28 05:45:31.340 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (10.7 + 1.2 + 1.2)A Ã— 0.95 = 2.99 kW[0m
[36m2025-10-28 05:50:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 05:50:31.321 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.4Â°C (median of 9 sensors: 23.6Â°C, 20.9Â°C, 21.7Â°C, 23.4Â°C, 27.3Â°C, 24.1Â°C, 22.1Â°C, 23.4Â°C, 26.0Â°C)[0m
[36m2025-10-28 05:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -206.0[0m
[36m2025-10-28 05:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 43.1Â°C[0m
[36m2025-10-28 05:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 55.3Â°C[0m
[36m2025-10-28 05:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=10.7A, L2=1.2A, L3=1.2A[0m
[36m2025-10-28 05:50:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.4Â°C, outdoor 8.2Â°C, flow 55.3Â°C, DM -206[0m
[36m2025-10-28 05:50:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 81 Hz (1h avg: 71, 6h avg: 37, mode: space) - OK: Normal operation (81 Hz, 6h avg: 37 Hz)[0m
[36m2025-10-28 05:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 05:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 05:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 05:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 05:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 05:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 05:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 05:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 05:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 05:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 05:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 72}[0m
[36m2025-10-28 05:50:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 05:50:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 05:50:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 05:50:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 05:50:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 05:50:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 05:50:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 05:50:31.322 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 05:50:31.322 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q23 = 56.71 Ã¶re/kWh[0m
[36m2025-10-28 05:50:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 05:50:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 05:50:31.323 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 05:50:31.323 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 05:50:31.323 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 05:50:31.323 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 05:50:31.325 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 05:50:31.326 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 05:50:31.326 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 05:50:31.326 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:50:31.326 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 05:50:31.326 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:50:31.326 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 05:50:31.327 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 05:50:31.327 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 05:50:31.327 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 05:50:31.327 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=55.3Â°C, error=-28.9Â°C, sensitivity=1.5 -> offset=-19.3[0m
[36m2025-10-28 05:50:31.327 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 05:50:31.327 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 55.3Â°C â†’ offset: -19.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -206)[0m
[36m2025-10-28 05:50:31.327 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Price classification Q23 (05:50): 56.71 â†’ NORMAL[0m
[32m2025-10-28 05:50:31.327 INFO (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Decision: offset -3.07Â°C - Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 55.3Â°C â†’ offset: -19.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -206) | GE-Spot Q23: NORMAL (night) | Too warm: 2.4Â°C over[0m
[32m2025-10-28 05:50:31.328 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -3.07Â°C, reasoning: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 55.3Â°C â†’ offset: -19.3Â°C; Weight: 0.20; Deferred: Moderate debt (DM -206) | GE-Spot Q23: NORMAL (night) | Too warm: 2.4Â°C over[0m
[36m2025-10-28 05:50:31.328 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset -3.07Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-28 05:50:31.328 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 5.796 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 05:50:31.328 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.4Â°C, outdoor=8.2Â°C, offset=-3.1Â°C, change=-0.03Â°C, Î”t=0.08h[0m
[36m2025-10-28 05:50:31.328 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.4Â°C, outdoor=8.2Â°C, offset=-3.1Â°C, flow=55.3Â°C, DM=-206[0m
[36m2025-10-28 05:50:31.331 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.0Â°C/h trend[0m
[36m2025-10-28 05:50:31.331 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 05:50:31.333 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 05:50:31.333 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 05:50:31.333 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=43.1[0m
[36m2025-10-28 05:50:31.333 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:50:31.333 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW temp lux currently ON, last_changed: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 05:50:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:50:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 05:50:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 4 quarters available, need 3 quarters (45 min), lookahead 1.0h[0m
[36m2025-10-28 05:50:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 2 windows evaluated[0m
[36m2025-10-28 05:50:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 56.5Ã¶re/kWh at 06:00 (0.2h away) â† SELECTED[0m
[36m2025-10-28 05:50:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 78.1Ã¶re/kWh at 06:15 (0.4h away)[0m
[32m2025-10-28 05:50:31.334 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 06:00 (Q24-Q26) @ 56.5Ã¶re/kWh, 0.2h away[0m
[36m2025-10-28 05:50:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:50:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-206, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 05:50:31.334 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.014 seconds (success: True)[0m
[36m2025-10-28 05:50:31.335 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (10.7 + 1.2 + 1.2)A Ã— 0.95 = 2.99 kW[0m
[36m2025-10-28 05:55:31.319 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 05:55:31.319 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.4Â°C (median of 9 sensors: 23.6Â°C, 20.9Â°C, 21.7Â°C, 23.4Â°C, 27.3Â°C, 24.0Â°C, 22.1Â°C, 23.4Â°C, 26.0Â°C)[0m
[36m2025-10-28 05:55:31.319 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -191.0[0m
[36m2025-10-28 05:55:31.319 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 44.6Â°C[0m
[36m2025-10-28 05:55:31.319 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 55.8Â°C[0m
[36m2025-10-28 05:55:31.319 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=10.7A, L2=1.2A, L3=1.2A[0m
[36m2025-10-28 05:55:31.319 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.4Â°C, outdoor 8.2Â°C, flow 55.8Â°C, DM -191[0m
[36m2025-10-28 05:55:31.319 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 81 Hz (1h avg: 72, 6h avg: 38, mode: space) - OK: Normal operation (81 Hz, 6h avg: 38 Hz)[0m
[36m2025-10-28 05:55:31.319 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 05:55:31.319 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 05:55:31.319 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 05:55:31.319 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 05:55:31.319 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 05:55:31.319 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 05:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 05:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 05:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 05:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 05:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 72}[0m
[36m2025-10-28 05:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 05:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 05:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 05:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 05:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 05:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 05:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 05:55:31.320 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 05:55:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q23 = 56.71 Ã¶re/kWh[0m
[36m2025-10-28 05:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 05:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 05:55:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 05:55:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 05:55:31.321 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 05:55:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 05:55:31.322 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 05:55:31.322 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 05:55:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 05:55:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:55:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 05:55:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:55:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 05:55:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 05:55:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 05:55:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 05:55:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=55.8Â°C, error=-29.4Â°C, sensitivity=1.5 -> offset=-19.6[0m
[36m2025-10-28 05:55:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 05:55:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 55.8Â°C â†’ offset: -19.6Â°C; Weight: 0.23; Deferred: Light debt (DM -191)[0m
[36m2025-10-28 05:55:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Price classification Q23 (05:55): 56.71 â†’ NORMAL[0m
[32m2025-10-28 05:55:31.324 INFO (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Decision: offset -3.33Â°C - Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 55.8Â°C â†’ offset: -19.6Â°C; Weight: 0.23; Deferred: Light debt (DM -191) | GE-Spot Q23: NORMAL (night) | Too warm: 2.4Â°C over[0m
[32m2025-10-28 05:55:31.325 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -3.33Â°C, reasoning: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 55.8Â°C â†’ offset: -19.6Â°C; Weight: 0.23; Deferred: Light debt (DM -191) | GE-Spot Q23: NORMAL (night) | Too warm: 2.4Â°C over[0m
[36m2025-10-28 05:55:31.325 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=-3.33Â°C, integer=-3Â°C, fractional=-0.33Â°C, accumulator_before=-0.90Â°C[0m
[32m2025-10-28 05:55:31.325 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] âœ“ Accumulated fractional offset reached threshold: applying -1Â°C adjustment (accumulator: -1.23Â°C â†’ -0.23Â°C)[0m
[36m2025-10-28 05:55:31.325 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Accumulator triggered: total_accumulated=-1.23Â°C, adjustment=-1Â°C, new_integer=-4Â°C, remaining=-0.23Â°C[0m
[36m2025-10-28 05:55:31.325 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset -3.33Â°C â†’ applying -4Â°C (accumulator: -0.23Â°C, needs 0.77Â°C more to trigger)[0m
[32m2025-10-28 05:55:31.329 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to -4Â°C (calculated: -3.33Â°C, accumulator: -0.23Â°C)[0m
[36m2025-10-28 05:55:31.329 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=-4Â°C, original=-3.33Â°C, accumulator=-0.23Â°C[0m
[32m2025-10-28 05:55:31.329 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset -3.33Â°C to NIBE via MyUplink[0m
[36m2025-10-28 05:55:31.329 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 2.620 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 05:55:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.4Â°C, outdoor=8.2Â°C, offset=-3.3Â°C, change=-0.04Â°C, Î”t=0.08h[0m
[36m2025-10-28 05:55:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.4Â°C, outdoor=8.2Â°C, offset=-3.3Â°C, flow=55.8Â°C, DM=-191[0m
[36m2025-10-28 05:55:31.339 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.3Â°C/h trend[0m
[36m2025-10-28 05:55:31.339 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 05:55:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 05:55:31.341 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 05:55:31.341 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=44.6[0m
[36m2025-10-28 05:55:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:55:31.341 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW temp lux currently ON, last_changed: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 05:55:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:55:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 05:55:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window search: 4 quarters available, need 3 quarters (45 min), lookahead 1.0h[0m
[36m2025-10-28 05:55:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW window candidates found: 2 windows evaluated[0m
[36m2025-10-28 05:55:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #1: 56.5Ã¶re/kWh at 06:00 (0.1h away) â† SELECTED[0m
[36m2025-10-28 05:55:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer]   #2: 78.1Ã¶re/kWh at 06:15 (0.3h away)[0m
[32m2025-10-28 05:55:31.341 INFO (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW optimal window selected: 06:00 (Q24-Q26) @ 56.5Ã¶re/kWh, 0.1h away[0m
[36m2025-10-28 05:55:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 05:55:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-191, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 05:55:31.342 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.023 seconds (success: True)[0m
[36m2025-10-28 05:55:31.343 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (10.7 + 1.2 + 1.2)A Ã— 0.95 = 2.99 kW[0m
[36m2025-10-28 06:00:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 06:00:31.320 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.4Â°C (median of 9 sensors: 23.6Â°C, 20.9Â°C, 21.6Â°C, 23.4Â°C, 27.3Â°C, 24.0Â°C, 22.1Â°C, 23.4Â°C, 26.0Â°C)[0m
[36m2025-10-28 06:00:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -173.0[0m
[36m2025-10-28 06:00:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 46.1Â°C[0m
[36m2025-10-28 06:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 55.8Â°C[0m
[36m2025-10-28 06:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=10.7A, L2=1.2A, L3=1.2A[0m
[36m2025-10-28 06:00:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.4Â°C, outdoor 8.2Â°C, flow 55.8Â°C, DM -173[0m
[36m2025-10-28 06:00:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 81 Hz (1h avg: 81, 6h avg: 39, mode: space) - WATCH: High demand period (1h avg: 81 Hz, current: 81 Hz)[0m
[36m2025-10-28 06:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 06:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 06:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 06:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 06:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 06:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 06:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 06:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 06:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 06:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 06:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 71}[0m
[36m2025-10-28 06:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 06:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 06:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 06:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 06:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 06:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 06:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 06:00:31.322 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 06:00:31.322 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q24 = 27.35 Ã¶re/kWh[0m
[36m2025-10-28 06:00:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 06:00:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 06:00:31.323 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 06:00:31.323 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 06:00:31.323 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 06:00:31.323 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 06:00:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 06:00:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 06:00:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 06:00:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:00:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 06:00:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:00:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 06:00:31.325 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 06:00:31.325 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 06:00:31.325 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 06:00:31.325 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=55.8Â°C, error=-29.4Â°C, sensitivity=1.5 -> offset=-19.6[0m
[36m2025-10-28 06:00:31.325 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 06:00:31.325 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 55.8Â°C â†’ offset: -19.6Â°C; Weight: 0.23; Deferred: Light debt (DM -173)[0m
[36m2025-10-28 06:00:31.325 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Price classification Q24 (06:00): 27.35 â†’ CHEAP[0m
[32m2025-10-28 06:00:31.325 INFO (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Decision: offset -3.48Â°C - Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 55.8Â°C â†’ offset: -19.6Â°C; Weight: 0.23; Deferred: Light debt (DM -173) | GE-Spot Q24: CHEAP (day) | Too warm: 2.4Â°C over (boosted 15%: cooling -0.31Â°C/h)[0m
[32m2025-10-28 06:00:31.326 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -3.48Â°C, reasoning: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 55.8Â°C â†’ offset: -19.6Â°C; Weight: 0.23; Deferred: Light debt (DM -173) | GE-Spot Q24: CHEAP (day) | Too warm: 2.4Â°C over (boosted 15%: cooling -0.31Â°C/h)[0m
[36m2025-10-28 06:00:31.326 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=-3.48Â°C, integer=-3Â°C, fractional=-0.48Â°C, accumulator_before=-0.23Â°C[0m
[36m2025-10-28 06:00:31.326 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset -3.48Â°C â†’ applying -3Â°C (accumulator: -0.72Â°C, needs 0.28Â°C more to trigger)[0m
[32m2025-10-28 06:00:31.328 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to -3Â°C (calculated: -3.48Â°C, accumulator: -0.72Â°C)[0m
[36m2025-10-28 06:00:31.328 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=-3Â°C, original=-3.48Â°C, accumulator=-0.72Â°C[0m
[32m2025-10-28 06:00:31.328 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset -3.48Â°C to NIBE via MyUplink[0m
[36m2025-10-28 06:00:31.328 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 2.642 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 06:00:31.328 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.4Â°C, outdoor=8.2Â°C, offset=-3.5Â°C, change=0.02Â°C, Î”t=0.08h[0m
[36m2025-10-28 06:00:31.329 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.4Â°C, outdoor=8.2Â°C, offset=-3.5Â°C, flow=55.8Â°C, DM=-173[0m
[36m2025-10-28 06:00:31.329 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-28 06:00:31.329 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 06:00:31.331 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 06:00:31.331 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 06:00:31.332 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=46.1[0m
[36m2025-10-28 06:00:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:00:31.332 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW temp lux currently ON, last_changed: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 06:00:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:00:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[33m2025-10-28 06:00:31.332 WARNING (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] Not enough price data for DHW window search: 1 quarters available, 3 needed[0m
[36m2025-10-28 06:00:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:00:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-173, warning=-316, threshold=-158, has_capacity=False[0m
[36m2025-10-28 06:00:31.332 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.012 seconds (success: True)[0m
[36m2025-10-28 06:00:31.334 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (10.7 + 1.2 + 1.2)A Ã— 0.95 = 2.99 kW[0m
[36m2025-10-28 06:05:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 06:05:31.320 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.4Â°C (median of 9 sensors: 23.6Â°C, 20.9Â°C, 21.7Â°C, 23.4Â°C, 27.3Â°C, 23.9Â°C, 22.1Â°C, 23.4Â°C, 26.0Â°C)[0m
[36m2025-10-28 06:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -154.0[0m
[36m2025-10-28 06:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 47.6Â°C[0m
[36m2025-10-28 06:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 55.8Â°C[0m
[36m2025-10-28 06:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=11.2A, L2=1.2A, L3=1.2A[0m
[36m2025-10-28 06:05:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.4Â°C, outdoor 8.2Â°C, flow 55.8Â°C, DM -154[0m
[36m2025-10-28 06:05:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 81 Hz (1h avg: 81, 6h avg: 40, mode: space) - WATCH: High demand period (1h avg: 81 Hz, current: 81 Hz)[0m
[36m2025-10-28 06:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 06:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 06:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 06:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 06:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 06:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 06:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 06:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 06:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 06:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 06:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 71}[0m
[36m2025-10-28 06:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 06:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 06:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 06:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 06:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 06:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 06:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 06:05:31.321 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 06:05:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q24 = 27.35 Ã¶re/kWh[0m
[36m2025-10-28 06:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 06:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 06:05:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 06:05:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 06:05:31.322 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 06:05:31.322 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 06:05:31.323 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 06:05:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 06:05:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 06:05:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:05:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 06:05:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:05:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 06:05:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 06:05:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 06:05:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 06:05:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=55.8Â°C, error=-29.4Â°C, sensitivity=1.5 -> offset=-19.6[0m
[36m2025-10-28 06:05:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 06:05:31.325 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 55.8Â°C â†’ offset: -19.6Â°C; Weight: 0.23; Deferred: Light debt (DM -154)[0m
[36m2025-10-28 06:05:31.325 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Price classification Q24 (06:05): 27.35 â†’ CHEAP[0m
[32m2025-10-28 06:05:31.325 INFO (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Decision: offset -3.03Â°C - Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 55.8Â°C â†’ offset: -19.6Â°C; Weight: 0.23; Deferred: Light debt (DM -154) | GE-Spot Q24: CHEAP (day) | Too warm: 2.4Â°C over[0m
[32m2025-10-28 06:05:31.325 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -3.03Â°C, reasoning: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 55.8Â°C â†’ offset: -19.6Â°C; Weight: 0.23; Deferred: Light debt (DM -154) | GE-Spot Q24: CHEAP (day) | Too warm: 2.4Â°C over[0m
[36m2025-10-28 06:05:31.325 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Skipping offset write, too soon since last write[0m
[36m2025-10-28 06:05:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset -3.03Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-28 06:05:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 2.738 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 06:05:31.325 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.4Â°C, outdoor=8.2Â°C, offset=-3.0Â°C, change=-0.02Â°C, Î”t=0.08h[0m
[36m2025-10-28 06:05:31.325 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.4Â°C, outdoor=8.2Â°C, offset=-3.0Â°C, flow=55.8Â°C, DM=-154[0m
[36m2025-10-28 06:05:31.331 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.1Â°C/h trend[0m
[36m2025-10-28 06:05:31.331 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 06:05:31.335 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 06:05:31.335 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 06:05:31.335 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=47.6[0m
[36m2025-10-28 06:05:31.335 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:05:31.335 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW temp lux currently ON, last_changed: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 06:05:31.335 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:05:31.335 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[33m2025-10-28 06:05:31.335 WARNING (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] Not enough price data for DHW window search: 1 quarters available, 3 needed[0m
[36m2025-10-28 06:05:31.335 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:05:31.335 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-154, warning=-316, threshold=-158, has_capacity=True[0m
[36m2025-10-28 06:05:31.336 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.016 seconds (success: True)[0m
[36m2025-10-28 06:05:31.337 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (11.2 + 1.2 + 1.2)A Ã— 0.95 = 3.10 kW[0m
[36m2025-10-28 06:10:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 06:10:31.321 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.5Â°C (median of 9 sensors: 23.6Â°C, 20.9Â°C, 21.6Â°C, 23.5Â°C, 27.3Â°C, 24.0Â°C, 22.1Â°C, 23.4Â°C, 26.0Â°C)[0m
[36m2025-10-28 06:10:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -139.0[0m
[36m2025-10-28 06:10:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 48.6Â°C[0m
[36m2025-10-28 06:10:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 55.8Â°C[0m
[36m2025-10-28 06:10:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=11.8A, L2=1.2A, L3=1.2A[0m
[36m2025-10-28 06:10:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.5Â°C, outdoor 8.2Â°C, flow 55.8Â°C, DM -139[0m
[36m2025-10-28 06:10:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 81 Hz (1h avg: 81, 6h avg: 41, mode: space) - WATCH: High demand period (1h avg: 81 Hz, current: 81 Hz)[0m
[36m2025-10-28 06:10:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 06:10:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 06:10:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 06:10:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 06:10:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 06:10:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 06:10:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 06:10:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 06:10:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 06:10:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 06:10:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 71}[0m
[36m2025-10-28 06:10:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 06:10:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 06:10:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 06:10:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 06:10:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 06:10:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 06:10:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 06:10:31.322 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 06:10:31.322 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q24 = 27.35 Ã¶re/kWh[0m
[36m2025-10-28 06:10:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 06:10:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 06:10:31.323 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 06:10:31.323 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 06:10:31.323 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 06:10:31.323 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 06:10:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 06:10:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 06:10:31.325 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 06:10:31.325 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:10:31.325 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 06:10:31.325 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:10:31.325 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 06:10:31.325 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 06:10:31.325 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 06:10:31.325 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 06:10:31.325 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=55.8Â°C, error=-29.4Â°C, sensitivity=1.5 -> offset=-19.6[0m
[36m2025-10-28 06:10:31.325 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 06:10:31.325 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 55.8Â°C â†’ offset: -19.6Â°C; Weight: 0.24[0m
[36m2025-10-28 06:10:31.325 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Price classification Q24 (06:10): 27.35 â†’ CHEAP[0m
[32m2025-10-28 06:10:31.326 INFO (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Decision: offset -3.26Â°C - Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 55.8Â°C â†’ offset: -19.6Â°C; Weight: 0.24 | GE-Spot Q24: CHEAP (day) | Too warm: 2.5Â°C over[0m
[32m2025-10-28 06:10:31.326 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -3.26Â°C, reasoning: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 55.8Â°C â†’ offset: -19.6Â°C; Weight: 0.24 | GE-Spot Q24: CHEAP (day) | Too warm: 2.5Â°C over[0m
[36m2025-10-28 06:10:31.326 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=-3.26Â°C, integer=-3Â°C, fractional=-0.26Â°C, accumulator_before=-0.72Â°C[0m
[36m2025-10-28 06:10:31.326 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset -3.26Â°C â†’ applying -3Â°C (accumulator: -0.98Â°C, needs 0.02Â°C more to trigger)[0m
[32m2025-10-28 06:10:31.328 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to -3Â°C (calculated: -3.26Â°C, accumulator: -0.98Â°C)[0m
[36m2025-10-28 06:10:31.328 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=-3Â°C, original=-3.26Â°C, accumulator=-0.98Â°C[0m
[32m2025-10-28 06:10:31.328 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset -3.26Â°C to NIBE via MyUplink[0m
[36m2025-10-28 06:10:31.328 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 2.861 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 06:10:31.328 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.5Â°C, outdoor=8.2Â°C, offset=-3.3Â°C, change=0.09Â°C, Î”t=0.08h[0m
[36m2025-10-28 06:10:31.328 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.5Â°C, outdoor=8.2Â°C, offset=-3.3Â°C, flow=55.8Â°C, DM=-139[0m
[36m2025-10-28 06:10:31.342 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, 0.2Â°C/h trend[0m
[36m2025-10-28 06:10:31.342 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 06:10:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 06:10:31.344 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 06:10:31.344 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=48.6[0m
[36m2025-10-28 06:10:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:10:31.344 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW temp lux currently ON, last_changed: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 06:10:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:10:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[33m2025-10-28 06:10:31.344 WARNING (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] Not enough price data for DHW window search: 1 quarters available, 3 needed[0m
[36m2025-10-28 06:10:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:10:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW spare capacity check: DM=-139, warning=-316, threshold=-158, has_capacity=True[0m
[36m2025-10-28 06:10:31.344 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.024 seconds (success: True)[0m
[36m2025-10-28 06:10:31.346 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (11.8 + 1.2 + 1.2)A Ã— 0.95 = 3.24 kW[0m
[36m2025-10-28 06:15:31.319 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 06:15:31.319 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.4Â°C (median of 9 sensors: 23.6Â°C, 20.9Â°C, 21.8Â°C, 23.4Â°C, 27.3Â°C, 23.9Â°C, 22.1Â°C, 23.4Â°C, 26.0Â°C)[0m
[36m2025-10-28 06:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -125.0[0m
[36m2025-10-28 06:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 50.1Â°C[0m
[36m2025-10-28 06:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 55.8Â°C[0m
[36m2025-10-28 06:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=11.8A, L2=1.2A, L3=1.2A[0m
[36m2025-10-28 06:15:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.4Â°C, outdoor 8.2Â°C, flow 55.8Â°C, DM -125[0m
[36m2025-10-28 06:15:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 81 Hz (1h avg: 81, 6h avg: 42, mode: space) - WATCH: High demand period (1h avg: 81 Hz, current: 81 Hz)[0m
[36m2025-10-28 06:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 06:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 06:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 06:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 06:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 06:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 06:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 06:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 06:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 06:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 06:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 70}[0m
[36m2025-10-28 06:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 06:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 06:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 06:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 06:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 06:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 06:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 06:15:31.321 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 06:15:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q25 = 60.80 Ã¶re/kWh[0m
[36m2025-10-28 06:15:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 06:15:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 06:15:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 06:15:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 06:15:31.322 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 06:15:31.322 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 06:15:31.322 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 06:15:31.323 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 06:15:31.323 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 06:15:31.323 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:15:31.323 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 06:15:31.323 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:15:31.323 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 06:15:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 06:15:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 06:15:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 06:15:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=55.8Â°C, error=-29.4Â°C, sensitivity=1.5 -> offset=-19.6[0m
[36m2025-10-28 06:15:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 06:15:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 55.8Â°C â†’ offset: -19.6Â°C; Weight: 0.24[0m
[36m2025-10-28 06:15:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Price classification Q25 (06:15): 60.80 â†’ NORMAL[0m
[32m2025-10-28 06:15:31.324 INFO (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Decision: offset -3.55Â°C - Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 55.8Â°C â†’ offset: -19.6Â°C; Weight: 0.24 | GE-Spot Q25: NORMAL (day) | Too warm: 2.4Â°C over[0m
[32m2025-10-28 06:15:31.325 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -3.55Â°C, reasoning: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 55.8Â°C â†’ offset: -19.6Â°C; Weight: 0.24 | GE-Spot Q25: NORMAL (day) | Too warm: 2.4Â°C over[0m
[36m2025-10-28 06:15:31.325 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Skipping offset write, too soon since last write[0m
[36m2025-10-28 06:15:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset -3.55Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-28 06:15:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 2.894 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 06:15:31.325 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.4Â°C, outdoor=8.2Â°C, offset=-3.5Â°C, change=-0.09Â°C, Î”t=0.08h[0m
[36m2025-10-28 06:15:31.325 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.4Â°C, outdoor=8.2Â°C, offset=-3.5Â°C, flow=55.8Â°C, DM=-125[0m
[36m2025-10-28 06:15:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-28 06:15:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 06:15:31.326 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 06:15:31.326 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 06:15:31.327 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=50.1[0m
[36m2025-10-28 06:15:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:15:31.327 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW temp lux currently ON, last_changed: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 06:15:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:15:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 06:15:31.327 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.008 seconds (success: True)[0m
[36m2025-10-28 06:15:31.328 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (11.8 + 1.2 + 1.2)A Ã— 0.95 = 3.24 kW[0m
[32m2025-10-28 06:16:48.587 INFO (MainThread) [custom_components.effektguard.switch] Enabling enable_optimization[0m
[32m2025-10-28 06:16:48.587 INFO (MainThread) [custom_components.effektguard] Runtime options changed, updating coordinator without reload[0m
[36m2025-10-28 06:16:48.588 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updating configuration: {'optimization_mode': 'balanced', 'tolerance': 1.0, 'thermal_mass': 2.0, 'insulation_quality': 1.5, 'dhw_target_temp': 45.0, 'dhw_morning_hour': 7, 'dhw_evening_hour': 20, 'dhw_morning_enabled': True, 'dhw_evening_enabled': True}[0m
[36m2025-10-28 06:16:48.588 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated tolerance: 1.0 (range: 0.4Â°C)[0m
[36m2025-10-28 06:16:48.588 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated thermal mass: 2.00[0m
[32m2025-10-28 06:16:48.588 INFO (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Insulation quality set to 1.50 (heat loss: 120.0 W/Â°C) - will be refined through learning[0m
[36m2025-10-28 06:16:48.588 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated insulation quality: 1.50[0m
[36m2025-10-28 06:16:48.588 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated optimization mode: balanced[0m
[36m2025-10-28 06:16:48.588 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated DHW demand periods: 2 periods (target: 45.0Â°C)[0m
[32m2025-10-28 06:16:48.588 INFO (MainThread) [custom_components.effektguard.coordinator] Configuration updated without reload - changes apply on next cycle[0m
[32m2025-10-28 06:16:49.054 INFO (MainThread) [custom_components.effektguard.switch] Enabling enable_hot_water_optimization[0m
[32m2025-10-28 06:16:49.054 INFO (MainThread) [custom_components.effektguard] Runtime options changed, updating coordinator without reload[0m
[36m2025-10-28 06:16:49.054 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updating configuration: {'optimization_mode': 'balanced', 'tolerance': 1.0, 'thermal_mass': 2.0, 'insulation_quality': 1.5, 'dhw_target_temp': 45.0, 'dhw_morning_hour': 7, 'dhw_evening_hour': 20, 'dhw_morning_enabled': True, 'dhw_evening_enabled': True}[0m
[36m2025-10-28 06:16:49.054 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated tolerance: 1.0 (range: 0.4Â°C)[0m
[36m2025-10-28 06:16:49.054 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated thermal mass: 2.00[0m
[32m2025-10-28 06:16:49.054 INFO (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Insulation quality set to 1.50 (heat loss: 120.0 W/Â°C) - will be refined through learning[0m
[36m2025-10-28 06:16:49.054 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated insulation quality: 1.50[0m
[36m2025-10-28 06:16:49.054 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated optimization mode: balanced[0m
[36m2025-10-28 06:16:49.054 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated DHW demand periods: 2 periods (target: 45.0Â°C)[0m
[32m2025-10-28 06:16:49.054 INFO (MainThread) [custom_components.effektguard.coordinator] Configuration updated without reload - changes apply on next cycle[0m
[32m2025-10-28 06:16:49.543 INFO (MainThread) [custom_components.effektguard.switch] Enabling enable_peak_protection[0m
[32m2025-10-28 06:16:49.543 INFO (MainThread) [custom_components.effektguard] Runtime options changed, updating coordinator without reload[0m
[36m2025-10-28 06:16:49.543 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updating configuration: {'optimization_mode': 'balanced', 'tolerance': 1.0, 'thermal_mass': 2.0, 'insulation_quality': 1.5, 'dhw_target_temp': 45.0, 'dhw_morning_hour': 7, 'dhw_evening_hour': 20, 'dhw_morning_enabled': True, 'dhw_evening_enabled': True}[0m
[36m2025-10-28 06:16:49.543 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated tolerance: 1.0 (range: 0.4Â°C)[0m
[36m2025-10-28 06:16:49.543 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated thermal mass: 2.00[0m
[32m2025-10-28 06:16:49.543 INFO (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Insulation quality set to 1.50 (heat loss: 120.0 W/Â°C) - will be refined through learning[0m
[36m2025-10-28 06:16:49.543 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated insulation quality: 1.50[0m
[36m2025-10-28 06:16:49.543 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated optimization mode: balanced[0m
[36m2025-10-28 06:16:49.543 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated DHW demand periods: 2 periods (target: 45.0Â°C)[0m
[32m2025-10-28 06:16:49.543 INFO (MainThread) [custom_components.effektguard.coordinator] Configuration updated without reload - changes apply on next cycle[0m
[32m2025-10-28 06:16:49.939 INFO (MainThread) [custom_components.effektguard.switch] Enabling enable_price_optimization[0m
[32m2025-10-28 06:16:49.939 INFO (MainThread) [custom_components.effektguard] Runtime options changed, updating coordinator without reload[0m
[36m2025-10-28 06:16:49.939 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updating configuration: {'optimization_mode': 'balanced', 'tolerance': 1.0, 'thermal_mass': 2.0, 'insulation_quality': 1.5, 'dhw_target_temp': 45.0, 'dhw_morning_hour': 7, 'dhw_evening_hour': 20, 'dhw_morning_enabled': True, 'dhw_evening_enabled': True}[0m
[36m2025-10-28 06:16:49.939 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated tolerance: 1.0 (range: 0.4Â°C)[0m
[36m2025-10-28 06:16:49.939 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated thermal mass: 2.00[0m
[32m2025-10-28 06:16:49.939 INFO (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Insulation quality set to 1.50 (heat loss: 120.0 W/Â°C) - will be refined through learning[0m
[36m2025-10-28 06:16:49.939 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated insulation quality: 1.50[0m
[36m2025-10-28 06:16:49.939 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated optimization mode: balanced[0m
[36m2025-10-28 06:16:49.939 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated DHW demand periods: 2 periods (target: 45.0Â°C)[0m
[32m2025-10-28 06:16:49.939 INFO (MainThread) [custom_components.effektguard.coordinator] Configuration updated without reload - changes apply on next cycle[0m
[32m2025-10-28 06:16:50.307 INFO (MainThread) [custom_components.effektguard.switch] Enabling enable_weather_prediction[0m
[32m2025-10-28 06:16:50.307 INFO (MainThread) [custom_components.effektguard] Runtime options changed, updating coordinator without reload[0m
[36m2025-10-28 06:16:50.307 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updating configuration: {'optimization_mode': 'balanced', 'tolerance': 1.0, 'thermal_mass': 2.0, 'insulation_quality': 1.5, 'dhw_target_temp': 45.0, 'dhw_morning_hour': 7, 'dhw_evening_hour': 20, 'dhw_morning_enabled': True, 'dhw_evening_enabled': True}[0m
[36m2025-10-28 06:16:50.307 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated tolerance: 1.0 (range: 0.4Â°C)[0m
[36m2025-10-28 06:16:50.307 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated thermal mass: 2.00[0m
[32m2025-10-28 06:16:50.307 INFO (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Insulation quality set to 1.50 (heat loss: 120.0 W/Â°C) - will be refined through learning[0m
[36m2025-10-28 06:16:50.307 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated insulation quality: 1.50[0m
[36m2025-10-28 06:16:50.307 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated optimization mode: balanced[0m
[36m2025-10-28 06:16:50.307 DEBUG (MainThread) [custom_components.effektguard.coordinator] Updated DHW demand periods: 2 periods (target: 45.0Â°C)[0m
[32m2025-10-28 06:16:50.308 INFO (MainThread) [custom_components.effektguard.coordinator] Configuration updated without reload - changes apply on next cycle[0m
[36m2025-10-28 06:20:31.319 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 06:20:31.320 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.4Â°C (median of 9 sensors: 23.6Â°C, 20.9Â°C, 21.8Â°C, 23.4Â°C, 27.3Â°C, 23.9Â°C, 22.1Â°C, 23.4Â°C, 25.0Â°C)[0m
[36m2025-10-28 06:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -110.0[0m
[36m2025-10-28 06:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 51.6Â°C[0m
[36m2025-10-28 06:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 56.3Â°C[0m
[36m2025-10-28 06:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=11.8A, L2=1.2A, L3=1.2A[0m
[36m2025-10-28 06:20:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.4Â°C, outdoor 8.2Â°C, flow 56.3Â°C, DM -110[0m
[36m2025-10-28 06:20:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 75 Hz (1h avg: 81, 6h avg: 43, mode: space) - WATCH: High demand period (1h avg: 81 Hz, current: 75 Hz)[0m
[36m2025-10-28 06:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 06:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 06:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 06:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 06:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 06:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 06:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 06:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 06:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 06:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 06:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 70}[0m
[36m2025-10-28 06:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 06:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 06:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 06:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 06:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 06:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 06:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 06:20:31.321 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 06:20:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q25 = 60.80 Ã¶re/kWh[0m
[36m2025-10-28 06:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 06:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 06:20:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 06:20:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 06:20:31.322 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 06:20:31.322 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 06:20:31.322 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 06:20:31.323 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 06:20:31.323 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 06:20:31.323 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:20:31.323 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 06:20:31.323 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:20:31.323 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 06:20:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 06:20:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 06:20:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 06:20:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=56.3Â°C, error=-29.9Â°C, sensitivity=1.5 -> offset=-19.9[0m
[36m2025-10-28 06:20:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 06:20:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 56.3Â°C â†’ offset: -19.9Â°C; Weight: 0.24[0m
[36m2025-10-28 06:20:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Price classification Q25 (06:20): 60.80 â†’ NORMAL[0m
[32m2025-10-28 06:20:31.324 INFO (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Decision: offset -3.61Â°C - Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 56.3Â°C â†’ offset: -19.9Â°C; Weight: 0.24 | GE-Spot Q25: NORMAL (day) | Too warm: 2.4Â°C over[0m
[32m2025-10-28 06:20:31.326 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -3.61Â°C, reasoning: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 56.3Â°C â†’ offset: -19.9Â°C; Weight: 0.24 | GE-Spot Q25: NORMAL (day) | Too warm: 2.4Â°C over[0m
[36m2025-10-28 06:20:31.326 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=-3.61Â°C, integer=-3Â°C, fractional=-0.61Â°C, accumulator_before=-0.98Â°C[0m
[32m2025-10-28 06:20:31.326 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] âœ“ Accumulated fractional offset reached threshold: applying -1Â°C adjustment (accumulator: -1.59Â°C â†’ -0.59Â°C)[0m
[36m2025-10-28 06:20:31.326 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Accumulator triggered: total_accumulated=-1.59Â°C, adjustment=-1Â°C, new_integer=-4Â°C, remaining=-0.59Â°C[0m
[36m2025-10-28 06:20:31.326 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset -3.61Â°C â†’ applying -4Â°C (accumulator: -0.59Â°C, needs 0.41Â°C more to trigger)[0m
[32m2025-10-28 06:20:31.327 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to -4Â°C (calculated: -3.61Â°C, accumulator: -0.59Â°C)[0m
[36m2025-10-28 06:20:31.328 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=-4Â°C, original=-3.61Â°C, accumulator=-0.59Â°C[0m
[32m2025-10-28 06:20:31.328 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset -3.61Â°C to NIBE via MyUplink[0m
[36m2025-10-28 06:20:31.328 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 2.771 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 06:20:31.328 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.4Â°C, outdoor=8.2Â°C, offset=-3.6Â°C, change=0.02Â°C, Î”t=0.08h[0m
[36m2025-10-28 06:20:31.328 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.4Â°C, outdoor=8.2Â°C, offset=-3.6Â°C, flow=56.3Â°C, DM=-110[0m
[36m2025-10-28 06:20:31.335 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.1Â°C/h trend[0m
[36m2025-10-28 06:20:31.335 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 06:20:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 06:20:31.340 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 06:20:31.340 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=51.6[0m
[36m2025-10-28 06:20:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:20:31.340 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW temp lux currently ON, last_changed: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 06:20:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:20:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 06:20:31.341 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW temp lux currently ON, last_changed: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 06:20:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:20:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[32m2025-10-28 06:20:31.341 INFO (MainThread) [custom_components.effektguard.coordinator] DHW control: Deactivating temporary lux - DHW_ADEQUATE (DHW: 51.6Â°C, DM: -110)[0m
[36m2025-10-28 06:20:31.342 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.022 seconds (success: True)[0m
[36m2025-10-28 06:20:31.343 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (11.8 + 1.2 + 1.2)A Ã— 0.95 = 3.24 kW[0m
[36m2025-10-28 06:25:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 06:25:31.320 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.4Â°C (median of 9 sensors: 23.6Â°C, 21.0Â°C, 21.7Â°C, 23.4Â°C, 27.2Â°C, 23.9Â°C, 22.1Â°C, 23.4Â°C, 25.0Â°C)[0m
[36m2025-10-28 06:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -96.0[0m
[36m2025-10-28 06:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 52.1Â°C[0m
[36m2025-10-28 06:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 28.5Â°C[0m
[36m2025-10-28 06:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=5.7A, L2=1.2A, L3=1.2A[0m
[36m2025-10-28 06:25:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.4Â°C, outdoor 8.2Â°C, flow 28.5Â°C, DM -96[0m
[36m2025-10-28 06:25:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 23 Hz (1h avg: 76, 6h avg: 42, mode: space) - WATCH: High demand period (1h avg: 76 Hz, current: 23 Hz)[0m
[36m2025-10-28 06:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 06:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 06:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 06:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 06:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 06:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 06:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 06:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 06:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 06:25:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 06:25:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 70}[0m
[36m2025-10-28 06:25:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 06:25:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 06:25:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 06:25:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 06:25:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 06:25:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 06:25:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 06:25:31.321 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 06:25:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q25 = 60.80 Ã¶re/kWh[0m
[36m2025-10-28 06:25:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 06:25:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 06:25:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 06:25:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 06:25:31.322 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 06:25:31.322 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 06:25:31.323 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 06:25:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 06:25:31.325 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 06:25:31.325 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:25:31.325 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 06:25:31.325 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:25:31.325 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 06:25:31.325 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 06:25:31.325 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 06:25:31.325 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 06:25:31.325 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=28.5Â°C, error=-2.1Â°C, sensitivity=1.5 -> offset=-1.4[0m
[36m2025-10-28 06:25:31.325 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 06:25:31.325 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 28.5Â°C â†’ offset: -1.4Â°C; Weight: 0.24[0m
[36m2025-10-28 06:25:31.325 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Price classification Q25 (06:25): 60.80 â†’ NORMAL[0m
[32m2025-10-28 06:25:31.326 INFO (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.57Â°C - Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 28.5Â°C â†’ offset: -1.4Â°C; Weight: 0.24 | GE-Spot Q25: NORMAL (day) | Too warm: 2.4Â°C over[0m
[32m2025-10-28 06:25:31.326 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.57Â°C, reasoning: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 28.5Â°C â†’ offset: -1.4Â°C; Weight: 0.24 | GE-Spot Q25: NORMAL (day) | Too warm: 2.4Â°C over[0m
[36m2025-10-28 06:25:31.326 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Skipping offset write, too soon since last write[0m
[36m2025-10-28 06:25:31.326 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset -0.57Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-28 06:25:31.326 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.330 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 06:25:31.326 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.4Â°C, outdoor=8.2Â°C, offset=-0.6Â°C, change=0.01Â°C, Î”t=0.08h[0m
[36m2025-10-28 06:25:31.326 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.4Â°C, outdoor=8.2Â°C, offset=-0.6Â°C, flow=28.5Â°C, DM=-96[0m
[36m2025-10-28 06:25:31.326 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-28 06:25:31.326 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 06:25:31.331 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 06:25:31.331 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 06:25:31.331 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=52.1[0m
[36m2025-10-28 06:25:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:25:31.334 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 06:25:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:25:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 06:25:31.341 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 06:25:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:25:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 06:25:31.341 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control rate limited: 5.0 min since last change (min 60 min)[0m
[36m2025-10-28 06:25:31.341 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.022 seconds (success: True)[0m
[36m2025-10-28 06:25:31.343 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (5.7 + 1.2 + 1.2)A Ã— 0.95 = 1.85 kW[0m
[33m2025-10-28 06:28:50.385 WARNING (MainThread) [homeassistant.components.automation.led_tak_groventre] LED TAK GROVENTRE: Already running[0m
[36m2025-10-28 06:30:31.319 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 06:30:31.319 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.4Â°C (median of 9 sensors: 23.6Â°C, 20.9Â°C, 21.7Â°C, 23.4Â°C, 27.2Â°C, 23.9Â°C, 22.1Â°C, 23.4Â°C, 25.0Â°C)[0m
[36m2025-10-28 06:30:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -62.0[0m
[36m2025-10-28 06:30:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 52.1Â°C[0m
[36m2025-10-28 06:30:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 28.5Â°C[0m
[36m2025-10-28 06:30:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=5.7A, L2=1.2A, L3=1.2A[0m
[36m2025-10-28 06:30:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.4Â°C, outdoor 8.2Â°C, flow 28.5Â°C, DM -62[0m
[36m2025-10-28 06:30:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 20 Hz (1h avg: 71, 6h avg: 42, mode: space) - OK: Normal operation (20 Hz, 6h avg: 42 Hz)[0m
[36m2025-10-28 06:30:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 06:30:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 06:30:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 06:30:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 06:30:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 06:30:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 06:30:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 06:30:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 06:30:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 06:30:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 06:30:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 69}[0m
[36m2025-10-28 06:30:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 06:30:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 06:30:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 06:30:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 06:30:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 06:30:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 06:30:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 06:30:31.321 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 06:30:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q26 = 81.44 Ã¶re/kWh[0m
[36m2025-10-28 06:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 06:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 06:30:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 06:30:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 06:30:31.322 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 06:30:31.322 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 06:30:31.323 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 06:30:31.323 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 06:30:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 06:30:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:30:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 06:30:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:30:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 06:30:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 06:30:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 06:30:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 06:30:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=28.5Â°C, error=-2.1Â°C, sensitivity=1.5 -> offset=-1.4[0m
[36m2025-10-28 06:30:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 06:30:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 28.5Â°C â†’ offset: -1.4Â°C; Weight: 0.24[0m
[36m2025-10-28 06:30:31.325 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Price classification Q26 (06:30): 81.44 â†’ NORMAL[0m
[32m2025-10-28 06:30:31.325 INFO (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.57Â°C - Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 28.5Â°C â†’ offset: -1.4Â°C; Weight: 0.24 | GE-Spot Q26: NORMAL (day) | Too warm: 2.4Â°C over[0m
[32m2025-10-28 06:30:31.327 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.57Â°C, reasoning: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 28.5Â°C â†’ offset: -1.4Â°C; Weight: 0.24 | GE-Spot Q26: NORMAL (day) | Too warm: 2.4Â°C over[0m
[36m2025-10-28 06:30:31.327 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=-0.57Â°C, integer=0Â°C, fractional=-0.57Â°C, accumulator_before=-0.59Â°C[0m
[32m2025-10-28 06:30:31.327 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] âœ“ Accumulated fractional offset reached threshold: applying -1Â°C adjustment (accumulator: -1.15Â°C â†’ -0.15Â°C)[0m
[36m2025-10-28 06:30:31.327 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Accumulator triggered: total_accumulated=-1.15Â°C, adjustment=-1Â°C, new_integer=-1Â°C, remaining=-0.15Â°C[0m
[36m2025-10-28 06:30:31.327 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset -0.57Â°C â†’ applying -1Â°C (accumulator: -0.15Â°C, needs 0.85Â°C more to trigger)[0m
[32m2025-10-28 06:30:31.331 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to -1Â°C (calculated: -0.57Â°C, accumulator: -0.15Â°C)[0m
[36m2025-10-28 06:30:31.331 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=-1Â°C, original=-0.57Â°C, accumulator=-0.15Â°C[0m
[32m2025-10-28 06:30:31.331 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset -0.57Â°C to NIBE via MyUplink[0m
[36m2025-10-28 06:30:31.332 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 1.354 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 06:30:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.4Â°C, outdoor=8.2Â°C, offset=-0.6Â°C, change=-0.04Â°C, Î”t=0.08h[0m
[36m2025-10-28 06:30:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.4Â°C, outdoor=8.2Â°C, offset=-0.6Â°C, flow=28.5Â°C, DM=-62[0m
[36m2025-10-28 06:30:31.336 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.0Â°C/h trend[0m
[36m2025-10-28 06:30:31.336 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 06:30:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 06:30:31.338 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 06:30:31.338 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=52.1[0m
[36m2025-10-28 06:30:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:30:31.343 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 06:30:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:30:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 06:30:31.345 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 06:30:31.346 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:30:31.346 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 06:30:31.346 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control rate limited: 10.0 min since last change (min 60 min)[0m
[36m2025-10-28 06:30:31.346 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.027 seconds (success: True)[0m
[36m2025-10-28 06:30:31.349 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (5.7 + 1.2 + 1.2)A Ã— 0.95 = 1.85 kW[0m
[36m2025-10-28 06:35:31.319 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 06:35:31.319 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.4Â°C (median of 9 sensors: 23.6Â°C, 20.9Â°C, 21.7Â°C, 23.3Â°C, 26.9Â°C, 23.9Â°C, 22.1Â°C, 23.4Â°C, 25.0Â°C)[0m
[36m2025-10-28 06:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -34.0[0m
[36m2025-10-28 06:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 52.1Â°C[0m
[36m2025-10-28 06:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 29.0Â°C[0m
[36m2025-10-28 06:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=5.7A, L2=1.2A, L3=1.2A[0m
[36m2025-10-28 06:35:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.4Â°C, outdoor 8.2Â°C, flow 29.0Â°C, DM -34[0m
[36m2025-10-28 06:35:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 20 Hz (1h avg: 67, 6h avg: 41, mode: space) - OK: Normal operation (20 Hz, 6h avg: 41 Hz)[0m
[36m2025-10-28 06:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 06:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 06:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 06:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 06:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 06:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 06:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 06:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 06:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 06:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 06:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 69}[0m
[36m2025-10-28 06:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 06:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 06:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 06:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 06:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 06:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 06:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 06:35:31.321 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 06:35:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q26 = 81.44 Ã¶re/kWh[0m
[36m2025-10-28 06:35:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 06:35:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 06:35:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 06:35:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 06:35:31.322 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 06:35:31.322 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 06:35:31.324 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 06:35:31.328 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 06:35:31.328 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 06:35:31.328 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:35:31.328 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 06:35:31.328 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:35:31.328 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 06:35:31.329 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 06:35:31.329 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 06:35:31.329 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 06:35:31.329 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=29.0Â°C, error=-2.6Â°C, sensitivity=1.5 -> offset=-1.7[0m
[36m2025-10-28 06:35:31.329 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 06:35:31.329 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 29.0Â°C â†’ offset: -1.7Â°C; Weight: 0.24[0m
[36m2025-10-28 06:35:31.330 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Price classification Q26 (06:35): 81.44 â†’ NORMAL[0m
[32m2025-10-28 06:35:31.330 INFO (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.61Â°C - Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 29.0Â°C â†’ offset: -1.7Â°C; Weight: 0.24 | GE-Spot Q26: NORMAL (day) | Too warm: 2.4Â°C over[0m
[32m2025-10-28 06:35:31.331 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.61Â°C, reasoning: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 29.0Â°C â†’ offset: -1.7Â°C; Weight: 0.24 | GE-Spot Q26: NORMAL (day) | Too warm: 2.4Â°C over[0m
[36m2025-10-28 06:35:31.331 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=-0.61Â°C, integer=0Â°C, fractional=-0.61Â°C, accumulator_before=-0.15Â°C[0m
[36m2025-10-28 06:35:31.331 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: -0.77Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-28 06:35:31.331 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset -0.61Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-28 06:35:31.331 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.002 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 06:35:31.331 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-28 06:35:31.331 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.4Â°C, outdoor=8.2Â°C, offset=-0.6Â°C, change=-0.03Â°C, Î”t=0.08h[0m
[36m2025-10-28 06:35:31.331 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.4Â°C, outdoor=8.2Â°C, offset=-0.6Â°C, flow=29.0Â°C, DM=-34[0m
[36m2025-10-28 06:35:31.331 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-28 06:35:31.331 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 06:35:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 06:35:31.332 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 06:35:31.332 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=52.1[0m
[36m2025-10-28 06:35:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:35:31.336 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 06:35:31.336 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:35:31.336 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 06:35:31.339 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 06:35:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:35:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 06:35:31.339 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control rate limited: 15.0 min since last change (min 60 min)[0m
[36m2025-10-28 06:35:31.339 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.020 seconds (success: True)[0m
[36m2025-10-28 06:35:31.340 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (5.7 + 1.2 + 1.2)A Ã— 0.95 = 1.85 kW[0m
[36m2025-10-28 06:40:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 06:40:31.320 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.4Â°C (median of 9 sensors: 23.6Â°C, 21.0Â°C, 21.9Â°C, 23.3Â°C, 26.7Â°C, 23.9Â°C, 22.1Â°C, 23.4Â°C, 25.0Â°C)[0m
[36m2025-10-28 06:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -15.0[0m
[36m2025-10-28 06:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 52.1Â°C[0m
[36m2025-10-28 06:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 29.0Â°C[0m
[36m2025-10-28 06:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=5.7A, L2=1.2A, L3=0.6A[0m
[36m2025-10-28 06:40:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.4Â°C, outdoor 8.2Â°C, flow 29.0Â°C, DM -15[0m
[36m2025-10-28 06:40:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 20 Hz (1h avg: 62, 6h avg: 41, mode: space) - OK: Normal operation (20 Hz, 6h avg: 41 Hz)[0m
[36m2025-10-28 06:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 06:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 06:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 06:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 06:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 06:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 06:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 06:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 06:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 06:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 06:40:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 69}[0m
[36m2025-10-28 06:40:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 06:40:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 06:40:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 06:40:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 06:40:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 06:40:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 06:40:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 06:40:31.321 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 06:40:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q26 = 81.44 Ã¶re/kWh[0m
[36m2025-10-28 06:40:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 06:40:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 06:40:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 06:40:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 06:40:31.322 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 06:40:31.322 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 06:40:31.322 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 06:40:31.323 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 06:40:31.323 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 06:40:31.323 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:40:31.323 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 06:40:31.323 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:40:31.324 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 06:40:31.324 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 06:40:31.324 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 06:40:31.324 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 06:40:31.324 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=29.0Â°C, error=-2.6Â°C, sensitivity=1.5 -> offset=-1.7[0m
[36m2025-10-28 06:40:31.324 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 06:40:31.324 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 29.0Â°C â†’ offset: -1.7Â°C; Weight: 0.24[0m
[36m2025-10-28 06:40:31.324 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Price classification Q26 (06:40): 81.44 â†’ NORMAL[0m
[32m2025-10-28 06:40:31.324 INFO (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.61Â°C - Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 29.0Â°C â†’ offset: -1.7Â°C; Weight: 0.24 | GE-Spot Q26: NORMAL (day) | Too warm: 2.4Â°C over[0m
[32m2025-10-28 06:40:31.325 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.61Â°C, reasoning: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 29.0Â°C â†’ offset: -1.7Â°C; Weight: 0.24 | GE-Spot Q26: NORMAL (day) | Too warm: 2.4Â°C over[0m
[36m2025-10-28 06:40:31.325 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=-0.61Â°C, integer=0Â°C, fractional=-0.61Â°C, accumulator_before=-0.77Â°C[0m
[32m2025-10-28 06:40:31.325 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] âœ“ Accumulated fractional offset reached threshold: applying -1Â°C adjustment (accumulator: -1.38Â°C â†’ -0.38Â°C)[0m
[36m2025-10-28 06:40:31.325 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Accumulator triggered: total_accumulated=-1.38Â°C, adjustment=-1Â°C, new_integer=-1Â°C, remaining=-0.38Â°C[0m
[36m2025-10-28 06:40:31.325 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset -0.61Â°C â†’ applying -1Â°C (accumulator: -0.38Â°C, needs 0.62Â°C more to trigger)[0m
[32m2025-10-28 06:40:31.328 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to -1Â°C (calculated: -0.61Â°C, accumulator: -0.38Â°C)[0m
[36m2025-10-28 06:40:31.328 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=-1Â°C, original=-0.61Â°C, accumulator=-0.38Â°C[0m
[32m2025-10-28 06:40:31.328 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset -0.61Â°C to NIBE via MyUplink[0m
[36m2025-10-28 06:40:31.328 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.008 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 06:40:31.328 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.01 kW below 0.5 kW threshold[0m
[36m2025-10-28 06:40:31.328 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.4Â°C, outdoor=8.2Â°C, offset=-0.6Â°C, change=-0.01Â°C, Î”t=0.08h[0m
[36m2025-10-28 06:40:31.328 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.4Â°C, outdoor=8.2Â°C, offset=-0.6Â°C, flow=29.0Â°C, DM=-15[0m
[36m2025-10-28 06:40:31.333 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.1Â°C/h trend[0m
[36m2025-10-28 06:40:31.333 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 06:40:31.342 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved learned data to storage[0m
[36m2025-10-28 06:40:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 06:40:31.343 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 06:40:31.343 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=52.1[0m
[36m2025-10-28 06:40:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:40:31.346 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 06:40:31.346 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:40:31.346 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 06:40:31.348 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 06:40:31.348 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:40:31.348 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 06:40:31.348 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control rate limited: 20.0 min since last change (min 60 min)[0m
[36m2025-10-28 06:40:31.348 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.029 seconds (success: True)[0m
[36m2025-10-28 06:40:31.350 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (5.7 + 1.2 + 0.6)A Ã— 0.95 = 1.71 kW[0m
[36m2025-10-28 06:45:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 06:45:31.320 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.3Â°C (median of 9 sensors: 23.6Â°C, 21.0Â°C, 21.8Â°C, 23.3Â°C, 26.6Â°C, 23.8Â°C, 22.1Â°C, 23.3Â°C, 25.0Â°C)[0m
[36m2025-10-28 06:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -4.0[0m
[36m2025-10-28 06:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 52.1Â°C[0m
[36m2025-10-28 06:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 29.5Â°C[0m
[36m2025-10-28 06:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=5.7A, L2=1.2A, L3=0.6A[0m
[36m2025-10-28 06:45:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.3Â°C, outdoor 8.2Â°C, flow 29.5Â°C, DM -4[0m
[36m2025-10-28 06:45:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor: 20 Hz (1h avg: 55, 6h avg: 41, mode: space) - OK: Normal operation (20 Hz, 6h avg: 41 Hz)[0m
[36m2025-10-28 06:45:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 06:45:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 06:45:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 06:45:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 06:45:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 06:45:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 06:45:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 06:45:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 06:45:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 06:45:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 06:45:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 68}[0m
[36m2025-10-28 06:45:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 06:45:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 06:45:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 06:45:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 06:45:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 06:45:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 06:45:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 06:45:31.321 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 06:45:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q27 = 92.00 Ã¶re/kWh[0m
[36m2025-10-28 06:45:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 06:45:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 06:45:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 06:45:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 06:45:31.323 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 06:45:31.323 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 06:45:31.323 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 06:45:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 06:45:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 06:45:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:45:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 06:45:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:45:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 06:45:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 06:45:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 06:45:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 06:45:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=29.5Â°C, error=-3.1Â°C, sensitivity=1.5 -> offset=-2.1[0m
[36m2025-10-28 06:45:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 06:45:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 29.5Â°C â†’ offset: -2.1Â°C; Weight: 0.24[0m
[36m2025-10-28 06:45:31.325 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Price classification Q27 (06:45): 92.00 â†’ NORMAL[0m
[32m2025-10-28 06:45:31.325 INFO (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.66Â°C - Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 29.5Â°C â†’ offset: -2.1Â°C; Weight: 0.24 | GE-Spot Q27: NORMAL (day) | Too warm: 2.3Â°C over[0m
[32m2025-10-28 06:45:31.327 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.66Â°C, reasoning: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 29.5Â°C â†’ offset: -2.1Â°C; Weight: 0.24 | GE-Spot Q27: NORMAL (day) | Too warm: 2.3Â°C over[0m
[36m2025-10-28 06:45:31.327 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=-0.66Â°C, integer=0Â°C, fractional=-0.66Â°C, accumulator_before=-0.38Â°C[0m
[32m2025-10-28 06:45:31.327 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] âœ“ Accumulated fractional offset reached threshold: applying -1Â°C adjustment (accumulator: -1.04Â°C â†’ -0.04Â°C)[0m
[36m2025-10-28 06:45:31.327 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Accumulator triggered: total_accumulated=-1.04Â°C, adjustment=-1Â°C, new_integer=-1Â°C, remaining=-0.04Â°C[0m
[36m2025-10-28 06:45:31.327 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset -0.66Â°C â†’ applying -1Â°C (accumulator: -0.04Â°C, needs 0.96Â°C more to trigger)[0m
[32m2025-10-28 06:45:31.330 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to -1Â°C (calculated: -0.66Â°C, accumulator: -0.04Â°C)[0m
[36m2025-10-28 06:45:31.330 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=-1Â°C, original=-0.66Â°C, accumulator=-0.04Â°C[0m
[32m2025-10-28 06:45:31.330 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset -0.66Â°C to NIBE via MyUplink[0m
[36m2025-10-28 06:45:31.330 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.000 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 06:45:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-28 06:45:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.3Â°C, outdoor=8.2Â°C, offset=-0.7Â°C, change=-0.02Â°C, Î”t=0.08h[0m
[36m2025-10-28 06:45:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.3Â°C, outdoor=8.2Â°C, offset=-0.7Â°C, flow=29.5Â°C, DM=-4[0m
[36m2025-10-28 06:45:31.340 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.3Â°C/h trend[0m
[36m2025-10-28 06:45:31.340 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 06:45:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 06:45:31.342 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 06:45:31.342 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=52.1[0m
[36m2025-10-28 06:45:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:45:31.346 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 06:45:31.346 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:45:31.346 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 06:45:31.350 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 06:45:31.350 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:45:31.350 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 06:45:31.350 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control rate limited: 25.0 min since last change (min 60 min)[0m
[36m2025-10-28 06:45:31.350 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.030 seconds (success: True)[0m
[36m2025-10-28 06:45:31.351 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (5.7 + 1.2 + 0.6)A Ã— 0.95 = 1.71 kW[0m
[36m2025-10-28 06:50:31.319 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 06:50:31.319 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.3Â°C (median of 9 sensors: 23.6Â°C, 21.0Â°C, 21.9Â°C, 23.3Â°C, 26.5Â°C, 23.8Â°C, 22.1Â°C, 23.3Â°C, 25.0Â°C)[0m
[36m2025-10-28 06:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = 6.0[0m
[36m2025-10-28 06:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 52.1Â°C[0m
[36m2025-10-28 06:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 29.5Â°C[0m
[36m2025-10-28 06:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.6A, L2=1.2A, L3=0.6A[0m
[36m2025-10-28 06:50:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.3Â°C, outdoor 8.2Â°C, flow 29.5Â°C, DM 6[0m
[36m2025-10-28 06:50:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor Hz not available from NIBE adapter[0m
[36m2025-10-28 06:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 06:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 06:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 06:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 06:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 06:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 06:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 06:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 06:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 06:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 06:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 68}[0m
[36m2025-10-28 06:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 06:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 06:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 06:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 06:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 06:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 06:50:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 06:50:31.321 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 06:50:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q27 = 92.00 Ã¶re/kWh[0m
[36m2025-10-28 06:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 06:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 06:50:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 06:50:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 06:50:31.322 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 06:50:31.322 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 06:50:31.322 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 06:50:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 06:50:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 06:50:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:50:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 06:50:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:50:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 06:50:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 06:50:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 06:50:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 06:50:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=29.5Â°C, error=-3.1Â°C, sensitivity=1.5 -> offset=-2.1[0m
[36m2025-10-28 06:50:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 06:50:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 29.5Â°C â†’ offset: -2.1Â°C; Weight: 0.24[0m
[36m2025-10-28 06:50:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Price classification Q27 (06:50): 92.00 â†’ NORMAL[0m
[32m2025-10-28 06:50:31.325 INFO (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.66Â°C - Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 29.5Â°C â†’ offset: -2.1Â°C; Weight: 0.24 | GE-Spot Q27: NORMAL (day) | Too warm: 2.3Â°C over[0m
[32m2025-10-28 06:50:31.325 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.66Â°C, reasoning: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 29.5Â°C â†’ offset: -2.1Â°C; Weight: 0.24 | GE-Spot Q27: NORMAL (day) | Too warm: 2.3Â°C over[0m
[36m2025-10-28 06:50:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset -0.66Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-28 06:50:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.000 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 06:50:31.325 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-28 06:50:31.325 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.3Â°C, outdoor=8.2Â°C, offset=-0.7Â°C, change=-0.03Â°C, Î”t=0.08h[0m
[36m2025-10-28 06:50:31.325 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.3Â°C, outdoor=8.2Â°C, offset=-0.7Â°C, flow=29.5Â°C, DM=6[0m
[36m2025-10-28 06:50:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-28 06:50:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 06:50:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 06:50:31.327 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 06:50:31.327 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=52.1[0m
[36m2025-10-28 06:50:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:50:31.335 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 06:50:31.335 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:50:31.335 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 06:50:31.337 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 06:50:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:50:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 06:50:31.337 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control rate limited: 30.0 min since last change (min 60 min)[0m
[36m2025-10-28 06:50:31.337 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.018 seconds (success: True)[0m
[36m2025-10-28 06:50:31.338 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.6 + 1.2 + 0.6)A Ã— 0.95 = 1.46 kW[0m
[36m2025-10-28 06:55:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 06:55:31.320 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.3Â°C (median of 9 sensors: 23.6Â°C, 21.0Â°C, 21.8Â°C, 23.2Â°C, 26.4Â°C, 23.8Â°C, 22.1Â°C, 23.3Â°C, 25.0Â°C)[0m
[36m2025-10-28 06:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = 9.0[0m
[36m2025-10-28 06:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 52.1Â°C[0m
[36m2025-10-28 06:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.0Â°C[0m
[36m2025-10-28 06:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.3A, L2=1.2A, L3=0.6A[0m
[36m2025-10-28 06:55:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.3Â°C, outdoor 8.2Â°C, flow 30.0Â°C, DM 9[0m
[36m2025-10-28 06:55:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor Hz not available from NIBE adapter[0m
[36m2025-10-28 06:55:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 06:55:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 06:55:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 06:55:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 06:55:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 06:55:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 06:55:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 06:55:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 06:55:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 06:55:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 06:55:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 68}[0m
[36m2025-10-28 06:55:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 06:55:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 06:55:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 06:55:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 06:55:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 06:55:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 06:55:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 06:55:31.321 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 06:55:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q27 = 92.00 Ã¶re/kWh[0m
[36m2025-10-28 06:55:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 06:55:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 06:55:31.323 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 06:55:31.323 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 06:55:31.323 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 06:55:31.323 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 06:55:31.323 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 06:55:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 06:55:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 06:55:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:55:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 06:55:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:55:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 06:55:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 06:55:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 06:55:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 06:55:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=30.0Â°C, error=-3.6Â°C, sensitivity=1.5 -> offset=-2.4[0m
[36m2025-10-28 06:55:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 06:55:31.325 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.0Â°C â†’ offset: -2.4Â°C; Weight: 0.24[0m
[36m2025-10-28 06:55:31.325 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Price classification Q27 (06:55): 92.00 â†’ NORMAL[0m
[32m2025-10-28 06:55:31.325 INFO (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.71Â°C - Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.0Â°C â†’ offset: -2.4Â°C; Weight: 0.24 | GE-Spot Q27: NORMAL (day) | Too warm: 2.3Â°C over[0m
[32m2025-10-28 06:55:31.325 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.71Â°C, reasoning: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.0Â°C â†’ offset: -2.4Â°C; Weight: 0.24 | GE-Spot Q27: NORMAL (day) | Too warm: 2.3Â°C over[0m
[36m2025-10-28 06:55:31.325 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=-0.71Â°C, integer=0Â°C, fractional=-0.71Â°C, accumulator_before=-0.04Â°C[0m
[36m2025-10-28 06:55:31.325 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: -0.76Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-28 06:55:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset -0.71Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-28 06:55:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.013 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 06:55:31.325 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.01 kW below 0.5 kW threshold[0m
[36m2025-10-28 06:55:31.325 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.3Â°C, outdoor=8.2Â°C, offset=-0.7Â°C, change=-0.01Â°C, Î”t=0.08h[0m
[36m2025-10-28 06:55:31.325 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.3Â°C, outdoor=8.2Â°C, offset=-0.7Â°C, flow=30.0Â°C, DM=9[0m
[36m2025-10-28 06:55:31.333 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.2Â°C/h trend[0m
[36m2025-10-28 06:55:31.334 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 06:55:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 06:55:31.334 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 06:55:31.334 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=52.1[0m
[36m2025-10-28 06:55:31.335 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:55:31.337 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 06:55:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:55:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 06:55:31.339 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 06:55:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 06:55:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 06:55:31.339 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control rate limited: 35.0 min since last change (min 60 min)[0m
[36m2025-10-28 06:55:31.339 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.019 seconds (success: True)[0m
[36m2025-10-28 06:55:31.340 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.3 + 1.2 + 0.6)A Ã— 0.95 = 1.39 kW[0m
[36m2025-10-28 07:00:31.319 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 07:00:31.320 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.3Â°C (median of 9 sensors: 23.6Â°C, 21.0Â°C, 21.8Â°C, 23.1Â°C, 26.3Â°C, 23.8Â°C, 22.1Â°C, 23.3Â°C, 25.0Â°C)[0m
[36m2025-10-28 07:00:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = 10.0[0m
[36m2025-10-28 07:00:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 52.1Â°C[0m
[36m2025-10-28 07:00:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.0Â°C[0m
[36m2025-10-28 07:00:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.4A, L2=1.2A, L3=0.6A[0m
[36m2025-10-28 07:00:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.3Â°C, outdoor 8.2Â°C, flow 30.0Â°C, DM 10[0m
[36m2025-10-28 07:00:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor Hz not available from NIBE adapter[0m
[36m2025-10-28 07:00:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 07:00:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 07:00:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 07:00:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 07:00:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 07:00:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 07:00:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 07:00:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 07:00:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 07:00:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 07:00:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 67}[0m
[36m2025-10-28 07:00:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 07:00:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 07:00:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 07:00:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 07:00:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 07:00:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 07:00:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 07:00:31.321 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 07:00:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q28 = 95.91 Ã¶re/kWh[0m
[36m2025-10-28 07:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 07:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 07:00:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 07:00:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 07:00:31.322 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 07:00:31.322 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 07:00:31.322 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 07:00:31.323 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 07:00:31.323 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 07:00:31.323 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:00:31.323 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 07:00:31.323 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:00:31.323 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 07:00:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 07:00:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 07:00:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 07:00:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=30.0Â°C, error=-3.6Â°C, sensitivity=1.5 -> offset=-2.4[0m
[36m2025-10-28 07:00:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 07:00:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.0Â°C â†’ offset: -2.4Â°C; Weight: 0.24[0m
[36m2025-10-28 07:00:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Price classification Q28 (07:00): 95.91 â†’ NORMAL[0m
[32m2025-10-28 07:00:31.324 INFO (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.71Â°C - Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.0Â°C â†’ offset: -2.4Â°C; Weight: 0.24 | GE-Spot Q28: NORMAL (day) | Too warm: 2.3Â°C over[0m
[32m2025-10-28 07:00:31.327 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.71Â°C, reasoning: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.0Â°C â†’ offset: -2.4Â°C; Weight: 0.24 | GE-Spot Q28: NORMAL (day) | Too warm: 2.3Â°C over[0m
[36m2025-10-28 07:00:31.327 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=-0.71Â°C, integer=0Â°C, fractional=-0.71Â°C, accumulator_before=-0.76Â°C[0m
[32m2025-10-28 07:00:31.327 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] âœ“ Accumulated fractional offset reached threshold: applying -1Â°C adjustment (accumulator: -1.47Â°C â†’ -0.47Â°C)[0m
[36m2025-10-28 07:00:31.327 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Accumulator triggered: total_accumulated=-1.47Â°C, adjustment=-1Â°C, new_integer=-1Â°C, remaining=-0.47Â°C[0m
[36m2025-10-28 07:00:31.327 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset -0.71Â°C â†’ applying -1Â°C (accumulator: -0.47Â°C, needs 0.53Â°C more to trigger)[0m
[32m2025-10-28 07:00:31.331 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to -1Â°C (calculated: -0.71Â°C, accumulator: -0.47Â°C)[0m
[36m2025-10-28 07:00:31.332 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=-1Â°C, original=-0.71Â°C, accumulator=-0.47Â°C[0m
[32m2025-10-28 07:00:31.332 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset -0.71Â°C to NIBE via MyUplink[0m
[36m2025-10-28 07:00:31.332 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.004 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 07:00:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-28 07:00:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.3Â°C, outdoor=8.2Â°C, offset=-0.7Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-28 07:00:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.3Â°C, outdoor=8.2Â°C, offset=-0.7Â°C, flow=30.0Â°C, DM=10[0m
[36m2025-10-28 07:00:31.336 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.2Â°C/h trend[0m
[36m2025-10-28 07:00:31.336 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 07:00:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 07:00:31.337 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 07:00:31.337 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=52.1[0m
[36m2025-10-28 07:00:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:00:31.343 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 07:00:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:00:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 07:00:31.347 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 07:00:31.347 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:00:31.347 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 07:00:31.347 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control rate limited: 40.0 min since last change (min 60 min)[0m
[36m2025-10-28 07:00:31.347 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.028 seconds (success: True)[0m
[36m2025-10-28 07:00:31.349 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.4 + 1.2 + 0.6)A Ã— 0.95 = 1.41 kW[0m
[36m2025-10-28 07:05:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 07:05:31.320 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.3Â°C (median of 9 sensors: 23.6Â°C, 21.0Â°C, 21.8Â°C, 23.1Â°C, 26.2Â°C, 23.8Â°C, 22.1Â°C, 23.3Â°C, 25.0Â°C)[0m
[36m2025-10-28 07:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = 11.0[0m
[36m2025-10-28 07:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 52.1Â°C[0m
[36m2025-10-28 07:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.0Â°C[0m
[36m2025-10-28 07:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.4A, L2=1.2A, L3=0.6A[0m
[36m2025-10-28 07:05:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.3Â°C, outdoor 8.2Â°C, flow 30.0Â°C, DM 11[0m
[36m2025-10-28 07:05:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor Hz not available from NIBE adapter[0m
[36m2025-10-28 07:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 07:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 07:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 07:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 07:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 07:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 07:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 07:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 07:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 07:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 07:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 67}[0m
[36m2025-10-28 07:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 07:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 07:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 07:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 07:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 07:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 07:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 07:05:31.321 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 07:05:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q28 = 95.91 Ã¶re/kWh[0m
[36m2025-10-28 07:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 07:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 07:05:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 07:05:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 07:05:31.322 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 07:05:31.322 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 07:05:31.322 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 07:05:31.323 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 07:05:31.323 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 07:05:31.323 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:05:31.323 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 07:05:31.323 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:05:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 07:05:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 07:05:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 07:05:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 07:05:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=30.0Â°C, error=-3.6Â°C, sensitivity=1.5 -> offset=-2.4[0m
[36m2025-10-28 07:05:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 07:05:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.0Â°C â†’ offset: -2.4Â°C; Weight: 0.24[0m
[36m2025-10-28 07:05:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Price classification Q28 (07:05): 95.91 â†’ NORMAL[0m
[32m2025-10-28 07:05:31.324 INFO (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.71Â°C - Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.0Â°C â†’ offset: -2.4Â°C; Weight: 0.24 | GE-Spot Q28: NORMAL (day) | Too warm: 2.3Â°C over[0m
[32m2025-10-28 07:05:31.325 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.71Â°C, reasoning: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.0Â°C â†’ offset: -2.4Â°C; Weight: 0.24 | GE-Spot Q28: NORMAL (day) | Too warm: 2.3Â°C over[0m
[36m2025-10-28 07:05:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset -0.71Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-28 07:05:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.000 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 07:05:31.325 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-28 07:05:31.325 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.3Â°C, outdoor=8.2Â°C, offset=-0.7Â°C, change=-0.01Â°C, Î”t=0.08h[0m
[36m2025-10-28 07:05:31.325 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.3Â°C, outdoor=8.2Â°C, offset=-0.7Â°C, flow=30.0Â°C, DM=11[0m
[36m2025-10-28 07:05:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-28 07:05:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 07:05:31.328 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 07:05:31.328 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 07:05:31.328 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=52.1[0m
[36m2025-10-28 07:05:31.328 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:05:31.335 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 07:05:31.335 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:05:31.336 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 07:05:31.338 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 07:05:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:05:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 07:05:31.338 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control rate limited: 45.0 min since last change (min 60 min)[0m
[36m2025-10-28 07:05:31.338 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.019 seconds (success: True)[0m
[36m2025-10-28 07:05:31.340 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.4 + 1.2 + 0.6)A Ã— 0.95 = 1.41 kW[0m
[36m2025-10-28 07:10:31.319 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 07:10:31.319 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.3Â°C (median of 9 sensors: 23.6Â°C, 21.0Â°C, 21.8Â°C, 23.0Â°C, 26.1Â°C, 23.8Â°C, 22.1Â°C, 23.3Â°C, 25.0Â°C)[0m
[36m2025-10-28 07:10:31.319 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = 10.0[0m
[36m2025-10-28 07:10:31.319 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 52.1Â°C[0m
[36m2025-10-28 07:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.0Â°C[0m
[36m2025-10-28 07:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.4A, L2=1.2A, L3=0.6A[0m
[36m2025-10-28 07:10:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.3Â°C, outdoor 8.2Â°C, flow 30.0Â°C, DM 10[0m
[36m2025-10-28 07:10:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor Hz not available from NIBE adapter[0m
[36m2025-10-28 07:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 07:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 07:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 07:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 07:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 07:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 07:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 07:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 07:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 07:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 07:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 67}[0m
[36m2025-10-28 07:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 07:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 07:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 07:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 07:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 07:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 07:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 07:10:31.320 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 07:10:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q28 = 95.91 Ã¶re/kWh[0m
[36m2025-10-28 07:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 07:10:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 07:10:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 07:10:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 07:10:31.322 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 07:10:31.322 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 07:10:31.322 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 07:10:31.323 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 07:10:31.323 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 07:10:31.323 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:10:31.323 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 07:10:31.323 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:10:31.323 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 07:10:31.323 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 07:10:31.323 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 07:10:31.324 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 07:10:31.324 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=30.0Â°C, error=-3.6Â°C, sensitivity=1.5 -> offset=-2.4[0m
[36m2025-10-28 07:10:31.324 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 07:10:31.324 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.0Â°C â†’ offset: -2.4Â°C; Weight: 0.24[0m
[36m2025-10-28 07:10:31.324 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Price classification Q28 (07:10): 95.91 â†’ NORMAL[0m
[32m2025-10-28 07:10:31.324 INFO (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.71Â°C - Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.0Â°C â†’ offset: -2.4Â°C; Weight: 0.24 | GE-Spot Q28: NORMAL (day) | Too warm: 2.3Â°C over[0m
[32m2025-10-28 07:10:31.324 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.71Â°C, reasoning: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.0Â°C â†’ offset: -2.4Â°C; Weight: 0.24 | GE-Spot Q28: NORMAL (day) | Too warm: 2.3Â°C over[0m
[36m2025-10-28 07:10:31.324 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset -0.71Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-28 07:10:31.324 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.007 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 07:10:31.324 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.01 kW below 0.5 kW threshold[0m
[36m2025-10-28 07:10:31.324 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.3Â°C, outdoor=8.2Â°C, offset=-0.7Â°C, change=-0.03Â°C, Î”t=0.08h[0m
[36m2025-10-28 07:10:31.324 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.3Â°C, outdoor=8.2Â°C, offset=-0.7Â°C, flow=30.0Â°C, DM=10[0m
[36m2025-10-28 07:10:31.330 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.2Â°C/h trend[0m
[36m2025-10-28 07:10:31.330 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 07:10:31.333 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 07:10:31.333 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 07:10:31.333 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=52.1[0m
[36m2025-10-28 07:10:31.333 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:10:31.337 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 07:10:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:10:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 07:10:31.339 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 07:10:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:10:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 07:10:31.340 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control rate limited: 50.0 min since last change (min 60 min)[0m
[36m2025-10-28 07:10:31.340 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.021 seconds (success: True)[0m
[36m2025-10-28 07:10:31.341 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.4 + 1.2 + 0.6)A Ã— 0.95 = 1.41 kW[0m
[36m2025-10-28 07:15:31.319 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 07:15:31.319 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.2Â°C (median of 9 sensors: 23.6Â°C, 21.0Â°C, 21.8Â°C, 23.1Â°C, 26.0Â°C, 23.7Â°C, 22.1Â°C, 23.2Â°C, 25.0Â°C)[0m
[36m2025-10-28 07:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = 9.0[0m
[36m2025-10-28 07:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 52.1Â°C[0m
[36m2025-10-28 07:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.5Â°C[0m
[36m2025-10-28 07:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.4A, L2=1.2A, L3=0.6A[0m
[36m2025-10-28 07:15:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.2Â°C, outdoor 8.2Â°C, flow 30.5Â°C, DM 9[0m
[36m2025-10-28 07:15:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor Hz not available from NIBE adapter[0m
[36m2025-10-28 07:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 07:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 07:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 07:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 07:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 07:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 07:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 07:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 07:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 07:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 07:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 66}[0m
[36m2025-10-28 07:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 07:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 07:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 07:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 07:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 07:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 07:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 07:15:31.320 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 07:15:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q29 = 93.52 Ã¶re/kWh[0m
[36m2025-10-28 07:15:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 07:15:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 07:15:31.323 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 07:15:31.323 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 07:15:31.323 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 07:15:31.323 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 07:15:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 07:15:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 07:15:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 07:15:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:15:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 07:15:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:15:31.325 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 07:15:31.325 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 07:15:31.325 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 07:15:31.325 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 07:15:31.325 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=30.5Â°C, error=-4.1Â°C, sensitivity=1.5 -> offset=-2.7[0m
[36m2025-10-28 07:15:31.325 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 07:15:31.325 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.24[0m
[36m2025-10-28 07:15:31.325 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Price classification Q29 (07:15): 93.52 â†’ NORMAL[0m
[32m2025-10-28 07:15:31.325 INFO (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.76Â°C - Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.24 | GE-Spot Q29: NORMAL (day) | Too warm: 2.2Â°C over[0m
[32m2025-10-28 07:15:31.328 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.76Â°C, reasoning: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.24 | GE-Spot Q29: NORMAL (day) | Too warm: 2.2Â°C over[0m
[36m2025-10-28 07:15:31.328 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=-0.76Â°C, integer=0Â°C, fractional=-0.76Â°C, accumulator_before=-0.47Â°C[0m
[32m2025-10-28 07:15:31.328 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] âœ“ Accumulated fractional offset reached threshold: applying -1Â°C adjustment (accumulator: -1.23Â°C â†’ -0.23Â°C)[0m
[36m2025-10-28 07:15:31.328 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Accumulator triggered: total_accumulated=-1.23Â°C, adjustment=-1Â°C, new_integer=-1Â°C, remaining=-0.23Â°C[0m
[36m2025-10-28 07:15:31.328 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset -0.76Â°C â†’ applying -1Â°C (accumulator: -0.23Â°C, needs 0.77Â°C more to trigger)[0m
[32m2025-10-28 07:15:31.329 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to -1Â°C (calculated: -0.76Â°C, accumulator: -0.23Â°C)[0m
[36m2025-10-28 07:15:31.329 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=-1Â°C, original=-0.76Â°C, accumulator=-0.23Â°C[0m
[32m2025-10-28 07:15:31.329 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset -0.76Â°C to NIBE via MyUplink[0m
[36m2025-10-28 07:15:31.329 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.000 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 07:15:31.329 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-28 07:15:31.329 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.2Â°C, outdoor=8.2Â°C, offset=-0.8Â°C, change=-0.01Â°C, Î”t=0.08h[0m
[36m2025-10-28 07:15:31.329 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.2Â°C, outdoor=8.2Â°C, offset=-0.8Â°C, flow=30.5Â°C, DM=9[0m
[36m2025-10-28 07:15:31.337 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.2Â°C/h trend[0m
[36m2025-10-28 07:15:31.338 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 07:15:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 07:15:31.340 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 07:15:31.340 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=52.1[0m
[36m2025-10-28 07:15:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:15:31.343 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 07:15:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:15:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 07:15:31.345 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 07:15:31.345 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:15:31.345 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 07:15:31.345 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control rate limited: 55.0 min since last change (min 60 min)[0m
[36m2025-10-28 07:15:31.346 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.026 seconds (success: True)[0m
[36m2025-10-28 07:15:31.347 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.4 + 1.2 + 0.6)A Ã— 0.95 = 1.41 kW[0m
[36m2025-10-28 07:20:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 07:20:31.320 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.2Â°C (median of 9 sensors: 23.6Â°C, 21.0Â°C, 21.8Â°C, 23.1Â°C, 26.0Â°C, 23.7Â°C, 22.1Â°C, 23.2Â°C, 25.0Â°C)[0m
[36m2025-10-28 07:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = 7.0[0m
[36m2025-10-28 07:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 52.1Â°C[0m
[36m2025-10-28 07:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.5Â°C[0m
[36m2025-10-28 07:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.4A, L2=1.2A, L3=0.6A[0m
[36m2025-10-28 07:20:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.2Â°C, outdoor 8.2Â°C, flow 30.5Â°C, DM 7[0m
[36m2025-10-28 07:20:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor Hz not available from NIBE adapter[0m
[36m2025-10-28 07:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 07:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 07:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 07:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 07:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 07:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 07:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 07:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 07:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 07:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 07:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 66}[0m
[36m2025-10-28 07:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 07:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 07:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 07:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 07:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 07:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 07:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 07:20:31.321 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 07:20:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q29 = 93.52 Ã¶re/kWh[0m
[36m2025-10-28 07:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 07:20:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 07:20:31.323 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 07:20:31.323 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 07:20:31.323 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 07:20:31.323 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 07:20:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 07:20:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 07:20:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 07:20:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:20:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 07:20:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:20:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 07:20:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 07:20:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 07:20:31.325 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 07:20:31.325 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=30.5Â°C, error=-4.1Â°C, sensitivity=1.5 -> offset=-2.7[0m
[36m2025-10-28 07:20:31.325 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 07:20:31.325 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.24[0m
[36m2025-10-28 07:20:31.325 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Price classification Q29 (07:20): 93.52 â†’ NORMAL[0m
[32m2025-10-28 07:20:31.325 INFO (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.75Â°C - Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.24 | GE-Spot Q29: NORMAL (day) | Too warm: 2.2Â°C over[0m
[32m2025-10-28 07:20:31.325 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.75Â°C, reasoning: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.24 | GE-Spot Q29: NORMAL (day) | Too warm: 2.2Â°C over[0m
[36m2025-10-28 07:20:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset -0.75Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-28 07:20:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.000 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 07:20:31.325 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-28 07:20:31.325 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.2Â°C, outdoor=8.2Â°C, offset=-0.8Â°C, change=-0.03Â°C, Î”t=0.08h[0m
[36m2025-10-28 07:20:31.325 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.2Â°C, outdoor=8.2Â°C, offset=-0.8Â°C, flow=30.5Â°C, DM=7[0m
[36m2025-10-28 07:20:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-28 07:20:31.326 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 07:20:31.331 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 07:20:31.331 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 07:20:31.331 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=52.1[0m
[36m2025-10-28 07:20:31.331 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:20:31.333 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 07:20:31.333 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:20:31.333 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 07:20:31.337 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 07:20:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:20:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 07:20:31.338 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control rate limited: 60.0 min since last change (min 60 min)[0m
[36m2025-10-28 07:20:31.338 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.018 seconds (success: True)[0m
[36m2025-10-28 07:20:31.339 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.4 + 1.2 + 0.6)A Ã— 0.95 = 1.41 kW[0m
[36m2025-10-28 07:25:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 07:25:31.320 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.2Â°C (median of 9 sensors: 23.6Â°C, 21.1Â°C, 21.9Â°C, 23.1Â°C, 25.9Â°C, 23.7Â°C, 22.1Â°C, 23.2Â°C, 25.0Â°C)[0m
[36m2025-10-28 07:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = 5.0[0m
[36m2025-10-28 07:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 52.1Â°C[0m
[36m2025-10-28 07:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.5Â°C[0m
[36m2025-10-28 07:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.4A, L2=1.2A, L3=0.6A[0m
[36m2025-10-28 07:25:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.2Â°C, outdoor 8.2Â°C, flow 30.5Â°C, DM 5[0m
[36m2025-10-28 07:25:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor Hz not available from NIBE adapter[0m
[36m2025-10-28 07:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 07:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 07:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 07:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 07:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 07:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 07:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 07:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 07:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 07:25:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 07:25:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 66}[0m
[36m2025-10-28 07:25:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 07:25:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 07:25:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 07:25:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 07:25:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 07:25:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 07:25:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 07:25:31.321 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 07:25:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q29 = 93.52 Ã¶re/kWh[0m
[36m2025-10-28 07:25:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 07:25:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 07:25:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 07:25:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 07:25:31.323 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 07:25:31.323 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 07:25:31.323 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 07:25:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 07:25:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 07:25:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:25:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 07:25:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:25:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 07:25:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 07:25:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 07:25:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 07:25:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=30.5Â°C, error=-4.1Â°C, sensitivity=1.5 -> offset=-2.7[0m
[36m2025-10-28 07:25:31.324 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 07:25:31.325 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.24[0m
[36m2025-10-28 07:25:31.325 DEBUG (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Price classification Q29 (07:25): 93.52 â†’ NORMAL[0m
[32m2025-10-28 07:25:31.325 INFO (SyncWorker_0) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.75Â°C - Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.24 | GE-Spot Q29: NORMAL (day) | Too warm: 2.2Â°C over[0m
[32m2025-10-28 07:25:31.325 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.75Â°C, reasoning: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.24 | GE-Spot Q29: NORMAL (day) | Too warm: 2.2Â°C over[0m
[36m2025-10-28 07:25:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset -0.75Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-28 07:25:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.021 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 07:25:31.325 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.02 kW below 0.5 kW threshold[0m
[36m2025-10-28 07:25:31.325 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.2Â°C, outdoor=8.2Â°C, offset=-0.8Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-28 07:25:31.325 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.2Â°C, outdoor=8.2Â°C, offset=-0.8Â°C, flow=30.5Â°C, DM=5[0m
[36m2025-10-28 07:25:31.330 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.2Â°C/h trend[0m
[36m2025-10-28 07:25:31.330 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 07:25:31.336 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 07:25:31.336 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 07:25:31.336 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=52.1[0m
[36m2025-10-28 07:25:31.336 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:25:31.339 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 07:25:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:25:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 07:25:31.341 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 07:25:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:25:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 07:25:31.341 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 07:25:31.341 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.022 seconds (success: True)[0m
[36m2025-10-28 07:25:31.343 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.4 + 1.2 + 0.6)A Ã— 0.95 = 1.41 kW[0m
[33m2025-10-28 07:29:01.280 WARNING (MainThread) [homeassistant.components.automation.led_tak_groventre] LED TAK GROVENTRE: Already running[0m
[36m2025-10-28 07:30:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 07:30:31.321 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.2Â°C (median of 9 sensors: 23.6Â°C, 21.1Â°C, 21.9Â°C, 23.1Â°C, 25.9Â°C, 23.7Â°C, 22.3Â°C, 23.2Â°C, 25.0Â°C)[0m
[36m2025-10-28 07:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = 4.0[0m
[36m2025-10-28 07:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 52.1Â°C[0m
[36m2025-10-28 07:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.5Â°C[0m
[36m2025-10-28 07:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.4A, L2=1.2A, L3=0.6A[0m
[36m2025-10-28 07:30:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.2Â°C, outdoor 8.2Â°C, flow 30.5Â°C, DM 4[0m
[36m2025-10-28 07:30:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor Hz not available from NIBE adapter[0m
[36m2025-10-28 07:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 07:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 07:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 07:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 07:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 07:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 07:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 07:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 07:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 07:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 07:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 65}[0m
[36m2025-10-28 07:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 07:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 07:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 07:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 07:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 07:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 07:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 07:30:31.322 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 07:30:31.322 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q30 = 86.22 Ã¶re/kWh[0m
[36m2025-10-28 07:30:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 07:30:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 07:30:31.323 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 07:30:31.323 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 07:30:31.323 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 07:30:31.323 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 07:30:31.323 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 07:30:31.324 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 07:30:31.324 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 07:30:31.324 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:30:31.325 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 07:30:31.325 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:30:31.325 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 07:30:31.326 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 07:30:31.326 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 07:30:31.326 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 07:30:31.326 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=30.5Â°C, error=-4.1Â°C, sensitivity=1.5 -> offset=-2.7[0m
[36m2025-10-28 07:30:31.326 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 07:30:31.326 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.24[0m
[36m2025-10-28 07:30:31.326 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Price classification Q30 (07:30): 86.22 â†’ NORMAL[0m
[32m2025-10-28 07:30:31.326 INFO (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.75Â°C - Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.24 | GE-Spot Q30: NORMAL (day) | Too warm: 2.2Â°C over[0m
[32m2025-10-28 07:30:31.327 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.75Â°C, reasoning: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.24 | GE-Spot Q30: NORMAL (day) | Too warm: 2.2Â°C over[0m
[36m2025-10-28 07:30:31.327 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=-0.75Â°C, integer=0Â°C, fractional=-0.75Â°C, accumulator_before=-0.23Â°C[0m
[36m2025-10-28 07:30:31.327 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â¸ Skipping NIBE write: offset rounds to 0Â°C (accumulator: -0.98Â°C, will apply when â‰¥Â±1.0Â°C)[0m
[36m2025-10-28 07:30:31.327 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset -0.75Â°C deferred (accumulating fractional changes or rate limited)[0m
[36m2025-10-28 07:30:31.327 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.011 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 07:30:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.01 kW below 0.5 kW threshold[0m
[36m2025-10-28 07:30:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.2Â°C, outdoor=8.2Â°C, offset=-0.7Â°C, change=-0.03Â°C, Î”t=0.08h[0m
[36m2025-10-28 07:30:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.2Â°C, outdoor=8.2Â°C, offset=-0.7Â°C, flow=30.5Â°C, DM=4[0m
[36m2025-10-28 07:30:31.333 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.2Â°C/h trend[0m
[36m2025-10-28 07:30:31.333 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 07:30:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 07:30:31.337 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 07:30:31.337 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=52.1[0m
[36m2025-10-28 07:30:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:30:31.340 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 07:30:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:30:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 07:30:31.342 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 07:30:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:30:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 07:30:31.342 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 07:30:31.343 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.022 seconds (success: True)[0m
[36m2025-10-28 07:30:31.344 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.4 + 1.2 + 0.6)A Ã— 0.95 = 1.41 kW[0m
[36m2025-10-28 07:35:31.319 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 07:35:31.320 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.2Â°C (median of 9 sensors: 23.6Â°C, 21.1Â°C, 21.8Â°C, 23.1Â°C, 26.0Â°C, 23.7Â°C, 22.3Â°C, 23.2Â°C, 25.0Â°C)[0m
[36m2025-10-28 07:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = 2.0[0m
[36m2025-10-28 07:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 52.1Â°C[0m
[36m2025-10-28 07:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.5Â°C[0m
[36m2025-10-28 07:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.4A, L2=1.2A, L3=0.6A[0m
[36m2025-10-28 07:35:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.2Â°C, outdoor 8.2Â°C, flow 30.5Â°C, DM 2[0m
[36m2025-10-28 07:35:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor Hz not available from NIBE adapter[0m
[36m2025-10-28 07:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 07:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 07:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 07:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 07:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 07:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 07:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 07:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 07:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 07:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 07:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 65}[0m
[36m2025-10-28 07:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 07:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 07:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 07:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 07:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 07:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 07:35:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 07:35:31.321 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 07:35:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q30 = 86.22 Ã¶re/kWh[0m
[36m2025-10-28 07:35:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 07:35:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 07:35:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 07:35:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 07:35:31.322 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 07:35:31.322 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 07:35:31.322 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 07:35:31.323 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 07:35:31.323 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 07:35:31.323 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:35:31.323 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 07:35:31.323 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:35:31.323 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 07:35:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 07:35:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 07:35:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 07:35:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=30.5Â°C, error=-4.1Â°C, sensitivity=1.5 -> offset=-2.7[0m
[36m2025-10-28 07:35:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 07:35:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.24[0m
[36m2025-10-28 07:35:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Price classification Q30 (07:35): 86.22 â†’ NORMAL[0m
[32m2025-10-28 07:35:31.324 INFO (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.74Â°C - Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.24 | GE-Spot Q30: NORMAL (day) | Too warm: 2.2Â°C over[0m
[32m2025-10-28 07:35:31.326 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.74Â°C, reasoning: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.24 | GE-Spot Q30: NORMAL (day) | Too warm: 2.2Â°C over[0m
[36m2025-10-28 07:35:31.326 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=-0.74Â°C, integer=0Â°C, fractional=-0.74Â°C, accumulator_before=-0.98Â°C[0m
[32m2025-10-28 07:35:31.326 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] âœ“ Accumulated fractional offset reached threshold: applying -1Â°C adjustment (accumulator: -1.72Â°C â†’ -0.72Â°C)[0m
[36m2025-10-28 07:35:31.326 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Accumulator triggered: total_accumulated=-1.72Â°C, adjustment=-1Â°C, new_integer=-1Â°C, remaining=-0.72Â°C[0m
[36m2025-10-28 07:35:31.326 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset -0.74Â°C â†’ applying -1Â°C (accumulator: -0.72Â°C, needs 0.28Â°C more to trigger)[0m
[32m2025-10-28 07:35:31.327 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to -1Â°C (calculated: -0.74Â°C, accumulator: -0.72Â°C)[0m
[36m2025-10-28 07:35:31.327 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=-1Â°C, original=-0.74Â°C, accumulator=-0.72Â°C[0m
[32m2025-10-28 07:35:31.327 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset -0.74Â°C to NIBE via MyUplink[0m
[36m2025-10-28 07:35:31.327 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.004 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 07:35:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-28 07:35:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.2Â°C, outdoor=8.2Â°C, offset=-0.7Â°C, change=-0.03Â°C, Î”t=0.08h[0m
[36m2025-10-28 07:35:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.2Â°C, outdoor=8.2Â°C, offset=-0.7Â°C, flow=30.5Â°C, DM=2[0m
[36m2025-10-28 07:35:31.332 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.2Â°C/h trend[0m
[36m2025-10-28 07:35:31.332 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 07:35:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 07:35:31.337 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 07:35:31.337 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=52.1[0m
[36m2025-10-28 07:35:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:35:31.341 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 07:35:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:35:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 07:35:31.345 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 07:35:31.345 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:35:31.345 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 07:35:31.345 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 07:35:31.346 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.026 seconds (success: True)[0m
[36m2025-10-28 07:35:31.347 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.4 + 1.2 + 0.6)A Ã— 0.95 = 1.41 kW[0m
[36m2025-10-28 07:40:31.319 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 07:40:31.320 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.2Â°C (median of 9 sensors: 23.6Â°C, 21.1Â°C, 21.9Â°C, 23.2Â°C, 25.9Â°C, 23.6Â°C, 22.3Â°C, 23.2Â°C, 25.0Â°C)[0m
[36m2025-10-28 07:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -2.0[0m
[36m2025-10-28 07:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 52.1Â°C[0m
[36m2025-10-28 07:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.5Â°C[0m
[36m2025-10-28 07:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.4A, L2=1.2A, L3=0.6A[0m
[36m2025-10-28 07:40:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.2Â°C, outdoor 8.2Â°C, flow 30.5Â°C, DM -2[0m
[36m2025-10-28 07:40:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor Hz not available from NIBE adapter[0m
[36m2025-10-28 07:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 07:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 07:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 07:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 07:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 07:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 07:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 07:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 07:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 07:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 07:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 65}[0m
[36m2025-10-28 07:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 07:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 07:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 07:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 07:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 07:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 07:40:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 07:40:31.321 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 07:40:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q30 = 86.22 Ã¶re/kWh[0m
[36m2025-10-28 07:40:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 07:40:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 07:40:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 07:40:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 07:40:31.322 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 07:40:31.322 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 07:40:31.322 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 07:40:31.323 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 07:40:31.323 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 07:40:31.323 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:40:31.323 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 07:40:31.323 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:40:31.323 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 07:40:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 07:40:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 07:40:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 07:40:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=30.5Â°C, error=-4.1Â°C, sensitivity=1.5 -> offset=-2.7[0m
[36m2025-10-28 07:40:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 07:40:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.24[0m
[36m2025-10-28 07:40:31.324 DEBUG (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Price classification Q30 (07:40): 86.22 â†’ NORMAL[0m
[32m2025-10-28 07:40:31.324 INFO (SyncWorker_7) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.75Â°C - Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.24 | GE-Spot Q30: NORMAL (day) | Too warm: 2.2Â°C over[0m
[32m2025-10-28 07:40:31.325 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.75Â°C, reasoning: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.24 | GE-Spot Q30: NORMAL (day) | Too warm: 2.2Â°C over[0m
[36m2025-10-28 07:40:31.326 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset -0.75Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-28 07:40:31.326 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.001 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 07:40:31.326 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-28 07:40:31.326 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.2Â°C, outdoor=8.2Â°C, offset=-0.7Â°C, change=0.01Â°C, Î”t=0.08h[0m
[36m2025-10-28 07:40:31.326 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.2Â°C, outdoor=8.2Â°C, offset=-0.7Â°C, flow=30.5Â°C, DM=-2[0m
[36m2025-10-28 07:40:31.326 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-28 07:40:31.326 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 07:40:31.331 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 07:40:31.331 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 07:40:31.331 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=52.1[0m
[36m2025-10-28 07:40:31.331 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:40:31.336 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 07:40:31.336 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:40:31.336 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 07:40:31.338 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 07:40:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:40:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 07:40:31.339 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 07:40:31.339 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.020 seconds (success: True)[0m
[36m2025-10-28 07:40:31.340 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.4 + 1.2 + 0.6)A Ã— 0.95 = 1.41 kW[0m
[36m2025-10-28 07:45:31.319 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 07:45:31.320 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.2Â°C (median of 9 sensors: 23.6Â°C, 21.1Â°C, 21.9Â°C, 23.1Â°C, 25.8Â°C, 23.6Â°C, 22.3Â°C, 23.2Â°C, 25.0Â°C)[0m
[36m2025-10-28 07:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -5.0[0m
[36m2025-10-28 07:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 52.1Â°C[0m
[36m2025-10-28 07:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.5Â°C[0m
[36m2025-10-28 07:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.0A, L2=1.2A, L3=0.6A[0m
[36m2025-10-28 07:45:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.2Â°C, outdoor 8.2Â°C, flow 30.5Â°C, DM -5[0m
[36m2025-10-28 07:45:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor Hz not available from NIBE adapter[0m
[36m2025-10-28 07:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 07:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 07:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 07:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 07:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 07:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 07:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 07:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 07:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 07:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 07:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 64}[0m
[36m2025-10-28 07:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 07:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 07:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 07:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 07:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 07:45:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 07:45:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 07:45:31.321 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 07:45:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q31 = 94.82 Ã¶re/kWh[0m
[36m2025-10-28 07:45:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 07:45:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 07:45:31.323 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 07:45:31.323 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 07:45:31.323 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 07:45:31.323 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 07:45:31.323 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 07:45:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 07:45:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 07:45:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:45:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 07:45:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:45:31.324 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 07:45:31.325 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 07:45:31.325 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 07:45:31.325 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 07:45:31.325 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=30.5Â°C, error=-4.1Â°C, sensitivity=1.5 -> offset=-2.7[0m
[36m2025-10-28 07:45:31.325 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 07:45:31.325 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.24[0m
[36m2025-10-28 07:45:31.325 DEBUG (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Price classification Q31 (07:45): 94.82 â†’ NORMAL[0m
[32m2025-10-28 07:45:31.325 INFO (SyncWorker_1) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.74Â°C - Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.24 | GE-Spot Q31: NORMAL (day) | Too warm: 2.2Â°C over[0m
[32m2025-10-28 07:45:31.326 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.74Â°C, reasoning: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.24 | GE-Spot Q31: NORMAL (day) | Too warm: 2.2Â°C over[0m
[36m2025-10-28 07:45:31.326 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset -0.74Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-28 07:45:31.326 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.019 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 07:45:31.326 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.02 kW below 0.5 kW threshold[0m
[36m2025-10-28 07:45:31.326 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.2Â°C, outdoor=8.2Â°C, offset=-0.7Â°C, change=-0.01Â°C, Î”t=0.08h[0m
[36m2025-10-28 07:45:31.326 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.2Â°C, outdoor=8.2Â°C, offset=-0.7Â°C, flow=30.5Â°C, DM=-5[0m
[36m2025-10-28 07:45:31.331 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.2Â°C/h trend[0m
[36m2025-10-28 07:45:31.331 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 07:45:31.337 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved learned data to storage[0m
[36m2025-10-28 07:45:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 07:45:31.337 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 07:45:31.338 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=52.1[0m
[36m2025-10-28 07:45:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:45:31.340 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 07:45:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:45:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 07:45:31.343 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 07:45:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:45:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 07:45:31.343 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 07:45:31.343 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.024 seconds (success: True)[0m
[36m2025-10-28 07:45:31.344 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.0 + 1.2 + 0.6)A Ã— 0.95 = 1.32 kW[0m
[36m2025-10-28 07:50:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 07:50:31.320 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.1Â°C (median of 9 sensors: 23.6Â°C, 21.1Â°C, 21.9Â°C, 23.0Â°C, 25.8Â°C, 23.6Â°C, 22.3Â°C, 23.1Â°C, 25.0Â°C)[0m
[36m2025-10-28 07:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -7.0[0m
[36m2025-10-28 07:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 52.1Â°C[0m
[36m2025-10-28 07:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.5Â°C[0m
[36m2025-10-28 07:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.3A, L2=1.2A, L3=0.6A[0m
[36m2025-10-28 07:50:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.1Â°C, outdoor 8.2Â°C, flow 30.5Â°C, DM -7[0m
[36m2025-10-28 07:50:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor Hz not available from NIBE adapter[0m
[36m2025-10-28 07:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 07:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 07:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 07:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 07:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 07:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 07:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 07:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 07:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 07:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 07:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 64}[0m
[36m2025-10-28 07:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 07:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 07:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 07:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 07:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 07:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 07:50:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 07:50:31.322 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 07:50:31.322 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q31 = 94.82 Ã¶re/kWh[0m
[36m2025-10-28 07:50:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 07:50:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 07:50:31.323 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 07:50:31.323 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 07:50:31.323 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 07:50:31.323 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 07:50:31.323 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 07:50:31.324 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 07:50:31.324 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 07:50:31.324 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:50:31.324 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 07:50:31.324 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:50:31.324 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 07:50:31.325 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 07:50:31.325 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 07:50:31.325 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 07:50:31.325 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=30.5Â°C, error=-4.1Â°C, sensitivity=1.5 -> offset=-2.7[0m
[36m2025-10-28 07:50:31.325 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 07:50:31.325 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.24[0m
[36m2025-10-28 07:50:31.325 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Price classification Q31 (07:50): 94.82 â†’ NORMAL[0m
[32m2025-10-28 07:50:31.325 INFO (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.74Â°C - Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.24 | GE-Spot Q31: NORMAL (day) | Too warm: 2.1Â°C over[0m
[32m2025-10-28 07:50:31.326 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.74Â°C, reasoning: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.24 | GE-Spot Q31: NORMAL (day) | Too warm: 2.1Â°C over[0m
[36m2025-10-28 07:50:31.326 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset -0.74Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-28 07:50:31.326 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.000 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 07:50:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-28 07:50:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.1Â°C, outdoor=8.2Â°C, offset=-0.7Â°C, change=-0.01Â°C, Î”t=0.08h[0m
[36m2025-10-28 07:50:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.1Â°C, outdoor=8.2Â°C, offset=-0.7Â°C, flow=30.5Â°C, DM=-7[0m
[36m2025-10-28 07:50:31.331 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.2Â°C/h trend[0m
[36m2025-10-28 07:50:31.331 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 07:50:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 07:50:31.334 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 07:50:31.334 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=52.1[0m
[36m2025-10-28 07:50:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:50:31.340 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 07:50:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:50:31.340 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 07:50:31.343 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 07:50:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:50:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 07:50:31.343 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 07:50:31.343 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.023 seconds (success: True)[0m
[36m2025-10-28 07:50:31.344 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.3 + 1.2 + 0.6)A Ã— 0.95 = 1.39 kW[0m
[36m2025-10-28 07:55:31.319 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 07:55:31.319 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.1Â°C (median of 9 sensors: 23.6Â°C, 21.1Â°C, 21.8Â°C, 23.0Â°C, 25.8Â°C, 23.6Â°C, 22.5Â°C, 23.1Â°C, 25.0Â°C)[0m
[36m2025-10-28 07:55:31.319 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -10.0[0m
[36m2025-10-28 07:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 52.1Â°C[0m
[36m2025-10-28 07:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.5Â°C[0m
[36m2025-10-28 07:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.3A, L2=1.2A, L3=0.6A[0m
[36m2025-10-28 07:55:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.1Â°C, outdoor 8.2Â°C, flow 30.5Â°C, DM -10[0m
[36m2025-10-28 07:55:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor Hz not available from NIBE adapter[0m
[36m2025-10-28 07:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 07:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 07:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 07:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 07:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 07:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 07:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 07:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 07:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 07:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 07:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 64}[0m
[36m2025-10-28 07:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 07:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 07:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 07:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 07:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 07:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 07:55:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 07:55:31.320 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 07:55:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q31 = 94.82 Ã¶re/kWh[0m
[36m2025-10-28 07:55:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 07:55:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 07:55:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 07:55:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 07:55:31.322 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 07:55:31.322 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 07:55:31.322 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 07:55:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 07:55:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 07:55:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:55:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 07:55:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:55:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 07:55:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 07:55:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 07:55:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 07:55:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=30.5Â°C, error=-4.1Â°C, sensitivity=1.5 -> offset=-2.7[0m
[36m2025-10-28 07:55:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 07:55:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.24[0m
[36m2025-10-28 07:55:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Price classification Q31 (07:55): 94.82 â†’ NORMAL[0m
[32m2025-10-28 07:55:31.324 INFO (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.74Â°C - Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.24 | GE-Spot Q31: NORMAL (day) | Too warm: 2.1Â°C over[0m
[32m2025-10-28 07:55:31.324 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.74Â°C, reasoning: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.24 | GE-Spot Q31: NORMAL (day) | Too warm: 2.1Â°C over[0m
[36m2025-10-28 07:55:31.324 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset -0.74Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-28 07:55:31.324 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.000 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 07:55:31.324 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-28 07:55:31.324 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.1Â°C, outdoor=8.2Â°C, offset=-0.7Â°C, change=-0.01Â°C, Î”t=0.08h[0m
[36m2025-10-28 07:55:31.324 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.1Â°C, outdoor=8.2Â°C, offset=-0.7Â°C, flow=30.5Â°C, DM=-10[0m
[36m2025-10-28 07:55:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-28 07:55:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 07:55:31.328 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 07:55:31.328 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 07:55:31.329 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=52.1[0m
[36m2025-10-28 07:55:31.329 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:55:31.331 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 07:55:31.331 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:55:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 07:55:31.333 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 07:55:31.333 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 07:55:31.333 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 07:55:31.334 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 07:55:31.334 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.015 seconds (success: True)[0m
[36m2025-10-28 07:55:31.335 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.3 + 1.2 + 0.6)A Ã— 0.95 = 1.39 kW[0m
[36m2025-10-28 08:00:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 08:00:31.321 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.1Â°C (median of 9 sensors: 23.6Â°C, 21.1Â°C, 21.9Â°C, 23.0Â°C, 25.8Â°C, 23.6Â°C, 22.5Â°C, 23.1Â°C, 25.0Â°C)[0m
[36m2025-10-28 08:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -14.0[0m
[36m2025-10-28 08:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 52.1Â°C[0m
[36m2025-10-28 08:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.5Â°C[0m
[36m2025-10-28 08:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.3A, L2=1.2A, L3=0.6A[0m
[36m2025-10-28 08:00:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.1Â°C, outdoor 8.2Â°C, flow 30.5Â°C, DM -14[0m
[36m2025-10-28 08:00:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor Hz not available from NIBE adapter[0m
[36m2025-10-28 08:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 08:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 08:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 08:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 08:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 08:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 08:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 08:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 08:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 08:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 08:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 63}[0m
[36m2025-10-28 08:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 08:00:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 08:00:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 08:00:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 08:00:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 08:00:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 08:00:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 08:00:31.322 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 08:00:31.322 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q32 = 110.16 Ã¶re/kWh[0m
[36m2025-10-28 08:00:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 08:00:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 08:00:31.323 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 08:00:31.323 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 08:00:31.323 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 08:00:31.323 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 08:00:31.323 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 08:00:31.324 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 08:00:31.324 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 08:00:31.324 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 08:00:31.324 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 08:00:31.324 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 08:00:31.325 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 08:00:31.325 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 08:00:31.325 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 08:00:31.325 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 08:00:31.325 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=30.5Â°C, error=-4.1Â°C, sensitivity=1.5 -> offset=-2.7[0m
[36m2025-10-28 08:00:31.325 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 08:00:31.325 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.24[0m
[36m2025-10-28 08:00:31.325 DEBUG (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Price classification Q32 (08:00): 110.16 â†’ EXPENSIVE[0m
[32m2025-10-28 08:00:31.325 INFO (SyncWorker_2) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.89Â°C - Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.24 | GE-Spot Q32: EXPENSIVE (day) | Too warm: 2.1Â°C over[0m
[32m2025-10-28 08:00:31.326 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.89Â°C, reasoning: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.24 | GE-Spot Q32: EXPENSIVE (day) | Too warm: 2.1Â°C over[0m
[36m2025-10-28 08:00:31.326 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=-0.89Â°C, integer=0Â°C, fractional=-0.89Â°C, accumulator_before=-0.72Â°C[0m
[32m2025-10-28 08:00:31.326 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] âœ“ Accumulated fractional offset reached threshold: applying -1Â°C adjustment (accumulator: -1.60Â°C â†’ -0.60Â°C)[0m
[36m2025-10-28 08:00:31.326 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Accumulator triggered: total_accumulated=-1.60Â°C, adjustment=-1Â°C, new_integer=-1Â°C, remaining=-0.60Â°C[0m
[36m2025-10-28 08:00:31.326 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset -0.89Â°C â†’ applying -1Â°C (accumulator: -0.60Â°C, needs 0.40Â°C more to trigger)[0m
[32m2025-10-28 08:00:31.327 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to -1Â°C (calculated: -0.89Â°C, accumulator: -0.60Â°C)[0m
[36m2025-10-28 08:00:31.327 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=-1Â°C, original=-0.89Â°C, accumulator=-0.60Â°C[0m
[32m2025-10-28 08:00:31.327 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset -0.89Â°C to NIBE via MyUplink[0m
[36m2025-10-28 08:00:31.327 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.013 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 08:00:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.01 kW below 0.5 kW threshold[0m
[36m2025-10-28 08:00:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.1Â°C, outdoor=8.2Â°C, offset=-0.9Â°C, change=-0.03Â°C, Î”t=0.08h[0m
[36m2025-10-28 08:00:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.1Â°C, outdoor=8.2Â°C, offset=-0.9Â°C, flow=30.5Â°C, DM=-14[0m
[36m2025-10-28 08:00:31.339 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.2Â°C/h trend[0m
[36m2025-10-28 08:00:31.339 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 08:00:31.342 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 08:00:31.342 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 08:00:31.342 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=52.1[0m
[36m2025-10-28 08:00:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 08:00:31.345 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 08:00:31.345 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 08:00:31.345 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 08:00:31.348 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 08:00:31.348 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 08:00:31.349 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 08:00:31.349 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 08:00:31.349 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.028 seconds (success: True)[0m
[36m2025-10-28 08:00:31.350 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.3 + 1.2 + 0.6)A Ã— 0.95 = 1.39 kW[0m
[36m2025-10-28 08:05:31.319 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 08:05:31.320 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.1Â°C (median of 9 sensors: 23.6Â°C, 21.2Â°C, 22.0Â°C, 23.0Â°C, 25.8Â°C, 23.6Â°C, 22.5Â°C, 23.1Â°C, 25.0Â°C)[0m
[36m2025-10-28 08:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -19.0[0m
[36m2025-10-28 08:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 52.1Â°C[0m
[36m2025-10-28 08:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.5Â°C[0m
[36m2025-10-28 08:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.3A, L2=1.2A, L3=0.6A[0m
[36m2025-10-28 08:05:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.1Â°C, outdoor 8.2Â°C, flow 30.5Â°C, DM -19[0m
[36m2025-10-28 08:05:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor Hz not available from NIBE adapter[0m
[36m2025-10-28 08:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 08:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 08:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 08:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 08:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 08:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 08:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 08:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 08:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 08:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 08:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 63}[0m
[36m2025-10-28 08:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 08:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 08:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 08:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 08:05:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 08:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 08:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 08:05:31.321 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 08:05:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q32 = 110.16 Ã¶re/kWh[0m
[36m2025-10-28 08:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 08:05:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 08:05:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 08:05:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 08:05:31.322 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 08:05:31.322 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 08:05:31.322 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 08:05:31.323 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 08:05:31.323 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 08:05:31.323 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 08:05:31.323 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 08:05:31.323 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 08:05:31.323 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 08:05:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 08:05:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 08:05:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 08:05:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=30.5Â°C, error=-4.1Â°C, sensitivity=1.5 -> offset=-2.7[0m
[36m2025-10-28 08:05:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 08:05:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.24[0m
[36m2025-10-28 08:05:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Price classification Q32 (08:05): 110.16 â†’ EXPENSIVE[0m
[32m2025-10-28 08:05:31.324 INFO (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.88Â°C - Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.24 | GE-Spot Q32: EXPENSIVE (day) | Too warm: 2.1Â°C over[0m
[32m2025-10-28 08:05:31.325 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.88Â°C, reasoning: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.24 | GE-Spot Q32: EXPENSIVE (day) | Too warm: 2.1Â°C over[0m
[36m2025-10-28 08:05:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset -0.88Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-28 08:05:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.003 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 08:05:31.325 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-28 08:05:31.325 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.1Â°C, outdoor=8.2Â°C, offset=-0.9Â°C, change=-0.02Â°C, Î”t=0.08h[0m
[36m2025-10-28 08:05:31.325 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.1Â°C, outdoor=8.2Â°C, offset=-0.9Â°C, flow=30.5Â°C, DM=-19[0m
[36m2025-10-28 08:05:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-28 08:05:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 08:05:31.328 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 08:05:31.328 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 08:05:31.328 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=52.1[0m
[36m2025-10-28 08:05:31.329 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 08:05:31.333 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 08:05:31.333 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 08:05:31.333 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 08:05:31.335 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 08:05:31.335 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 08:05:31.335 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 08:05:31.335 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 08:05:31.335 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.016 seconds (success: True)[0m
[36m2025-10-28 08:05:31.336 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.3 + 1.2 + 0.6)A Ã— 0.95 = 1.39 kW[0m
[36m2025-10-28 08:10:31.319 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 08:10:31.319 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.1Â°C (median of 9 sensors: 23.6Â°C, 21.2Â°C, 21.9Â°C, 22.9Â°C, 25.7Â°C, 23.6Â°C, 22.5Â°C, 23.1Â°C, 25.0Â°C)[0m
[36m2025-10-28 08:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -23.0[0m
[36m2025-10-28 08:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 52.1Â°C[0m
[36m2025-10-28 08:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.5Â°C[0m
[36m2025-10-28 08:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.3A, L2=1.2A, L3=0.6A[0m
[36m2025-10-28 08:10:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.1Â°C, outdoor 8.2Â°C, flow 30.5Â°C, DM -23[0m
[36m2025-10-28 08:10:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor Hz not available from NIBE adapter[0m
[36m2025-10-28 08:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 08:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 08:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 08:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 08:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 08:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 08:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 08:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 08:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 08:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 08:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 63}[0m
[36m2025-10-28 08:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 08:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 08:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 08:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 08:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 08:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 08:10:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 08:10:31.321 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 08:10:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q32 = 110.16 Ã¶re/kWh[0m
[36m2025-10-28 08:10:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 08:10:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 08:10:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 08:10:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 08:10:31.322 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 08:10:31.322 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 08:10:31.322 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 08:10:31.323 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 08:10:31.323 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 08:10:31.323 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 08:10:31.323 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 08:10:31.323 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 08:10:31.323 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 08:10:31.324 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 08:10:31.324 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 08:10:31.324 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 08:10:31.324 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=30.5Â°C, error=-4.1Â°C, sensitivity=1.5 -> offset=-2.7[0m
[36m2025-10-28 08:10:31.324 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 08:10:31.324 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.24[0m
[36m2025-10-28 08:10:31.324 DEBUG (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Price classification Q32 (08:10): 110.16 â†’ EXPENSIVE[0m
[32m2025-10-28 08:10:31.324 INFO (SyncWorker_6) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.88Â°C - Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.24 | GE-Spot Q32: EXPENSIVE (day) | Too warm: 2.1Â°C over[0m
[32m2025-10-28 08:10:31.325 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.88Â°C, reasoning: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.24 | GE-Spot Q32: EXPENSIVE (day) | Too warm: 2.1Â°C over[0m
[36m2025-10-28 08:10:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset -0.88Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-28 08:10:31.325 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.017 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 08:10:31.325 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.02 kW below 0.5 kW threshold[0m
[36m2025-10-28 08:10:31.325 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.1Â°C, outdoor=8.2Â°C, offset=-0.9Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-28 08:10:31.325 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.1Â°C, outdoor=8.2Â°C, offset=-0.9Â°C, flow=30.5Â°C, DM=-23[0m
[36m2025-10-28 08:10:31.329 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.1Â°C/h trend[0m
[36m2025-10-28 08:10:31.329 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 08:10:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 08:10:31.330 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 08:10:31.330 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=52.1[0m
[36m2025-10-28 08:10:31.330 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 08:10:31.333 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 08:10:31.333 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 08:10:31.333 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 08:10:31.339 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 08:10:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 08:10:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 08:10:31.339 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 08:10:31.340 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.020 seconds (success: True)[0m
[36m2025-10-28 08:10:31.341 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.3 + 1.2 + 0.6)A Ã— 0.95 = 1.39 kW[0m
[36m2025-10-28 08:15:31.319 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 08:15:31.320 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.1Â°C (median of 9 sensors: 23.6Â°C, 21.2Â°C, 22.0Â°C, 23.0Â°C, 25.7Â°C, 23.5Â°C, 22.5Â°C, 23.1Â°C, 25.0Â°C)[0m
[36m2025-10-28 08:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -26.0[0m
[36m2025-10-28 08:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 52.1Â°C[0m
[36m2025-10-28 08:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.5Â°C[0m
[36m2025-10-28 08:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.3A, L2=1.2A, L3=0.6A[0m
[36m2025-10-28 08:15:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.1Â°C, outdoor 8.2Â°C, flow 30.5Â°C, DM -26[0m
[36m2025-10-28 08:15:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor Hz not available from NIBE adapter[0m
[36m2025-10-28 08:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 08:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 08:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 08:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 08:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 08:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 08:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 08:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 08:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 08:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 08:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 62}[0m
[36m2025-10-28 08:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 08:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 08:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 08:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 08:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 08:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 08:15:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 08:15:31.321 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 08:15:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q33 = 101.24 Ã¶re/kWh[0m
[36m2025-10-28 08:15:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 08:15:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 08:15:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 08:15:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 08:15:31.322 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 08:15:31.322 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 08:15:31.322 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 08:15:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 08:15:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 08:15:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 08:15:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 08:15:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 08:15:31.323 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 08:15:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 08:15:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 08:15:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 08:15:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=30.5Â°C, error=-4.1Â°C, sensitivity=1.5 -> offset=-2.7[0m
[36m2025-10-28 08:15:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 08:15:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.24[0m
[36m2025-10-28 08:15:31.324 DEBUG (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Price classification Q33 (08:15): 101.24 â†’ NORMAL[0m
[32m2025-10-28 08:15:31.324 INFO (SyncWorker_5) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.73Â°C - Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.24 | GE-Spot Q33: NORMAL (day) | Too warm: 2.1Â°C over[0m
[32m2025-10-28 08:15:31.325 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.73Â°C, reasoning: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.24 | GE-Spot Q33: NORMAL (day) | Too warm: 2.1Â°C over[0m
[36m2025-10-28 08:15:31.325 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset calculation: original=-0.73Â°C, integer=0Â°C, fractional=-0.73Â°C, accumulator_before=-0.60Â°C[0m
[32m2025-10-28 08:15:31.325 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] âœ“ Accumulated fractional offset reached threshold: applying -1Â°C adjustment (accumulator: -1.33Â°C â†’ -0.33Â°C)[0m
[36m2025-10-28 08:15:31.325 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Accumulator triggered: total_accumulated=-1.33Â°C, adjustment=-1Â°C, new_integer=-1Â°C, remaining=-0.33Â°C[0m
[36m2025-10-28 08:15:31.325 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] â†’ Deferring fractional offset -0.73Â°C â†’ applying -1Â°C (accumulator: -0.33Â°C, needs 0.67Â°C more to trigger)[0m
[32m2025-10-28 08:15:31.327 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Set NIBE offset to -1Â°C (calculated: -0.73Â°C, accumulator: -0.33Â°C)[0m
[36m2025-10-28 08:15:31.327 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Offset write complete: entity=number.f750_cu_3x400v_heating_offset_climate_system_1, value=-1Â°C, original=-0.73Â°C, accumulator=-0.33Â°C[0m
[32m2025-10-28 08:15:31.327 INFO (MainThread) [custom_components.effektguard.coordinator] Applied offset -0.73Â°C to NIBE via MyUplink[0m
[36m2025-10-28 08:15:31.327 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.000 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 08:15:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-28 08:15:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.1Â°C, outdoor=8.2Â°C, offset=-0.7Â°C, change=-0.02Â°C, Î”t=0.08h[0m
[36m2025-10-28 08:15:31.327 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.1Â°C, outdoor=8.2Â°C, offset=-0.7Â°C, flow=30.5Â°C, DM=-26[0m
[36m2025-10-28 08:15:31.332 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.2Â°C/h trend[0m
[36m2025-10-28 08:15:31.332 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 08:15:31.333 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 08:15:31.333 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 08:15:31.333 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=52.1[0m
[36m2025-10-28 08:15:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 08:15:31.343 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 08:15:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 08:15:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 08:15:31.345 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 08:15:31.345 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 08:15:31.345 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 08:15:31.346 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 08:15:31.346 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.026 seconds (success: True)[0m
[36m2025-10-28 08:15:31.347 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.3 + 1.2 + 0.6)A Ã— 0.95 = 1.39 kW[0m
[36m2025-10-28 08:20:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 08:20:31.320 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.1Â°C (median of 9 sensors: 23.6Â°C, 21.2Â°C, 21.9Â°C, 22.9Â°C, 25.7Â°C, 23.5Â°C, 22.5Â°C, 23.1Â°C, 25.0Â°C)[0m
[36m2025-10-28 08:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -31.0[0m
[36m2025-10-28 08:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 52.1Â°C[0m
[36m2025-10-28 08:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.5Â°C[0m
[36m2025-10-28 08:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.3A, L2=1.2A, L3=0.6A[0m
[36m2025-10-28 08:20:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.1Â°C, outdoor 8.2Â°C, flow 30.5Â°C, DM -31[0m
[36m2025-10-28 08:20:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor Hz not available from NIBE adapter[0m
[36m2025-10-28 08:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 08:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 08:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 08:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 08:20:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 08:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 08:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 08:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 08:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 08:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 08:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 62}[0m
[36m2025-10-28 08:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 08:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 08:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 08:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 08:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 08:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 08:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 08:20:31.321 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 08:20:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q33 = 101.24 Ã¶re/kWh[0m
[36m2025-10-28 08:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 08:20:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 08:20:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 08:20:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 08:20:31.322 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 08:20:31.323 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 08:20:31.323 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 08:20:31.323 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 08:20:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 08:20:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 08:20:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 08:20:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 08:20:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 08:20:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 08:20:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 08:20:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 08:20:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=30.5Â°C, error=-4.1Â°C, sensitivity=1.5 -> offset=-2.7[0m
[36m2025-10-28 08:20:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 08:20:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.24[0m
[36m2025-10-28 08:20:31.324 DEBUG (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Price classification Q33 (08:20): 101.24 â†’ NORMAL[0m
[32m2025-10-28 08:20:31.325 INFO (SyncWorker_3) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.73Â°C - Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.24 | GE-Spot Q33: NORMAL (day) | Too warm: 2.1Â°C over[0m
[32m2025-10-28 08:20:31.325 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.73Â°C, reasoning: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.24 | GE-Spot Q33: NORMAL (day) | Too warm: 2.1Â°C over[0m
[36m2025-10-28 08:20:31.326 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset -0.73Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-28 08:20:31.326 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.000 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 08:20:31.326 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-28 08:20:31.326 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.1Â°C, outdoor=8.2Â°C, offset=-0.7Â°C, change=-0.01Â°C, Î”t=0.08h[0m
[36m2025-10-28 08:20:31.326 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.1Â°C, outdoor=8.2Â°C, offset=-0.7Â°C, flow=30.5Â°C, DM=-31[0m
[36m2025-10-28 08:20:31.326 DEBUG (MainThread) [custom_components.effektguard.coordinator] Skipping thermal predictor save - throttled (300s since last save)[0m
[36m2025-10-28 08:20:31.326 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 08:20:31.329 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 08:20:31.329 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 08:20:31.329 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=52.1[0m
[36m2025-10-28 08:20:31.329 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 08:20:31.331 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 08:20:31.331 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 08:20:31.331 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 08:20:31.334 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 08:20:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 08:20:31.334 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 08:20:31.335 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 08:20:31.335 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.015 seconds (success: True)[0m
[36m2025-10-28 08:20:31.336 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.3 + 1.2 + 0.6)A Ã— 0.95 = 1.39 kW[0m
[36m2025-10-28 08:25:31.319 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 08:25:31.319 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.0Â°C (median of 9 sensors: 23.6Â°C, 21.2Â°C, 22.1Â°C, 22.9Â°C, 25.6Â°C, 23.5Â°C, 22.5Â°C, 23.0Â°C, 25.0Â°C)[0m
[36m2025-10-28 08:25:31.319 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -35.0[0m
[36m2025-10-28 08:25:31.319 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 52.1Â°C[0m
[36m2025-10-28 08:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.5Â°C[0m
[36m2025-10-28 08:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.3A, L2=1.2A, L3=0.6A[0m
[36m2025-10-28 08:25:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.0Â°C, outdoor 8.2Â°C, flow 30.5Â°C, DM -35[0m
[36m2025-10-28 08:25:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor Hz not available from NIBE adapter[0m
[36m2025-10-28 08:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 08:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 08:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 08:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 08:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 08:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 08:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 08:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 08:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 08:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 08:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 62}[0m
[36m2025-10-28 08:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 08:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 08:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 08:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 08:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 08:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 08:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 08:25:31.320 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 08:25:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q33 = 101.24 Ã¶re/kWh[0m
[36m2025-10-28 08:25:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 08:25:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 08:25:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 08:25:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 08:25:31.322 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 08:25:31.322 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 08:25:31.322 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 08:25:31.323 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 08:25:31.323 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 08:25:31.323 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 08:25:31.323 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 08:25:31.323 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 08:25:31.323 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 08:25:31.323 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 08:25:31.323 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 08:25:31.324 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 08:25:31.324 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=30.5Â°C, error=-4.1Â°C, sensitivity=1.5 -> offset=-2.7[0m
[36m2025-10-28 08:25:31.324 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 08:25:31.324 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.24[0m
[36m2025-10-28 08:25:31.324 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Price classification Q33 (08:25): 101.24 â†’ NORMAL[0m
[32m2025-10-28 08:25:31.324 INFO (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.72Â°C - Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.24 | GE-Spot Q33: NORMAL (day) | Too warm: 2.0Â°C over[0m
[32m2025-10-28 08:25:31.326 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.72Â°C, reasoning: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.24 | GE-Spot Q33: NORMAL (day) | Too warm: 2.0Â°C over[0m
[36m2025-10-28 08:25:31.326 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset -0.72Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-28 08:25:31.326 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.001 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 08:25:31.326 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-28 08:25:31.326 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.0Â°C, outdoor=8.2Â°C, offset=-0.7Â°C, change=-0.02Â°C, Î”t=0.08h[0m
[36m2025-10-28 08:25:31.326 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.0Â°C, outdoor=8.2Â°C, offset=-0.7Â°C, flow=30.5Â°C, DM=-35[0m
[36m2025-10-28 08:25:31.334 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.2Â°C/h trend[0m
[36m2025-10-28 08:25:31.334 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 08:25:31.337 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 08:25:31.338 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 08:25:31.338 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=52.1[0m
[36m2025-10-28 08:25:31.338 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 08:25:31.341 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 08:25:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 08:25:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 08:25:31.343 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 08:25:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 08:25:31.343 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 08:25:31.343 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 08:25:31.343 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.024 seconds (success: True)[0m
[36m2025-10-28 08:25:31.344 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.3 + 1.2 + 0.6)A Ã— 0.95 = 1.39 kW[0m
[36m2025-10-28 08:30:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Starting EffektGuard data update[0m
[32m2025-10-28 08:30:31.320 INFO (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Multi-sensor indoor temp: 23.0Â°C (median of 9 sensors: 23.6Â°C, 21.2Â°C, 22.0Â°C, 22.9Â°C, 25.6Â°C, 23.5Â°C, 22.7Â°C, 23.0Â°C, 25.0Â°C)[0m
[36m2025-10-28 08:30:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Using configured degree minutes sensor: sensor.f750_cu_3x400v_degree_minutes = -37.0[0m
[36m2025-10-28 08:30:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW top temperature (BT7): 52.1Â°C[0m
[36m2025-10-28 08:30:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] DHW charging temperature (BT6): 30.5Â°C[0m
[36m2025-10-28 08:30:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] Phase currents (BE): L1=4.3A, L2=1.2A, L3=0.6A[0m
[36m2025-10-28 08:30:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] NIBE data retrieved: indoor 23.0Â°C, outdoor 8.2Â°C, flow 30.5Â°C, DM -37[0m
[36m2025-10-28 08:30:31.320 DEBUG (MainThread) [custom_components.effektguard.coordinator] Compressor Hz not available from NIBE adapter[0m
[36m2025-10-28 08:30:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot entity sensor.gespot_current_price_se4 attributes:[0m
[36m2025-10-28 08:30:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - currency: SEK[0m
[36m2025-10-28 08:30:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - area: SE4[0m
[36m2025-10-28 08:30:31.320 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - vat: 0.0%[0m
[36m2025-10-28 08:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - display_unit: cents[0m
[36m2025-10-28 08:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - use_subunit: True[0m
[36m2025-10-28 08:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_source: nordpool[0m
[36m2025-10-28 08:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - source_info: {'validated_sources': ['energy_charts', 'entsoe', 'nordpool'], 'active_source': 'nordpool'}[0m
[36m2025-10-28 08:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - ha_timezone: Europe/Stockholm[0m
[36m2025-10-28 08:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - api_timezone: Europe/Oslo[0m
[36m2025-10-28 08:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - data_validity: {'data_valid_until': '2025-10-29T00:00:00+01:00', 'last_valid_interval': '2025-10-28T23:45:00+01:00', 'interval_count': 96, 'today_intervals': 96, 'tomorrow_intervals': 0, 'has_current_interval': True, 'intervals_remaining': 61}[0m
[36m2025-10-28 08:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - today_interval_prices: list with 96 items[0m
[36m2025-10-28 08:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_interval_prices: list with 0 items[0m
[36m2025-10-28 08:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - tomorrow_valid: False[0m
[36m2025-10-28 08:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - unit_of_measurement: Ã¶re/kWh[0m
[36m2025-10-28 08:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - device_class: monetary[0m
[36m2025-10-28 08:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter]   - friendly_name: GE-Spot Current Price SE4[0m
[36m2025-10-28 08:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot configured unit: Ã¶re/kWh (using prices as-is, no conversion)[0m
[32m2025-10-28 08:30:31.321 INFO (MainThread) [custom_components.effektguard.adapters.gespot_adapter] GE-Spot prices loaded: 96 today only (tomorrow not yet available) in Ã¶re/kWh[0m
[36m2025-10-28 08:30:31.321 DEBUG (MainThread) [custom_components.effektguard.coordinator] GE-Spot data retrieved: 96 quarters today, current Q34 = 94.69 Ã¶re/kWh[0m
[36m2025-10-28 08:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Reading weather forecast from entity: weather.openweathermap[0m
[36m2025-10-28 08:30:31.321 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] No forecast attribute in weather.openweathermap, trying weather.get_forecasts service call[0m
[36m2025-10-28 08:30:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Service call response keys: ['weather.openweathermap'][0m
[36m2025-10-28 08:30:31.322 DEBUG (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast retrieved via service call: 48 hours[0m
[32m2025-10-28 08:30:31.323 INFO (MainThread) [custom_components.effektguard.adapters.weather_adapter] Weather forecast from weather.openweathermap: 48 hours available (sufficient for optimization)[0m
[36m2025-10-28 08:30:31.323 DEBUG (MainThread) [custom_components.effektguard.coordinator] Weather data retrieved: current 9.2Â°C, 48 hours forecast[0m
[36m2025-10-28 08:30:31.326 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Calculating optimization decision[0m
[36m2025-10-28 08:30:31.327 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.price_analyzer] Price percentiles - P25: 56.117, P50: 84.179, P75: 104.332, P90: 129.043[0m
[36m2025-10-28 08:30:31.327 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.price_analyzer] Classified 96 today periods, 0 tomorrow periods[0m
[36m2025-10-28 08:30:31.327 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 08:30:31.327 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Expected DM for Moderate Cold zone at 8.2Â°C: normal -116 to -316, warning -316[0m
[36m2025-10-28 08:30:31.328 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 08:30:31.328 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Thermal mass adjusted thresholds: heating type 'radiator' (multiplier 1.00) â†’ warning -316 (base: -316), critical -1500[0m
[36m2025-10-28 08:30:31.328 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] KÃ¼hne formula: outdoor=8.2Â°C, indoor_target=21.0Â°C, temp_diff=12.8Â°C, HC=0.180 kW/K -> flow=25.9Â°C[0m
[36m2025-10-28 08:30:31.328 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_learning] No historical data for 10-5, using seasonal defaults: avg=9.8Â°C (range: 5.8 to 13.8Â°C)[0m
[36m2025-10-28 08:30:31.328 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] Safety margin calculation: zone_base=0.5Â°C, temp_adj=0.0Â°C, learning=0.0Â°C -> total=0.5Â°C[0m
[36m2025-10-28 08:30:31.328 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] Offset calculation: optimal=26.4Â°C, current=30.5Â°C, error=-4.1Â°C, sensitivity=1.5 -> offset=-2.7[0m
[36m2025-10-28 08:30:31.328 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.weather_compensation] Dynamic weight: outdoor=8.2Â°C (zone_low=-1.0Â°C), unusual=False -> weight=0.50[0m
[36m2025-10-28 08:30:31.328 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Weather compensation layer: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.24[0m
[36m2025-10-28 08:30:31.328 DEBUG (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Price classification Q34 (08:30): 94.69 â†’ NORMAL[0m
[32m2025-10-28 08:30:31.329 INFO (SyncWorker_4) [custom_components.effektguard.optimization.decision_engine] Decision: offset -0.72Â°C - Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.24 | GE-Spot Q34: NORMAL (day) | Too warm: 2.0Â°C over[0m
[32m2025-10-28 08:30:31.331 INFO (MainThread) [custom_components.effektguard.coordinator] Decision: offset -0.72Â°C, reasoning: Math WC: kuehne; Zone: Moderate Cold; Optimal: 25.9Â°C; Safety: +0.5Â°C; Adjusted: 26.4Â°C; Current: 30.5Â°C â†’ offset: -2.7Â°C; Weight: 0.24 | GE-Spot Q34: NORMAL (day) | Too warm: 2.0Â°C over[0m
[36m2025-10-28 08:30:31.331 DEBUG (MainThread) [custom_components.effektguard.coordinator] Offset -0.72Â°C matches last applied value, skipping redundant API call[0m
[36m2025-10-28 08:30:31.332 DEBUG (MainThread) [custom_components.effektguard.coordinator] ğŸ“Š External power meter (whole house): 0.003 kW from sensor.gen24_elnat_import_effekt[0m
[36m2025-10-28 08:30:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.effect_manager] Skipping peak recording: 0.00 kW below 0.5 kW threshold[0m
[36m2025-10-28 08:30:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.adaptive_learning] Recorded observation: indoor=23.0Â°C, outdoor=8.2Â°C, offset=-0.7Â°C, change=0.00Â°C, Î”t=0.08h[0m
[36m2025-10-28 08:30:31.332 DEBUG (MainThread) [custom_components.effektguard.optimization.thermal_predictor] Recorded thermal state: indoor=23.0Â°C, outdoor=8.2Â°C, offset=-0.7Â°C, flow=30.5Â°C, DM=-37[0m
[36m2025-10-28 08:30:31.337 DEBUG (MainThread) [custom_components.effektguard.coordinator] Saved thermal predictor state: 96 snapshots, -0.2Â°C/h trend[0m
[36m2025-10-28 08:30:31.337 DEBUG (MainThread) [custom_components.effektguard.coordinator] Recorded learning observations successfully[0m
[36m2025-10-28 08:30:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.savings_calculator] Savings estimate: Peak 13.31â†’11.32 kW (1.99 kW reduction), Effect: 100 SEK, Spot: 0 SEK/month, Total: 100 SEK/month[0m
[36m2025-10-28 08:30:31.339 DEBUG (MainThread) [custom_components.effektguard.coordinator] Estimated savings: 100 SEK/month (effect: 100 SEK, spot: 0 SEK)[0m
[36m2025-10-28 08:30:31.339 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW sensor check: has_dhw_top_temp=True, dhw_top_temp=52.1[0m
[36m2025-10-28 08:30:31.339 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 08:30:31.341 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 08:30:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 08:30:31.341 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 08:30:31.344 DEBUG (MainThread) [custom_components.effektguard.coordinator] Last DHW heating from history: 2025-10-28 04:03:16.676370+00:00[0m
[36m2025-10-28 08:30:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.climate_zones] DM range for 8.2Â°C (zone avg: -1.0Â°C, delta: 9.2Â°C): normal -116 to -316, warning -316, critical -1500[0m
[36m2025-10-28 08:30:31.344 DEBUG (MainThread) [custom_components.effektguard.optimization.dhw_optimizer] DHW DM thresholds for 8.2Â°C (zone: Moderate Cold): block=-316, abort=-396[0m
[36m2025-10-28 08:30:31.344 DEBUG (MainThread) [custom_components.effektguard.coordinator] DHW control: No change needed (should_heat=False, lux_on=False, reason=DHW_ADEQUATE)[0m
[36m2025-10-28 08:30:31.344 DEBUG (MainThread) [custom_components.effektguard.coordinator] Finished fetching effektguard data in 0.025 seconds (success: True)[0m
[36m2025-10-28 08:30:31.346 DEBUG (MainThread) [custom_components.effektguard.adapters.nibe_adapter] NIBE 3-phase power: 240.0V Ã— (4.3 + 1.2 + 0.6)A Ã— 0.95 = 1.39 kW[0m
